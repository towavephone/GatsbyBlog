webpackJsonp([0xbc0b0b31708d],{1306:function(n,a){n.exports={data:{file:{childImageSharp:{sizes:{base64:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAeCAYAAAAsEj5rAAAACXBIWXMAAAsSAAALEgHS3X78AAAHlElEQVRIx12We2xT5xXAbcI2Vmn7o1I1uhVYRxL8tuPn9bXv0+/4/YgdOyYkkATCCEEYsqVNC2wCIYQWShmUBFh4hMAWECot0BUtlI4yAS1oKqJQXimsDBgTU8codnLO7r0uUPpJn87Rp+/8vvOdc75zr8xmZmTieI1NykU5yxOfxDncz3NUjAlyDXMjXGMhys+cG+FzGQ8VU4t7XuV8z8m+GUkrJclSqVReYJ0ZWQ8Tl2AdTPhnq9ns2QKd+crDZiHha8NsYCE21HZiXphpb3sxxTf99Tdsw51ldHqFaLOXXyzvYqOyZ0YPk5soylfouuUbvHOxh56JbiqJfi4/FnE1lxKetrGUZ954nbcdU/752ORpxWVsc6mZjPxctFtApeVtra1lmIPwTxClgeCqvGTsX/WWOEbtyTGWSoGbToOPzUHQ1QghVxOEhRniZ5U8XB4TzvTdgj1ZJdq2OOrkGhVRBnrYFum6TiK0l2fr0emMlVxcBhlnEniqDjlBuqg0CnD0MPWiDrwzhR4u+5B3x3WiLUNHJjxzZYvR8ZKTCP+Xo1JoM/nBYvSB1egHuyUIrCOBPj4LtD0KlD2K4h7SGip62aygxzaK9rHA3Aqt2vw0MRYjnyJtYaQdsXG9hgWFwgmVlXZUKUjUqmm0CgfwhA80Kgr1Wg40Sue4SuFEnZq+YjMbJ0kh0zmfemjQ0j2EJYh2a23RVOODIBvHmCsBUaoWLDoWKIsP50bTApxC5QwH1Ghp0Gk4MBk8aDLQEslooCc88VClsK+zGANI2mqLer0XFuea8PSuN+DM7o3QWyhAR7IBfj+vDbyOICS9aSjkZo8nvSlUKuxXLDUOKdN6LSl/AlRUE+vNAnD50l8XeTIEPiYEzXYG5mlNeGz7BvjPpY/g5snDcHxwE+zs7oCh1zvHCrNm48u/ML8j2muVQblBZ3t6ZY2KXKtQcDiwdk1xx9rV0BlqghEuD4fNUTy1Zwhw7Cbioxu461fdsOgFDa5pbh3zu6NifE9f+XCPlGHS5nuaFI3K8brJ4EUHES4WFiyEP2/dCPc2vYH/3NIHePcywP1LWLp3Ec4tWQa3FvbAu7294yqVA801rju5utYfiQyKDD4DnC8GWEhMafJPtBALxuHjo3+C8bufIn59DfHBFcDiDcQvzyF+/iEsbWuDadNMaDW5H7nY6Iyyh165zfLNtdUqIqLTsEJSQqBVUTD1JQPqdRT8sf9NuH7kMHy0fRg+O3EUzp96H/Zs2SBklxFKxwFmowtdTCIoPQx7oKLzl32PPTRPVSudDwQgCrUGL0+twdzsDjjSdwD2J1fh/q7N0N+1EtykB178qVY4lAahRktWkw95JrG4DAxPvHU3Wwb+rlcsHfK0WNxCoMdUCgdUaxnMBPKw7dVe2LyhDw4MboORA4NQOd2CaiUFaqWjZJGAyQGRUeubP8FqElqZspquEBeUM2zrnEQUa3R8USVcp2qGDZV6ErqXL4PfrlwFhSU9cPL4MejfshOsZq90sCg5KvHZ5MnPfa+cmFrxukRFuRZNcYqIoNngHheeFmiF11ClIDBdPwfqG9qhc1E3rF25GnrX90M204JqBfWItPrP8lTqa7vFpSw3GJ9cZjI4pW5TXaWezpKxh4Q5gEY9LwApVOtZMApxVWhd2DKvC7K5FjTUsFCj45Ah4yXaHuz1MBlgyHCb1HXISIXMTcekOJqN1h/72Mx92h5DwuwHjeChWseBQsNgJJ6H944eB5oNgaLajnaL/07E24wuKr7Cz+XuuenUsMioCxYmyHhnSPLQTYVVYVfjI46Mo80WBLMgLY4E1FhCOENBAsfHQG/0juuNPqGguU8ywXas5XNbg6783wJ8w781GtUPJc+irkap/Ufdje0JXytStnDJbA2D1Z4EKxEHsyUMRmsIdcZaNFpCYBYqwWQLPhD3Btn6t2Pe5uF0cD7Sdr/xmSab8racFaDooOvuk0wDEs40EFQGbVQGbEKXJoTPgZ3JoJGIgULvR6M1jE67rzvpae5ojC7GEJ9rfgILc7lC3NV0T6flTtjoPLK+VuD8rcD65gDtaQInPxOtzoxQRrXgD8/BdW/+YezYByfxvfdHvnxl+ZLKCDfzUMIze60Ey+brJukrqcjA1u3tBw8dfZiZuRQFaNFory/WEPUlE5kFK5WDQKRtbFPfUOnChUvFL27cwKuj/8CBHXv2iQw/k/KGuNwyCYiIkhw+sO/569eu7b1+ffR/H5z4BAcG38X1m/biyjX9ODR8GC9dHsXLV0fx5KlzePDIyFd7ht9ZJZhJrcvLhV/wMuUPljQWtC6Z+FjfuWPHlPMXLq64Onpz3d8/Pf9WX//OW2vWbITBof3n3tqya9fbh/7SvW1gZ9Xj/V1dr8kf614qIZONjBwrezi8Ty54K5d9ZzTmF+xe1LnioaD+4Nvrn4/ermif3yHp8UCDLMCky7Z+n192+/YdST9z5mPZ7t1D8ouXv6gQ4S9WTplks7mut8xZijxbKz2vvi2D39/cPyB/HC5xOm2czPvd35F8rkGCS0+I4WXV1QbJaMq06XqbNXCQJIILpH8hOic3GghZMpl62qG/Nf4PRzaQ862MzO4AAAAASUVORK5CYII=",aspectRatio:.6666666666666666,src:"/static/avatar-dc7bc85837bf005ae32d2a37dfdfa8a2-25c91.png",srcSet:"/static/avatar-dc7bc85837bf005ae32d2a37dfdfa8a2-8a97b.png 200w,\n/static/avatar-dc7bc85837bf005ae32d2a37dfdfa8a2-0fdf3.png 400w,\n/static/avatar-dc7bc85837bf005ae32d2a37dfdfa8a2-25c91.png 600w",srcWebp:"/static/avatar-dc7bc85837bf005ae32d2a37dfdfa8a2-216f6.webp",srcSetWebp:"/static/avatar-dc7bc85837bf005ae32d2a37dfdfa8a2-5d70e.webp 200w,\n/static/avatar-dc7bc85837bf005ae32d2a37dfdfa8a2-d1677.webp 400w,\n/static/avatar-dc7bc85837bf005ae32d2a37dfdfa8a2-216f6.webp 600w",sizes:"(max-width: 600px) 100vw, 600px"}}},site:{siteMetadata:{title:"å¥³ç‹æ§çš„åšå®¢",description:'å‰ç«¯å·¥ç¨‹å¸ˆï¼Œé»‘çŒ«å¥³ç‹æ§ï¼Œæ¬¢è¿å‹¾æ­ï¼ŒæŠ€æœ¯ç›¸å…³<a href="https://github.com/towavephone" target="_blank">@towavephone</a>ï¼ŒQQé—²èŠ<a href="tencent://AddContact/?fromId=45&fromSubId=1&subcmd=all&uin=634407147&website=www.oicqzone.com">@towave</a>ï¼Œbiliå…³æ³¨<a href="https://space.bilibili.com/11507708#/" target="_blank">@towave</a>',siteUrl:"https://blog.towavephone.com"}},mainPost:{html:'<h1 id="ä¸€ä¸ªç«™ç‚¹é…ç½®å¤šä¸ªåŸŸå"><a href="#%E4%B8%80%E4%B8%AA%E7%AB%99%E7%82%B9%E9%85%8D%E7%BD%AE%E5%A4%9A%E4%B8%AA%E5%9F%9F%E5%90%8D" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ä¸€ä¸ªç«™ç‚¹é…ç½®å¤šä¸ªåŸŸå</h1>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="30486592483215036000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="å¤åˆ¶æˆåŠŸ"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`server {\n    listen       80;\n    server_name  ops-coffee.cn b.ops-coffee.cn;\n}`, `30486592483215036000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title=""\n              >\n                \n                <span class="gatsby-code-button-text-icon">å¤åˆ¶ä»£ç </span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="text"><pre style="counter-reset: linenumber NaN" class="language-text line-numbers"><code class="language-text">server {\n    listen       80;\n    server_name  ops-coffee.cn b.ops-coffee.cn;\n}</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>server_name åè·Ÿå¤šä¸ªåŸŸåå³å¯ï¼Œå¤šä¸ªåŸŸåä¹‹é—´ç”¨ç©ºæ ¼åˆ†éš”</p>\n<h1 id="ä¸€ä¸ªæœåŠ¡é…ç½®å¤šä¸ªç«™ç‚¹"><a href="#%E4%B8%80%E4%B8%AA%E6%9C%8D%E5%8A%A1%E9%85%8D%E7%BD%AE%E5%A4%9A%E4%B8%AA%E7%AB%99%E7%82%B9" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ä¸€ä¸ªæœåŠ¡é…ç½®å¤šä¸ªç«™ç‚¹</h1>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="45447780058798520000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="å¤åˆ¶æˆåŠŸ"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`server {\n    listen       80;\n    server_name  a.ops-coffee.cn;\n\n    location / {\n        root /home/project/pa;\n        index index.html;\n    }\n}\n\nserver {\n    listen       80;\n    server_name  ops-coffee.cn b.ops-coffee.cn;\n\n    location / {\n        root /home/project/pb;\n        index index.html;\n    }\n}\n\nserver {\n    listen       80;\n    server_name  c.ops-coffee.cn;\n\n    location / {\n        root /home/project/pc;\n        index index.html;\n    }\n}`, `45447780058798520000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title=""\n              >\n                \n                <span class="gatsby-code-button-text-icon">å¤åˆ¶ä»£ç </span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="text"><pre style="counter-reset: linenumber NaN" class="language-text line-numbers"><code class="language-text">server {\n    listen       80;\n    server_name  a.ops-coffee.cn;\n\n    location / {\n        root /home/project/pa;\n        index index.html;\n    }\n}\n\nserver {\n    listen       80;\n    server_name  ops-coffee.cn b.ops-coffee.cn;\n\n    location / {\n        root /home/project/pb;\n        index index.html;\n    }\n}\n\nserver {\n    listen       80;\n    server_name  c.ops-coffee.cn;\n\n    location / {\n        root /home/project/pc;\n        index index.html;\n    }\n}</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>åŸºäº nginx è™šæ‹Ÿä¸»æœºé…ç½®å®ç°ï¼Œnginx æœ‰ä¸‰ç§ç±»å‹çš„è™šæ‹Ÿä¸»æœº</p>\n<p>åŸºäº ip çš„è™šæ‹Ÿä¸»æœºï¼šéœ€è¦ä½ çš„æœåŠ¡å™¨ä¸Šæœ‰å¤šä¸ªåœ°å€ï¼Œæ¯ä¸ªç«™ç‚¹å¯¹åº”ä¸åŒçš„åœ°å€ï¼Œè¿™ç§æ–¹å¼ä½¿ç”¨çš„æ¯”è¾ƒå°‘</p>\n<p>åŸºäºç«¯å£çš„è™šæ‹Ÿä¸»æœºï¼šæ¯ä¸ªç«™ç‚¹å¯¹åº”ä¸åŒçš„ç«¯å£ï¼Œè®¿é—®çš„æ—¶å€™ä½¿ç”¨ ip:port çš„æ–¹å¼è®¿é—®ï¼Œå¯ä»¥ä¿®æ”¹ listen çš„ç«¯å£æ¥ä½¿ç”¨</p>\n<p>åŸºäºåŸŸåçš„è™šæ‹Ÿä¸»æœºï¼šä½¿ç”¨æœ€å¹¿çš„æ–¹å¼ï¼Œä¸Šè¾¹ä¾‹å­ä¸­å°±æ˜¯ç”¨äº†åŸºäºåŸŸåçš„è™šæ‹Ÿä¸»æœºï¼Œå‰ææ¡ä»¶æ˜¯ä½ æœ‰å¤šä¸ªåŸŸååˆ†åˆ«å¯¹åº”æ¯ä¸ªç«™ç‚¹ï¼Œserver_name å¡«å†™ä¸åŒçš„åŸŸåå³å¯</p>\n<h1 id="nginx-æ·»åŠ è´¦å·å¯†ç éªŒè¯"><a href="#nginx-%E6%B7%BB%E5%8A%A0%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E9%AA%8C%E8%AF%81" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>nginx æ·»åŠ è´¦å·å¯†ç éªŒè¯</h1>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="11809241179937513000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="å¤åˆ¶æˆåŠŸ"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`server {\n    location / {\n        auth_basic &quot;please input user&passwd&quot;;\n        auth_basic_user_file key/auth.key;\n    }\n}`, `11809241179937513000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title=""\n              >\n                \n                <span class="gatsby-code-button-text-icon">å¤åˆ¶ä»£ç </span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="text"><pre style="counter-reset: linenumber NaN" class="language-text line-numbers"><code class="language-text">server {\n    location / {\n        auth_basic &quot;please input user&amp;passwd&quot;;\n        auth_basic_user_file key/auth.key;\n    }\n}</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>æœ‰å¾ˆå¤šæœåŠ¡é€šè¿‡ nginx è®¿é—®ï¼Œä½†æœ¬èº«æ²¡æœ‰æä¾›è´¦å·è®¤è¯çš„åŠŸèƒ½ï¼Œå°±å¯ä»¥é€šè¿‡ nginx æä¾›çš„ authbase è´¦å·å¯†ç è®¤è¯æ¥å®ç°ï¼Œå¯ä»¥ç”¨ä»¥ä¸‹è„šæœ¬æ¥ç”Ÿæˆè´¦å·çš„å¯†ç </p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="36470967567936864000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="å¤åˆ¶æˆåŠŸ"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`# cat pwd.pl\n#!/usr/bin/perl\nuse strict;\n\nmy \\$pw=\\$ARGV[0] ;\nprint crypt(\\$pw,\\$pw).&quot;\\n&quot;;`, `36470967567936864000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="bash"\n              >\n                <span class="gatsby-code-button-language">bash</span>\n                <span class="gatsby-code-button-text-icon">å¤åˆ¶ä»£ç </span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash"><span class="token comment"># cat pwd.pl</span>\n<span class="token comment">#!/usr/bin/perl</span>\nuse strict<span class="token punctuation">;</span>\n\nmy <span class="token variable">$pw</span><span class="token operator">=</span><span class="token variable">$ARGV</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">;</span>\nprint crypt<span class="token punctuation">(</span><span class="token variable">$pw</span>,<span class="token variable">$pw</span><span class="token punctuation">)</span>.<span class="token string">"<span class="token entity" title="\\n">\\n</span>"</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>ä½¿ç”¨æ–¹æ³•ï¼š</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="96265971769938000000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="å¤åˆ¶æˆåŠŸ"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`# perl pwd.pl ops-coffee.cn\nopf8BImqCAXww\n# echo &quot;admin:opf8BImqCAXww&quot; > key/auth.key`, `96265971769938000000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="bash"\n              >\n                <span class="gatsby-code-button-language">bash</span>\n                <span class="gatsby-code-button-text-icon">å¤åˆ¶ä»£ç </span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash"><span class="token comment"># perl pwd.pl ops-coffee.cn</span>\nopf8BImqCAXww\n<span class="token comment"># echo "admin:opf8BImqCAXww" > key/auth.key</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<h1 id="nginx-å¼€å¯åˆ—ç›®å½•"><a href="#nginx-%E5%BC%80%E5%90%AF%E5%88%97%E7%9B%AE%E5%BD%95" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>nginx å¼€å¯åˆ—ç›®å½•</h1>\n<p>å½“ä½ æƒ³è®© nginx ä½œä¸ºæ–‡ä»¶ä¸‹è½½æœåŠ¡å™¨å­˜åœ¨æ—¶ï¼Œéœ€è¦å¼€å¯ nginx åˆ—ç›®å½•</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="55392431592076270000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="å¤åˆ¶æˆåŠŸ"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`server {\n    location download {\n        autoindex on;\n\n        autoindex_exact_size off;\n        autoindex_localtime on;\n    }\n}`, `55392431592076270000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title=""\n              >\n                \n                <span class="gatsby-code-button-text-icon">å¤åˆ¶ä»£ç </span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="text"><pre style="counter-reset: linenumber NaN" class="language-text line-numbers"><code class="language-text">server {\n    location download {\n        autoindex on;\n\n        autoindex_exact_size off;\n        autoindex_localtime on;\n    }\n}</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><code class="language-text">autoindex_exact_size</code>ï¼šä¸º onï¼ˆé»˜è®¤ï¼‰æ—¶æ˜¾ç¤ºæ–‡ä»¶çš„ç¡®åˆ‡å¤§å°ï¼Œå•ä½æ˜¯ byteï¼›æ”¹ä¸º off æ˜¾ç¤ºæ–‡ä»¶å¤§æ¦‚å¤§å°ï¼Œå•ä½ KB æˆ– MB æˆ– GB</p>\n<p><code class="language-text">autoindex_localtime</code>ï¼šä¸º offï¼ˆé»˜è®¤ï¼‰æ—¶æ˜¾ç¤ºçš„æ–‡ä»¶æ—¶é—´ä¸º GMT æ—¶é—´ï¼›æ”¹ä¸º on åï¼Œæ˜¾ç¤ºçš„æ–‡ä»¶æ—¶é—´ä¸ºæœåŠ¡å™¨æ—¶é—´</p>\n<p>é»˜è®¤å½“è®¿é—®åˆ—å‡ºçš„ txt ç­‰æ–‡ä»¶æ—¶ä¼šåœ¨æµè§ˆå™¨ä¸Šæ˜¾ç¤ºæ–‡ä»¶çš„å†…å®¹ï¼Œå¦‚æœä½ æƒ³è®©æµè§ˆå™¨ç›´æ¥ä¸‹è½½ï¼ŒåŠ ä¸Šä¸‹è¾¹çš„é…ç½®</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="64681518509818030000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="å¤åˆ¶æˆåŠŸ"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`if (\\$request_filename ~* ^.*?\\.(txt|pdf|jpg|png)\\$) {\n    add_header Content-Disposition \'attachment\';\n}`, `64681518509818030000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title=""\n              >\n                \n                <span class="gatsby-code-button-text-icon">å¤åˆ¶ä»£ç </span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="text"><pre style="counter-reset: linenumber NaN" class="language-text line-numbers"><code class="language-text">if ($request_filename ~* ^.*?\\.(txt|pdf|jpg|png)$) {\n    add_header Content-Disposition &#39;attachment&#39;;\n}</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<h1 id="é…ç½®é»˜è®¤ç«™ç‚¹"><a href="#%E9%85%8D%E7%BD%AE%E9%BB%98%E8%AE%A4%E7%AB%99%E7%82%B9" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>é…ç½®é»˜è®¤ç«™ç‚¹</h1>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="81742300909219500000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="å¤åˆ¶æˆåŠŸ"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`server {\n    listen 80 default;\n}`, `81742300909219500000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title=""\n              >\n                \n                <span class="gatsby-code-button-text-icon">å¤åˆ¶ä»£ç </span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="text"><pre style="counter-reset: linenumber NaN" class="language-text line-numbers"><code class="language-text">server {\n    listen 80 default;\n}</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<p>å½“ä¸€ä¸ª nginx æœåŠ¡ä¸Šåˆ›å»ºäº†å¤šä¸ªè™šæ‹Ÿä¸»æœºæ—¶é»˜è®¤ä¼šä»ä¸Šåˆ°ä¸‹æŸ¥æ‰¾ï¼Œå¦‚æœåŒ¹é…ä¸åˆ°è™šæ‹Ÿä¸»æœºåˆ™ä¼šè¿”å›ç¬¬ä¸€ä¸ªè™šæ‹Ÿä¸»æœºçš„å†…å®¹ï¼Œå¦‚æœä½ æƒ³æŒ‡å®šä¸€ä¸ªé»˜è®¤ç«™ç‚¹æ—¶ï¼Œå¯ä»¥å°†è¿™ä¸ªç«™ç‚¹çš„è™šæ‹Ÿä¸»æœºæ”¾åœ¨é…ç½®æ–‡ä»¶ä¸­ç¬¬ä¸€ä¸ªè™šæ‹Ÿä¸»æœºçš„ä½ç½®ï¼Œæˆ–è€…åœ¨è¿™ä¸ªç«™ç‚¹çš„è™šæ‹Ÿä¸»æœºä¸Šé…ç½® listen default</p>\n<h1 id="ä¸å…è®¸é€šè¿‡-ip-è®¿é—®"><a href="#%E4%B8%8D%E5%85%81%E8%AE%B8%E9%80%9A%E8%BF%87-ip-%E8%AE%BF%E9%97%AE" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ä¸å…è®¸é€šè¿‡ IP è®¿é—®</h1>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="33057128389695390000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="å¤åˆ¶æˆåŠŸ"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`server {\n    listen       80 default;\n    server_name  _;\n\n    return      404;\n}`, `33057128389695390000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title=""\n              >\n                \n                <span class="gatsby-code-button-text-icon">å¤åˆ¶ä»£ç </span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="text"><pre style="counter-reset: linenumber NaN" class="language-text line-numbers"><code class="language-text">server {\n    listen       80 default;\n    server_name  _;\n\n    return      404;\n}</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>å¯èƒ½æœ‰ä¸€äº›æœªå¤‡æ¡ˆçš„åŸŸåæˆ–è€…ä½ ä¸å¸Œæœ›çš„åŸŸåå°†æœåŠ¡å™¨åœ°å€æŒ‡å‘äº†ä½ çš„æœåŠ¡å™¨ï¼Œè¿™æ—¶å€™å°±ä¼šå¯¹ä½ çš„ç«™ç‚¹é€ æˆä¸€å®šçš„å½±å“ï¼Œéœ€è¦ç¦æ­¢ IP æˆ–æœªé…ç½®çš„åŸŸåè®¿é—®ï¼Œæˆ‘ä»¬åˆ©ç”¨ä¸Šè¾¹æ‰€è¯´çš„ default è§„åˆ™ï¼Œå°†é»˜è®¤æµé‡éƒ½è½¬åˆ° 404 å»</p>\n<p>ä¸Šè¾¹è¿™ä¸ªæ–¹æ³•æ¯”è¾ƒç²—æš´ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥é…ç½®ä¸‹æ‰€æœ‰æœªé…ç½®çš„åœ°å€è®¿é—®æ—¶ç›´æ¥ 301 é‡å®šå‘åˆ°ä½ çš„ç½‘ç«™å»ï¼Œä¹Ÿèƒ½ä¸ºä½ çš„ç½‘ç«™å¸¦æ¥ä¸€å®šçš„æµé‡</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="66244827400132690000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="å¤åˆ¶æˆåŠŸ"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`server {\n    rewrite ^/(.*)\\$ https://ops-coffee.cn/\\$1    permanent;\n}`, `66244827400132690000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title=""\n              >\n                \n                <span class="gatsby-code-button-text-icon">å¤åˆ¶ä»£ç </span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="text"><pre style="counter-reset: linenumber NaN" class="language-text line-numbers"><code class="language-text">server {\n    rewrite ^/(.*)$ https://ops-coffee.cn/$1    permanent;\n}</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<h1 id="ç›´æ¥è¿”å›éªŒè¯æ–‡ä»¶"><a href="#%E7%9B%B4%E6%8E%A5%E8%BF%94%E5%9B%9E%E9%AA%8C%E8%AF%81%E6%96%87%E4%BB%B6" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ç›´æ¥è¿”å›éªŒè¯æ–‡ä»¶</h1>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="11227169317434282000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="å¤åˆ¶æˆåŠŸ"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`location = /XDFyle6tNA.txt {\n    default_type text/plain;\n    return 200 \'d6296a84657eb275c05c31b10924f6ea\';\n}`, `11227169317434282000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title=""\n              >\n                \n                <span class="gatsby-code-button-text-icon">å¤åˆ¶ä»£ç </span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="text"><pre style="counter-reset: linenumber NaN" class="language-text line-numbers"><code class="language-text">location = /XDFyle6tNA.txt {\n    default_type text/plain;\n    return 200 &#39;d6296a84657eb275c05c31b10924f6ea&#39;;\n}</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>å¾ˆå¤šæ—¶å€™å¾®ä¿¡ç­‰ç¨‹åºéƒ½éœ€è¦æˆ‘ä»¬æ”¾ä¸€ä¸ª txt çš„æ–‡ä»¶åˆ°é¡¹ç›®é‡Œä»¥éªŒè¯é¡¹ç›®å½’å±ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡ä¸Šè¾¹è¿™ç§æ–¹å¼ä¿®æ”¹ nginx å³å¯ï¼Œæ— éœ€çœŸæ­£çš„æŠŠæ–‡ä»¶ç»™æ”¾åˆ°æœåŠ¡å™¨ä¸Š</p>\n<h1 id="nginx-é…ç½®-upstream-åå‘ä»£ç†"><a href="#nginx-%E9%85%8D%E7%BD%AE-upstream-%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>nginx é…ç½® upstream åå‘ä»£ç†</h1>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="1956396321518116900"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="å¤åˆ¶æˆåŠŸ"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`http {\n    ...\n    upstream tomcats {\n        server 192.168.106.176 weight=1;\n        server 192.168.106.177 weight=1;\n    }\n\n    server {\n        location /ops-coffee/ {\n            proxy_pass http://tomcats;\n\n            proxy_set_header Host \\$host;\n            proxy_set_header X-Real-IP \\$remote_addr;\n            proxy_set_header X-Forwarded-For \\$proxy_add_x_forwarded_for;\n            proxy_set_header X-Forwarded-Proto \\$scheme;\n        }\n    }\n\n}`, `1956396321518116900`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title=""\n              >\n                \n                <span class="gatsby-code-button-text-icon">å¤åˆ¶ä»£ç </span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="text"><pre style="counter-reset: linenumber NaN" class="language-text line-numbers"><code class="language-text">http {\n    ...\n    upstream tomcats {\n        server 192.168.106.176 weight=1;\n        server 192.168.106.177 weight=1;\n    }\n\n    server {\n        location /ops-coffee/ {\n            proxy_pass http://tomcats;\n\n            proxy_set_header Host $host;\n            proxy_set_header X-Real-IP $remote_addr;\n            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n            proxy_set_header X-Forwarded-Proto $scheme;\n        }\n    }\n\n}</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>ç¨ä¸æ³¨æ„å¯èƒ½ä¼šè½å…¥ä¸€ä¸ª <code class="language-text">proxy_pass</code> åŠ æ ä¸åŠ æ çš„é™·é˜±ï¼Œè¿™é‡Œè¯¦ç»†è¯´ä¸‹ <code class="language-text">proxy_pass</code> <code class="language-text">http://tomcats</code> ä¸ <code class="language-text">proxy_pass</code> <code class="language-text">http://tomcats/</code> çš„åŒºåˆ«ï¼š</p>\n<p>è™½ç„¶åªæ˜¯ä¸€ä¸ª / çš„åŒºåˆ«ä½†ç»“æœç¡®åƒå·®ä¸‡åˆ«ã€‚åˆ†ä¸ºä»¥ä¸‹ä¸¤ç§æƒ…å†µï¼š</p>\n<ol>\n<li>\n<p>ç›®æ ‡åœ°å€ä¸­ä¸å¸¦ uri(<code class="language-text">proxy_pass</code> <code class="language-text">http://tomcats</code>)ã€‚æ­¤æ—¶æ–°çš„ç›®æ ‡ url ä¸­ï¼ŒåŒ¹é…çš„ uri éƒ¨åˆ†ä¸åšä¿®æ”¹ï¼ŒåŸæ¥æ˜¯ä»€ä¹ˆå°±æ˜¯ä»€ä¹ˆã€‚</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="49718729782984200000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="å¤åˆ¶æˆåŠŸ"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`location /ops-coffee/ {\n   proxy_pass  http://192.168.106.135:8181;\n}\n\nhttp://domain/ops-coffee/   -->     http://192.168.106.135:8181/ops-coffee/\nhttp://domain/ops-coffee/action/abc   -->     http://192.168.106.135:8181/ops-coffee/action/abc`, `49718729782984200000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title=""\n              >\n                \n                <span class="gatsby-code-button-text-icon">å¤åˆ¶ä»£ç </span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="text"><pre style="counter-reset: linenumber NaN" class="language-text line-numbers"><code class="language-text">location /ops-coffee/ {\n   proxy_pass  http://192.168.106.135:8181;\n}\n\nhttp://domain/ops-coffee/   --&gt;     http://192.168.106.135:8181/ops-coffee/\nhttp://domain/ops-coffee/action/abc   --&gt;     http://192.168.106.135:8181/ops-coffee/action/abc</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n</li>\n<li>\n<p>ç›®æ ‡åœ°å€ä¸­å¸¦ uri (<code class="language-text">proxy_pass</code> <code class="language-text">http://tomcats/</code>ï¼Œ/ä¹Ÿæ˜¯ uri) ,æ­¤æ—¶æ–°çš„ç›®æ ‡ url ä¸­ï¼ŒåŒ¹é…çš„ uri éƒ¨åˆ†å°†ä¼šè¢«ä¿®æ”¹ä¸ºè¯¥å‚æ•°ä¸­çš„ uriã€‚</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="7568435861555089000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="å¤åˆ¶æˆåŠŸ"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`location /ops-coffee/ {\n   proxy_pass  http://192.168.106.135:8181/;\n}\n\nhttp://domain/ops-coffee/   -->     http://192.168.106.135:8181\nhttp://domain/ops-coffee/action/abc   -->     http://192.168.106.135:8181/action/abc`, `7568435861555089000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title=""\n              >\n                \n                <span class="gatsby-code-button-text-icon">å¤åˆ¶ä»£ç </span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="text"><pre style="counter-reset: linenumber NaN" class="language-text line-numbers"><code class="language-text">location /ops-coffee/ {\n   proxy_pass  http://192.168.106.135:8181/;\n}\n\nhttp://domain/ops-coffee/   --&gt;     http://192.168.106.135:8181\nhttp://domain/ops-coffee/action/abc   --&gt;     http://192.168.106.135:8181/action/abc</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n</li>\n</ol>\n<h1 id="nginx-upstream-å¼€å¯-keepalive"><a href="#nginx-upstream-%E5%BC%80%E5%90%AF-keepalive" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>nginx upstream å¼€å¯ keepalive</h1>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="50926064743121870000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="å¤åˆ¶æˆåŠŸ"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`upstream tomcat {\n    server ops-coffee.cn:8080;\n    keepalive 1024;\n}\n\nserver {\n    location / {\n        proxy_http_version 1.1;\n        proxy_set_header Connection &quot;&quot;;\n\n        proxy_pass http://tomcat;\n    }\n}`, `50926064743121870000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title=""\n              >\n                \n                <span class="gatsby-code-button-text-icon">å¤åˆ¶ä»£ç </span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="text"><pre style="counter-reset: linenumber NaN" class="language-text line-numbers"><code class="language-text">upstream tomcat {\n    server ops-coffee.cn:8080;\n    keepalive 1024;\n}\n\nserver {\n    location / {\n        proxy_http_version 1.1;\n        proxy_set_header Connection &quot;&quot;;\n\n        proxy_pass http://tomcat;\n    }\n}</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>nginx åœ¨é¡¹ç›®ä¸­å¤§å¤šæ•°æƒ…å†µä¸‹ä¼šä½œä¸ºåå‘ä»£ç†ä½¿ç”¨ï¼Œä¾‹å¦‚ nginx åæ¥ tomcatï¼Œnginx åæ¥ php ç­‰ï¼Œè¿™æ—¶æˆ‘ä»¬å¼€å¯ nginx å’Œåç«¯æœåŠ¡ä¹‹é—´çš„ keepalive èƒ½å¤Ÿå‡å°‘é¢‘ç¹åˆ›å»º TCP è¿æ¥é€ æˆçš„èµ„æºæ¶ˆè€—ï¼Œé…ç½®å¦‚ä¸Š</p>\n<p>keepalive: æŒ‡å®šæ¯ä¸ª nginxworker å¯ä»¥ä¿æŒçš„æœ€å¤§è¿æ¥æ•°é‡ä¸º 1024ï¼Œé»˜è®¤ä¸è®¾ç½®ï¼Œå³ nginx ä½œä¸º client æ—¶ keepalive æœªç”Ÿæ•ˆ</p>\n<p><code class="language-text">proxy_http_version 1.1</code>: å¼€å¯ keepalive è¦æ±‚ HTTP åè®®ç‰ˆæœ¬ä¸º HTTP 1.1</p>\n<p><code class="language-text">proxy_set_header Connection &quot;&quot;</code>: ä¸ºäº†å…¼å®¹è€çš„åè®®ä»¥åŠé˜²æ­¢ http å¤´ä¸­æœ‰ Connection close å¯¼è‡´çš„ keepalive å¤±æ•ˆï¼Œè¿™é‡Œéœ€è¦åŠæ—¶æ¸…æ‰ HTTP å¤´éƒ¨çš„ Connection</p>\n<h1 id="404-è‡ªåŠ¨è·³è½¬åˆ°é¦–é¡µ"><a href="#404-%E8%87%AA%E5%8A%A8%E8%B7%B3%E8%BD%AC%E5%88%B0%E9%A6%96%E9%A1%B5" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>404 è‡ªåŠ¨è·³è½¬åˆ°é¦–é¡µ</h1>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="74238356167913470000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="å¤åˆ¶æˆåŠŸ"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`server {\n    location / {\n       error_page 404 =  @ops-coffee;\n    }\n\n    location @ops-coffee {\n       rewrite  .*  / permanent;\n    }\n}`, `74238356167913470000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title=""\n              >\n                \n                <span class="gatsby-code-button-text-icon">å¤åˆ¶ä»£ç </span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="text"><pre style="counter-reset: linenumber NaN" class="language-text line-numbers"><code class="language-text">server {\n    location / {\n       error_page 404 =  @ops-coffee;\n    }\n\n    location @ops-coffee {\n       rewrite  .*  / permanent;\n    }\n}</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>ç½‘ç«™å‡ºç° 404 é¡µé¢ä¸æ˜¯ç‰¹åˆ«å‹å¥½ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸Šè¾¹çš„é…ç½®åœ¨å‡ºç° 404 ä¹‹åç»™è‡ªåŠ¨è·³è½¬åˆ°é¦–é¡µå»</p>',
excerpt:"ä¸€ä¸ªç«™ç‚¹é…ç½®å¤šä¸ªåŸŸå server_name åè·Ÿå¤šä¸ªåŸŸåå³å¯ï¼Œå¤šä¸ªåŸŸåä¹‹é—´ç”¨ç©ºæ ¼åˆ†éš” ä¸€ä¸ªæœåŠ¡é…ç½®å¤šä¸ªç«™ç‚¹ åŸºäº nginx è™šæ‹Ÿä¸»æœºé…ç½®å®ç°ï¼Œnginx æœ‰ä¸‰ç§ç±»å‹çš„è™šæ‹Ÿä¸»æœº åŸºäº ipâ€¦",timeToRead:5,tableOfContents:'<ul>\n<li><a href="/nginx-common-configurations-techniques/#%E4%B8%80%E4%B8%AA%E7%AB%99%E7%82%B9%E9%85%8D%E7%BD%AE%E5%A4%9A%E4%B8%AA%E5%9F%9F%E5%90%8D">ä¸€ä¸ªç«™ç‚¹é…ç½®å¤šä¸ªåŸŸå</a></li>\n<li><a href="/nginx-common-configurations-techniques/#%E4%B8%80%E4%B8%AA%E6%9C%8D%E5%8A%A1%E9%85%8D%E7%BD%AE%E5%A4%9A%E4%B8%AA%E7%AB%99%E7%82%B9">ä¸€ä¸ªæœåŠ¡é…ç½®å¤šä¸ªç«™ç‚¹</a></li>\n<li><a href="/nginx-common-configurations-techniques/#nginx-%E6%B7%BB%E5%8A%A0%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E9%AA%8C%E8%AF%81">nginx æ·»åŠ è´¦å·å¯†ç éªŒè¯</a></li>\n<li><a href="/nginx-common-configurations-techniques/#nginx-%E5%BC%80%E5%90%AF%E5%88%97%E7%9B%AE%E5%BD%95">nginx å¼€å¯åˆ—ç›®å½•</a></li>\n<li><a href="/nginx-common-configurations-techniques/#%E9%85%8D%E7%BD%AE%E9%BB%98%E8%AE%A4%E7%AB%99%E7%82%B9">é…ç½®é»˜è®¤ç«™ç‚¹</a></li>\n<li><a href="/nginx-common-configurations-techniques/#%E4%B8%8D%E5%85%81%E8%AE%B8%E9%80%9A%E8%BF%87-ip-%E8%AE%BF%E9%97%AE">ä¸å…è®¸é€šè¿‡ IP è®¿é—®</a></li>\n<li><a href="/nginx-common-configurations-techniques/#%E7%9B%B4%E6%8E%A5%E8%BF%94%E5%9B%9E%E9%AA%8C%E8%AF%81%E6%96%87%E4%BB%B6">ç›´æ¥è¿”å›éªŒè¯æ–‡ä»¶</a></li>\n<li><a href="/nginx-common-configurations-techniques/#nginx-%E9%85%8D%E7%BD%AE-upstream-%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86">nginx é…ç½® upstream åå‘ä»£ç†</a></li>\n<li><a href="/nginx-common-configurations-techniques/#nginx-upstream-%E5%BC%80%E5%90%AF-keepalive">nginx upstream å¼€å¯ keepalive</a></li>\n<li><a href="/nginx-common-configurations-techniques/#404-%E8%87%AA%E5%8A%A8%E8%B7%B3%E8%BD%AC%E5%88%B0%E9%A6%96%E9%A1%B5">404 è‡ªåŠ¨è·³è½¬åˆ°é¦–é¡µ</a></li>\n</ul>',wordCount:{words:222},frontmatter:{date:"2019-06-06 15:03:49",path:"/nginx-common-configurations-techniques/",tags:"åç«¯, nginx",title:"nginxå¸¸ç”¨é…ç½®å’ŒæŠ€å·§",draft:null,catalog_number:null}},nextPost:{html:'<h1 id="æ¦‚è¿°"><a href="#%E6%A6%82%E8%BF%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>æ¦‚è¿°</h1>\n<p>ç›¸æ¯”ä»£ç çš„ Lint æˆ–è€… Prettierï¼Œæˆ–è®¸æˆ‘ä»¬æ›´åº”è¯¥å…³æ³¨ä»£ç æ˜¯å¦å…·æœ‰å¼¹æ€§ã€‚</p>\n<p><a href="https://mobile.twitter.com/dan_abramov" target="_blank" rel="nofollow noreferrer noopener">Dan</a> æ€»ç»“äº†å¼¹æ€§ç»„ä»¶å…·æœ‰çš„å››ä¸ªç‰¹å¾ï¼š</p>\n<ol>\n<li><strong>ä¸è¦é˜»å¡æ•°æ®æµã€‚</strong></li>\n<li><strong>æ—¶åˆ»å‡†å¤‡å¥½æ¸²æŸ“ã€‚</strong></li>\n<li><strong>ä¸è¦æœ‰å•ä¾‹ç»„ä»¶ã€‚</strong></li>\n<li><strong>éš”ç¦»æœ¬åœ°çŠ¶æ€ã€‚</strong></li>\n</ol>\n<p>ä»¥ä¸Šè§„åˆ™ä¸ä»…é€‚ç”¨äº Reactï¼Œå®ƒé€‚ç”¨äºæ‰€æœ‰ UI ç»„ä»¶ã€‚</p>\n<h2 id="ä¸è¦é˜»å¡æ¸²æŸ“çš„æ•°æ®æµ"><a href="#%E4%B8%8D%E8%A6%81%E9%98%BB%E5%A1%9E%E6%B8%B2%E6%9F%93%E7%9A%84%E6%95%B0%E6%8D%AE%E6%B5%81" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ä¸è¦é˜»å¡æ¸²æŸ“çš„æ•°æ®æµ</h2>\n<p>ä¸é˜»å¡æ•°æ®æµçš„æ„æ€ï¼Œå°±æ˜¯ <strong>ä¸è¦å°†æ¥æ”¶åˆ°çš„å‚æ•°æœ¬åœ°åŒ–ï¼Œ</strong> æˆ–è€… <strong>ä½¿ç»„ä»¶å®Œå…¨å—æ§</strong>ã€‚</p>\n<p>åœ¨ Class Component è¯­æ³•ä¸‹ï¼Œ<strong>ç”±äºæœ‰ç”Ÿå‘½å‘¨æœŸçš„æ¦‚å¿µï¼Œåœ¨æŸä¸ªç”Ÿå‘½å‘¨æœŸå°† <code class="language-text">props</code> å­˜å‚¨åˆ° <code class="language-text">state</code> çš„æ–¹å¼å±¡è§ä¸é²œã€‚</strong> ç„¶è€Œä¸€æ—¦å°† <code class="language-text">props</code> å›ºåŒ–åˆ° <code class="language-text">state</code>ï¼Œç»„ä»¶å°±ä¸å—æ§äº†ï¼š</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="47918167884143830000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="å¤åˆ¶æˆåŠŸ"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class Button extends React.Component {\n  state = {\n    color: this.props.color\n  };\n  render() {\n    const { color } = this.state; // ğŸ”´ \\`color\\` is stale!\n    return <button className={\'Button-\' + color}>{this.props.children}</button>;\n  }\n}`, `47918167884143830000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="jsx"\n              >\n                <span class="gatsby-code-button-language">jsx</span>\n                <span class="gatsby-code-button-text-icon">å¤åˆ¶ä»£ç </span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx"><span class="token keyword">class</span> <span class="token class-name">Button</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>\n  state <span class="token operator">=</span> <span class="token punctuation">{</span>\n    color<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>color\n  <span class="token punctuation">}</span><span class="token punctuation">;</span>\n  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">const</span> <span class="token punctuation">{</span> color <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">;</span> <span class="token comment">// ğŸ”´ `color` is stale!</span>\n    <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">className</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token string">\'Button-\'</span> <span class="token operator">+</span> color<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>children<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>å½“ç»„ä»¶å†æ¬¡åˆ·æ–°æ—¶ï¼Œ<code class="language-text">props.color</code> å˜åŒ–äº†ï¼Œä½† <code class="language-text">state.color</code> ä¸ä¼šå˜ï¼Œè¿™ç§æƒ…å†µå°±é˜»å¡äº†æ•°æ®æµï¼Œå°ä¼™ä¼´ä»¬å¯èƒ½ä¼šåæ§½ç»„ä»¶æœ‰ BUGã€‚è¿™æ—¶å€™å¦‚æœä½ å°è¯•é€šè¿‡å…¶ä»–ç”Ÿå‘½å‘¨æœŸï¼ˆ<code class="language-text">componentWillReceiveProps</code> æˆ– <code class="language-text">componentDidUpdate</code>ï¼‰å»ä¿®å¤ï¼Œä»£ç ä¼šå˜å¾—éš¾ä»¥ç®¡ç†ã€‚</p>\n<p>ç„¶è€Œ Function Component æ²¡æœ‰ç”Ÿå‘½å‘¨æœŸçš„æ¦‚å¿µï¼Œ<strong>æ‰€ä»¥æ²¡æœ‰å¿…é¡»è¦å°† <code class="language-text">props</code> å­˜å‚¨åˆ° <code class="language-text">state</code></strong>ï¼Œç›´æ¥æ¸²æŸ“å³å¯ï¼š</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="93461785548312640000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="å¤åˆ¶æˆåŠŸ"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`function Button({ color, children }) {\n  return (\n    // âœ… \\`color\\` is always fresh!\n    <button className={\'Button-\' + color}>{children}</button>\n  );\n}`, `93461785548312640000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="jsx"\n              >\n                <span class="gatsby-code-button-language">jsx</span>\n                <span class="gatsby-code-button-text-icon">å¤åˆ¶ä»£ç </span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx"><span class="token keyword">function</span> <span class="token function">Button</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> color<span class="token punctuation">,</span> children <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> <span class="token punctuation">(</span>\n    <span class="token comment">// âœ… `color` is always fresh!</span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">className</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token string">\'Button-\'</span> <span class="token operator">+</span> color<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token punctuation">{</span>children<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>\n  <span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>å¦‚æœéœ€è¦å¯¹ <code class="language-text">props</code> è¿›è¡ŒåŠ å·¥ï¼Œå¯ä»¥åˆ©ç”¨ <code class="language-text">useMemo</code> å¯¹åŠ å·¥è¿‡ç¨‹è¿›è¡Œç¼“å­˜ï¼Œä»…å½“ä¾èµ–å˜åŒ–æ—¶æ‰é‡æ–°æ‰§è¡Œï¼š</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="85988936857426770000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="å¤åˆ¶æˆåŠŸ"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`const textColor = useMemo(\n  () => slowlyCalculateTextColor(color),\n  [color] // âœ… Donâ€™t recalculate until \\`color\\` changes\n);`, `85988936857426770000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="jsx"\n              >\n                <span class="gatsby-code-button-language">jsx</span>\n                <span class="gatsby-code-button-text-icon">å¤åˆ¶ä»£ç </span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx"><span class="token keyword">const</span> textColor <span class="token operator">=</span> <span class="token function">useMemo</span><span class="token punctuation">(</span>\n  <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">slowlyCalculateTextColor</span><span class="token punctuation">(</span>color<span class="token punctuation">)</span><span class="token punctuation">,</span>\n  <span class="token punctuation">[</span>color<span class="token punctuation">]</span> <span class="token comment">// âœ… Donâ€™t recalculate until `color` changes</span>\n<span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="ä¸è¦é˜»å¡å‰¯ä½œç”¨çš„æ•°æ®æµ"><a href="#%E4%B8%8D%E8%A6%81%E9%98%BB%E5%A1%9E%E5%89%AF%E4%BD%9C%E7%94%A8%E7%9A%84%E6%95%B0%E6%8D%AE%E6%B5%81" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ä¸è¦é˜»å¡å‰¯ä½œç”¨çš„æ•°æ®æµ</h2>\n<p>å‘è¯·æ±‚å°±æ˜¯ä¸€ç§å‰¯ä½œç”¨ï¼Œå¦‚æœåœ¨ä¸€ä¸ªç»„ä»¶å†…å‘è¯·æ±‚ï¼Œé‚£ä¹ˆåœ¨å–æ•°å‚æ•°å˜åŒ–æ—¶ï¼Œæœ€å¥½èƒ½é‡æ–°å–æ•°ã€‚</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="44660169303590200000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="å¤åˆ¶æˆåŠŸ"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class SearchResults extends React.Component {\n  state = {\n    data: null\n  };\n  componentDidMount() {\n    this.fetchResults();\n  }\n  componentDidUpdate(prevProps) {\n    if (prevProps.query !== this.props.query) {\n      // âœ… Refetch on change\n      this.fetchResults();\n    }\n  }\n  fetchResults() {\n    const url = this.getFetchUrl();\n    // Do the fetching...\n  }\n  getFetchUrl() {\n    return \'http://myapi/results?query\' + this.props.query; // âœ… Updates are handled\n  }\n  render() {\n    // ...\n  }\n}`, `44660169303590200000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="jsx"\n              >\n                <span class="gatsby-code-button-language">jsx</span>\n                <span class="gatsby-code-button-text-icon">å¤åˆ¶ä»£ç </span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx"><span class="token keyword">class</span> <span class="token class-name">SearchResults</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>\n  state <span class="token operator">=</span> <span class="token punctuation">{</span>\n    data<span class="token punctuation">:</span> <span class="token keyword">null</span>\n  <span class="token punctuation">}</span><span class="token punctuation">;</span>\n  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">fetchResults</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n  <span class="token function">componentDidUpdate</span><span class="token punctuation">(</span><span class="token parameter">prevProps</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span>prevProps<span class="token punctuation">.</span>query <span class="token operator">!==</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>query<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token comment">// âœ… Refetch on change</span>\n      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">fetchResults</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n  <span class="token function">fetchResults</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getFetchUrl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token comment">// Do the fetching...</span>\n  <span class="token punctuation">}</span>\n  <span class="token function">getFetchUrl</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">return</span> <span class="token string">\'http://myapi/results?query\'</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>query<span class="token punctuation">;</span> <span class="token comment">// âœ… Updates are handled</span>\n  <span class="token punctuation">}</span>\n  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// ...</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>å¦‚æœç”¨ Class Component çš„æ–¹å¼å®ç°ï¼Œæˆ‘ä»¬éœ€è¦å°†è¯·æ±‚å‡½æ•° <code class="language-text">getFetchUrl</code> æŠ½å‡ºæ¥ï¼Œå¹¶ä¸”åœ¨ <code class="language-text">componentDidMount</code> ä¸ <code class="language-text">componentDidUpdate</code> æ—¶åŒæ—¶è°ƒç”¨å®ƒï¼Œè¿˜è¦æ³¨æ„ <code class="language-text">componentDidUpdate</code> æ—¶å¦‚æœå–æ•°å‚æ•° <code class="language-text">state.query</code> æ²¡æœ‰å˜åŒ–åˆ™ä¸æ‰§è¡Œ <code class="language-text">getFetchUrl</code>ã€‚</p>\n<p>è¿™æ ·çš„ç»´æŠ¤ä½“éªŒå¾ˆç³Ÿç³•ï¼Œå¦‚æœå–æ•°å‚æ•°å¢åŠ äº† <code class="language-text">state.currentPage</code>ï¼Œä½ å¾ˆå¯èƒ½åœ¨ <code class="language-text">componentDidUpdate</code> ä¸­æ¼æ‰å¯¹ <code class="language-text">state.currentPage</code> çš„åˆ¤æ–­ã€‚</p>\n<p>å¦‚æœä½¿ç”¨ Function Componentï¼Œå¯ä»¥é€šè¿‡ <code class="language-text">useCallback</code> å°†æ•´ä¸ªå–æ•°è¿‡ç¨‹ä½œä¸ºä¸€ä¸ªæ•´ä½“ï¼š</p>\n<blockquote>\n<p>åŸæ–‡æ²¡æœ‰ä½¿ç”¨ <code class="language-text">useCallback</code>ï¼Œç¬”è€…è¿›è¡Œäº†åŠ å·¥ã€‚</p>\n</blockquote>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="30429538041773994000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="å¤åˆ¶æˆåŠŸ"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`function SearchResults({ query }) {\n  const [data, setData] = useState(null);\n  const [currentPage, setCurrentPage] = useState(0);\n\n  const getFetchUrl = useCallback(() => {\n    return \'http://myapi/results?query=\' + query + \'&page=\' + currentPage;\n  }, [currentPage, query]);\n\n  useEffect(() => {\n    const url = getFetchUrl();\n    // Do the fetching...\n  }, [getFetchUrl]); // âœ… Refetch on change\n\n  // ...\n}`, `30429538041773994000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="jsx"\n              >\n                <span class="gatsby-code-button-language">jsx</span>\n                <span class="gatsby-code-button-text-icon">å¤åˆ¶ä»£ç </span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx"><span class="token keyword">function</span> <span class="token function">SearchResults</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> query <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> <span class="token punctuation">[</span>data<span class="token punctuation">,</span> setData<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">const</span> <span class="token punctuation">[</span>currentPage<span class="token punctuation">,</span> setCurrentPage<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n  <span class="token keyword">const</span> getFetchUrl <span class="token operator">=</span> <span class="token function">useCallback</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    <span class="token keyword">return</span> <span class="token string">\'http://myapi/results?query=\'</span> <span class="token operator">+</span> query <span class="token operator">+</span> <span class="token string">\'&amp;page=\'</span> <span class="token operator">+</span> currentPage<span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>currentPage<span class="token punctuation">,</span> query<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    <span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token function">getFetchUrl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token comment">// Do the fetching...</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>getFetchUrl<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âœ… Refetch on change</span>\n\n  <span class="token comment">// ...</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Function Component å¯¹ <code class="language-text">props</code> ä¸ <code class="language-text">state</code> çš„æ•°æ®éƒ½ä¸€è§†åŒä»ï¼Œä¸”å¯ä»¥å°†å–æ•°é€»è¾‘ä¸ â€œæ›´æ–°åˆ¤æ–­â€ é€šè¿‡ <code class="language-text">useCallback</code> å®Œå…¨å°è£…åœ¨ä¸€ä¸ªå‡½æ•°å†…ï¼Œå†å°†è¿™ä¸ªå‡½æ•°ä½œä¸ºæ•´ä½“ä¾èµ–é¡¹æ·»åŠ åˆ° <code class="language-text">useEffect</code>ï¼Œå¦‚æœæœªæ¥å†æ–°å¢ä¸€ä¸ªå‚æ•°ï¼Œåªè¦ä¿®æ”¹ <code class="language-text">getFetchUrl</code> è¿™ä¸ªå‡½æ•°å³å¯ï¼Œè€Œä¸”è¿˜å¯ä»¥é€šè¿‡ <code class="language-text">eslint-plugin-react-hooks</code> æ’ä»¶é™æ€åˆ†ææ˜¯å¦é—æ¼äº†ä¾èµ–é¡¹ã€‚</p>\n<p>Function Component ä¸ä½†å°†ä¾èµ–é¡¹èšåˆèµ·æ¥ï¼Œè¿˜è§£å†³äº† Class Component åˆ†æ•£åœ¨å¤šå¤„ç”Ÿå‘½å‘¨æœŸçš„å‡½æ•°åˆ¤æ–­ï¼Œå¼•å‘çš„æ— æ³•é™æ€åˆ†æä¾èµ–çš„é—®é¢˜ã€‚</p>\n<h2 id="ä¸è¦å› ä¸ºæ€§èƒ½ä¼˜åŒ–è€Œé˜»å¡æ•°æ®æµ"><a href="#%E4%B8%8D%E8%A6%81%E5%9B%A0%E4%B8%BA%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E8%80%8C%E9%98%BB%E5%A1%9E%E6%95%B0%E6%8D%AE%E6%B5%81" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ä¸è¦å› ä¸ºæ€§èƒ½ä¼˜åŒ–è€Œé˜»å¡æ•°æ®æµ</h2>\n<p>ç›¸æ¯” <code class="language-text">PureComponent</code> ä¸ <code class="language-text">React.memo</code>ï¼Œæ‰‹åŠ¨è¿›è¡Œæ¯”è¾ƒä¼˜åŒ–æ˜¯ä¸å¤ªå®‰å…¨çš„ï¼Œæ¯”å¦‚ä½ å¯èƒ½ä¼šå¿˜è®°å¯¹å‡½æ•°è¿›è¡Œå¯¹æ¯”ï¼š</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="12618497001075380000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="å¤åˆ¶æˆåŠŸ"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class Button extends React.Component {\n  shouldComponentUpdate(prevProps) {\n    // ğŸ”´ Doesn\'t compare this.props.onClick\n    return this.props.color !== prevProps.color;\n  }\n  render() {\n    const onClick = this.props.onClick; // ğŸ”´ Doesn\'t reflect updates\n    const textColor = slowlyCalculateTextColor(this.props.color);\n    return (\n      <button onClick={onClick} className={\'Button-\' + this.props.color + \' Button-text-\' + textColor}>\n        {this.props.children}\n      </button>\n    );\n  }\n}`, `12618497001075380000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="jsx"\n              >\n                <span class="gatsby-code-button-language">jsx</span>\n                <span class="gatsby-code-button-text-icon">å¤åˆ¶ä»£ç </span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx"><span class="token keyword">class</span> <span class="token class-name">Button</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>\n  <span class="token function">shouldComponentUpdate</span><span class="token punctuation">(</span><span class="token parameter">prevProps</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// ğŸ”´ Doesn\'t compare this.props.onClick</span>\n    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>color <span class="token operator">!==</span> prevProps<span class="token punctuation">.</span>color<span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">const</span> onClick <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>onClick<span class="token punctuation">;</span> <span class="token comment">// ğŸ”´ Doesn\'t reflect updates</span>\n    <span class="token keyword">const</span> textColor <span class="token operator">=</span> <span class="token function">slowlyCalculateTextColor</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>color<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">return</span> <span class="token punctuation">(</span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>onClick<span class="token punctuation">}</span></span> <span class="token attr-name">className</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token string">\'Button-\'</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>color <span class="token operator">+</span> <span class="token string">\' Button-text-\'</span> <span class="token operator">+</span> textColor<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">\n        </span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>children<span class="token punctuation">}</span><span class="token plain-text">\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>\n    <span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>ä¸Šé¢çš„ä»£ç æ‰‹åŠ¨è¿›è¡Œäº† <code class="language-text">shouldComponentUpdate</code> å¯¹æ¯”ä¼˜åŒ–ï¼Œä½†æ˜¯å¿½ç•¥äº†å¯¹å‡½æ•°å‚æ•° <code class="language-text">onClick</code> çš„å¯¹æ¯”ï¼Œå› æ­¤è™½ç„¶å¤§éƒ¨åˆ†æ—¶é—´ <code class="language-text">onClick</code> ç¡®å®æ²¡æœ‰å˜åŒ–ï¼Œå› æ­¤ä»£ç ä¹Ÿä¸ä¼šæœ‰ä»€ä¹ˆ bugï¼š</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="43754465882387630000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="å¤åˆ¶æˆåŠŸ"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class MyForm extends React.Component {\n  handleClick = () => {\n    // âœ… Always the same function\n    // Do something\n  };\n  render() {\n    return (\n      <>\n        <h1>Hello!</h1>\n        <Button color=\'green\' onClick={this.handleClick}>\n          Press me\n        </Button>\n      </>\n    );\n  }\n}`, `43754465882387630000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="jsx"\n              >\n                <span class="gatsby-code-button-language">jsx</span>\n                <span class="gatsby-code-button-text-icon">å¤åˆ¶ä»£ç </span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx"><span class="token keyword">class</span> <span class="token class-name">MyForm</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>\n  <span class="token function-variable function">handleClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    <span class="token comment">// âœ… Always the same function</span>\n    <span class="token comment">// Do something</span>\n  <span class="token punctuation">}</span><span class="token punctuation">;</span>\n  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">return</span> <span class="token punctuation">(</span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">></span></span><span class="token plain-text">\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">Hello!</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Button</span></span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">\'</span>green<span class="token punctuation">\'</span></span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleClick<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">\n          Press me\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Button</span></span><span class="token punctuation">></span></span><span class="token plain-text">\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">></span></span>\n    <span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>ä½†æ˜¯ä¸€æ—¦æ¢ä¸€ç§æ–¹å¼å®ç° <code class="language-text">onClick</code>ï¼Œæƒ…å†µå°±ä¸ä¸€æ ·äº†ï¼Œæ¯”å¦‚ä¸‹é¢ä¸¤ç§æƒ…å†µï¼š</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="4797342253412884000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="å¤åˆ¶æˆåŠŸ"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class MyForm extends React.Component {\n  state = {\n    isEnabled: true\n  };\n  handleClick = () => {\n    this.setState({ isEnabled: false });\n    // Do something\n  };\n  render() {\n    return (\n      <>\n        <h1>Hello!</h1>\n        <Button\n          color=\'green\'\n          onClick={\n            // ğŸ”´ Button ignores updates to the onClick prop\n            this.state.isEnabled ? this.handleClick : null\n          }\n        >\n          Press me\n        </Button>\n      </>\n    );\n  }\n}`, `4797342253412884000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="jsx"\n              >\n                <span class="gatsby-code-button-language">jsx</span>\n                <span class="gatsby-code-button-text-icon">å¤åˆ¶ä»£ç </span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx"><span class="token keyword">class</span> <span class="token class-name">MyForm</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>\n  state <span class="token operator">=</span> <span class="token punctuation">{</span>\n    isEnabled<span class="token punctuation">:</span> <span class="token boolean">true</span>\n  <span class="token punctuation">}</span><span class="token punctuation">;</span>\n  <span class="token function-variable function">handleClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> isEnabled<span class="token punctuation">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token comment">// Do something</span>\n  <span class="token punctuation">}</span><span class="token punctuation">;</span>\n  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">return</span> <span class="token punctuation">(</span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">></span></span><span class="token plain-text">\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">Hello!</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Button</span></span>\n          <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">\'</span>green<span class="token punctuation">\'</span></span>\n          <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>\n            <span class="token comment">// ğŸ”´ Button ignores updates to the onClick prop</span>\n            <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>isEnabled <span class="token operator">?</span> <span class="token keyword">this</span><span class="token punctuation">.</span>handleClick <span class="token punctuation">:</span> <span class="token keyword">null</span>\n          <span class="token punctuation">}</span></span>\n        <span class="token punctuation">></span></span><span class="token plain-text">\n          Press me\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Button</span></span><span class="token punctuation">></span></span><span class="token plain-text">\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">></span></span>\n    <span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><code class="language-text">onClick</code> éšæœºåœ¨ <code class="language-text">null</code> ä¸ <code class="language-text">this.handleClick</code> ä¹‹é—´åˆ‡æ¢ã€‚</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="36965967837473740000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="å¤åˆ¶æˆåŠŸ"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`drafts.map((draft) => (\n  <Button\n    color=\'blue\'\n    key={draft.id}\n    onClick={\n      // ğŸ”´ Button ignores updates to the onClick prop\n      this.handlePublish.bind(this, draft.content)\n    }\n  >\n    Publish\n  </Button>\n));`, `36965967837473740000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="jsx"\n              >\n                <span class="gatsby-code-button-language">jsx</span>\n                <span class="gatsby-code-button-text-icon">å¤åˆ¶ä»£ç </span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx">drafts<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">draft</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Button</span></span>\n    <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">\'</span>blue<span class="token punctuation">\'</span></span>\n    <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>draft<span class="token punctuation">.</span>id<span class="token punctuation">}</span></span>\n    <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>\n      <span class="token comment">// ğŸ”´ Button ignores updates to the onClick prop</span>\n      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handlePublish</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> draft<span class="token punctuation">.</span>content<span class="token punctuation">)</span>\n    <span class="token punctuation">}</span></span>\n  <span class="token punctuation">></span></span><span class="token plain-text">\n    Publish\n  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Button</span></span><span class="token punctuation">></span></span>\n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>å¦‚æœ <code class="language-text">draft.content</code> å˜åŒ–äº†ï¼Œåˆ™ <code class="language-text">onClick</code> å‡½æ•°å˜åŒ–ã€‚</p>\n<p>ä¹Ÿå°±æ˜¯å¦‚æœå­ç»„ä»¶è¿›è¡Œæ‰‹åŠ¨ä¼˜åŒ–æ—¶ï¼Œå¦‚æœæ¼äº†å¯¹å‡½æ•°çš„å¯¹æ¯”ï¼Œå¾ˆæœ‰å¯èƒ½æ‰§è¡Œåˆ°æ—§çš„å‡½æ•°å¯¼è‡´é”™è¯¯çš„é€»è¾‘ã€‚</p>\n<p>æ‰€ä»¥å°½é‡ä¸è¦è‡ªå·±è¿›è¡Œä¼˜åŒ–ï¼ŒåŒæ—¶åœ¨ Function Component ç¯å¢ƒä¸‹ï¼Œåœ¨å†…éƒ¨ç”³æ˜çš„å‡½æ•°æ¯æ¬¡éƒ½æœ‰ä¸åŒçš„å¼•ç”¨ï¼Œå› æ­¤ä¾¿äºå‘ç°é€»è¾‘ BUGï¼ŒåŒæ—¶åˆ©ç”¨ <code class="language-text">useCallback</code> ä¸ <code class="language-text">useContext</code> æœ‰åŠ©äºè§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>\n<h2 id="æ—¶åˆ»å‡†å¤‡æ¸²æŸ“"><a href="#%E6%97%B6%E5%88%BB%E5%87%86%E5%A4%87%E6%B8%B2%E6%9F%93" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>æ—¶åˆ»å‡†å¤‡æ¸²æŸ“</h2>\n<p>ç¡®ä¿ä½ çš„ç»„ä»¶å¯ä»¥éšæ—¶é‡æ¸²æŸ“ï¼Œä¸”ä¸ä¼šå¯¼è‡´å†…éƒ¨çŠ¶æ€ç®¡ç†å‡ºç° BUGã€‚</p>\n<p>è¦åšåˆ°è¿™ä¸€ç‚¹å…¶å®æŒºéš¾çš„ï¼Œæ¯”å¦‚ä¸€ä¸ªå¤æ‚ç»„ä»¶ï¼Œå¦‚æœæ¥æ”¶äº†ä¸€ä¸ªçŠ¶æ€ä½œä¸ºèµ·ç‚¹ï¼Œä¹‹åçš„ä»£ç åŸºäºè¿™ä¸ªèµ·ç‚¹æ´¾ç”Ÿäº†è®¸å¤šå†…éƒ¨çŠ¶æ€ï¼ŒæŸä¸ªæ—¶åˆ»æ”¹å˜äº†è¿™ä¸ªèµ·å§‹å€¼ï¼Œç»„ä»¶è¿˜èƒ½æ­£å¸¸è¿è¡Œå—ï¼Ÿ</p>\n<p>æ¯”å¦‚ä¸‹é¢çš„ä»£ç ï¼š</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="10763078297401330000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="å¤åˆ¶æˆåŠŸ"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// ğŸ¤” Should prevent unnecessary re-renders... right?\nclass TextInput extends React.PureComponent {\n  state = {\n    value: \'\'\n  };\n  // ğŸ”´ Resets local state on every parent render\n  componentWillReceiveProps(nextProps) {\n    this.setState({ value: nextProps.value });\n  }\n  handleChange = (e) => {\n    this.setState({ value: e.target.value });\n  };\n  render() {\n    return <input value={this.state.value} onChange={this.handleChange} />;\n  }\n}`, `10763078297401330000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="jsx"\n              >\n                <span class="gatsby-code-button-language">jsx</span>\n                <span class="gatsby-code-button-text-icon">å¤åˆ¶ä»£ç </span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx"><span class="token comment">// ğŸ¤” Should prevent unnecessary re-renders... right?</span>\n<span class="token keyword">class</span> <span class="token class-name">TextInput</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>PureComponent</span> <span class="token punctuation">{</span>\n  state <span class="token operator">=</span> <span class="token punctuation">{</span>\n    value<span class="token punctuation">:</span> <span class="token string">\'\'</span>\n  <span class="token punctuation">}</span><span class="token punctuation">;</span>\n  <span class="token comment">// ğŸ”´ Resets local state on every parent render</span>\n  <span class="token function">componentWillReceiveProps</span><span class="token punctuation">(</span><span class="token parameter">nextProps</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> value<span class="token punctuation">:</span> nextProps<span class="token punctuation">.</span>value <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n  <span class="token function-variable function">handleChange</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> value<span class="token punctuation">:</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">;</span>\n  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>value<span class="token punctuation">}</span></span> <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleChange<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><code class="language-text">componentWillReceiveProps</code> æ ‡è¯†äº†æ¯æ¬¡ç»„ä»¶æ¥æ”¶åˆ°æ–°çš„ <code class="language-text">props</code>ï¼Œéƒ½ä¼šå°† <code class="language-text">props.value</code> åŒæ­¥åˆ° <code class="language-text">state.value</code>ã€‚è¿™å°±æ˜¯ä¸€ç§æ´¾ç”Ÿ <code class="language-text">state</code>ï¼Œè™½ç„¶çœ‹ä¸Šå»å¯ä»¥åšåˆ°ä¼˜é›…æ‰¿æ¥ <code class="language-text">props</code> çš„å˜åŒ–ï¼Œä½† <strong>çˆ¶å…ƒç´ å› ä¸ºå…¶ä»–åŸå› çš„ rerender å°±ä¼šå¯¼è‡´ <code class="language-text">state.value</code> éæ­£å¸¸é‡ç½®ï¼Œæ¯”å¦‚çˆ¶å…ƒç´ çš„ <code class="language-text">forceUpdate</code>ã€‚</strong></p>\n<p>å½“ç„¶å¯ä»¥é€šè¿‡ <strong>ä¸è¦é˜»å¡æ¸²æŸ“çš„æ•°æ®æµ</strong> ä¸€èŠ‚æ‰€è¯´çš„æ–¹å¼ï¼Œæ¯”å¦‚ <code class="language-text">PureComponent</code>, <code class="language-text">shouldComponentUpdate</code>, <code class="language-text">React.memo</code> æ¥åšæ€§èƒ½ä¼˜åŒ–ï¼ˆå½“ <code class="language-text">props.value</code> æ²¡æœ‰å˜åŒ–æ—¶å°±ä¸ä¼šé‡ç½® <code class="language-text">state.value</code>ï¼‰ï¼Œä½†è¿™æ ·çš„ä»£ç ä¾ç„¶æ˜¯è„†å¼±çš„ã€‚</p>\n<p>å¥å£®çš„ä»£ç ä¸ä¼šå› ä¸ºåˆ é™¤äº†æŸé¡¹ä¼˜åŒ–å°±å‡ºç° BUGï¼Œä¸è¦ä½¿ç”¨æ´¾ç”Ÿ <code class="language-text">state</code> å°±èƒ½é¿å…æ­¤é—®é¢˜ã€‚</p>\n<blockquote>\n<p>è§£å†³è¿™ä¸ªé—®é¢˜çš„æ–¹å¼æ˜¯</p>\n<ol>\n<li>å¦‚æœç»„ä»¶ä¾èµ–äº† <code class="language-text">props.value</code>ï¼Œå°±ä¸éœ€è¦ä½¿ç”¨ <code class="language-text">state.value</code>ï¼Œå®Œå…¨åšæˆ <strong>å—æ§ç»„ä»¶</strong>ã€‚</li>\n<li>å¦‚æœå¿…é¡»æœ‰ <code class="language-text">state.value</code>ï¼Œé‚£å°±åšæˆå†…éƒ¨çŠ¶æ€ï¼Œä¹Ÿå°±æ˜¯ä¸è¦ä»å¤–éƒ¨æ¥æ”¶ <code class="language-text">props.value</code>ã€‚æ€»ä¹‹é¿å…å†™ â€œä»‹äºå—æ§ä¸éå—æ§ä¹‹é—´çš„ç»„ä»¶â€ã€‚</li>\n</ol>\n</blockquote>\n<p>è¡¥å……ä¸€ä¸‹ï¼Œå¦‚æœåšæˆäº†éå—æ§ç»„ä»¶ï¼Œå´æƒ³é‡ç½®åˆå§‹å€¼ï¼Œé‚£ä¹ˆåœ¨çˆ¶çº§è°ƒç”¨å¤„åŠ ä¸Š <code class="language-text">key</code> æ¥è§£å†³ï¼š</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="85810877330085230000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="å¤åˆ¶æˆåŠŸ"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`<EmailInput defaultEmail={this.props.user.email} key={this.props.user.id} />`, `85810877330085230000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="jsx"\n              >\n                <span class="gatsby-code-button-language">jsx</span>\n                <span class="gatsby-code-button-text-icon">å¤åˆ¶ä»£ç </span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">EmailInput</span></span> <span class="token attr-name">defaultEmail</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>user<span class="token punctuation">.</span>email<span class="token punctuation">}</span></span> <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>user<span class="token punctuation">.</span>id<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>\n<p>å¦å¤–ä¹Ÿå¯ä»¥é€šè¿‡ <code class="language-text">ref</code> è§£å†³ï¼Œè®©å­å…ƒç´ æä¾›ä¸€ä¸ª <code class="language-text">reset</code> å‡½æ•°ï¼Œä¸è¿‡ä¸æ¨èä½¿ç”¨ <code class="language-text">ref</code>ã€‚</p>\n<h2 id="ä¸è¦æœ‰å•ä¾‹ç»„ä»¶"><a href="#%E4%B8%8D%E8%A6%81%E6%9C%89%E5%8D%95%E4%BE%8B%E7%BB%84%E4%BB%B6" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ä¸è¦æœ‰å•ä¾‹ç»„ä»¶</h2>\n<p>ä¸€ä¸ªæœ‰å¼¹æ€§çš„åº”ç”¨ï¼Œåº”è¯¥èƒ½é€šè¿‡ä¸‹é¢è€ƒéªŒï¼š</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="39748503227269350000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="å¤åˆ¶æˆåŠŸ"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`ReactDOM.render(\n  <>\n    <MyApp />\n    <MyApp />\n  </>,\n  document.getElementById(\'root\')\n);`, `39748503227269350000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="jsx"\n              >\n                <span class="gatsby-code-button-language">jsx</span>\n                <span class="gatsby-code-button-text-icon">å¤åˆ¶ä»£ç </span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx">ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">></span></span><span class="token plain-text">\n    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">MyApp</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">\n    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">MyApp</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">\n  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">></span></span><span class="token punctuation">,</span>\n  document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">\'root\'</span><span class="token punctuation">)</span>\n<span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>å°†æ•´ä¸ªåº”ç”¨æ¸²æŸ“ä¸¤éï¼Œçœ‹çœ‹æ˜¯å¦èƒ½å„è‡ªæ­£ç¡®è¿ä½œï¼Ÿ</p>\n<p>é™¤äº†ç»„ä»¶æœ¬åœ°çŠ¶æ€ç”±æœ¬åœ°ç»´æŠ¤å¤–ï¼Œå…·æœ‰å¼¹æ€§çš„ç»„ä»¶ä¸åº”è¯¥å› ä¸ºå…¶ä»–å®ä¾‹è°ƒç”¨äº†æŸäº›å‡½æ•°ï¼Œè€Œ â€œæ°¸è¿œé”™è¿‡äº†æŸäº›çŠ¶æ€æˆ–åŠŸèƒ½â€ã€‚</p>\n<p>ç¬”è€…è¡¥å……ï¼šä¸€ä¸ªå±é™©çš„ç»„ä»¶ä¸€èˆ¬æ˜¯è¿™ä¹ˆæ€è€ƒçš„ï¼šæ²¡æœ‰äººä¼šéšæ„ç ´åæ•°æ®æµï¼Œå› æ­¤åªè¦åœ¨ <code class="language-text">didMount</code> ä¸ <code class="language-text">unMount</code> æ—¶åšå¥½æ•°æ®åˆå§‹åŒ–å’Œé”€æ¯å°±è¡Œäº†ã€‚</p>\n<p>é‚£ä¹ˆå½“å¦ä¸€ä¸ªå®ä¾‹è¿›è¡Œé”€æ¯æ“ä½œæ—¶ï¼Œå¯èƒ½ä¼šç ´åè¿™ä¸ªå®ä¾‹çš„ä¸­é—´çŠ¶æ€ã€‚ä¸€ä¸ªå…·æœ‰å¼¹æ€§çš„ç»„ä»¶åº”è¯¥èƒ½ <strong>éšæ—¶å“åº”</strong> çŠ¶æ€çš„å˜åŒ–ï¼Œæ²¡æœ‰ç”Ÿå‘½å‘¨æœŸæ¦‚å¿µçš„ Function Component å¤„ç†èµ·æ¥æ˜¾ç„¶æ›´å¾—å¿ƒåº”æ‰‹ã€‚</p>\n<h2 id="éš”ç¦»æœ¬åœ°çŠ¶æ€"><a href="#%E9%9A%94%E7%A6%BB%E6%9C%AC%E5%9C%B0%E7%8A%B6%E6%80%81" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>éš”ç¦»æœ¬åœ°çŠ¶æ€</h2>\n<p><strong>å¾ˆå¤šæ—¶å€™éš¾ä»¥åˆ¤æ–­æ•°æ®å±äºç»„ä»¶çš„æœ¬åœ°çŠ¶æ€è¿˜æ˜¯å…¨å±€çŠ¶æ€ã€‚</strong></p>\n<p>æ–‡ç« æä¾›äº†ä¸€ä¸ªåˆ¤æ–­æ–¹æ³•ï¼š<strong>â€œæƒ³è±¡è¿™ä¸ªç»„ä»¶åŒæ—¶æ¸²æŸ“äº†ä¸¤ä¸ªå®ä¾‹ï¼Œè¿™ä¸ªæ•°æ®ä¼šåŒæ—¶å½±å“è¿™ä¸¤ä¸ªå®ä¾‹å—ï¼Ÿå¦‚æœç­”æ¡ˆæ˜¯ ä¸ä¼šï¼Œé‚£è¿™ä¸ªæ•°æ®å°±é€‚åˆä½œä¸ºæœ¬åœ°çŠ¶æ€â€ã€‚</strong></p>\n<p>å°¤å…¶åœ¨å†™ä¸šåŠ¡ç»„ä»¶æ—¶ï¼Œå®¹æ˜“å°†ä¸šåŠ¡æ•°æ®ä¸ç»„ä»¶æœ¬èº«çŠ¶æ€æ•°æ®æ··æ·†ã€‚</p>\n<p>æ ¹æ®ç¬”è€…çš„ç»éªŒï¼Œ<strong>ä»ä¸Šå±‚ä¸šåŠ¡åˆ°åº•å±‚é€šç”¨ç»„ä»¶ä¹‹é—´ï¼Œæœ¬åœ°çŠ¶æ€æ•°é‡æ˜¯é€’å¢çš„ï¼š</strong></p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="10594337476526873000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="å¤åˆ¶æˆåŠŸ"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`ä¸šåŠ¡\n  -> å…¨å±€æ•°æ®æµ\n    -> é¡µé¢ï¼ˆå®Œå…¨ä¾èµ–å…¨å±€æ•°æ®æµï¼Œå‡ ä¹æ²¡æœ‰è‡ªå·±çš„çŠ¶æ€ï¼‰\n      -> ä¸šåŠ¡ç»„ä»¶ï¼ˆä»é¡µé¢æˆ–å…¨å±€æ•°æ®æµç»§æ‰¿æ•°æ®ï¼Œå¾ˆå°‘æœ‰è‡ªå·±çŠ¶æ€ï¼‰\n        -> é€šç”¨ç»„ä»¶ï¼ˆå®Œå…¨å—æ§ï¼Œæ¯”å¦‚ inputï¼›æˆ–å¤§é‡å†…èšçŠ¶æ€çš„å¤æ‚é€šç”¨é€»è¾‘ï¼Œæ¯”å¦‚ monaco-editorï¼‰`, `10594337476526873000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title=""\n              >\n                \n                <span class="gatsby-code-button-text-icon">å¤åˆ¶ä»£ç </span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="text"><pre style="counter-reset: linenumber NaN" class="language-text line-numbers"><code class="language-text">ä¸šåŠ¡\n  -&gt; å…¨å±€æ•°æ®æµ\n    -&gt; é¡µé¢ï¼ˆå®Œå…¨ä¾èµ–å…¨å±€æ•°æ®æµï¼Œå‡ ä¹æ²¡æœ‰è‡ªå·±çš„çŠ¶æ€ï¼‰\n      -&gt; ä¸šåŠ¡ç»„ä»¶ï¼ˆä»é¡µé¢æˆ–å…¨å±€æ•°æ®æµç»§æ‰¿æ•°æ®ï¼Œå¾ˆå°‘æœ‰è‡ªå·±çŠ¶æ€ï¼‰\n        -&gt; é€šç”¨ç»„ä»¶ï¼ˆå®Œå…¨å—æ§ï¼Œæ¯”å¦‚ inputï¼›æˆ–å¤§é‡å†…èšçŠ¶æ€çš„å¤æ‚é€šç”¨é€»è¾‘ï¼Œæ¯”å¦‚ monaco-editorï¼‰</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h1 id="ç²¾è¯»"><a href="#%E7%B2%BE%E8%AF%BB" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ç²¾è¯»</h1>\n<p>å†æ¬¡å¼ºè°ƒï¼Œä¸€ä¸ªæœ‰å¼¹æ€§çš„ç»„ä»¶éœ€è¦åŒæ—¶æ»¡è¶³ä¸‹é¢ 4 ä¸ªåŸåˆ™ï¼š</p>\n<ol>\n<li><strong>ä¸è¦é˜»å¡æ•°æ®æµã€‚</strong></li>\n<li><strong>æ—¶åˆ»å‡†å¤‡å¥½æ¸²æŸ“ã€‚</strong></li>\n<li><strong>ä¸è¦æœ‰å•ä¾‹ç»„ä»¶ã€‚</strong></li>\n<li><strong>éš”ç¦»æœ¬åœ°çŠ¶æ€ã€‚</strong></li>\n</ol>\n<p>æƒ³è¦éµå¾ªè¿™äº›è§„åˆ™çœ‹ä¸Šå»ä¹Ÿä¸éš¾ï¼Œä½†å®è·µè¿‡ç¨‹ä¸­ä¼šé‡åˆ°ä¸å°‘é—®é¢˜ï¼Œç¬”è€…ä¸¾å‡ ä¸ªä¾‹å­ã€‚</p>\n<h2 id="é¢‘ç¹ä¼ é€’å›è°ƒå‡½æ•°"><a href="#%E9%A2%91%E7%B9%81%E4%BC%A0%E9%80%92%E5%9B%9E%E8%B0%83%E5%87%BD%E6%95%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>é¢‘ç¹ä¼ é€’å›è°ƒå‡½æ•°</h2>\n<p>Function Component ä¼šå¯¼è‡´ç»„ä»¶ç²’åº¦æ‹†åˆ†çš„æ¯”è¾ƒç»†ï¼Œåœ¨æé«˜å¯ç»´æŠ¤æ€§åŒæ—¶ï¼Œä¹Ÿä¼šå¯¼è‡´å…¨å±€ <code class="language-text">state</code> æˆä¸ºè¿‡å»ï¼Œä¸‹é¢çš„ä»£ç å¯èƒ½è®©ä½ è§‰å¾—åˆ«æ‰­ï¼š</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="61902474138653660000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="å¤åˆ¶æˆåŠŸ"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`const App = memo(function App() {\n  const [count, setCount] = useState(0);\n  const [name, setName] = useState(&quot;nick&quot;);\n\n  return (\n    <>\n      <Count count={count} setCount={setCount}/>\n      <Name name={name} setName={setName}/>\n    </>\n  );\n});\n\nconst Count = memo(function Count(props) {\n  return (\n      <input value={props.count} onChange={pipeEvent(props.setCount)}>\n  );\n});\n\nconst Name = memo(function Name(props) {\n  return (\n  <input value={props.name} onChange={pipeEvent(props.setName)}>\n  );\n});`, `61902474138653660000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="jsx"\n              >\n                <span class="gatsby-code-button-language">jsx</span>\n                <span class="gatsby-code-button-text-icon">å¤åˆ¶ä»£ç </span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx"><span class="token keyword">const</span> App <span class="token operator">=</span> <span class="token function">memo</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> <span class="token punctuation">[</span>count<span class="token punctuation">,</span> setCount<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">const</span> <span class="token punctuation">[</span>name<span class="token punctuation">,</span> setName<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">"nick"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n  <span class="token keyword">return</span> <span class="token punctuation">(</span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">></span></span><span class="token plain-text">\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Count</span></span> <span class="token attr-name">count</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>count<span class="token punctuation">}</span></span> <span class="token attr-name">setCount</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>setCount<span class="token punctuation">}</span></span><span class="token punctuation">/></span></span><span class="token plain-text">\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Name</span></span> <span class="token attr-name">name</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>name<span class="token punctuation">}</span></span> <span class="token attr-name">setName</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>setName<span class="token punctuation">}</span></span><span class="token punctuation">/></span></span><span class="token plain-text">\n    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">></span></span>\n  <span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> Count <span class="token operator">=</span> <span class="token function">memo</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">Count</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> <span class="token punctuation">(</span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>count<span class="token punctuation">}</span></span> <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token function">pipeEvent</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>setCount<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">\n  );\n});\n\nconst Name = memo(function Name(props) </span><span class="token punctuation">{</span>\n  <span class="token keyword">return</span> <span class="token punctuation">(</span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>name<span class="token punctuation">}</span></span> <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token function">pipeEvent</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>setName<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">\n  );\n});</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>è™½ç„¶å°†å­ç»„ä»¶ <code class="language-text">Count</code> ä¸ <code class="language-text">Name</code> æ‹†åˆ†å‡ºæ¥ï¼Œé€»è¾‘æ›´åŠ è§£è€¦ï¼Œä½†å­ç»„ä»¶éœ€è¦æ›´æ–°çˆ¶ç»„ä»¶çš„çŠ¶æ€å°±å˜å¾—éº»çƒ¦ï¼Œæˆ‘ä»¬ä¸å¸Œæœ›å°†å‡½æ•°ä½œä¸ºå‚æ•°é€ä¼ ç»™å­ç»„ä»¶ã€‚</p>\n<p>ä¸€ç§åŠæ³•æ˜¯å°†å‡½æ•°é€šè¿‡ <code class="language-text">Context</code> ä¼ ç»™å­ç»„ä»¶ï¼š</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="3530055418569211400"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="å¤åˆ¶æˆåŠŸ"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`const SetCount = createContext(null)\nconst SetName = createContext(null)\n\nconst App = memo(function App() {\n  const [count, setCount] = useState(0);\n  const [name, setName] = useState(&quot;nick&quot;);\n\n  return (\n    <SetCount.Provider value={setCount}>\n      <SetName.Provider value={setName}>\n        <Count count={count}/>\n        <Name name={name}/>\n      </SetName.Provider>\n    </SetCount.Provider>\n  );\n});\n\nconst Count = memo(function Count(props) {\n  const setCount = useContext(SetCount)\n  return (\n      <input value={props.count} onChange={pipeEvent(setCount)}>\n  );\n});\n\nconst Name = memo(function Name(props) {\n  const setName = useContext(SetName)\n  return (\n  <input value={props.name} onChange={pipeEvent(setName)}>\n  );\n});`, `3530055418569211400`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="jsx"\n              >\n                <span class="gatsby-code-button-language">jsx</span>\n                <span class="gatsby-code-button-text-icon">å¤åˆ¶ä»£ç </span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx"><span class="token keyword">const</span> SetCount <span class="token operator">=</span> <span class="token function">createContext</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>\n<span class="token keyword">const</span> SetName <span class="token operator">=</span> <span class="token function">createContext</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>\n\n<span class="token keyword">const</span> App <span class="token operator">=</span> <span class="token function">memo</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> <span class="token punctuation">[</span>count<span class="token punctuation">,</span> setCount<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">const</span> <span class="token punctuation">[</span>name<span class="token punctuation">,</span> setName<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">"nick"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n  <span class="token keyword">return</span> <span class="token punctuation">(</span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">SetCount.Provider</span></span> <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>setCount<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">SetName.Provider</span></span> <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>setName<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Count</span></span> <span class="token attr-name">count</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>count<span class="token punctuation">}</span></span><span class="token punctuation">/></span></span><span class="token plain-text">\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Name</span></span> <span class="token attr-name">name</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>name<span class="token punctuation">}</span></span><span class="token punctuation">/></span></span><span class="token plain-text">\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">SetName.Provider</span></span><span class="token punctuation">></span></span><span class="token plain-text">\n    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">SetCount.Provider</span></span><span class="token punctuation">></span></span>\n  <span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> Count <span class="token operator">=</span> <span class="token function">memo</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">Count</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> setCount <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span>SetCount<span class="token punctuation">)</span>\n  <span class="token keyword">return</span> <span class="token punctuation">(</span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>count<span class="token punctuation">}</span></span> <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token function">pipeEvent</span><span class="token punctuation">(</span>setCount<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">\n  );\n});\n\nconst Name = memo(function Name(props) </span><span class="token punctuation">{</span>\n  <span class="token keyword">const</span> setName <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span>SetName<span class="token punctuation">)</span>\n  <span class="token keyword">return</span> <span class="token punctuation">(</span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>name<span class="token punctuation">}</span></span> <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token function">pipeEvent</span><span class="token punctuation">(</span>setName<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">\n  );\n});</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>ä½†è¿™æ ·ä¼šå¯¼è‡´ <code class="language-text">Provider</code> è¿‡äºè‡ƒè‚¿ï¼Œå› æ­¤å»ºè®®éƒ¨åˆ†ç»„ä»¶ä½¿ç”¨ <code class="language-text">useReducer</code> æ›¿ä»£ <code class="language-text">useState</code>ï¼Œå°†å‡½æ•°åˆå¹¶åˆ° <code class="language-text">dispatch</code>ï¼š</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="67183980581897990000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="å¤åˆ¶æˆåŠŸ"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`const AppDispatch = createContext(null)\n\nclass State = {\n  count = 0\n  name = \'nick\'\n}\n\nfunction appReducer(state, action) {\n  switch(action.type) {\n    case \'setCount\':\n      return {\n        ...state,\n        count: action.value\n      }\n    case \'setName\':\n      return {\n        ...state,\n        name: action.value\n      }\n    default:\n      return state\n  }\n}\n\nconst App = memo(function App() {\n  const [state, dispatch] = useReducer(appReducer, new State())\n\n  return (\n    <AppDispatch.Provider value={dispatch}>\n      <Count count={count}/>\n      <Name name={name}/>\n    </AppDispatch.Provider>\n  );\n});\n\nconst Count = memo(function Count(props) {\n  const dispatch = useContext(AppDispatch)\n  return (\n      <input value={props.count} onChange={pipeEvent(value => dispatch({type: \'setCount\', value}))}>\n  );\n});\n\nconst Name = memo(function Name(props) {\n  const dispatch = useContext(AppDispatch)\n  return (\n  <input value={props.name} onChange={pipeEvent(pipeEvent(value => dispatch({type: \'setName\', value})))}>\n  );\n});`, `67183980581897990000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="jsx"\n              >\n                <span class="gatsby-code-button-language">jsx</span>\n                <span class="gatsby-code-button-text-icon">å¤åˆ¶ä»£ç </span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx"><span class="token keyword">const</span> AppDispatch <span class="token operator">=</span> <span class="token function">createContext</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>\n\n<span class="token keyword">class</span> <span class="token class-name">State</span> <span class="token operator">=</span> <span class="token punctuation">{</span>\n  count <span class="token operator">=</span> <span class="token number">0</span>\n  name <span class="token operator">=</span> <span class="token string">\'nick\'</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">function</span> <span class="token function">appReducer</span><span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">switch</span><span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">case</span> <span class="token string">\'setCount\'</span><span class="token punctuation">:</span>\n      <span class="token keyword">return</span> <span class="token punctuation">{</span>\n        <span class="token operator">...</span>state<span class="token punctuation">,</span>\n        count<span class="token punctuation">:</span> action<span class="token punctuation">.</span>value\n      <span class="token punctuation">}</span>\n    <span class="token keyword">case</span> <span class="token string">\'setName\'</span><span class="token punctuation">:</span>\n      <span class="token keyword">return</span> <span class="token punctuation">{</span>\n        <span class="token operator">...</span>state<span class="token punctuation">,</span>\n        name<span class="token punctuation">:</span> action<span class="token punctuation">.</span>value\n      <span class="token punctuation">}</span>\n    <span class="token keyword">default</span><span class="token punctuation">:</span>\n      <span class="token keyword">return</span> state\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">const</span> App <span class="token operator">=</span> <span class="token function">memo</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> <span class="token punctuation">[</span>state<span class="token punctuation">,</span> dispatch<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useReducer</span><span class="token punctuation">(</span>appReducer<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">State</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n  <span class="token keyword">return</span> <span class="token punctuation">(</span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">AppDispatch.Provider</span></span> <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>dispatch<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Count</span></span> <span class="token attr-name">count</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>count<span class="token punctuation">}</span></span><span class="token punctuation">/></span></span><span class="token plain-text">\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Name</span></span> <span class="token attr-name">name</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>name<span class="token punctuation">}</span></span><span class="token punctuation">/></span></span><span class="token plain-text">\n    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">AppDispatch.Provider</span></span><span class="token punctuation">></span></span>\n  <span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> Count <span class="token operator">=</span> <span class="token function">memo</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">Count</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> dispatch <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span>AppDispatch<span class="token punctuation">)</span>\n  <span class="token keyword">return</span> <span class="token punctuation">(</span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>count<span class="token punctuation">}</span></span> <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token function">pipeEvent</span><span class="token punctuation">(</span><span class="token parameter">value</span> <span class="token operator">=></span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>type<span class="token punctuation">:</span> <span class="token string">\'setCount\'</span><span class="token punctuation">,</span> value<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">\n  );\n});\n\nconst Name = memo(function Name(props) </span><span class="token punctuation">{</span>\n  <span class="token keyword">const</span> dispatch <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span>AppDispatch<span class="token punctuation">)</span>\n  <span class="token keyword">return</span> <span class="token punctuation">(</span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>name<span class="token punctuation">}</span></span> <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token function">pipeEvent</span><span class="token punctuation">(</span><span class="token function">pipeEvent</span><span class="token punctuation">(</span><span class="token parameter">value</span> <span class="token operator">=></span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>type<span class="token punctuation">:</span> <span class="token string">\'setName\'</span><span class="token punctuation">,</span> value<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">\n  );\n});</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>å°†çŠ¶æ€èšåˆåˆ° <code class="language-text">reducer</code> ä¸­ï¼Œè¿™æ ·ä¸€ä¸ª <code class="language-text">ContextProvider</code> å°±èƒ½è§£å†³æ‰€æœ‰æ•°æ®å¤„ç†é—®é¢˜äº†ã€‚</p>\n<blockquote>\n<p>memo åŒ…è£¹çš„ç»„ä»¶ç±»ä¼¼ PureComponent æ•ˆæœã€‚</p>\n</blockquote>\n<h2 id="usecallback-å‚æ•°å˜åŒ–é¢‘ç¹"><a href="#usecallback-%E5%8F%82%E6%95%B0%E5%8F%98%E5%8C%96%E9%A2%91%E7%B9%81" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>useCallback å‚æ•°å˜åŒ–é¢‘ç¹</h2>\n<p>åœ¨ <a href="https://github.com/dt-fe/weekly/blob/master/96.%E7%B2%BE%E8%AF%BB%E3%80%8AuseEffect%20%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97%E3%80%8B.md#%E5%A6%82%E6%9E%9C%E9%9D%9E%E8%A6%81%E6%8A%8A-function-%E5%86%99%E5%9C%A8-effect-%E5%A4%96%E9%9D%A2%E5%91%A2" target="_blank" rel="nofollow noreferrer noopener">ç²¾è¯»ã€ŠuseEffect å®Œå…¨æŒ‡å—ã€‹</a> æˆ‘ä»¬ä»‹ç»äº†åˆ©ç”¨ <code class="language-text">useCallback</code> åˆ›å»ºä¸€ä¸ª Immutable çš„å‡½æ•°ï¼š</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="90676808714873100000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="å¤åˆ¶æˆåŠŸ"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`function Form() {\n  const [text, updateText] = useState(\'\');\n\n  const handleSubmit = useCallback(() => {\n    const currentText = text;\n    alert(currentText);\n  }, [text]);\n\n  return (\n    <>\n      <input value={text} onChange={(e) => updateText(e.target.value)} />\n      <ExpensiveTree onSubmit={handleSubmit} />\n    </>\n  );\n}`, `90676808714873100000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="jsx"\n              >\n                <span class="gatsby-code-button-language">jsx</span>\n                <span class="gatsby-code-button-text-icon">å¤åˆ¶ä»£ç </span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx"><span class="token keyword">function</span> <span class="token function">Form</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> <span class="token punctuation">[</span>text<span class="token punctuation">,</span> updateText<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">\'\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n  <span class="token keyword">const</span> handleSubmit <span class="token operator">=</span> <span class="token function">useCallback</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    <span class="token keyword">const</span> currentText <span class="token operator">=</span> text<span class="token punctuation">;</span>\n    <span class="token function">alert</span><span class="token punctuation">(</span>currentText<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>text<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n  <span class="token keyword">return</span> <span class="token punctuation">(</span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">></span></span><span class="token plain-text">\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>text<span class="token punctuation">}</span></span> <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">updateText</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ExpensiveTree</span></span> <span class="token attr-name">onSubmit</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleSubmit<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">\n    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">></span></span>\n  <span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>ä½†è¿™ä¸ªå‡½æ•°çš„ä¾èµ– <code class="language-text">[text]</code> å˜åŒ–è¿‡äºé¢‘ç¹ï¼Œä»¥è‡³äºåœ¨æ¯ä¸ª <code class="language-text">render</code> éƒ½ä¼šé‡æ–°ç”Ÿæˆ <code class="language-text">handleSubmit</code> å‡½æ•°ï¼Œå¯¹æ€§èƒ½æœ‰ä¸€å®šå½±å“ã€‚ä¸€ç§è§£å†³åŠæ³•æ˜¯åˆ©ç”¨ <code class="language-text">Ref</code> è§„é¿è¿™ä¸ªé—®é¢˜ï¼š</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="14934622098508931000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="å¤åˆ¶æˆåŠŸ"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`function Form() {\n  const [text, updateText] = useState(\'\');\n  const textRef = useRef();\n\n  useEffect(() => {\n    textRef.current = text; // Write it to the ref\n  });\n\n  const handleSubmit = useCallback(() => {\n    const currentText = textRef.current; // Read it from the ref\n    alert(currentText);\n  }, [textRef]); // Don\'t recreate handleSubmit like [text] would do\n\n  return (\n    <>\n      <input value={text} onChange={(e) => updateText(e.target.value)} />\n      <ExpensiveTree onSubmit={handleSubmit} />\n    </>\n  );\n}`, `14934622098508931000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="jsx"\n              >\n                <span class="gatsby-code-button-language">jsx</span>\n                <span class="gatsby-code-button-text-icon">å¤åˆ¶ä»£ç </span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx"><span class="token keyword">function</span> <span class="token function">Form</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> <span class="token punctuation">[</span>text<span class="token punctuation">,</span> updateText<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">\'\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">const</span> textRef <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    textRef<span class="token punctuation">.</span>current <span class="token operator">=</span> text<span class="token punctuation">;</span> <span class="token comment">// Write it to the ref</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n  <span class="token keyword">const</span> handleSubmit <span class="token operator">=</span> <span class="token function">useCallback</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    <span class="token keyword">const</span> currentText <span class="token operator">=</span> textRef<span class="token punctuation">.</span>current<span class="token punctuation">;</span> <span class="token comment">// Read it from the ref</span>\n    <span class="token function">alert</span><span class="token punctuation">(</span>currentText<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>textRef<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Don\'t recreate handleSubmit like [text] would do</span>\n\n  <span class="token keyword">return</span> <span class="token punctuation">(</span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">></span></span><span class="token plain-text">\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>text<span class="token punctuation">}</span></span> <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">updateText</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ExpensiveTree</span></span> <span class="token attr-name">onSubmit</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleSubmit<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">\n    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">></span></span>\n  <span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>å½“ç„¶ï¼Œä¹Ÿå¯ä»¥å°†è¿™ä¸ªè¿‡ç¨‹å°è£…ä¸ºä¸€ä¸ªè‡ªå®šä¹‰ Hooksï¼Œè®©ä»£ç ç¨å¾®å¥½çœ‹äº›ï¼š</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="57625204985360520000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="å¤åˆ¶æˆåŠŸ"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`function Form() {\n  const [text, updateText] = useState(\'\');\n  // Will be memoized even if \\`text\\` changes:\n  const handleSubmit = useEventCallback(() => {\n    alert(text);\n  }, [text]);\n\n  return (\n    <>\n      <input value={text} onChange={(e) => updateText(e.target.value)} />\n      <ExpensiveTree onSubmit={handleSubmit} />\n    </>\n  );\n}\n\nfunction useEventCallback(fn, dependencies) {\n  const ref = useRef(() => {\n    throw new Error(\'Cannot call an event handler while rendering.\');\n  });\n\n  useEffect(() => {\n    ref.current = fn;\n  }, [fn, ...dependencies]);\n\n  return useCallback(() => {\n    const fn = ref.current;\n    return fn();\n  }, [ref]);\n}`, `57625204985360520000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="jsx"\n              >\n                <span class="gatsby-code-button-language">jsx</span>\n                <span class="gatsby-code-button-text-icon">å¤åˆ¶ä»£ç </span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx"><span class="token keyword">function</span> <span class="token function">Form</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> <span class="token punctuation">[</span>text<span class="token punctuation">,</span> updateText<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">\'\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token comment">// Will be memoized even if `text` changes:</span>\n  <span class="token keyword">const</span> handleSubmit <span class="token operator">=</span> <span class="token function">useEventCallback</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    <span class="token function">alert</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>text<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n  <span class="token keyword">return</span> <span class="token punctuation">(</span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">></span></span><span class="token plain-text">\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>text<span class="token punctuation">}</span></span> <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">updateText</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ExpensiveTree</span></span> <span class="token attr-name">onSubmit</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleSubmit<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">\n    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">></span></span>\n  <span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">function</span> <span class="token function">useEventCallback</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> dependencies</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> ref <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">\'Cannot call an event handler while rendering.\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    ref<span class="token punctuation">.</span>current <span class="token operator">=</span> fn<span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>fn<span class="token punctuation">,</span> <span class="token operator">...</span>dependencies<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n  <span class="token keyword">return</span> <span class="token function">useCallback</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    <span class="token keyword">const</span> fn <span class="token operator">=</span> ref<span class="token punctuation">.</span>current<span class="token punctuation">;</span>\n    <span class="token keyword">return</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>ref<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<blockquote>\n<p>ä¸è¿‡è¿™ç§æ–¹æ¡ˆå¹¶ä¸ä¼˜é›…ï¼Œ<a href="https://reactjs.org/docs/hooks-faq.html#how-to-read-an-often-changing-value-from-usecallback" target="_blank" rel="nofollow noreferrer noopener">React è€ƒè™‘æä¾›ä¸€ä¸ªæ›´ä¼˜é›…çš„æ–¹æ¡ˆ</a>ã€‚</p>\n</blockquote>\n<h2 id="æœ‰å¯èƒ½è¢«æ»¥ç”¨çš„-usereducer"><a href="#%E6%9C%89%E5%8F%AF%E8%83%BD%E8%A2%AB%E6%BB%A5%E7%94%A8%E7%9A%84-usereducer" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>æœ‰å¯èƒ½è¢«æ»¥ç”¨çš„ useReducer</h2>\n<p>åœ¨ <a href="https://github.com/dt-fe/weekly/blob/master/96.%E7%B2%BE%E8%AF%BB%E3%80%8AuseEffect%20%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97%E3%80%8B.md#%E5%B0%86%E6%9B%B4%E6%96%B0%E4%B8%8E%E5%8A%A8%E4%BD%9C%E8%A7%A3%E8%80%A6" target="_blank" rel="nofollow noreferrer noopener">ç²¾è¯»ã€ŠuseEffect å®Œå…¨æŒ‡å—ã€‹</a> â€œå°†æ›´æ–°ä¸åŠ¨ä½œè§£è€¦â€ ä¸€èŠ‚é‡Œæåˆ°äº†ï¼Œåˆ©ç”¨ <code class="language-text">useReducer</code> è§£å†³ â€œå‡½æ•°åŒæ—¶ä¾èµ–å¤šä¸ªå¤–éƒ¨å˜é‡çš„é—®é¢˜â€ã€‚</p>\n<p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¼šè¿™ä¹ˆä½¿ç”¨ <code class="language-text">useReducer</code>:</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="15149840864117060000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="å¤åˆ¶æˆåŠŸ"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`const reducer = (state, action) => {\n  switch (action.type) {\n    case \'increment\':\n      return { value: state.value + 1 };\n    case \'decrement\':\n      return { value: state.value - 1 };\n    case \'incrementAmount\':\n      return { value: state.value + action.amount };\n    default:\n      throw new Error();\n  }\n};\n\nconst [state, dispatch] = useReducer(reducer, { value: 0 });`, `15149840864117060000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="tsx"\n              >\n                <span class="gatsby-code-button-language">tsx</span>\n                <span class="gatsby-code-button-text-icon">å¤åˆ¶ä»£ç </span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="tsx"><pre style="counter-reset: linenumber NaN" class="language-tsx line-numbers"><code class="language-tsx"><span class="token keyword">const</span> <span class="token function-variable function">reducer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">switch</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span><span class="token keyword">type</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">case</span> <span class="token string">\'increment\'</span><span class="token punctuation">:</span>\n      <span class="token keyword">return</span> <span class="token punctuation">{</span> value<span class="token punctuation">:</span> state<span class="token punctuation">.</span>value <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>\n    <span class="token keyword">case</span> <span class="token string">\'decrement\'</span><span class="token punctuation">:</span>\n      <span class="token keyword">return</span> <span class="token punctuation">{</span> value<span class="token punctuation">:</span> state<span class="token punctuation">.</span>value <span class="token operator">-</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>\n    <span class="token keyword">case</span> <span class="token string">\'incrementAmount\'</span><span class="token punctuation">:</span>\n      <span class="token keyword">return</span> <span class="token punctuation">{</span> value<span class="token punctuation">:</span> state<span class="token punctuation">.</span>value <span class="token operator">+</span> action<span class="token punctuation">.</span>amount <span class="token punctuation">}</span><span class="token punctuation">;</span>\n    <span class="token keyword">default</span><span class="token punctuation">:</span>\n      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> <span class="token punctuation">[</span>state<span class="token punctuation">,</span> dispatch<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useReducer</span><span class="token punctuation">(</span>reducer<span class="token punctuation">,</span> <span class="token punctuation">{</span> value<span class="token punctuation">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>ä½†å…¶å® <code class="language-text">useReducer</code> å¯¹ <code class="language-text">state</code> ä¸ <code class="language-text">action</code> çš„å®šä¹‰å¯ä»¥å¾ˆéšæ„ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ <code class="language-text">useReducer</code> æ‰“é€ ä¸€ä¸ª <code class="language-text">useState</code>ã€‚</p>\n<p>æ¯”å¦‚æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ‹¥æœ‰å¤æ•° key çš„ <code class="language-text">useState</code>:</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="62909164172016110000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="å¤åˆ¶æˆåŠŸ"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`const [state, setState] = useState({ count: 0, name: \'nick\' });\n\n// ä¿®æ”¹ count\nsetState((state) => ({ ...state, count: 1 }));\n\n// ä¿®æ”¹ name\nsetState((state) => ({ ...state, name: \'jack\' }));`, `62909164172016110000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="jsx"\n              >\n                <span class="gatsby-code-button-language">jsx</span>\n                <span class="gatsby-code-button-text-icon">å¤åˆ¶ä»£ç </span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx"><span class="token keyword">const</span> <span class="token punctuation">[</span>state<span class="token punctuation">,</span> setState<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> count<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token string">\'nick\'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">// ä¿®æ”¹ count</span>\n<span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token operator">...</span>state<span class="token punctuation">,</span> count<span class="token punctuation">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">// ä¿®æ”¹ name</span>\n<span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token operator">...</span>state<span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token string">\'jack\'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>åˆ©ç”¨ <code class="language-text">useReducer</code> å®ç°ç›¸ä¼¼çš„åŠŸèƒ½ï¼š</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="54334118283262470000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="å¤åˆ¶æˆåŠŸ"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`function reducer(state, action) {\n  return action(state);\n}\n\nconst [state, dispatch] = useReducer(reducer, { count: 0, name: \'nick\' });\n\n// ä¿®æ”¹ count\ndispatch((state) => ({ ...state, count: 1 }));\n\n// ä¿®æ”¹ name\ndispatch((state) => ({ ...state, name: \'jack\' }));`, `54334118283262470000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="jsx"\n              >\n                <span class="gatsby-code-button-language">jsx</span>\n                <span class="gatsby-code-button-text-icon">å¤åˆ¶ä»£ç </span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx"><span class="token keyword">function</span> <span class="token function">reducer</span><span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> <span class="token function">action</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">const</span> <span class="token punctuation">[</span>state<span class="token punctuation">,</span> dispatch<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useReducer</span><span class="token punctuation">(</span>reducer<span class="token punctuation">,</span> <span class="token punctuation">{</span> count<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token string">\'nick\'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">// ä¿®æ”¹ count</span>\n<span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token operator">...</span>state<span class="token punctuation">,</span> count<span class="token punctuation">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">// ä¿®æ”¹ name</span>\n<span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token operator">...</span>state<span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token string">\'jack\'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>å› æ­¤é’ˆå¯¹å¦‚ä¸Šæƒ…å†µï¼Œæˆ‘ä»¬å¯èƒ½æ»¥ç”¨äº† <code class="language-text">useReducer</code>ï¼Œå»ºè®®ç›´æ¥ç”¨ <code class="language-text">useState</code> ä»£æ›¿ã€‚</p>\n<h1 id="æ€»ç»“"><a href="#%E6%80%BB%E7%BB%93" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>æ€»ç»“</h1>\n<p>æœ¬æ–‡æ€»ç»“äº†å…·æœ‰å¼¹æ€§çš„ç»„ä»¶çš„å››ä¸ªç‰¹æ€§ï¼šä¸è¦é˜»å¡æ•°æ®æµã€æ—¶åˆ»å‡†å¤‡å¥½æ¸²æŸ“ã€ä¸è¦æœ‰å•ä¾‹ç»„ä»¶ã€éš”ç¦»æœ¬åœ°çŠ¶æ€ã€‚</p>\n<p>è¿™ä¸ªçº¦å®šå¯¹ä»£ç è´¨é‡å¾ˆé‡è¦ï¼Œè€Œä¸”éš¾ä»¥é€šè¿‡ lint è§„åˆ™æˆ–ç®€å•è‚‰çœ¼è§‚å¯ŸåŠ ä»¥è¯†åˆ«ï¼Œå› æ­¤æ¨å¹¿èµ·æ¥è¿˜æ˜¯æœ‰ä¸å°éš¾åº¦ã€‚</p>\n<p>æ€»çš„æ¥è¯´ï¼ŒFunction Component å¸¦æ¥äº†æ›´ä¼˜é›…çš„ä»£ç ä½“éªŒï¼Œä½†æ˜¯å¯¹å›¢é˜Ÿåä½œçš„è¦æ±‚ä¹Ÿæ›´é«˜äº†ã€‚</p>',
excerpt:"æ¦‚è¿° ç›¸æ¯”ä»£ç çš„ Lint æˆ–è€… Prettierï¼Œæˆ–è®¸æˆ‘ä»¬æ›´åº”è¯¥å…³æ³¨ä»£ç æ˜¯å¦å…·æœ‰å¼¹æ€§ã€‚ Dan  æ€»ç»“äº†å¼¹æ€§ç»„ä»¶å…·æœ‰çš„å››ä¸ªç‰¹å¾ï¼š ä¸è¦é˜»å¡æ•°æ®æµã€‚ æ—¶åˆ»å‡†å¤‡å¥½æ¸²æŸ“ã€‚ ä¸è¦æœ‰å•ä¾‹ç»„ä»¶ã€‚ éš”ç¦»æœ¬åœ°çŠ¶æ€ã€‚ ä»¥ä¸Šè§„åˆ™ä¸ä»…é€‚ç”¨äº Reactï¼Œå®ƒé€‚ç”¨äºæ‰€æœ‰ UIâ€¦",frontmatter:{date:"2019-06-06 14:35:51",path:"/write-resilient-components/",tags:"å‰ç«¯, ç»„ä»¶",title:"ç¼–å†™æœ‰å¼¹æ€§çš„ç»„ä»¶",draft:null}},prePost:{html:'<p>ä¼šè¯å‘èµ·åè®®ï¼ˆSIPï¼‰æ˜¯ VoIP æŠ€æœ¯ä¸­æœ€å¸¸ç”¨çš„åè®®ä¹‹ä¸€ã€‚å®ƒæ˜¯ä¸€ç§åº”ç”¨å±‚åè®®ï¼Œä¸å…¶ä»–åº”ç”¨å±‚åè®®ååŒå·¥ä½œï¼Œé€šè¿‡ Internet æ§åˆ¶å¤šåª’ä½“é€šä¿¡ä¼šè¯ã€‚</p>\n<h1 id="æ¦‚è¿°"><a href="#%E6%A6%82%E8%BF%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>æ¦‚è¿°</h1>\n<ul>\n<li>SIP æ˜¯ç”¨äºé€šè¿‡å› ç‰¹ç½‘åè®®åˆ›å»ºï¼Œä¿®æ”¹å’Œç»ˆæ­¢å¤šåª’ä½“ä¼šè¯çš„ä¿¡ä»¤åè®®ã€‚ä¼šè¯åªä¸è¿‡æ˜¯ä¸¤ä¸ªç«¯ç‚¹ä¹‹é—´çš„ç®€å•è°ƒç”¨ã€‚ç«¯ç‚¹å¯ä»¥æ˜¯æ™ºèƒ½ç”µè¯ï¼Œç¬”è®°æœ¬ç”µè„‘æˆ–å¯ä»¥é€šè¿‡å› ç‰¹ç½‘æ¥æ”¶å’Œå‘é€å¤šåª’ä½“å†…å®¹çš„ä»»ä½•è®¾å¤‡ã€‚</li>\n<li>SIP æ˜¯ç”± IETFï¼ˆInternet Engineering Task Forceï¼‰ æ ‡å‡†å®šä¹‰çš„åº”ç”¨å±‚åè®®ã€‚å®ƒåœ¨ RFC 3261 ä¸­å®šä¹‰ã€‚</li>\n<li>SIP ä½“ç°äº†å®¢æˆ·ç«¯ - æœåŠ¡å™¨ä½“ç³»ç»“æ„ï¼Œä»¥åŠä½¿ç”¨ HTTP å’Œ URL çš„ URL å’Œ URI ä»¥åŠ SMTP çš„æ–‡æœ¬ç¼–ç æ–¹æ¡ˆå’Œå¤´æ ·å¼ã€‚</li>\n<li>SIP é‡‡ç”¨ SDPï¼ˆä¼šè¯æè¿°åè®®ï¼‰ çš„å¸®åŠ©ï¼Œå®ƒæè¿°äº†ç”¨äºé€šè¿‡ IP ç½‘ç»œä¼ é€è¯­éŸ³å’Œè§†é¢‘çš„ä¼šè¯å’Œ RTPï¼ˆå®æ—¶ä¼ è¾“åè®®ï¼‰ã€‚</li>\n<li>SIP å¯ç”¨äºåŒæ–¹ï¼ˆå•æ’­ï¼‰æˆ–å¤šæ–¹ï¼ˆå¤šæ’­ï¼‰ä¼šè¯ã€‚</li>\n<li>å…¶ä»– SIP åº”ç”¨åŒ…æ‹¬æ–‡ä»¶ä¼ è¾“ï¼Œå³æ—¶é€šè®¯ï¼Œè§†é¢‘ä¼šè®®ï¼Œç½‘ç»œæ¸¸æˆï¼Œä»¥åŠæµå¤šåª’ä½“åˆ†å‘ã€‚</li>\n</ul>\n<p>ä¸‹å›¾è¯´æ˜äº† SIP åœ¨ä¸€èˆ¬æ–¹æ¡ˆä¸­çš„é€‚ç”¨æ€§ï¼š</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/2019-06-10-11-59-57-514e7696b1300e07d312f20f411c5d24-ae33f.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 391px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 138.3631713554987%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAcCAIAAADuuAg3AAAACXBIWXMAAAsSAAALEgHS3X78AAAD1ElEQVQ4y02VWS+kURCGv98gbkhc2GMLiQSJ3+BO3BIJ3bR1dNO2Qbdd26fHlpluS+y7MZZphLYNZkxCuHYj3EgkfsA83yndM+/FSXWdqvetqnO+09rz87PD4WhtbbXb7Tabzb+KIXZLS0tzc7Pdh/b29qamJo/Hoy0vLwcGBoaEhKSlpSUlJcXGxqampsbHx0dHR6ekpCQmJsbFxWHjiYmJYTchISE0NDQgICAzM1NbWVlhOzk5uaSkBMqamprCwsLS0lKz2VxeXm61WsvKyjIyMvCwVVdXZzKZ0tPT4crJydGWlpaCgoIiIyMjIiJwQRQeHh4VFSUe1rCwMDyII4s4sviDg4OzsrI0ekZQemtSwG5sbGT9qCDd2nyQEVDC7u6u9vj46Ha7vyq4XC7Wqamp2dnZ+fn58fHxsbGxLwouBX/Y6Ojo0dGRtr+/bzAY6PCDAp0jC93AwACaTqdzeHgYis7OznIFYioqKoqLi9HXTk5OGAm/8ZoVqqurqc2q0KoAC3XKrmjA0tfXpx0fHxuNRjnAoqIivAxWRKgCBaFmyHjghQg6PEzqPbmtra2jo4M9WElg5cCIIBM1Dgkn+Q0NDYR1dXVZLBZS9GQECwoK6BzDpEAmNqT4Mfjp9xsUMLq7u9+VaQlZ6NFBUFYp3qKAp7KyEqO2tra+vp7WKEFPhonrDZP0yQYiQpSfn09OVVWVUQGbyP7+fjx0ridTgwwQ0CTJZMoqI4QROmx25bTYguU9uVSBCOkcyITomd3/uaQ0jH/JPT09nBuVs8E2CqTJUVEh1VI/P7me1Mz9Yf76tA8PD7Ozs80+UJXQSwlwQeSvSC4SXPzkXmhPT09c3U//wakwNDSEAjrYnxUw/DGDg4Ner1d7fX3d3t7+7sPm5ibrxsYG6+rq6traGsY3H7C3traIX19fv7u70w4ODnJzc6mTzvkkkOLe8RlwjHye3H5+0h5ri4LMkrK5pxrqdMK5c/okO3wgXz5gLiPJTBQPyYRxo/hment79U8yLy9PThhWvMycIFbUYEGfNH5yBZmcf4S6Mi/JxMSEW4EPnQdAHoPFxcWZmZnJycm5uTneOX5i8wwQJo8EZ6y9vb39Vri+vr65ufmjIJ6fChi/FAiQLYzLy8uHhweNBF4jngSelenpaYbJVH8o7OzsMHYMxru3t0cYtlcBWf3dvr+/J+3q6goyxkO3IyMjrPTJOXO2lI0tfwwLCwuUQDnE62/Y7e0tfGdnZyKOAofnUcDg/uFBmRLwoHl6ekokq6788vKCdaZwfn4Oq6xi+O2LiwvxSCRlU/JfMSqBLu9O3AUAAAAASUVORK5CYII=\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="2019 06 10 11 59 57" title="" data-src="/static/2019-06-10-11-59-57-514e7696b1300e07d312f20f411c5d24-ae33f.png" data-srcset="/static/2019-06-10-11-59-57-514e7696b1300e07d312f20f411c5d24-12493.png 200w,\n/static/2019-06-10-11-59-57-514e7696b1300e07d312f20f411c5d24-ae33f.png 391w" data-sizes="(max-width: 391px) 100vw, 391px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>é€šå¸¸ï¼ŒSIP åè®®ç”¨äºä¸¤ä¸ªæˆ–å¤šä¸ªç«¯ç‚¹ä¹‹é—´çš„äº’è”ç½‘ç”µè¯å’Œå¤šåª’ä½“åˆ†å‘ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªäººå¯ä»¥ä½¿ç”¨ SIP å‘èµ·å¯¹å¦ä¸€ä¸ªäººçš„ç”µè¯å‘¼å«ï¼Œæˆ–è€…æœ‰äººå¯ä»¥ä¸è®¸å¤šå‚ä¸è€…å»ºç«‹ç”µè¯ä¼šè®®ã€‚</p>\n<p>SIP åè®®çš„è®¾è®¡éå¸¸ç®€å•ï¼Œé…ç½®æœ‰é™çš„å‘½ä»¤ã€‚å®ƒä¹Ÿæ˜¯åŸºäºæ–‡æœ¬çš„ï¼Œæ‰€ä»¥ä»»ä½•äººéƒ½å¯ä»¥è¯»å– SIP ä¼šè¯ä¸­çš„ç«¯ç‚¹ä¹‹é—´ä¼ é€’çš„ SIP æ¶ˆæ¯ã€‚</p>\n<p>æœ‰ä¸€äº›å®ä½“å¸®åŠ© SIP åˆ›å»ºå…¶ç½‘ç»œã€‚åœ¨ SIP ä¸­ï¼Œæ¯ä¸ªç½‘å…ƒç”± SIP URIï¼ˆç»Ÿä¸€èµ„æºæ ‡è¯†ç¬¦ï¼‰ æ¥æ ‡è¯†ï¼Œå®ƒåƒä¸€ä¸ªåœ°å€ã€‚ä»¥ä¸‹æ˜¯ç½‘ç»œå…ƒç´ ï¼š</p>\n<ul>\n<li>ç”¨æˆ·ä»£ç†</li>\n<li>ä»£ç†æœåŠ¡å™¨</li>\n<li>æ³¨å†ŒæœåŠ¡å™¨</li>\n<li>é‡å®šå‘æœåŠ¡å™¨</li>\n<li>ä½ç½®æœåŠ¡å™¨</li>\n</ul>\n<h2 id="ç”¨æˆ·ä»£ç†"><a href="#%E7%94%A8%E6%88%B7%E4%BB%A3%E7%90%86" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ç”¨æˆ·ä»£ç†</h2>\n<p>å®ƒæ˜¯ SIP ç½‘ç»œçš„ç«¯ç‚¹å’Œæœ€é‡è¦çš„ç½‘ç»œå…ƒç´ ä¹‹ä¸€ã€‚ç«¯ç‚¹å¯ä»¥å¯åŠ¨ï¼Œä¿®æ”¹æˆ–ç»ˆæ­¢ä¼šè¯ã€‚ç”¨æˆ·ä»£ç†æ˜¯ SIP ç½‘ç»œä¸­æœ€æ™ºèƒ½çš„è®¾å¤‡æˆ–ç½‘ç»œå…ƒä»¶ã€‚å®ƒå¯ä»¥æ˜¯è½¯ç”µè¯ï¼Œæ‰‹æœºæˆ–ç¬”è®°æœ¬ç”µè„‘ã€‚</p>\n<p>ç”¨æˆ·ä»£ç†åœ¨é€»è¾‘ä¸Šåˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼š</p>\n<ul>\n<li>ç”¨æˆ·ä»£ç†å®¢æˆ·ç«¯ï¼ˆUACï¼‰ - å‘é€è¯·æ±‚å¹¶æ¥æ”¶å“åº”çš„å®ä½“ã€‚</li>\n<li>ç”¨æˆ·ä»£ç†æœåŠ¡å™¨ï¼ˆUASï¼‰ - æ¥æ”¶è¯·æ±‚å¹¶å‘é€å“åº”çš„å®ä½“ã€‚</li>\n</ul>\n<p>SIP åŸºäºå®¢æˆ·æœº - æœåŠ¡å™¨æ¶æ„ï¼Œå…¶ä¸­å‘¼å«è€…çš„ç”µè¯å……å½“å‘èµ·å‘¼å«çš„å®¢æˆ·ç«¯ï¼Œè¢«å«æ–¹çš„ç”µè¯å……å½“å“åº”å‘¼å«çš„æœåŠ¡å™¨ã€‚</p>\n<h2 id="ä»£ç†æœåŠ¡å™¨"><a href="#%E4%BB%A3%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ä»£ç†æœåŠ¡å™¨</h2>\n<p>ç½‘ç»œå…ƒç´ æ¥æ”¶æ¥è‡ªç”¨æˆ·ä»£ç†çš„è¯·æ±‚å¹¶å°†å…¶è½¬å‘ç»™å¦ä¸€ä¸ªç”¨æˆ·ã€‚</p>\n<ul>\n<li>åŸºæœ¬ä¸Šä»£ç†æœåŠ¡å™¨çš„ä½œç”¨å°±åƒä¸€ä¸ªè·¯ç”±å™¨ã€‚</li>\n<li>å®ƒæœ‰ä¸€äº›æ™ºæ…§æ¥äº†è§£ SIP è¯·æ±‚ï¼Œå¹¶åœ¨ URI çš„å¸®åŠ©ä¸‹å‘é€å®ƒã€‚</li>\n<li>ä»£ç†æœåŠ¡å™¨ä½äºä¸¤ä¸ªç”¨æˆ·ä»£ç†ä¹‹é—´ã€‚</li>\n<li>æºå’Œç›®çš„åœ°ä¹‹é—´æœ€å¤šå¯ä»¥æœ‰ 70 ä¸ªä»£ç†æœåŠ¡å™¨ã€‚</li>\n</ul>\n<p>æœ‰ä¸¤ç§ç±»å‹çš„ä»£ç†æœåŠ¡å™¨ï¼š</p>\n<ul>\n<li>æ— çŠ¶æ€ä»£ç†æœåŠ¡å™¨ - å®ƒåªæ˜¯è½¬å‘æ”¶åˆ°çš„æ¶ˆæ¯ã€‚è¿™ç§ç±»å‹çš„æœåŠ¡å™¨ä¸å­˜å‚¨ä»»ä½•å‘¼å«æˆ–äº¤æ˜“çš„ä¿¡æ¯ã€‚</li>\n<li>æœ‰çŠ¶æ€ä»£ç†æœåŠ¡å™¨ - è¿™ç§ç±»å‹çš„ä»£ç†æœåŠ¡å™¨å¯ä»¥è·Ÿè¸ªæ”¶åˆ°çš„æ¯ä¸ªè¯·æ±‚å’Œå“åº”ï¼Œå¹¶ä¸”å¦‚æœéœ€è¦ï¼Œå¯ä»¥å°†æ¥ä½¿ç”¨å®ƒã€‚å¦‚æœå¯¹æ–¹æ²¡æœ‰å“åº”ï¼Œå®ƒå¯ä»¥é‡æ–°å‘é€è¯·æ±‚ã€‚</li>\n</ul>\n<h2 id="æ³¨å†ŒæœåŠ¡å™¨"><a href="#%E6%B3%A8%E5%86%8C%E6%9C%8D%E5%8A%A1%E5%99%A8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>æ³¨å†ŒæœåŠ¡å™¨</h2>\n<p>æ³¨å†ŒæœåŠ¡å™¨æ¥å—ç”¨æˆ·ä»£ç†çš„æ³¨å†Œè¯·æ±‚ã€‚å®ƒå¯ä»¥å¸®åŠ©ç”¨æˆ·åœ¨ç½‘ç»œä¸­è¿›è¡Œèº«ä»½éªŒè¯ã€‚å®ƒå°† URI å’Œç”¨æˆ·çš„ä½ç½®å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ï¼Œä»¥å¸®åŠ©åŒä¸€åŸŸå†…çš„å…¶ä»– SIP æœåŠ¡å™¨ã€‚</p>\n<p>çœ‹çœ‹ä¸‹é¢çš„ç¤ºä¾‹ï¼Œæ˜¾ç¤º SIP æ³¨å†Œçš„è¿‡ç¨‹ï¼š</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/2019-06-10-14-04-44-91eda7151b50ca646842814cf1b14b11-16a51.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 324px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 62.96296296296296%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABo0lEQVQoz5VSW3OaUBDm/7/4H9InX9q0zUMzEy6lIBqIXI8F5Zo2oHNUxhF7rKMkX+IIJm0fug/L7rf77e3A/bjPNFVjbPv4/8LdGQZ/I6RZxhj7a0Zd19BJGMiy4ti2rt+KgqzfDuaLFcff8B4ZOZZF6aJJhXr5trJljNL5HEmLRV5MKaW/2G9us9kURYHw4ST1iVe/yDm4rqplWTY9ONQghDSpMOIovPp89VWUJFEk34PzUJ7nk8nk2OmZvF6vO52OruuWZQ1N07asXk+9/nLN87wkSYqiAjdNczgcOo4DMAzDtnNZlqqq7na77UlgHzDs/rDf7xsc54SbZVkURS15uVye++fbvkGgsWOSJK86G4axWq1wRhSCO6ezi3cXHy/ff7j8hMMCAY5oVVXI9H2/JYMmCAIgnM3zvKPGng7e1LZhjwg5gnEcd7td13Xbg6FkEARvxv7XrzKdTl8djD2/PoV1n6WmZWKENE3DcBxFiR8EcRw9FMV47P98yJGDTrPZrCU3FvHcb4o86PexqyyLPW0gCKLW11ziqYrseqM/p3sCoy7NG/C5ws4AAAAASUVORK5CYII=\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="2019 06 10 14 04 44" title="" data-src="/static/2019-06-10-14-04-44-91eda7151b50ca646842814cf1b14b11-16a51.png" data-srcset="/static/2019-06-10-14-04-44-91eda7151b50ca646842814cf1b14b11-6752f.png 200w,\n/static/2019-06-10-14-04-44-91eda7151b50ca646842814cf1b14b11-16a51.png 324w" data-sizes="(max-width: 324px) 100vw, 324px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>è¿™é‡Œå‘¼å«è€…æƒ³è¦å‘ TMC åŸŸæ³¨å†Œã€‚å› æ­¤ï¼Œå®ƒå‘ TMC çš„ Registrar æœåŠ¡å™¨å‘é€ REGISTER è¯·æ±‚ï¼Œå¹¶ä¸”æœåŠ¡å™¨åœ¨æˆæƒå®¢æˆ·ç«¯æ—¶è¿”å› 200 OK å“åº”ã€‚</p>\n<h2 id="é‡å®šå‘æœåŠ¡å™¨"><a href="#%E9%87%8D%E5%AE%9A%E5%90%91%E6%9C%8D%E5%8A%A1%E5%99%A8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>é‡å®šå‘æœåŠ¡å™¨</h2>\n<p>é‡å®šå‘æœåŠ¡å™¨æ¥æ”¶è¯·æ±‚ï¼Œå¹¶åœ¨æ³¨å†Œå™¨åˆ›å»ºçš„ä½ç½®æ•°æ®åº“ä¸­æŸ¥æ‰¾è¯·æ±‚çš„é¢„æœŸæ”¶ä»¶äººã€‚</p>\n<p>é‡å®šå‘æœåŠ¡å™¨ä½¿ç”¨æ•°æ®åº“è·å–ä½ç½®ä¿¡æ¯ï¼Œå¹¶ä»¥ 3xxï¼ˆé‡å®šå‘å“åº”ï¼‰ å“åº”ç»™ç”¨æˆ·ã€‚æˆ‘ä»¬å°†åœ¨æœ¬æ•™ç¨‹çš„åé¢è®¨è®ºå“åº”ä»£ç ã€‚</p>\n<h2 id="ä½ç½®æœåŠ¡å™¨"><a href="#%E4%BD%8D%E7%BD%AE%E6%9C%8D%E5%8A%A1%E5%99%A8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ä½ç½®æœåŠ¡å™¨</h2>\n<p>ä½ç½®æœåŠ¡å™¨æä¾›æœ‰å…³å‘¼å«è€…å¯èƒ½çš„ä½ç½®åˆ°é‡å®šå‘å’Œä»£ç†æœåŠ¡å™¨çš„ä¿¡æ¯ã€‚</p>\n<p>åªæœ‰ä»£ç†æœåŠ¡å™¨æˆ–é‡å®šå‘æœåŠ¡å™¨å¯ä»¥è”ç³»ä½ç½®æœåŠ¡å™¨ã€‚</p>\n<p>ä¸‹å›¾æç»˜äº†æ¯ä¸ªç½‘ç»œå…ƒç´ åœ¨å»ºç«‹ä¼šè¯ä¸­æ‰€æ‰®æ¼”çš„è§’è‰²ï¼š</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/2019-06-10-14-06-20-13440bdd0d351c261f85053275b31948-28759.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 500px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 63.6%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAB20lEQVQoz4VSz2/TMBTO37sTNw5oQhwQ4gKckLjsgpC4DgmBEAfQmBgrLVvXrmu6po27JG1+2E4cx3bsJDjJGrYdxpMd+f343vf0vRjVvcYgxDNTYFyWpWpMP7qsUZVloY++VRNtcs7aA44jOU/X3vz4yB8NsxUArjM1TcZZU1U24M5qeBOT4vNg8v7XRCW4FCKMY5qmJct6F/Mv/THlQtfkShVlZUQbZ//wdP8ESMErpRiCaHRqL+Zg7bKV7f/pR+cjOL0QNN0EAZjPfM9zIUYZZ1IaL188f/Tm7c6rPQQWm4WFA19zF3kuKNW984wmV4Aj2A4nwNId9PwwbCc3Hu7uPnv65NunD9q3Bv21vayrpAwj5IZxdUOeJpwTHPGMXgtmef5gtjQDgvQclCoh6q6FihLmYJ5Lpb2apekSQHRwcna5cq7BXBX6QMpZLju1cxjlKOrcql1EShxw9fF4eGaBNmT8y3Wa67KlRVa2YEylpI4pqdnpbEKARQiiJN7u+Qa6pUmoeH2AH3wV339OK9vMRE4pFVzI4rYAt/a8XT2M6eN3w529cc/caFdvZRHFK5h4mMii+A/Ycd3e0Y/z4W9zOtmKLHGclHeJ74CbL8zEZZSO/cRG9P4//y+u7uAR2J+vYAAAAABJRU5ErkJggg==\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="2019 06 10 14 06 20" title="" data-src="/static/2019-06-10-14-06-20-13440bdd0d351c261f85053275b31948-28759.png" data-srcset="/static/2019-06-10-14-06-20-13440bdd0d351c261f85053275b31948-6ac48.png 200w,\n/static/2019-06-10-14-06-20-13440bdd0d351c261f85053275b31948-4b8bf.png 400w,\n/static/2019-06-10-14-06-20-13440bdd0d351c261f85053275b31948-28759.png 500w" data-sizes="(max-width: 500px) 100vw, 500px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<h1 id="ç³»ç»Ÿæ¶æ„"><a href="#%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ç³»ç»Ÿæ¶æ„</h1>\n<p>SIP è¢«æ„é€ ä¸ºåˆ†å±‚åè®®ï¼Œè¿™æ„å‘³ç€å…¶è¡Œä¸ºæ ¹æ®ä¸€ç»„ç›¸å½“ç‹¬ç«‹çš„å¤„ç†é˜¶æ®µæ¥æè¿°ï¼Œåªæœ‰æ¯ä¸ªé˜¶æ®µä¹‹é—´çš„æ¾æ•£è€¦åˆã€‚</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/2019-06-10-19-31-14-5e7501d7e92f7c43e4dca4328bd0686b-b50a0.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 202px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 216.83168316831686%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAArCAIAAAD3xz8iAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAFw0lEQVRIx32Wh1NaWRSH+Xt3ZyeWKCoaTbKr0bHEhgiPIogFEESKBQSlCPJAMJb0mbRJZtJ7V/d7XPYF0eyZ4XHfu+fc037nnKs5OTl58eJFIBCYm52TJGlqasrn84ZCoWCZ+B4Mhfx+v9M5bTSapqenPR7PgwcPkDo+PtbcunVrZGRkYWHBYJjw+nz+xcVgMORfWlpaXHS53J6FBZbhUGDaOcPT7XHPu1z68fHNzU3kNRaLxev13rlzRzJLlzvb/vrzj/bOq3X1jU2Njd3Xepu1zS2tbQb9WEtbW1NDHS+R2Ob2dra7u1sRfvz48fDwsMPhCIfDmUxmu0wsstksC+WZy4kFtLq6Ojc3NzAwUCwWFWF+nz9/TiQS+DM5OTk2NoYtMzMzOLK4uOjz+ebn5202m16vNxgM6FheXn716lXFZ34n/9GnT5/evHlz+/btUqlEqAYHBzc2NlB7eHj4/Pnzjx8/Hh0dCU4hpREvfFVPEQtOSafT6qtKqvwv4bPb5C8SibD4+fNntUA1aVRtMAklqmYCUaNZ5akIH5VJvHz//v3Zs2dggBRkMxnJZNrd3SWLDx8+fPToET5Xa6po/vbt28HBAeElzkaTkcCOjo6azRbblM1qtY6DCb2egywWM2EnEO/evatEG/PIkHFy0u32xOIbe3t7+/t7h4cHLPJyfqdYPDw4LBQKO8WdXC4HsHxeL1lgV9FM6kjmzZs3R0eGenr+btU26Tq6Ll5sudzZ2dHZ1drW1tHRYZKkznZdW3tne7uur78fBF2/fh10aIgK2Caf6+uRYNDvsNsdjukJg9FqtTlnZmyK4dZAYMlRXlms9nnX/JTdDqIqPsuyDHpw2O12g41UMlko5Atlysm5vCwnk8mVlVWvd8HlcplMJqrty5cvirAaeuIJE+hzOp0owbErV65SpByKa1Ql1u3v7xPdUwirwYDYuH//fjQaFfk7C7JT8FSzp24IQ9Sj1d1zECaYxLbgACc1woLhFMLUjRqzcQ/YfPjw4e3btwJP55h9XCZWAHNra4taJ54myWQ0GsfHx4kcSWZtNpvpR8T//fv3qjmKZoqbHExMTBBnKmlzcyORTNBMcjlZ6SrZDMAi1IFgkCOA4/r6uoi5BqCSFZpGNpsJLAXCy8sr5HR1dW1tjT/a59KSPxJVKB6Lx2OxzUQCvIATRRgmGmCxWErE13v7enU63YUL9T3XuhsaG5qatS2tLaPDQyNjo/X1jY11dXxwe/2Af8JgIB1KA+zv74/H4/m8vJXZQgO6I2trC14vSIpGorFYjDauGBUOoTsny5gJIn/8+KH4TD0qMZIkmJKplOKtLO/s7BAeOZ+nmMAvH1OpFDjDZ4AtemAFngSAusd+9ogweGR0EB4KGFZeRcCJBchTM6qp6X4i+Hfv3r1x44ap3EkYKQiobUSInYLnWfTxSnpwrFqmumf9tnvC9/XrV3LGU8jU1MZvhQURBTysLsD/E67uvhAG15h9TuutmQPiCBQ+efKE5DFoAIIYNNUj5VfAxIoCIpnlQW1g3JEYSTLZaWnTDhYUCTWDLS9fvlTlNcIY6oFeTW5BD6hw2MxN2tZrfX2tWm1zU0tv/0A6vSU6FOfS6tBU0QwMaFR0c5DEEGYRja5ZzJLdOev1uCWTec7lBl4ULOfCwNDFEOpcwycgxbCmB1N6iTLxXyoVr3ZdstqdjFt4kpXvCgFbDAR2GnotkMZb9ug7PNOpNJcCObc9ONBndTgBObYo8mWCAc+xsaenR/P06VPqGauoeyEfWVudslqoqnB4GfdANR2bK46wCzX5fJ6JgQuKzwweriXwsVcq7a6shHTa+n+6e3Udl7TaFq4yXR26Cw0XC2UTaEZDQ0OiK1eq6vXr15SbMhNJyexcsHwP41pFIwmFwryROaYnpULDYuL+qio16dxJGM4cT7ZnZ2dFMZJet8eDn/fu3SPC59xJzhbm76i6qv4FndI1TKRREB4AAAAASUVORK5CYII=\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="2019 06 10 19 31 14" title="" data-src="/static/2019-06-10-19-31-14-5e7501d7e92f7c43e4dca4328bd0686b-b50a0.png" data-srcset="/static/2019-06-10-19-31-14-5e7501d7e92f7c43e4dca4328bd0686b-0e5e0.png 200w,\n/static/2019-06-10-19-31-14-5e7501d7e92f7c43e4dca4328bd0686b-b50a0.png 202w" data-sizes="(max-width: 202px) 100vw, 202px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<ul>\n<li>SIP çš„æœ€ä½å±‚æ˜¯å…¶è¯­æ³•å’Œç¼–ç ã€‚å…¶ç¼–ç ä½¿ç”¨å¢å¼ºçš„ Backus-Naur è¡¨æ ¼è¯­æ³•ï¼ˆBNFï¼‰æ¥æŒ‡å®šã€‚</li>\n<li>ç¬¬äºŒå±‚æ˜¯ä¼ è¾“å±‚ã€‚å®ƒå®šä¹‰å®¢æˆ·ç«¯å¦‚ä½•å‘é€è¯·æ±‚å¹¶æ¥æ”¶å“åº”ï¼Œä»¥åŠæœåŠ¡å™¨å¦‚ä½•æ¥æ”¶è¯·æ±‚å¹¶é€šè¿‡ç½‘ç»œå‘é€å“åº”ï¼Œæ‰€æœ‰ SIP å…ƒç´ éƒ½åŒ…å«ä¼ è¾“å±‚ã€‚</li>\n<li>æ¥ä¸‹æ¥æ˜¯äº‹åŠ¡å±‚ã€‚äº‹åŠ¡æ˜¯ç”±å®¢æˆ·ç«¯äº‹åŠ¡ï¼ˆä½¿ç”¨ä¼ è¾“å±‚ï¼‰å‘é€åˆ°æœåŠ¡å™¨äº‹åŠ¡çš„è¯·æ±‚ï¼Œä»¥åŠä»æœåŠ¡å™¨äº‹åŠ¡å‘é€å›å®¢æˆ·ç«¯çš„å¯¹è¯¥è¯·æ±‚çš„æ‰€æœ‰å“åº”ã€‚ç”¨æˆ·ä»£ç†å®¢æˆ·ç«¯ï¼ˆUACï¼‰å®Œæˆçš„ä»»ä½•ä»»åŠ¡éƒ½å°†ä½¿ç”¨ä¸€ç³»åˆ—äº‹åŠ¡è¿›è¡Œã€‚æ— çŠ¶æ€ä»£ç†ä¸åŒ…å«äº‹åŠ¡å±‚ã€‚</li>\n<li>äº‹åŠ¡å±‚ä¸Šé¢çš„å±‚ç§°ä¸ºäº‹åŠ¡ç”¨æˆ·ã€‚é™¤äº†æ— çŠ¶æ€ä»£ç†ä¹‹å¤–ï¼Œæ¯ä¸ª SIP å®ä½“éƒ½æ˜¯ä¸€ä¸ªäº‹åŠ¡ç”¨æˆ·ã€‚</li>\n</ul>\n<p>ä¸‹å›¾æ˜¾ç¤ºäº† SIP ä¼šè¯çš„åŸºæœ¬å‘¼å«æµç¨‹ï¼š</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/2019-06-10-19-32-44-f8ef215a624bdd21f854652eb7df10f3-81a6c.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 600px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 61.33333333333334%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsSAAALEgHS3X78AAABYUlEQVQoz22RzY6CUAyFff+XGnfqYkxcCEEJIKCCClwE5Z+ZT2pEJ9NFU3rPOT0tk6IofoaguN1ufd8fg2OSJHSu12tVVV3X5XlOQed+v7/jJ3xTgYAZx/HhcFgsFqvVKgiC/X5PZ7n8nk6/5vMZWmEYIlSWpQiN5DRNgZIdx/E873w+K6VAW5blui5aIHltmobMJJWqiTwDzbIMt/B1XV+vNfhpqqIo2m63u90O2wyERgbJsIdt5CFghgc8kzVNE7Tv++BkQ9CcAybz67qmk+XZaFsmo0JGkU9js7lcLkJgDnIYlDF1XZ1O4QeZaNsWYYZAMwzDNE3WY0+YPOFRxv5zMLkKEmRODVMsSKBCkwz4g4wqfqgxiUPkOZXvP6ByKoImtilQxAuAcTK/kTcQsh6jOLtt2yInTdyBRxEKw55klkSMGgvNEKiQX59SI0EB+Gmb6fEQcuTkLV79PyF9bP4CKGOpcZAD1HMAAAAASUVORK5CYII=\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="2019 06 10 19 32 44" title="" data-src="/static/2019-06-10-19-32-44-f8ef215a624bdd21f854652eb7df10f3-81a6c.png" data-srcset="/static/2019-06-10-19-32-44-f8ef215a624bdd21f854652eb7df10f3-468c3.png 200w,\n/static/2019-06-10-19-32-44-f8ef215a624bdd21f854652eb7df10f3-3ff2b.png 400w,\n/static/2019-06-10-19-32-44-f8ef215a624bdd21f854652eb7df10f3-81a6c.png 600w" data-sizes="(max-width: 600px) 100vw, 600px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>ä»¥ä¸‹æ˜¯å¯¹ä¸Šè¿°å‘¼å«æµç¨‹çš„é€æ­¥è¯´æ˜ï¼š</p>\n<ul>\n<li>å‘é€åˆ°ä»£ç†æœåŠ¡å™¨çš„ INVITE è¯·æ±‚è´Ÿè´£å¯åŠ¨ä¼šè¯ã€‚</li>\n<li>ä»£ç†æœåŠ¡å™¨å‘é€ 100 å°è¯•ç«‹å³å“åº”å‘¼å«è€…ï¼ˆAliceï¼‰ä»¥åœæ­¢ INVITE è¯·æ±‚çš„é‡æ–°å‘é€ã€‚</li>\n<li>ä»£ç†æœåŠ¡å™¨åœ¨ä½ç½®æœåŠ¡å™¨ä¸­æœç´¢ Bob çš„åœ°å€ã€‚è·å–åœ°å€åï¼Œè¿›ä¸€æ­¥è½¬å‘ INVITE è¯·æ±‚ã€‚</li>\n<li>æ­¤åï¼ŒBob æ‰‹æœºç”Ÿæˆçš„ 180 æŒ¯é“ƒï¼ˆä¸´æ—¶å“åº”ï¼‰è¿”å›ç»™çˆ±ä¸½ä¸ã€‚</li>\n<li>é²å‹ƒæ‹¿èµ·æ‰‹æœºåä¸€ä¸ª 200 OK å“åº”å¾ˆå¿«äº§ç”Ÿã€‚</li>\n<li>ä¸€æ—¦ 200 OK åˆ°è¾¾ Aliceï¼ŒBob ä» Alice æ”¶åˆ°ä¸€ä¸ª ACKã€‚</li>\n<li>åŒæ—¶ï¼Œä¼šè¯å»ºç«‹ï¼ŒRTP æ•°æ®åŒ…ï¼ˆä¼šè¯ï¼‰ä»ä¸¤ç«¯å¼€å§‹æµåŠ¨ã€‚</li>\n<li>ä¼šè¯ç»“æŸåï¼Œä»»ä½•å‚ä¸è€…ï¼ˆAlice æˆ– Bobï¼‰éƒ½å¯ä»¥å‘é€ä¸€ä¸ª BYE è¯·æ±‚æ¥ç»ˆæ­¢ä¼šè¯ã€‚</li>\n<li>BYE ç›´æ¥ä» Alice åˆ° Bob ç»•è¿‡ä»£ç†æœåŠ¡å™¨ã€‚</li>\n<li>æœ€åï¼ŒBob å‘é€ 200 OK å“åº”æ¥ç¡®è®¤ BYEï¼Œä¼šè¯ç»ˆæ­¢ã€‚</li>\n<li>åœ¨ä¸Šè¿°åŸºæœ¬å‘¼å«æµç¨‹ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ä¸‰ä¸ªäº‹åŠ¡ï¼ˆæ ‡è®°ä¸º 1ï¼Œ2ï¼Œ3ï¼‰ã€‚</li>\n</ul>\n<p>å®Œæ•´çš„å‘¼å«ï¼ˆä» INVITE åˆ° 200 OKï¼‰ç§°ä¸ºå¯¹è¯ Dialogã€‚</p>\n<h1 id="sip-æ¢¯å½¢"><a href="#sip-%E6%A2%AF%E5%BD%A2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>SIP æ¢¯å½¢</h1>\n<p>ä»£ç†å¦‚ä½•å¸®åŠ©ä¸€ä¸ªç”¨æˆ·ä¸å¦ä¸€ä¸ªç”¨æˆ·è¿æ¥ï¼Ÿè®©æˆ‘ä»¬åœ¨ä¸‹å›¾çš„å¸®åŠ©ä¸‹æ‰¾å‡ºã€‚</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/2019-06-10-19-41-07-626e78b214093282713cb4538e1b4946-068c2.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 422px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 62.085308056872044%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsSAAALEgHS3X78AAABTElEQVQoz3WSS66CUBBE7/53YAxODHtwihNQh+gIlETED2gUQUUB9Ui/EJ9iDfg0Xd1VdVGr1SpN02OFJEmCIJjP5/v9nlfqVOI4pofiZrM5/ofi86PC/X7n6jiOZVk8lGWZZdntdpPnfr+/WCzqNoFigJSkahhGt9u9Xq/smUwmnue5rmvbtqZp4/FYBjWQpcoGXdfzPEezbI6iCM2dTodZQq6X/5GF6VRYr9fv2mQ0Enzf/5TN4O12ezqdiqIYDocSwXtH7SgMQzppI06kvci8Hw6H8/lMzlj9cFVDimxCwm63k07FSXBDam3+8QPyiWW1L4Xgy+VC6ZtZVvjm445oXuTRaESSvV6PKYhhECFzJWdMknNWgQpuscYa0zRbrRa/gyJDzmYwGMjZRj/AIHLiwJfL5Ww2a7fbEBVp8euQQaPJxgigTKdT5DwBp/ykSH3SIScAAAAASUVORK5CYII=\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="2019 06 10 19 41 07" title="" data-src="/static/2019-06-10-19-41-07-626e78b214093282713cb4538e1b4946-068c2.png" data-srcset="/static/2019-06-10-19-41-07-626e78b214093282713cb4538e1b4946-2e5ea.png 200w,\n/static/2019-06-10-19-41-07-626e78b214093282713cb4538e1b4946-68ec0.png 400w,\n/static/2019-06-10-19-41-07-626e78b214093282713cb4538e1b4946-068c2.png 422w" data-sizes="(max-width: 422px) 100vw, 422px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>å›¾ä¸­æ‰€ç¤ºçš„æ‹“æ‰‘ç»“æ„ç§°ä¸º SIP æ¢¯å½¢å›¾ã€‚è¯¥è¿‡ç¨‹å‘ç”Ÿå¦‚ä¸‹ï¼š</p>\n<ul>\n<li>å½“å‘¼å«æ–¹å‘èµ·å‘¼å«æ—¶ï¼Œå°†å‘ä»£ç†æœåŠ¡å™¨å‘é€ INVITE æ¶ˆæ¯ã€‚ä»£ç†æœåŠ¡å™¨æ”¶åˆ° INVITE åï¼Œå°è¯•å€ŸåŠ© DNS æœåŠ¡å™¨è§£æå—ç†è€…çš„åœ°å€ã€‚</li>\n<li>åœ¨è·å¾—ä¸‹ä¸€ä¸ªè·¯ç”±ä¹‹åï¼Œå‘¼å«è€…çš„ä»£ç†æœåŠ¡å™¨ï¼ˆä»£ç† 1ï¼Œä¹Ÿç§°ä¸ºå‡ºç«™ä»£ç†æœåŠ¡å™¨ï¼‰å°† INVITE è¯·æ±‚è½¬å‘ç»™ä½œä¸ºè¢«å‘¼å«è€…çš„å…¥ç«™ä»£ç†æœåŠ¡å™¨ï¼ˆä»£ç†æœåŠ¡å™¨ 2ï¼‰çš„è¢«å‘¼å«è€…çš„ä»£ç†æœåŠ¡å™¨ã€‚</li>\n<li>å…¥ç«™ä»£ç†æœåŠ¡å™¨è”ç³»ä½ç½®æœåŠ¡å™¨ä»¥è·å–ç”¨æˆ·æ³¨å†Œçš„è¢«å«æ–¹åœ°å€ä¿¡æ¯ã€‚</li>\n<li>ä»ä½ç½®æœåŠ¡å™¨è·å–ä¿¡æ¯åï¼Œå°†å‘¼å«è½¬å‘åˆ°å…¶ç›®çš„åœ°ã€‚</li>\n<li>ä¸€æ—¦ç”¨æˆ·ä»£ç†çŸ¥é“ä»–ä»¬çš„åœ°å€ï¼Œä»–ä»¬å¯ä»¥ç»•è¿‡å‘¼å«ï¼Œå³ç›´æ¥é€šè¯ã€‚</li>\n</ul>\n<p>ä»¥ä¸Šæ›´æ–°äº<code class="language-text">2019-6-10 20:24:54</code></p>\n<hr>',excerpt:"ä¼šè¯å‘èµ·åè®®ï¼ˆSIPï¼‰æ˜¯ VoIP æŠ€æœ¯ä¸­æœ€å¸¸ç”¨çš„åè®®ä¹‹ä¸€ã€‚å®ƒæ˜¯ä¸€ç§åº”ç”¨å±‚åè®®ï¼Œä¸å…¶ä»–åº”ç”¨å±‚åè®®ååŒå·¥ä½œï¼Œé€šè¿‡ Internet æ§åˆ¶å¤šåª’ä½“é€šä¿¡ä¼šè¯ã€‚ æ¦‚è¿° SIPâ€¦",frontmatter:{date:"2019-06-10 11:43:51",path:"/sip-protocol-introduction-learning/",tags:"å‰ç«¯, SIP",title:"SIPåè®®å…¥é—¨å­¦ä¹ ",draft:null}}},pathContext:{mainPostPath:"/nginx-common-configurations-techniques/",nextPostPath:"/write-resilient-components/",prePostPath:"/sip-protocol-introduction-learning/"}}}});