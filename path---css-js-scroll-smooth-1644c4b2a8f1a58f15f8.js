webpackJsonp([0xe1869d84d1b8],{1219:function(a,n){a.exports={data:{file:{childImageSharp:{sizes:{base64:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAeCAYAAAAsEj5rAAAACXBIWXMAAAsSAAALEgHS3X78AAAHlElEQVRIx12We2xT5xXAbcI2Vmn7o1I1uhVYRxL8tuPn9bXv0+/4/YgdOyYkkATCCEEYsqVNC2wCIYQWShmUBFh4hMAWECot0BUtlI4yAS1oKqJQXimsDBgTU8codnLO7r0uUPpJn87Rp+/8vvOdc75zr8xmZmTieI1NykU5yxOfxDncz3NUjAlyDXMjXGMhys+cG+FzGQ8VU4t7XuV8z8m+GUkrJclSqVReYJ0ZWQ8Tl2AdTPhnq9ns2QKd+crDZiHha8NsYCE21HZiXphpb3sxxTf99Tdsw51ldHqFaLOXXyzvYqOyZ0YPk5soylfouuUbvHOxh56JbiqJfi4/FnE1lxKetrGUZ954nbcdU/752ORpxWVsc6mZjPxctFtApeVtra1lmIPwTxClgeCqvGTsX/WWOEbtyTGWSoGbToOPzUHQ1QghVxOEhRniZ5U8XB4TzvTdgj1ZJdq2OOrkGhVRBnrYFum6TiK0l2fr0emMlVxcBhlnEniqDjlBuqg0CnD0MPWiDrwzhR4u+5B3x3WiLUNHJjxzZYvR8ZKTCP+Xo1JoM/nBYvSB1egHuyUIrCOBPj4LtD0KlD2K4h7SGip62aygxzaK9rHA3Aqt2vw0MRYjnyJtYaQdsXG9hgWFwgmVlXZUKUjUqmm0CgfwhA80Kgr1Wg40Sue4SuFEnZq+YjMbJ0kh0zmfemjQ0j2EJYh2a23RVOODIBvHmCsBUaoWLDoWKIsP50bTApxC5QwH1Ghp0Gk4MBk8aDLQEslooCc88VClsK+zGANI2mqLer0XFuea8PSuN+DM7o3QWyhAR7IBfj+vDbyOICS9aSjkZo8nvSlUKuxXLDUOKdN6LSl/AlRUE+vNAnD50l8XeTIEPiYEzXYG5mlNeGz7BvjPpY/g5snDcHxwE+zs7oCh1zvHCrNm48u/ML8j2muVQblBZ3t6ZY2KXKtQcDiwdk1xx9rV0BlqghEuD4fNUTy1Zwhw7Cbioxu461fdsOgFDa5pbh3zu6NifE9f+XCPlGHS5nuaFI3K8brJ4EUHES4WFiyEP2/dCPc2vYH/3NIHePcywP1LWLp3Ec4tWQa3FvbAu7294yqVA801rju5utYfiQyKDD4DnC8GWEhMafJPtBALxuHjo3+C8bufIn59DfHBFcDiDcQvzyF+/iEsbWuDadNMaDW5H7nY6Iyyh165zfLNtdUqIqLTsEJSQqBVUTD1JQPqdRT8sf9NuH7kMHy0fRg+O3EUzp96H/Zs2SBklxFKxwFmowtdTCIoPQx7oKLzl32PPTRPVSudDwQgCrUGL0+twdzsDjjSdwD2J1fh/q7N0N+1EtykB178qVY4lAahRktWkw95JrG4DAxPvHU3Wwb+rlcsHfK0WNxCoMdUCgdUaxnMBPKw7dVe2LyhDw4MboORA4NQOd2CaiUFaqWjZJGAyQGRUeubP8FqElqZspquEBeUM2zrnEQUa3R8USVcp2qGDZV6ErqXL4PfrlwFhSU9cPL4MejfshOsZq90sCg5KvHZ5MnPfa+cmFrxukRFuRZNcYqIoNngHheeFmiF11ClIDBdPwfqG9qhc1E3rF25GnrX90M204JqBfWItPrP8lTqa7vFpSw3GJ9cZjI4pW5TXaWezpKxh4Q5gEY9LwApVOtZMApxVWhd2DKvC7K5FjTUsFCj45Ah4yXaHuz1MBlgyHCb1HXISIXMTcekOJqN1h/72Mx92h5DwuwHjeChWseBQsNgJJ6H944eB5oNgaLajnaL/07E24wuKr7Cz+XuuenUsMioCxYmyHhnSPLQTYVVYVfjI46Mo80WBLMgLY4E1FhCOENBAsfHQG/0juuNPqGguU8ywXas5XNbg6783wJ8w781GtUPJc+irkap/Ufdje0JXytStnDJbA2D1Z4EKxEHsyUMRmsIdcZaNFpCYBYqwWQLPhD3Btn6t2Pe5uF0cD7Sdr/xmSab8racFaDooOvuk0wDEs40EFQGbVQGbEKXJoTPgZ3JoJGIgULvR6M1jE67rzvpae5ojC7GEJ9rfgILc7lC3NV0T6flTtjoPLK+VuD8rcD65gDtaQInPxOtzoxQRrXgD8/BdW/+YezYByfxvfdHvnxl+ZLKCDfzUMIze60Ey+brJukrqcjA1u3tBw8dfZiZuRQFaNFory/WEPUlE5kFK5WDQKRtbFPfUOnChUvFL27cwKuj/8CBHXv2iQw/k/KGuNwyCYiIkhw+sO/569eu7b1+ffR/H5z4BAcG38X1m/biyjX9ODR8GC9dHsXLV0fx5KlzePDIyFd7ht9ZJZhJrcvLhV/wMuUPljQWtC6Z+FjfuWPHlPMXLq64Onpz3d8/Pf9WX//OW2vWbITBof3n3tqya9fbh/7SvW1gZ9Xj/V1dr8kf614qIZONjBwrezi8Ty54K5d9ZzTmF+xe1LnioaD+4Nvrn4/ermif3yHp8UCDLMCky7Z+n192+/YdST9z5mPZ7t1D8ouXv6gQ4S9WTplks7mut8xZijxbKz2vvi2D39/cPyB/HC5xOm2czPvd35F8rkGCS0+I4WXV1QbJaMq06XqbNXCQJIILpH8hOic3GghZMpl62qG/Nf4PRzaQ862MzO4AAAAASUVORK5CYII=",aspectRatio:.6666666666666666,src:"/static/avatar-dc7bc85837bf005ae32d2a37dfdfa8a2-25c91.png",srcSet:"/static/avatar-dc7bc85837bf005ae32d2a37dfdfa8a2-8a97b.png 200w,\n/static/avatar-dc7bc85837bf005ae32d2a37dfdfa8a2-0fdf3.png 400w,\n/static/avatar-dc7bc85837bf005ae32d2a37dfdfa8a2-25c91.png 600w",srcWebp:"/static/avatar-dc7bc85837bf005ae32d2a37dfdfa8a2-216f6.webp",srcSetWebp:"/static/avatar-dc7bc85837bf005ae32d2a37dfdfa8a2-5d70e.webp 200w,\n/static/avatar-dc7bc85837bf005ae32d2a37dfdfa8a2-d1677.webp 400w,\n/static/avatar-dc7bc85837bf005ae32d2a37dfdfa8a2-216f6.webp 600w",sizes:"(max-width: 600px) 100vw, 600px"}}},site:{siteMetadata:{title:"女王控的博客",description:'前端工程师，黑猫女王控，欢迎勾搭，技术相关<a href="https://github.com/towavephone" target="_blank">@towavephone</a>，QQ闲聊<a href="tencent://AddContact/?fromId=45&fromSubId=1&subcmd=all&uin=634407147&website=www.oicqzone.com">@towave</a>，bili关注<a href="https://space.bilibili.com/11507708#/" target="_blank">@towave</a>',siteUrl:"https://blog.towavephone.com"}},mainPost:{html:'<p>假设页面中有下面这一段 HTML：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="92861198218852170000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`<a href=&quot;#&quot; rel=&quot;internal&quot;>返回顶部</a>`, `92861198218852170000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="html"\n              >\n                <span class="gatsby-code-button-language">html</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="html"><pre style="counter-reset: linenumber NaN" class="language-html line-numbers"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#<span class="token punctuation">"</span></span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>internal<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>返回顶部<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>\n<p>点击“返回顶部”这个文字链接的时候，页面就会“唰”地瞬间定位到浏览器顶部。</p>\n<p>浏览器已经开始支持原生平滑滚动定位，CSS scroll-behavior 属性和 JS scrollIntoView()方法都可以。</p>\n<h1 id="css-scroll-behavior-与平滑滚动"><a href="#css-scroll-behavior-%E4%B8%8E%E5%B9%B3%E6%BB%91%E6%BB%9A%E5%8A%A8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>CSS scroll-behavior 与平滑滚动</h1>\n<p>scroll-behavior:smooth 写在滚动容器元素上，可以让容器（非鼠标手势触发）的滚动变得平滑。</p>\n<p>语法</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="52325661262408320000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`scroll-behavior: auto;\nscroll-behavior: smooth;`, `52325661262408320000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="css"\n              >\n                <span class="gatsby-code-button-language">css</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="css"><pre style="counter-reset: linenumber NaN" class="language-css line-numbers"><code class="language-css"><span class="token property">scroll-behavior</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span>\n<span class="token property">scroll-behavior</span><span class="token punctuation">:</span> smooth<span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>\n<p>初始值是’auto’。</p>\n<p>凡是需要滚动的地方都加一句 scroll-behavior:smooth 就好了！</p>\n<p>举个例子，在 PC 浏览器中，网页默认滚动是在<code class="language-text">&lt;html&gt;</code>标签上的，移动端大多数在<code class="language-text">&lt;body&gt;</code>标签上，于是，我加上这么一句：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="22589390086909567000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`html,\nbody {\n  scroll-behavior: smooth;\n}`, `22589390086909567000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="css"\n              >\n                <span class="gatsby-code-button-language">css</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="css"><pre style="counter-reset: linenumber NaN" class="language-css line-numbers"><code class="language-css"><span class="token selector">html,\nbody</span> <span class="token punctuation">{</span>\n  <span class="token property">scroll-behavior</span><span class="token punctuation">:</span> smooth<span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>\n<h1 id="js-scrollintoview-与平滑滚动"><a href="#js-scrollintoview-%E4%B8%8E%E5%B9%B3%E6%BB%91%E6%BB%9A%E5%8A%A8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>JS scrollIntoView 与平滑滚动</h1>\n<p>DOM 元素的 scrollIntoView()方法是一个 IE6 浏览器也支持的原生 JS API，可以让元素进入视区，通过触发滚动容器的定位实现。</p>\n<p>随着 Chrome 和 Firefox 浏览器开始支持 CSS scroll-behavior 属性，顺便对 scrollIntoView()方法进行了升级，使支持更多参数，其中一个参数就是可以使滚动平滑。</p>\n<p>语法如下：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="71686554088568790000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`target.scrollIntoView({\n  behavior: \'smooth\'\n});`, `71686554088568790000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="js"\n              >\n                <span class="gatsby-code-button-language">js</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="js"><pre style="counter-reset: linenumber NaN" class="language-js line-numbers"><code class="language-js">target<span class="token punctuation">.</span><span class="token function">scrollIntoView</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  behavior<span class="token punctuation">:</span> <span class="token string">\'smooth\'</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<p>我们随便打开一个有链接的页面，把首个链接滚动到屏幕外，然后控制台输入类似下面代码，我们就可以看到页面平滑滚动定位了：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="24837454990039220000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`document.links[0].scrollIntoView({\n  behavior: \'smooth\'\n});`, `24837454990039220000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="js"\n              >\n                <span class="gatsby-code-button-language">js</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="js"><pre style="counter-reset: linenumber NaN" class="language-js line-numbers"><code class="language-js">document<span class="token punctuation">.</span>links<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">scrollIntoView</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  behavior<span class="token punctuation">:</span> <span class="token string">\'smooth\'</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<h2 id="其他"><a href="#%E5%85%B6%E4%BB%96" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>其他</h2>\n<ul>\n<li>\n<p>scrollIntoView()升级后的方法，除了支持’behavior’，还有’block’和’inline’等参数，有兴趣可以参阅 MDN 相关文档。</p>\n</li>\n<li>\n<p>如果我们的网页已经通过 CSS 设置了 scroll-behavior:smooth 声明，则我们直接执行 target.scrollIntoView()方法就会有平滑滚动，无需再额外设置 behavior 参数。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="95656924039808140000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`document.forms[0].scrollIntoView();`, `95656924039808140000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="js"\n              >\n                <span class="gatsby-code-button-language">js</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="js"><pre style="counter-reset: linenumber NaN" class="language-js line-numbers"><code class="language-js">document<span class="token punctuation">.</span>forms<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">scrollIntoView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>\n</li>\n</ul>\n<h1 id="js-平滑滚动向下兼容处理"><a href="#js-%E5%B9%B3%E6%BB%91%E6%BB%9A%E5%8A%A8%E5%90%91%E4%B8%8B%E5%85%BC%E5%AE%B9%E5%A4%84%E7%90%86" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>JS 平滑滚动向下兼容处理</h1>\n<p>JS 实现平滑滚动并不难，jQuery 中 animate()方法：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="58519853596346480000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`scrollContainer.animate({\n  scrollTop: 0\n});`, `58519853596346480000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="js"\n              >\n                <span class="gatsby-code-button-language">js</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="js"><pre style="counter-reset: linenumber NaN" class="language-js line-numbers"><code class="language-js">scrollContainer<span class="token punctuation">.</span><span class="token function">animate</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  scrollTop<span class="token punctuation">:</span> <span class="token number">0</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<p>或者使用 requestAnimationFrame API 这类原生 JS 也能实现。例如下面这个我速写的个方法：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="15552514722378197000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`/**\n @description 页面垂直平滑滚动到指定滚动高度\n @author zhangxinxu(.com)\n*/\nvar scrollSmoothTo = function(position) {\n  if (!window.requestAnimationFrame) {\n    window.requestAnimationFrame = function(callback, element) {\n      return setTimeout(callback, 17);\n    };\n  }\n  // 当前滚动高度\n  var scrollTop = document.documentElement.scrollTop || document.body.scrollTop;\n  // 滚动step方法\n  var step = function() {\n    // 距离目标滚动距离\n    var distance = position - scrollTop;\n    // 目标滚动位置\n    scrollTop = scrollTop + distance / 5;\n    if (Math.abs(distance) < 1) {\n      window.scrollTo(0, position);\n    } else {\n      window.scrollTo(0, scrollTop);\n      requestAnimationFrame(step);\n    }\n  };\n  step();\n};`, `15552514722378197000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="js"\n              >\n                <span class="gatsby-code-button-language">js</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="js"><pre style="counter-reset: linenumber NaN" class="language-js line-numbers"><code class="language-js"><span class="token comment">/**\n @description 页面垂直平滑滚动到指定滚动高度\n @author zhangxinxu(.com)\n*/</span>\n<span class="token keyword">var</span> <span class="token function-variable function">scrollSmoothTo</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">position</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>window<span class="token punctuation">.</span>requestAnimationFrame<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    window<span class="token punctuation">.</span><span class="token function-variable function">requestAnimationFrame</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">callback<span class="token punctuation">,</span> element</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">return</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>callback<span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n  <span class="token comment">// 当前滚动高度</span>\n  <span class="token keyword">var</span> scrollTop <span class="token operator">=</span> document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>scrollTop <span class="token operator">||</span> document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>scrollTop<span class="token punctuation">;</span>\n  <span class="token comment">// 滚动step方法</span>\n  <span class="token keyword">var</span> <span class="token function-variable function">step</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 距离目标滚动距离</span>\n    <span class="token keyword">var</span> distance <span class="token operator">=</span> position <span class="token operator">-</span> scrollTop<span class="token punctuation">;</span>\n    <span class="token comment">// 目标滚动位置</span>\n    scrollTop <span class="token operator">=</span> scrollTop <span class="token operator">+</span> distance <span class="token operator">/</span> <span class="token number">5</span><span class="token punctuation">;</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>distance<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      window<span class="token punctuation">.</span><span class="token function">scrollTo</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> position<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n      window<span class="token punctuation">.</span><span class="token function">scrollTo</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> scrollTop<span class="token punctuation">)</span><span class="token punctuation">;</span>\n      <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span>step<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span><span class="token punctuation">;</span>\n  <span class="token function">step</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>使用的是缓动动画 JS 小算法，滚动先快后慢。</p>\n<p>使用如下，例如我们希望网页平滑滚动到顶部，直接：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="84816840486787630000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`scrollSmoothTo(0);`, `84816840486787630000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="js"\n              >\n                <span class="gatsby-code-button-language">js</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="js"><pre style="counter-reset: linenumber NaN" class="language-js line-numbers"><code class="language-js"><span class="token function">scrollSmoothTo</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>\n<p>难的是如何支持平滑滚动的浏览器原生处理，不支持的浏览器还是使用老的 JS 方法处理。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="46846951890370510000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`if (typeof window.getComputedStyle(document.body).scrollBehavior == \'undefined\') {\n  // 传统的JS平滑滚动处理代码...\n}`, `46846951890370510000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="js"\n              >\n                <span class="gatsby-code-button-language">js</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="js"><pre style="counter-reset: linenumber NaN" class="language-js line-numbers"><code class="language-js"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> window<span class="token punctuation">.</span><span class="token function">getComputedStyle</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">.</span>scrollBehavior <span class="token operator">==</span> <span class="token string">\'undefined\'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token comment">// 传统的JS平滑滚动处理代码...</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>',excerpt:"假设页面中有下面这一段 HTML： 点击“返回顶部”这个文字链接的时候，页面就会“唰”地瞬间定位到浏览器顶部。 浏览器已经开始支持原生平滑滚动定位，CSS scroll-behavior 属性和 JS scrollIntoView()方法都可以。 CSS scroll…",timeToRead:2,tableOfContents:'<ul>\n<li><a href="/css-js-scroll-smooth/#css-scroll-behavior-%E4%B8%8E%E5%B9%B3%E6%BB%91%E6%BB%9A%E5%8A%A8">CSS scroll-behavior 与平滑滚动</a></li>\n<li>\n<p><a href="/css-js-scroll-smooth/#js-scrollintoview-%E4%B8%8E%E5%B9%B3%E6%BB%91%E6%BB%9A%E5%8A%A8">JS scrollIntoView 与平滑滚动</a></p>\n<ul>\n<li><a href="/css-js-scroll-smooth/#%E5%85%B6%E4%BB%96">其他</a></li>\n</ul>\n</li>\n<li><a href="/css-js-scroll-smooth/#js-%E5%B9%B3%E6%BB%91%E6%BB%9A%E5%8A%A8%E5%90%91%E4%B8%8B%E5%85%BC%E5%AE%B9%E5%A4%84%E7%90%86">JS 平滑滚动向下兼容处理</a></li>\n</ul>',wordCount:{words:127},frontmatter:{date:"2020-01-14 10:55:12",path:"/css-js-scroll-smooth/",tags:"前端, CSS, CSS知识点",title:"CSS scroll-behavior和JS scrollIntoView让页面滚动平滑",draft:null,catalog_number:null}},nextPost:{html:'<p>所谓“层叠规则”，指的是当网页中的元素发生层叠时的表现规则。</p>\n<p>默认情况下，网页内容是没有偏移角的垂直视觉呈现，当内容发生层叠的时候，一定会有一个前后的层叠顺序产生，有点儿类似于真实世界中“论资排辈”的感觉。</p>\n<h1 id="z-index-只是-css-层叠规则中的一部分"><a href="#z-index-%E5%8F%AA%E6%98%AF-css-%E5%B1%82%E5%8F%A0%E8%A7%84%E5%88%99%E4%B8%AD%E7%9A%84%E4%B8%80%E9%83%A8%E5%88%86" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>z-index 只是 CSS 层叠规则中的一部分</h1>\n<p>在 CSS 世界中，z-index 属性只有和定位元素（position 不为 static 的元素）在一起的时候才有作用，可以是正数也可以是负数。理论上说，数值越大层级越高，但实际上其规则要复杂很多。</p>\n<p>但随着 CSS3 新世界的到来，z-index 已经并非只对定位元素有效，flex 盒子的子元素也可以设置 z-index 属性。</p>\n<p>要知道，网页中绝大部分元素是非定位元素，并且影响层叠顺序的属性远不止 z-index 一个，因此大家千万不要以为 z-index 属性就可以代表 CSS 世界的层叠规则，实际上 z-index 只是 CSS 层叠规则中的一叶小舟，CSS 层叠规则的体量要比大家想象的要大得多。</p>\n<h1 id="理解-css-世界的层叠上下文和层叠水平"><a href="#%E7%90%86%E8%A7%A3-css-%E4%B8%96%E7%95%8C%E7%9A%84%E5%B1%82%E5%8F%A0%E4%B8%8A%E4%B8%8B%E6%96%87%E5%92%8C%E5%B1%82%E5%8F%A0%E6%B0%B4%E5%B9%B3" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>理解 CSS 世界的层叠上下文和层叠水平</h1>\n<h2 id="什么是层叠上下文"><a href="#%E4%BB%80%E4%B9%88%E6%98%AF%E5%B1%82%E5%8F%A0%E4%B8%8A%E4%B8%8B%E6%96%87" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>什么是层叠上下文</h2>\n<p>层叠上下文，英文称作 stacking context，是 HTML 中的一个三维的概念。如果一个元素含有层叠上下文，我们可以理解为这个元素在 z 轴上就“高人一等”。</p>\n<p>这里出现了一个名词 — z 轴，它指的是什么呢？其表示的是用户与显示器之间这条看不见的垂直线，即图 7-1 中的这条水平线。</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/2020-01-10-10-26-48-e3545ce32a6b4a015fa7918f38ed5326-27d67.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 281px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 73.66548042704626%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAAsSAAALEgHS3X78AAABGElEQVQoz5WTSW6EMBBFuf/pkEBiBStmgZnDTPdrKiK0cJOkFsgu+/36LhvjcRvrulZVtW2bdtX4Fc6yrCzLI7MsyzRNP/C2hxaWrW3bNk3DdJ5ny7JM0/xr5a7rgiAoimIYBjKoHEYMxDiVUoqBtnLf92EY8s3zXPakaSq8gaUkSZgjifn1FEzxTEEkoihiAA8zjmMcxy+4rmtSrBVKwbenwDCmWAVjyXVdvpT52oMNL1gcSuWrcwyLW3Yyls59nxlVNLAnKleeDN3iFIzFwts9IwyPqhYWUxxBD98HcjSs3gODevjTO5E8lbmeZo9/VD5LQNLnO5i7oUPHIZkCkLla08Ce5/Ee+R/oMG/Ltm3f9x3HkYaf4wnu727qh9tH1AAAAABJRU5ErkJggg==\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="2020 01 10 10 26 48" title="" data-src="/static/2020-01-10-10-26-48-e3545ce32a6b4a015fa7918f38ed5326-27d67.png" data-srcset="/static/2020-01-10-10-26-48-e3545ce32a6b4a015fa7918f38ed5326-3c38b.png 200w,\n/static/2020-01-10-10-26-48-e3545ce32a6b4a015fa7918f38ed5326-27d67.png 281w" data-sizes="(max-width: 281px) 100vw, 281px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>层叠上下文是一个概念，跟“块状格式化上下文”（BFC）类似。我们可以把层叠上下文理解为一种“层叠结界”，自成一个小世界。这个小世界中可能有其他的“层叠结界”，而自身也可能处于其他“层叠结界”中。</p>\n<h2 id="什么是层叠水平"><a href="#%E4%BB%80%E4%B9%88%E6%98%AF%E5%B1%82%E5%8F%A0%E6%B0%B4%E5%B9%B3" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>什么是层叠水平</h2>\n<p>stacking level，决定了同一个层叠上下文中元素在 z 轴上的显示顺序。</p>\n<p>所有的元素都有层叠水平，包括层叠上下文元素，也包括普通元素。然而，对普通元素的层叠水平探讨只局限在当前层叠上下文元素中。为什么呢？因为不如此就没有意义。层叠上下文本身就是一个强力的“层叠结界”，而普通元素的层叠水平是无法突破这个结界和结界外的元素去较量层叠水平的。</p>\n<p>需要注意的是，诸位千万不要把层叠水平和 CSS 的 z-index 属性混为一谈。尽管某些情况下 z-index 确实可以影响层叠水平，但是只限于定位元素以及 flex 盒子的孩子元素；而层叠水平所有的元素都存在。</p>\n<h1 id="理解元素的层叠顺序"><a href="#%E7%90%86%E8%A7%A3%E5%85%83%E7%B4%A0%E7%9A%84%E5%B1%82%E5%8F%A0%E9%A1%BA%E5%BA%8F" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>理解元素的层叠顺序</h1>\n<p>再来说说层叠顺序。层叠顺序，英文称作 stacking order，表示元素发生层叠时有着特定的垂直显示顺序。注意，这里跟上面两个不一样，上面的“层叠上下文”和“层叠水平”是概念，而这里的“层叠顺序”是规则。</p>\n<p>在 CSS 2.1 的年代，在 CSS3 新世界还没有到来的时候（注意这里的前提），层叠顺序规则如图 7-2 所示。</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/2020-01-10-10-34-34-1cdd1d60f812818a8cbd0a86e2bedebf-32723.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 355px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 80.56338028169014%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAIAAACZeshMAAAACXBIWXMAAAsSAAALEgHS3X78AAACoElEQVQoz31Ta0/TYBTuv/EXeIlfMF6IHwgGAYdMxQ8GQRRQlKHDCCrKNjCYmHiPCHI1AxJJiGQToczdNze6tWXQbWxs3UZZcbeyrZ29hMVN8cnb9+3bPOc8J885BZJkKuiMBKCw3xbymXGfFfcag7GtBJPLMTS7FYDZg3AFAivhhX6Dulc337X8tROckywqr6o2rXjuX8FFAPyW0NQ19bQUHJPrJhX6kcfa91JwdghSfVnze6KCWp6dSCSi0ShJkul0mgve9u1ASnRhGJJJlwe6tLK7mp52sKdtSVqvMmt8LIPm9YUUHo/HYrE4HI54PM4FC7VhKNF5Rd0tAW8/1XbIDHee6CW9hnaFueGR8ZsumE9RXLaQkiSSdl1gdm69om2pSgLWdi+Iu7/X3FeXtsyNqBAql4ynUwzDZqALDBMOmr8j3mhFMyiWzTfDH67bPzZBQ6KfLyutL04b+8cDepaQZegC5b0ecE+SSuM4pfV6Sg291SZ5h00hsfXdsw+0WHrGsNEN0rSV5FxgcoXK+TayeyC13QQNP3S+VjpvfoZbJ+Fbn6D6t7ZLfaYyQ3CGLzPLqTFMUTBXf4bOsu/+X8hzq2jQXPdjsUmzdEMPtuq1klVTX8g2GMMtPJsG/vZQqGqHCmsCE+bVN9hUFTYtWleK3DMXXFPnHGOnQiujnH42A+w3PQzvTYpYgyZKnIPlcGMjXN+AiuuQypq1i41YbXPo3fj+wbyJGWonFjISpnn0uBg5UokcPoscPAMfKocOlPgePAP+P718hhzlx1fLLqPHqtGT55ETNWhpLXy0YlP+qthtmkfeeTrLIpPdpSg8kgqGKW5FdvHIbjCcIWPAn01iJ9br9RIEwf4Abrd7gwf7BUZgF4Z5/D7E5YonEnn+bxPqMTLth1doAAAAAElFTkSuQmCC\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="2020 01 10 10 34 34" title="" data-src="/static/2020-01-10-10-34-34-1cdd1d60f812818a8cbd0a86e2bedebf-32723.png" data-srcset="/static/2020-01-10-10-34-34-1cdd1d60f812818a8cbd0a86e2bedebf-d1052.png 200w,\n/static/2020-01-10-10-34-34-1cdd1d60f812818a8cbd0a86e2bedebf-32723.png 355w" data-sizes="(max-width: 355px) 100vw, 355px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>关于图 7-2 这里有一些补充说明。</p>\n<ol>\n<li>位于最下面的 background/border 特指层叠上下文元素的边框和背景色。每一个层叠顺序规则仅适用于当前层叠上下文元素的小世界。</li>\n<li>inline 水平盒子指的是包括 inline/inline-block/inline-table 元素的“层叠顺序”，它们都是同等级别的。</li>\n<li>单纯从层叠水平上看，实际上 z-index: 0 和 z-index: auto 是可以看成是一样的。注意这里的措辞 — “单纯从层叠水平上看”，实际上，两者在层叠上下文领域有着根本性的差异。</li>\n</ol>\n<p>为什么内联元素的层叠顺序要比浮动元素和块状元素都高？</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/2020-01-10-10-37-34-c5bdac16327e2094d52d237c4e39d0b0-8e7aa.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 362px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 77.34806629834253%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAAsSAAALEgHS3X78AAACiElEQVQoz32S3U9SYRzH/VdaW7ddtGpr2VqbF62rvHAtp2wMmrlWuZxcYAxsvsRmsXRGS4YshK0LB2iK2HzjRcwpcIjD4U1EDqB4jrwcDxwO5xw6cAp8W9892/PseX6ffX+/5/drgl2HkGUXNEe8hiAwE3Tp/bu2eIUVzVA4TpMkeYIXkWOGpisX1LQ15Z0Xry9IrQtvrXNi6/fnSzalmw0sE6UCnCAyWQJB8WSSpqhLYOckYOhZ0Q5vqOSbqhHneL9dObD5eXBr2RRmnxnmXyB7qq86nE3kj0Kodsw18Nr6XuoYktqHpXapaE096Qaj6H4qT7MZM5fkXIW5bVYHKiSO3qENvswh6HcKxE6eyNnCX5V/8VfLJ0jiMF3KY0UELaTTDZipiSxRVLnc93H7doelU/lDqDd16eafamZ6zLP6gw37gY/JYXSZKmVzRRQ978zJsBIb1YA9O9qOoEIITbSDH1o98nsO2UjYWK260qi25ngW5iQC9fcdsnFAqvFJNP53X0Gxytc7Db7ZOVqsYGQBTpK5LBaPnyTgMzD3l0Buf+XIqwP7VJ52g/ul0fViZqd7eov/K6wuofFiJkWTZYYk2eZddGa4ATGGhzWeLsj8LDLHC1t40dXuyLIAMrcicVPNhj5fMyeaYSiaIhmySGQCxjbft2ZIzvPLOiBJOyh6vK8YRKYMmMt3Odzwp0oHgAq2jYaevAo8EAabOwM326BbrcCVO6lP6jMw17P6oaraPFMFAnrE815r/n29hV2+Gw+Bq3dTY+r/OJ/KgaJx+3Z+cQ37acOW1rOLa8cmSyEQ+QtzhgiCwDCM4ziGYXt7e8lkMhaLsTfBUAjOoCkciyLpNIETp0b1DwOa/ZGQzfZkAAAAAElFTkSuQmCC\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="2020 01 10 10 37 34" title="" data-src="/static/2020-01-10-10-37-34-c5bdac16327e2094d52d237c4e39d0b0-8e7aa.png" data-srcset="/static/2020-01-10-10-37-34-c5bdac16327e2094d52d237c4e39d0b0-acee0.png 200w,\n/static/2020-01-10-10-37-34-c5bdac16327e2094d52d237c4e39d0b0-8e7aa.png 362w" data-sizes="(max-width: 362px) 100vw, 362px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>background/border 为装饰属性，浮动和块状元素一般用作布局，而内联元素都是内容。网页中最重要的是什么？当然是内容了！尤其是 CSS 世界是为更好的图文展示而设计的，因此，一定要让内容的层叠顺序相当高，这样当发生层叠时，重要的文字、图片内容才可以优先显示在屏幕上。例如，文字和浮动图片重叠的时候，如图 7-4 所示。</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/2020-01-10-10-38-33-fb679695589a8c36e06e1e1976b92620-5ae8a.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 214px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 50.46728971962617%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsSAAALEgHS3X78AAAByklEQVQoz2VRy27TQBTNpyAW/AMVKrtUqEIqRWxggUTVJRIbEEJCsOm2lZoFEh/AJ5QVYkEJjkziV1pn6owTO7ZjR7GjOE5sjxub0zjQShxpZu69c859zFSKotB08uHw1VHt4OTryecvx3Xu1PcDckFIRxVFwfNGqqpSqp+127KiSLLsB4Hv+xBWsJptrvr8Tu319sHbnQd7m/XGz8V80TeMgWlcaCSKZl2qq2pHFASN0g4h2eVyOp2uxb+lH/d2br3b26h93H30YkuUBJ3S87NzlXQ81+W4+q861xJFrsGlKQM/z/NrcaP17f7u7ePDp/z3T2/ev7RsC0GWpnESs4wlMZCwLEuSOM+LEmEYrsV863T74caTx9Xq1t39/Weu66DCfDGHaAGU+9UZz1eIomg8Hq/FjDHHtt2hbZqG49hZhjIZW+FyBbgp8v11S1yJ0QClFFmnYQgGeLZtj0Yj5MZglmWZpum6Lmh4YRi4RWQwGIBQQYjn+clkgv8IgmA2mxFCdF3XNK3f70uSpCgKXLCRqNvtyrLcbDYFQUCWSvEflsul53mO4/R6PRgY0jAMVCvf+SbzWvzvArOBChn24XCI1tAFyt7klMYfakgL3mr8YxQAAAAASUVORK5CYII=\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="2020 01 10 10 38 33" title="" data-src="/static/2020-01-10-10-38-33-fb679695589a8c36e06e1e1976b92620-5ae8a.png" data-srcset="/static/2020-01-10-10-38-33-fb679695589a8c36e06e1e1976b92620-40813.png 200w,\n/static/2020-01-10-10-38-33-fb679695589a8c36e06e1e1976b92620-5ae8a.png 214w" data-sizes="(max-width: 214px) 100vw, 214px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<h1 id="务必牢记的层叠准则"><a href="#%E5%8A%A1%E5%BF%85%E7%89%A2%E8%AE%B0%E7%9A%84%E5%B1%82%E5%8F%A0%E5%87%86%E5%88%99" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>务必牢记的层叠准则</h1>\n<p>下面这两条是层叠领域的黄金准则。当元素发生层叠的时候，其覆盖关系遵循下面两条准则：</p>\n<ol>\n<li>谁大谁上：当具有明显的层叠水平标识的时候，如生效的 z-index 属性值，在同一个层叠上下文领域，层叠水平值大的那一个覆盖小的那一个。</li>\n<li>后来居上：当元素的层叠水平一致、层叠顺序相同的时候，在 DOM 流中处于后面的元素会覆盖前面的元素。</li>\n</ol>\n<p>在 CSS 和 HTML 领域，只要元素发生了重叠，都离不开上面这两条黄金准则。因为后面会有多个实例说明，这里就到此为止。</p>\n<h1 id="深入了解层叠上下文"><a href="#%E6%B7%B1%E5%85%A5%E4%BA%86%E8%A7%A3%E5%B1%82%E5%8F%A0%E4%B8%8A%E4%B8%8B%E6%96%87" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>深入了解层叠上下文</h1>\n<h2 id="层叠上下文的特性"><a href="#%E5%B1%82%E5%8F%A0%E4%B8%8A%E4%B8%8B%E6%96%87%E7%9A%84%E7%89%B9%E6%80%A7" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>层叠上下文的特性</h2>\n<p>层叠上下文元素有如下特性：</p>\n<ul>\n<li>层叠上下文的层叠水平要比普通元素高（原因后面会说明）。</li>\n<li>层叠上下文可以阻断元素的混合模式。（isolation: isolate 创建一个新的层叠上下文(stacking context)。）</li>\n<li>层叠上下文可以嵌套，内部层叠上下文及其所有子元素均受制于外部的“层叠上下文”。</li>\n<li>每个层叠上下文和兄弟元素独立，也就是说，当进行层叠变化或渲染的时候，只需要考虑后代元素。</li>\n<li>每个层叠上下文是自成体系的，当元素发生层叠的时候，整个元素被认为是在父层叠上下文的层叠顺序中。</li>\n</ul>\n<h2 id="层叠上下文的创建"><a href="#%E5%B1%82%E5%8F%A0%E4%B8%8A%E4%B8%8B%E6%96%87%E7%9A%84%E5%88%9B%E5%BB%BA" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>层叠上下文的创建</h2>\n<p>和块状格式化上下文一样，层叠上下文也基本上是由一些特定的 CSS 属性创建的。我将其总结为 3 个流派。</p>\n<ol>\n<li>天生派：页面根元素天生具有层叠上下文，称为根层叠上下文。</li>\n<li>正统派：z-index 值为数值的定位元素的传统“层叠上下文”。</li>\n<li>扩招派：其他 CSS3 属性。</li>\n</ol>\n<h3 id="根层叠上下文"><a href="#%E6%A0%B9%E5%B1%82%E5%8F%A0%E4%B8%8A%E4%B8%8B%E6%96%87" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>根层叠上下文</h3>\n<p>根层叠上下文指的是页面根元素，可以看成是<code class="language-text">&lt;html&gt;</code>元素。因此，页面中所有的元素一定处于至少一个“层叠结界”中。</p>\n<h3 id="定位元素与传统层叠上下文"><a href="#%E5%AE%9A%E4%BD%8D%E5%85%83%E7%B4%A0%E4%B8%8E%E4%BC%A0%E7%BB%9F%E5%B1%82%E5%8F%A0%E4%B8%8A%E4%B8%8B%E6%96%87" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>定位元素与传统层叠上下文</h3>\n<p>对于 position 值为 relative/absolute 以及 Firefox/IE 浏览器（不包括 Chrome 浏览器）下含有 position:fixed 声明的定位元素，当其 z-index 值不是 auto 的时候，会创建层叠上下文。</p>\n<html><head></head><body><div class="gatsby-code-button-container" data-toaster-id="48197700527956260000" data-toaster-class="gatsby-code-button-toaster" data-toaster-text-class="gatsby-code-button-toaster-text" data-toaster-text="复制成功" data-toaster-duration="3500" onclick="copyToClipboard(`<div style=&quot;position:relative; z-index:auto;&quot;>\n  <!-- 美女 -->\n  <img data-src=&quot;1.jpg&quot; style=&quot;position:absolute; z-index:2;&quot; />\n</div>\n<div style=&quot;position:relative; z-index:auto;&quot;>\n  <!-- 美景 -->\n  <img src=&quot;2.jpg&quot; style=&quot;position:relative; z-index:1;&quot; />\n</div>`, `48197700527956260000`)">\n              <div class="gatsby-code-button" title="html">\n                <span class="gatsby-code-button-language">html</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div></body></html>\n<div class="gatsby-highlight" data-language="html"><pre style="counter-reset: linenumber NaN" class="language-html line-numbers"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">position</span><span class="token punctuation">:</span>relative<span class="token punctuation">;</span> <span class="token property">z-index</span><span class="token punctuation">:</span>auto<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token comment">&lt;!-- 美女 --></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1.jpg<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">position</span><span class="token punctuation">:</span>absolute<span class="token punctuation">;</span> <span class="token property">z-index</span><span class="token punctuation">:</span>2<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">position</span><span class="token punctuation">:</span>relative<span class="token punctuation">;</span> <span class="token property">z-index</span><span class="token punctuation">:</span>auto<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token comment">&lt;!-- 美景 --></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2.jpg<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">position</span><span class="token punctuation">:</span>relative<span class="token punctuation">;</span> <span class="token property">z-index</span><span class="token punctuation">:</span>1<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>结果如图 7-5 所示。效果符合预期，毕竟“美女”图片的 z-index 值是 2，而“美景”图片的 z-index 是 1。</p>\n<p>下面我们对父级简单调整一下，把 z-index:auto 改成层叠水平一样高的 z-index:0，代码如下：</p>\n<html><head></head><body><div class="gatsby-code-button-container" data-toaster-id="4752159376587950000" data-toaster-class="gatsby-code-button-toaster" data-toaster-text-class="gatsby-code-button-toaster-text" data-toaster-text="复制成功" data-toaster-duration="3500" onclick="copyToClipboard(`<div style=&quot;position:relative; z-index:0;&quot;>\n  <!-- 美女 -->\n  <img data-src=&quot;1.jpg&quot; style=&quot;position:absolute; z-index:2;&quot; />\n</div>\n<div style=&quot;position:relative; z-index:0;&quot;>\n  <!-- 美景 -->\n  <img src=&quot;2.jpg&quot; style=&quot;position:relative; z-index:1;&quot; />\n</div>`, `4752159376587950000`)">\n              <div class="gatsby-code-button" title="html">\n                <span class="gatsby-code-button-language">html</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div></body></html>\n<div class="gatsby-highlight" data-language="html"><pre style="counter-reset: linenumber NaN" class="language-html line-numbers"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">position</span><span class="token punctuation">:</span>relative<span class="token punctuation">;</span> <span class="token property">z-index</span><span class="token punctuation">:</span>0<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token comment">&lt;!-- 美女 --></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1.jpg<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">position</span><span class="token punctuation">:</span>absolute<span class="token punctuation">;</span> <span class="token property">z-index</span><span class="token punctuation">:</span>2<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">position</span><span class="token punctuation">:</span>relative<span class="token punctuation">;</span> <span class="token property">z-index</span><span class="token punctuation">:</span>0<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token comment">&lt;!-- 美景 --></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2.jpg<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">position</span><span class="token punctuation">:</span>relative<span class="token punctuation">;</span> <span class="token property">z-index</span><span class="token punctuation">:</span>1<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>结果会发现覆盖关系居然反过来了，此时“美景”图片覆盖在了“美女”图片之上，如图 7-6 所示。</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/2020-01-10-10-55-50-d906710da880e7712ac254f486c806c0-81a6c.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 600px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 38.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsSAAALEgHS3X78AAAB4ElEQVQY02PY2uNzfpHf03WBF2b6rWvzbY+137xl9X8g+PsXSPwD4p8f9u5dMe3K/7lXfiy88WvF3T9bn/w7+vbflz//GXbXiR5rFb8zVXJPkXiSoZAIC0N7fy9I758/QL0gzT/e7NveNfX69zk3Pi64+3nt028H3v24/OPn93//GM5PULg4XfH+VOUrNYqHw5ViVHl6+tqAWv78+Qux+P+Pd1f3t5x5fOvys+u3X9988enO558Pfv1++O/fd4YjU+SuJMkv15YtNZGsNpNxUeXu6SgDaf77D6L574+P59cXXzu97cGFTW+vb/l6Z+v3B7u+P97798c7hvNFsqcNFLYVKC0Jk+8KUqj1FOtPd/3x9RPIw/9A3v7/7+ue6eGLKiKXVwdsqXFdW2K3pMhuaoblw+tnGHb15VXZsU2ME2qLFK4PFKr25q2L1Xr/9jVE8z9wsF07sCTTmKPWlTXDiSvGij3WlifSkunS6X0Md09vbUxwboh3yI52So5yLk3ymNGQ/vULxOZ/EMu/PLs6tTS8Kd6+OsUtI8a5Ms2nPdv3wc1LDL9+fP3w4d3LV6+ePXny+cP7Tx/efv388cePH/9h4NOnT58/f/z44e2Tp88eP3z08f27jx/eAXV9//YNADpXTyrfjFNrAAAAAElFTkSuQmCC\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="2020 01 10 10 55 50" title="" data-src="/static/2020-01-10-10-55-50-d906710da880e7712ac254f486c806c0-81a6c.png" data-srcset="/static/2020-01-10-10-55-50-d906710da880e7712ac254f486c806c0-468c3.png 200w,\n/static/2020-01-10-10-55-50-d906710da880e7712ac254f486c806c0-3ff2b.png 400w,\n/static/2020-01-10-10-55-50-d906710da880e7712ac254f486c806c0-81a6c.png 600w" data-sizes="(max-width: 600px) 100vw, 600px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>z-index: auto 所在的<code class="language-text">&lt;div&gt;</code>元素是一个普通定位元素，于是，里面的两个<code class="language-text">&lt;img&gt;</code>元素的层叠比较就不受父级的影响，两者直接套用“层叠黄金准则”。这里，两个<code class="language-text">&lt;img&gt;</code>元素有着明显不一的 z-index 值，因此遵循“谁大谁上”的准则，于是，z-index 为 2 的那个“美女”就显示在 z-index 为 1 的“美景”上面了。</p>\n<p>而 z-index 一旦变成数值，哪怕是 0，就会创建一个层叠上下文。此时，层叠规则就发生了变化。层叠上下文的特性里面最后一条是自成体系。两个<code class="language-text">&lt;img&gt;</code>元素的层叠顺序比较变成了优先比较其父级层叠上下文元素的层叠顺序。这里，由于外面的两个<code class="language-text">&lt;div&gt;</code>元素都是 z-index:0，两者层叠顺序一样大，此时遵循“层叠黄金准则”的另外一个准则“后来居上”，根据在 DOM 文档流中的位置决定谁在上面，于是，位于后面的“美景”就自然而然显示在“美女”上面了。对，没错，<code class="language-text">&lt;img&gt;</code>元素上的 z-index 没起作用！</p>\n<p>有时候，我们在网页重构的时候会发现 z-index 嵌套错乱，这时要看看是不是受父级的层叠上下文元素干扰了，可能就豁然开朗了。但我还是提一下，IE6 和 IE7 浏览器有个 bug，就是 z-index:auto 的定位元素也会创建层叠上下文。这就是过去 IE6 和 IE7 的 z-index 会折腾死人的原因。</p>\n<p>我再提一下 position:fixed。在过去，position:fixed 和 relative/ absolute 在层叠上下文这一块是一样的，都是需要 z-index 为数值才行。但是，不知道什么时候起，Chrome 等 WebKit 内核浏览器下 position:fixed 元素天然层叠上下文元素，无须 z-index 为数值。根据我的测试，目前 IE 和 Firefox 仍是老套路。</p>\n<h3 id="css3-与新时代的层叠上下文"><a href="#css3-%E4%B8%8E%E6%96%B0%E6%97%B6%E4%BB%A3%E7%9A%84%E5%B1%82%E5%8F%A0%E4%B8%8A%E4%B8%8B%E6%96%87" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>CSS3 与新时代的层叠上下文</h3>\n<p>CSS3 新世界的出现除了带来了新属性，还对过去的很多规则发出了挑战，其中对层叠上下文规则的影响显得特别突出。</p>\n<ol>\n<li>元素为 flex 布局元素（父元素 display:flex|inline-flex），同时 z-index 值不是 auto。</li>\n<li>元素的 opacity 值不是 1。</li>\n<li>元素的 transform 值不是 none。</li>\n<li>元素 mix-blend-mode 值不是 normal。</li>\n<li>元素的 filter 值不是 none。</li>\n<li>元素的 isolation 值是 isolate。</li>\n<li>元素的 will-change 属性值为上面 2 ～ 6 的任意一个（如 will-change:opacity、will-chang:transform 等）。</li>\n<li>元素的 -webkit-overflow-scrolling 设为 touch。</li>\n</ol>\n<h2 id="层叠上下文与层叠顺序"><a href="#%E5%B1%82%E5%8F%A0%E4%B8%8A%E4%B8%8B%E6%96%87%E4%B8%8E%E5%B1%82%E5%8F%A0%E9%A1%BA%E5%BA%8F" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>层叠上下文与层叠顺序</h2>\n<p>一旦普通元素具有了层叠上下文，其层叠顺序就会变高。那它的层叠顺序究竟在哪个位置、哪个级别呢？</p>\n<p>这里需要分两种情况讨论：</p>\n<ol>\n<li>如果层叠上下文元素不依赖 z-index 数值，则其层叠顺序是 z-index:auto，可看成 z:index:0 级别；</li>\n<li>如果层叠上下文元素依赖 z-index 数值，则其层叠顺序由 z-index 值决定。</li>\n</ol>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/2020-01-10-11-06-57-22c8ac4ad7bee66e93a312e92a4232b1-1fbcb.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 398px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 78.643216080402%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAIAAACZeshMAAAACXBIWXMAAAsSAAALEgHS3X78AAACkElEQVQoz4VT/U8SYRy/P6lfK+uHXtZay4YvU6tZzkoBdc6yGTZKEYx8mXP9UIvMsjJbkqtMRVMURC4FgvDeODqOk461A1SIY3HHdQfL6TrXd8+ePc+ez8vz/ex5AHr9p8+MfpvAXKPQl+f+1RH/isnLfE8IgpDjc8I/lftb4hpA54hPmqVZvWNKa5u+Y/t4a/Gtco5y0eIZz/E7ONkC/JP4WM3MG619yAiO9ICPO1YeaBxDPa4nvW7YE93xL0jE43EcxzEMYxhGIici27QnujCOdrXYjO3Lhna7XmM3aGza5vnPFjyWYjeTmbwCL6JjsZjIDAQCiYTUF8DnhV2OiE5t7Wi3q7odjV0rjTqwoROsve0sVttevidFACfXPyDdJydsb2Xi0aRlKXyyfqGkzXpxwFI9MFs7OKvo/tA/7UTZMJGM8jmO47N7AitoFPy9WKzqhkP5cL4efqSCTHXQ0zLv4Fl3/1HnPSM+JcH2hgfs3nA8L/DCeoI6BhpKV7t1Pr3OZ7i/3nfX12lCBjy0GY878+FxMmSpAUHYSDMaZNwID7+Dml5DDWNw8wv/NZOvunftzGSwL+/PFfIH5J6BFCzzixz0VAyvVa8tKN1W9dfFRu9yG+LQRpx9DDrKsmmapmXJkn8yEwNpszv4jJxpCluaQlNqauYmaWnFJi5s2FrZdCrHyTnvaIhTZmsDNhdDr06jKhVyqQ45X4Oeq8TKrwTLVeHrXcD+XLEz7ndmO/kD3MSsmOIqcrgMOVKOHFQghxTQgVN4hXJ/513+XCodqFTDRaXI8UppnKiCi0qCl1v+Ry48bi7Lhqg0TrB4iMVJaQSIDBmRIVMUJX6AVCpFEEQoFCr8BCpKB8NklsvuRv4B5bgrkz/SXtQAAAAASUVORK5CYII=\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="2020 01 10 11 06 57" title="" data-src="/static/2020-01-10-11-06-57-22c8ac4ad7bee66e93a312e92a4232b1-1fbcb.png" data-srcset="/static/2020-01-10-11-06-57-22c8ac4ad7bee66e93a312e92a4232b1-4ab03.png 200w,\n/static/2020-01-10-11-06-57-22c8ac4ad7bee66e93a312e92a4232b1-1fbcb.png 398w" data-sizes="(max-width: 398px) 100vw, 398px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>这下大家应该知道为什么定位元素会层叠在普通元素的上面了吧？其根本原因就是：元素一旦成为定位元素，其 z-index 就会自动生效，此时其 z-index 就是默认的 auto，也就是 0 级别，根据上面的层叠顺序表，就会覆盖 inline 或 block 或 float 元素。而不支持 z-index 的层叠上下文元素天然是 z-index:auto 级别，也就意味着，层叠上下文元素和定位元素是一个层叠顺序的，于是当它们发生层叠的时候，遵循的是“后来居上”准则。</p>\n<html><head></head><body><div class="gatsby-code-button-container" data-toaster-id="77244088607937090000" data-toaster-class="gatsby-code-button-toaster" data-toaster-text-class="gatsby-code-button-toaster-text" data-toaster-text="复制成功" data-toaster-duration="3500" onclick="copyToClipboard(`<img data-src=&quot;1.jpg&quot; style=&quot;position:relative&quot; /> <img src=&quot;2.jpg&quot; style=&quot;transform:scale(1);&quot; />`, `77244088607937090000`)">\n              <div class="gatsby-code-button" title="html">\n                <span class="gatsby-code-button-language">html</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div></body></html>\n<div class="gatsby-highlight" data-language="html"><pre style="counter-reset: linenumber NaN" class="language-html line-numbers"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1.jpg<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">position</span><span class="token punctuation">:</span>relative</span><span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2.jpg<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">transform</span><span class="token punctuation">:</span><span class="token function">scale</span><span class="token punctuation">(</span>1<span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>\n<p>这符合“后来居上”准则，“美景”覆盖在“美女”之上，如图 7-8 所示。</p>\n<html><head></head><body><div class="gatsby-code-button-container" data-toaster-id="19760948729948200000" data-toaster-class="gatsby-code-button-toaster" data-toaster-text-class="gatsby-code-button-toaster-text" data-toaster-text="复制成功" data-toaster-duration="3500" onclick="copyToClipboard(`<img data-src=&quot;2.jpg&quot; style=&quot;transform:scale(1);&quot; /> <img src=&quot;1.jpg&quot; style=&quot;position:relative&quot; />`, `19760948729948200000`)">\n              <div class="gatsby-code-button" title="html">\n                <span class="gatsby-code-button-language">html</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div></body></html>\n<div class="gatsby-highlight" data-language="html"><pre style="counter-reset: linenumber NaN" class="language-html line-numbers"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2.jpg<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">transform</span><span class="token punctuation">:</span><span class="token function">scale</span><span class="token punctuation">(</span>1<span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1.jpg<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">position</span><span class="token punctuation">:</span>relative</span><span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>\n<p>这同样符合“后来居上”准则，“美女”覆盖在“美景”之上，如图 7-9 所示。</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/2020-01-10-11-11-53-4eb26f7e9f048aa2e1515f133a747503-68fa4.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 641px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 36.973478939157566%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsSAAALEgHS3X78AAABjElEQVQY02O4d2nnwvMvl93+t+r2r40P/ux5+e/q53///sMAmPn765sDsxOurop5ujH+7Ly4+bVhU+uyXn//xXDnxMwZp2/Muf194d2PG59+OfL+272fv/4jNP8Faf78+ECT1PFW4bvTxNckirhKs2mrKb359o3hydlZF2/svfP69pN31z99u/v378P//58DNSHb/PPjk/PT1S9PVrjeqHwkS2mlm5S7mebnb+8Ybh3oO7yq88KuBff3TXt8YOqD/dMenVr17+8fmF6QzV8/PDrZo3DRVW62kWyuvmSaiZiHqdzLB1cYHp5d3BtjMDlee0qCcleYbJ2/WGea1c+fP8A6/0Fs/vPv7YlK27W2Ytuq5JcmysyIk2vx4j26dTHD3x8f2uNtci3ZklxEA2yFw22EyuPMEZr///8LdsWJTbMzbXjKvcRiXETiXaXi7fj3b1nE8O3Lx8fXT+zbsmYvEG1ff3Lfltvnj/75/fs/UqB9//Hz04t7J/du2rN51e4t6w7t3nLu0I53L54AAL6sK+iccUPyAAAAAElFTkSuQmCC\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="2020 01 10 11 11 53" title="" data-src="/static/2020-01-10-11-11-53-4eb26f7e9f048aa2e1515f133a747503-68fa4.png" data-srcset="/static/2020-01-10-11-11-53-4eb26f7e9f048aa2e1515f133a747503-ea38f.png 200w,\n/static/2020-01-10-11-11-53-4eb26f7e9f048aa2e1515f133a747503-bb505.png 400w,\n/static/2020-01-10-11-11-53-4eb26f7e9f048aa2e1515f133a747503-68fa4.png 641w" data-sizes="(max-width: 641px) 100vw, 641px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>你会发现，两者样式一模一样，只是在 DOM 流中的位置不一样，这导致它们的层叠表现不一样，后面的图片在前面的图片的上面显示。这就说明层叠上下文元素的层叠顺序就是 z-index:auto 级别。</p>\n<p>最后分享一个与层叠上下文相关的有趣现象。</p>\n<p>在实际项目中，我们可能会渐进使用 CSS3 的 fadeIn 淡入 animation 效果增强体验，于是我们可能就会遇到类似下面的现象，有一个绝对定位的黑色半透明层覆盖在图片上，默认显示如图 7-10 所示。但是，一旦图片开始走 fadeIn 淡出的 CSS3 动画，文字就跑到图片后面去了，因为文字一直是 100%透明的纯白色，文字变淡是因为跑到图片后面，而图片半透明，文字穿透显示而已，如图 7-11 所示。</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/2020-01-10-11-13-55-ef1b3d7a7c985f95fd76c1415e9c56f2-50e58.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 593px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 31.1973018549747%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsSAAALEgHS3X78AAABZElEQVQY02N4/+D4li736yv8H64IPDPNf2GVd3uS+7NHd/7////v318gAjLe3Dl0Zl3dqxOdzw+039jWtn1Ow9Z5vT9/fGf4cHvbrir+M52StydLrk4W9VXlE+dlv3ThAlDP379QzW+vbzi3KPTR5uQnmxJ398SVJ4TmZ6V9/fqF4cPdnWcmSF+erfJgkvLZQqVdgQpOiiKnzl2EaP4P1vzh5uY7m+Ke7Mp6tTn9zsz0Iw1JdYU5n758ZXh9c/vpXvEr/vLzDGSKjSXKTCWs1AXPnUex+dWNzXfWxt2py9xSkjqvOHVWcUJted6nT18Ybl7eNj1CbZqNUWuEVq6jZqKHfpid+q2rF5E1P7y64lSB94HCsF1dwcvLgudVBMyvS/wOdPbLF0/v3Lhy6+7V61fO3Lt1/uGtizcunvr6+RM4wP4Bya9fv3149/zFncuP7l589+zG+6fXnt44/fzu5Q/v3wMAGAz6LJyS9aoAAAAASUVORK5CYII=\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="2020 01 10 11 13 55" title="" data-src="/static/2020-01-10-11-13-55-ef1b3d7a7c985f95fd76c1415e9c56f2-50e58.png" data-srcset="/static/2020-01-10-11-13-55-ef1b3d7a7c985f95fd76c1415e9c56f2-d1b16.png 200w,\n/static/2020-01-10-11-13-55-ef1b3d7a7c985f95fd76c1415e9c56f2-aef18.png 400w,\n/static/2020-01-10-11-13-55-ef1b3d7a7c985f95fd76c1415e9c56f2-50e58.png 593w" data-sizes="(max-width: 593px) 100vw, 593px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>为什么会这样？实际上，学了本节的内容后就很容易理解了。fadeIn 动画本质是 opacity 透明度的变化：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="49717236424855970000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`@keyframes fadeIn {\n  0% {\n    opacity: 0;\n  }\n  100% {\n    opacity: 1;\n  }\n}`, `49717236424855970000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="css"\n              >\n                <span class="gatsby-code-button-language">css</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="css"><pre style="counter-reset: linenumber NaN" class="language-css line-numbers"><code class="language-css"><span class="token atrule"><span class="token rule">@keyframes</span> fadeIn</span> <span class="token punctuation">{</span>\n  <span class="token selector">0%</span> <span class="token punctuation">{</span>\n    <span class="token property">opacity</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n  <span class="token selector">100%</span> <span class="token punctuation">{</span>\n    <span class="token property">opacity</span><span class="token punctuation">:</span> 1<span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>要知道，opacity 的值不是 1 的时候，是具有层叠上下文的，层叠顺序是 z-index:auto 级别，跟没有 z-index 值的 absolute 绝对定位元素是平起平坐的。而本实例中的文字元素在图片元素的前面，于是，只要 CSS3 动画不是最终一瞬间的 opacity:1，位于 DOM 流后面的图片就会遵循“后来居上”准则而覆盖文字。</p>\n<p>知道原因，想要解决这个问题就很简单了：</p>\n<ol>\n<li>调整 DOM 流的先后顺序；</li>\n<li>提高文字的层叠顺序，例如，设置 z-index:1。</li>\n</ol>\n<h1 id="z-index-负值深入理解"><a href="#z-index-%E8%B4%9F%E5%80%BC%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>z-index 负值深入理解</h1>\n<p>z-index 是支持负值的，例如 z-index:-1 或者 z-index:-99999 都是可以的。</p>\n<p>那 z-index 具体的表现规则又是怎样的呢？</p>\n<p>很多人（包括我）一开始的时候，以为一个定位元素设置 z-index 负值，就会跑到页面的背后，隐藏掉，看不到了。结果实际上是有时候确实隐藏了，但有时候又隐藏不掉。为什么会这样？</p>\n<p>因为 z-index 负值的最终表现并不是单一的，而是与“层叠上下文”和“层叠顺序”密切相关。前面展示的层叠顺序规则 7 阶图，其中最下面的 2 阶是理解 z-index 负值表现的关键，如图 7-12 所示。</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/2020-01-10-11-22-00-b6b756518b8da62d1149e34df1eccd06-9a824.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 235px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 69.7872340425532%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAAsSAAALEgHS3X78AAACuUlEQVQoz22R2U8aURSH+QubprZ97UtfrC3qsLkWQRg2UUptWqtJlzSNVm0ctY1UhWGYDUStoAgoIFJZZpRloDADgr0jTRpNT76Hk3vz/U7OvZJmo8nlyqVchctWOKZSuoZjb1NiyjWudnWzJIVUyTVG+94FsRd+xyjhtm2tj5JLkHNZiSIKFFGiK33u1QHsa/fm7nwICK1m65+cTxWdRhq373hs/g09vWmkNmDvut7r0FA/dPSamkJknhUlvtjl9M8eAOGy0Ww2W83rCEn+V2lNi2+aaHR8y2XxOmHCZaAwC+0ykS4L6dSTq3L0ez+29HQjsHh4e3IhXULkKAJhiMy90o8uwuS8jpjTer5oiTYLMLVgoEDjeB8I7mT3vOld+iy6z1zLZyVEhi7LMQRyf1MTLzX0zIR/yuqdHvd9erMzCVOwgjCoRGA5PirFdD3Y8050xuIT5WKWW9PgDg3pUBPrZnpyhDSrPNZBfKwftw6AHjfKCRGFiFlFWvpIfS/+0b4tymAHoSYIVb7B1yvF369hH7gzKUUB+BNDhG1YZHyQAP3EkHhiUWGfX/lFub16qyU+g1CrvzVuAQ3E2wbJEQPRpXFLtSIKIw4ZsF49rjITEOxRmMjTTPmGzNfqdjWp7nRrnmEmCJOqicc6qttCd+oplc0PWb1PDF6pie6zbz8aJkKxkqRt/p0sNFZnD2anfs5N7yEfAkNj9J1u90OF577c0wFhHTKRexD2QO6524NFTzjJ1f+q/ZVVvsUUGky+nj3n2WL9vHjJFhq5vABgi416oyVhWTYUChUKhXQ6nc/nBaF+cpKMxxLB4P5+MBCPHzO5bKVSjkbDR9FwKpVkmdzFxXk8diTwvARoiUSiWq1mMhkQBAaCiDiQjo8jkUg8nuC4Ms8LocPwYTgSi8XT6Uw2xySTpzzP/wHkE4tYzIFZUQAAAABJRU5ErkJggg==\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="2020 01 10 11 22 00" title="" data-src="/static/2020-01-10-11-22-00-b6b756518b8da62d1149e34df1eccd06-9a824.png" data-srcset="/static/2020-01-10-11-22-00-b6b756518b8da62d1149e34df1eccd06-012e0.png 200w,\n/static/2020-01-10-11-22-00-b6b756518b8da62d1149e34df1eccd06-9a824.png 235w" data-sizes="(max-width: 235px) 100vw, 235px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>图 7-12 中已经很明显地标明了，z-index 负值元素的层级是在层叠上下文元素上面、block 元素的下面，也就是 z-index 虽然名为负数层级，但依然无法突破当前层叠上下文所包裹的小世界。</p>\n<html><head></head><body><div class="gatsby-code-button-container" data-toaster-id="73390872164823670000" data-toaster-class="gatsby-code-button-toaster" data-toaster-text-class="gatsby-code-button-toaster-text" data-toaster-text="复制成功" data-toaster-duration="3500" onclick="copyToClipboard(`<div class=&quot;box&quot;>\n  <img data-src=&quot;1.jpg&quot; />\n</div>`, `73390872164823670000`)">\n              <div class="gatsby-code-button" title="html">\n                <span class="gatsby-code-button-language">html</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div></body></html>\n<div class="gatsby-highlight" data-language="html"><pre style="counter-reset: linenumber NaN" class="language-html line-numbers"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>box<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1.jpg<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<p>先看下面的 CSS 代码：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="17747486572212724000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`.box {\n  background-color: blue;\n}\n\n.box > img {\n  position: relative;\n  z-index: -1;\n  right: -50px;\n}`, `17747486572212724000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="css"\n              >\n                <span class="gatsby-code-button-language">css</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="css"><pre style="counter-reset: linenumber NaN" class="language-css line-numbers"><code class="language-css"><span class="token selector">.box</span> <span class="token punctuation">{</span>\n  <span class="token property">background-color</span><span class="token punctuation">:</span> blue<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token selector">.box > img</span> <span class="token punctuation">{</span>\n  <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>\n  <span class="token property">z-index</span><span class="token punctuation">:</span> -1<span class="token punctuation">;</span>\n  <span class="token property">right</span><span class="token punctuation">:</span> -50px<span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>此时.box 是一个普普通通的元素，图片元素所在的层叠上下文元素一定是 .box 的某个祖先元素。好了，知道这么多足够了，现在再回顾一下刚刚出现的图 7-13 所示的这张图。</p>\n<p>图 7-13 中非常明显地标明了 z-index 负值在 block 元素的下面。本例中，图片是 z-index 负值元素，.box 是 block 元素，也就是图片应该在 .box 元素的后面显示，因此，图片会被 .box 元素的蓝色背景覆盖。最后的结果确实如此，如图 7-14 所示。</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/2020-01-10-11-26-27-4128c6610b5d8423da5c2d1fa76abc17-5e116.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 591px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 31.810490693739425%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsSAAALEgHS3X78AAABXElEQVQY0y3PsUsCURzA8XenU6Ag4h/QkoWgDUKD20FbS9DSP9BQi9RQg4kWiEM2FI6C0BKEZCo3OEl5F1pw0ZWQFFJcWtKhpud56nuv97TH4zv8eB/eewBjjCAiC042whhCNB4jOqfBzSb2+ZDLhTwe5HajRc/I6cLrXCKxvwr0ti6nq9J55S4plxKPYlxSa62JRBBSrCjYakUAIIaZFAwBwDPmA25pFnQa3cxO4Spwk46IqZBw5i+Imbfaa2s8gtOb63Vss1HGstSbWIq9jugatwC0li5fvKTjD7Fg8fRQPAqI0d3iSfi23zMw/sd2OwQAms3QZCI1CJ5zRFaWnYD8kJwoXyuxPWE7JGwEha2wsBkS683+FJNnWyyYAIahZdkRKTd/nPR7Qa/bGxpGp619vqtSpVGUlPLTd0n++lE7g4FOsGHgfF7jeZ3n+9lsN5f7TV1qz/cfSK3+AbId9t36rQpsAAAAAElFTkSuQmCC\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="2020 01 10 11 26 27" title="" data-src="/static/2020-01-10-11-26-27-4128c6610b5d8423da5c2d1fa76abc17-5e116.png" data-srcset="/static/2020-01-10-11-26-27-4128c6610b5d8423da5c2d1fa76abc17-dd2a5.png 200w,\n/static/2020-01-10-11-26-27-4128c6610b5d8423da5c2d1fa76abc17-20405.png 400w,\n/static/2020-01-10-11-26-27-4128c6610b5d8423da5c2d1fa76abc17-5e116.png 591w" data-sizes="(max-width: 591px) 100vw, 591px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>现在，我们给.box 元素加个样式，使其具有层叠上下文。很多 CSS 属性都可以，我们这里就使用不影响视觉表现的 transform 属性示意如下：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="9223711312692860000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`.box {\n  background-color: blue;\n  transform: scale(1);\n}\n\n.box > img {\n  position: relative;\n  z-index: -1;\n  right: -50px;\n}`, `9223711312692860000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="css"\n              >\n                <span class="gatsby-code-button-language">css</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="css"><pre style="counter-reset: linenumber NaN" class="language-css line-numbers"><code class="language-css"><span class="token selector">.box</span> <span class="token punctuation">{</span>\n  <span class="token property">background-color</span><span class="token punctuation">:</span> blue<span class="token punctuation">;</span>\n  <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">scale</span><span class="token punctuation">(</span>1<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token selector">.box > img</span> <span class="token punctuation">{</span>\n  <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>\n  <span class="token property">z-index</span><span class="token punctuation">:</span> -1<span class="token punctuation">;</span>\n  <span class="token property">right</span><span class="token punctuation">:</span> -50px<span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>CSS3 transform 可以让元素具有新的层叠上下文，于是，对照图 7-15，非常明显地标明了 z-index 负值在层叠上下文元素的背景色之上，也就是说，这里 z-index 是负值的图片元素应该在.box 元素的上面。最后的结果确实如此，如图 7-16 所示。</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/2020-01-10-11-26-47-762d82898305a2462bd9d4faf5b8e39a-ad33d.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 652px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 29.601226993865033%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABVUlEQVQY02P4DwT/kMD/f3///fv7999/MPj7FyR99tx/H4/3OydFXVkR+nhd+KlZ4dOL/WbWpDEAJZ9denl64eUz8y+fnHXxUM+pJ2dfgHSA9f/5A2Lu2vNfkPvFrlrZkx0i96ZJrk8Sc5NiM9ZUB2m+tvXu6uxda9qPrW47Pr/wwOZZly6cfPb75x+45r37/gvzvDg+UfPqVKWrdSqHM5RXuUn5WhmDNL9//On6vgd9tceaKg431x+tLT3UVHnow4fvYM1A+//t3vOfl/P5oRaZS87Cs/SEs7QF47Q4vG00GCB++/Xr77ZlN6fNvFQ15VzdtAsNMy8+efkVrvn48f8mZu/3VSXtiona1R2zuTx2VUXYwal5DO/evfv27dvXr98+ff748tXrN28/Pn3+6s3bD58/f/nx4wcs2P69fv3x1ZvPz968f/rszbNnr9+8evvr53cA/PIN8nnJG/8AAAAASUVORK5CYII=\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="2020 01 10 11 26 47" title="" data-src="/static/2020-01-10-11-26-47-762d82898305a2462bd9d4faf5b8e39a-ad33d.png" data-srcset="/static/2020-01-10-11-26-47-762d82898305a2462bd9d4faf5b8e39a-6a23f.png 200w,\n/static/2020-01-10-11-26-47-762d82898305a2462bd9d4faf5b8e39a-cad54.png 400w,\n/static/2020-01-10-11-26-47-762d82898305a2462bd9d4faf5b8e39a-ad33d.png 652w" data-sizes="(max-width: 652px) 100vw, 652px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>可以这么说，z-index 负值渲染的过程就是一个寻找第一个层叠上下文元素的过程，然后层叠顺序止步于这个层叠上下文元素。</p>\n<p>那 z-index 负值在实际项目中有什么用呢？具体作用如下。</p>\n<ol>\n<li>\n<p><strong>可访问性隐藏。</strong>z-index 负值可以隐藏元素，只需要层叠上下文内的某一个父元素加个背景色就可以。它与 clip 隐藏相比的一个优势是，元素无须绝对定位，设置 position:relative 也可以隐藏，另一个优势是它对原来的布局以及元素的行为没有任何影响，而 clip 隐藏会导致控件 focus 的焦点发生细微的变化，在特定条件下是有体验问题的。它的不足之处就是不具有普遍适用性，需要其他元素配合进行隐藏。</p>\n</li>\n<li>\n<p><strong>IE8 下的多背景模拟。</strong>CSS3 中有一个多背景特性，就是一个 background 可以写多个背景图。虽然 IE8 浏览器不支持多背景特性，但是 IE8 浏览器支持伪元素，于是，IE8 理论上也能实现多背景，这个背景最多 3 个，好在绝大多数场景 3 个背景图足矣。最麻烦的其实是这个伪元素生成的背景一定是使用 absolute 绝对定位，以免影响内容的布局。于是问题来了，绝对定位会覆盖常规的元素，此时则必须借助 z-index 负值，核心 CSS 代码如下：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="99289348291319250000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`.box {\n background-image: (1png);\n position: relative;\n z-index: 0; /* 创建层叠上下文 */\n}\n\n.box:before,\n.box:after {\n content: \'\';\n position: absolute;\n z-index: -1;\n}\n\n.box:before {\n background-image: (2png);\n}\n\n.box:after {\n background-image: (3png);\n}`, `99289348291319250000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="css"\n              >\n                <span class="gatsby-code-button-language">css</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="css"><pre style="counter-reset: linenumber NaN" class="language-css line-numbers"><code class="language-css"><span class="token selector">.box</span> <span class="token punctuation">{</span>\n <span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token punctuation">(</span>1png<span class="token punctuation">)</span><span class="token punctuation">;</span>\n <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>\n <span class="token property">z-index</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span> <span class="token comment">/* 创建层叠上下文 */</span>\n<span class="token punctuation">}</span>\n\n<span class="token selector">.box:before,\n.box:after</span> <span class="token punctuation">{</span>\n <span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">\'\'</span><span class="token punctuation">;</span>\n <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>\n <span class="token property">z-index</span><span class="token punctuation">:</span> -1<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token selector">.box:before</span> <span class="token punctuation">{</span>\n <span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token punctuation">(</span>2png<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token selector">.box:after</span> <span class="token punctuation">{</span>\n <span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token punctuation">(</span>3png<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>此时，就算.box 元素里面是纯文字，伪元素图片照样在文字下面，如此广泛的适用场景使上面的处理几乎可以作为通用的多背景模拟实现准则来实现了：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="46572952500003725000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`<div class=&quot;box&quot;>我是一段纯文字...</div>`, `46572952500003725000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="html"\n              >\n                <span class="gatsby-code-button-language">html</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="html"><pre style="counter-reset: linenumber NaN" class="language-html line-numbers"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>box<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>我是一段纯文字...<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>\n</li>\n<li>\n<p><strong>定位在元素的后面。</strong>我们直接看一个模拟纸张效果的例子，该效果的亮点是纸张的边角有卷起来的效果，因为底边的阴影看起来更有角度，如图 7-17 所示。 <html><head></head><body><a class="gatsby-resp-image-link" href="/static/2020-01-10-11-32-52-bb9310ed4565490aa68c4c0a81ba4c0a-63b89.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 221px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 72.39819004524887%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAAsSAAALEgHS3X78AAAB+klEQVQoz32S247SUBSGeUCjg2YsPe92l7bgJNwgGMM48U7fQfHK4UUIMeFwIQXmAkJItANtOQ+H0l22S9CEscQ/X1b2v9K/a7XZMUr3+11373/f+9ZZwq1FA2tot6xW5+6gTqfT7XYJITG6D4jzOvgZD+xEYDNR/B8MnTC3n9gEq+q6lkwmFUXJZrPr9foQ9t6Q+0syFMiQj7KzeTrjS0WB4zXT1A3DwBjncrm/4fFbMmTISCIjMcruXqRzsVQUz4ZJOCmEIzZ0UOjIUYKhTBfyf8LXocOFrhK6KEowQnSJbovSuTAldHZDPZGONTrGdPIvoYfpCpe+SCyHU9HJZHJDHJG4GnExcfDvesJuhOmD9vXzMWw8ChMSfPyQSxvxzBVzlb58Zb5IG89TRtxMXhjaMx0/1ZQnKf1CwyzGSUN/PDkISKHwnuVkGSUlSRNEFeAFheMRNBOsxDDiS0aQZdU4yDRNTdPy+fwxHLy7LggCh7GiqgirSFFkQFUQoCh/LELyUQghQRAymcxqtYIfRvv9vmVZ7Xa71Wo1m83jBQRBp3OiUwvXMwzD2Gw28zxvu936vr/ZbOBd8/l8sVjAVtB5OAgszIHDcrmE83Q6hQjY2GAwqNfrtm33ej3XdeErGo1GtVqFCuvUajVY59tB8BhYqJVKpVwuQ+QXfmtDYC9kTjwAAAAASUVORK5CYII=\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="2020 01 10 11 32 52" title="" data-src="/static/2020-01-10-11-32-52-bb9310ed4565490aa68c4c0a81ba4c0a-63b89.png" data-srcset="/static/2020-01-10-11-32-52-bb9310ed4565490aa68c4c0a81ba4c0a-89cc8.png 200w,\n/static/2020-01-10-11-32-52-bb9310ed4565490aa68c4c0a81ba4c0a-63b89.png 221w" data-sizes="(max-width: 221px) 100vw, 221px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>HTML 结构大致如下：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="50898695194229410000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`<div class=&quot;container&quot;>\n <div class=&quot;page&quot;>标题和内容</div>\n</div>`, `50898695194229410000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="html"\n              >\n                <span class="gatsby-code-button-language">html</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="html"><pre style="counter-reset: linenumber NaN" class="language-html line-numbers"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>page<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>标题和内容<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<p>其中，.container 是灰色背景元素，.page 是黄色背景的纸张元素，关键 CSS 如下：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="10465394543693085000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`.container {\n background-color: #666;\n /* 创建层叠上下文 */\n position: relative;\n z-index: 0;\n}\n\n.page {\n background-color: #f4f39e;\n position: relative;\n}\n\n/* 边角卷边阴影 */\n.page:before,\n.page:after {\n content: \'\';\n width: 90%;\n height: 20%;\n box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);\n position: absolute;\n /* 层叠上下文（灰色背景）之上，定位元素（黄色纸张）之下 */\n z-index: -1;\n}\n\n/* 边角卷边阴影定位和角度控制 */\n.page:before {\n transform: skew(-15deg) rotate(-5deg);\n transform-origin: left bottom;\n left: 0;\n bottom: 0;\n}\n\n.page:after {\n transform: skew(15deg) rotate(5deg);\n transform-origin: right bottom;\n right: 0;\n bottom: 0;\n}`, `10465394543693085000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="css"\n              >\n                <span class="gatsby-code-button-language">css</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="css"><pre style="counter-reset: linenumber NaN" class="language-css line-numbers"><code class="language-css"><span class="token selector">.container</span> <span class="token punctuation">{</span>\n <span class="token property">background-color</span><span class="token punctuation">:</span> #666<span class="token punctuation">;</span>\n <span class="token comment">/* 创建层叠上下文 */</span>\n <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>\n <span class="token property">z-index</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token selector">.page</span> <span class="token punctuation">{</span>\n <span class="token property">background-color</span><span class="token punctuation">:</span> #f4f39e<span class="token punctuation">;</span>\n <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">/* 边角卷边阴影 */</span>\n<span class="token selector">.page:before,\n.page:after</span> <span class="token punctuation">{</span>\n <span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">\'\'</span><span class="token punctuation">;</span>\n <span class="token property">width</span><span class="token punctuation">:</span> 90%<span class="token punctuation">;</span>\n <span class="token property">height</span><span class="token punctuation">:</span> 20%<span class="token punctuation">;</span>\n <span class="token property">box-shadow</span><span class="token punctuation">:</span> 0 8px 16px <span class="token function">rgba</span><span class="token punctuation">(</span>0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0.3<span class="token punctuation">)</span><span class="token punctuation">;</span>\n <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>\n <span class="token comment">/* 层叠上下文（灰色背景）之上，定位元素（黄色纸张）之下 */</span>\n <span class="token property">z-index</span><span class="token punctuation">:</span> -1<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">/* 边角卷边阴影定位和角度控制 */</span>\n<span class="token selector">.page:before</span> <span class="token punctuation">{</span>\n <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">skew</span><span class="token punctuation">(</span>-15deg<span class="token punctuation">)</span> <span class="token function">rotate</span><span class="token punctuation">(</span>-5deg<span class="token punctuation">)</span><span class="token punctuation">;</span>\n <span class="token property">transform-origin</span><span class="token punctuation">:</span> left bottom<span class="token punctuation">;</span>\n <span class="token property">left</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n <span class="token property">bottom</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token selector">.page:after</span> <span class="token punctuation">{</span>\n <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">skew</span><span class="token punctuation">(</span>15deg<span class="token punctuation">)</span> <span class="token function">rotate</span><span class="token punctuation">(</span>5deg<span class="token punctuation">)</span><span class="token punctuation">;</span>\n <span class="token property">transform-origin</span><span class="token punctuation">:</span> right bottom<span class="token punctuation">;</span>\n <span class="token property">right</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n <span class="token property">bottom</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>.container 灰色背景通过 position:relative;z-index:0 创建了层叠上下文，.page 仅有 position:relative 而没有设置 z-index 值，因此只能算 z-index:auto 程度的定位元素，于是，z-index:-1 两个边角阴影就完美地藏在了层叠上下文（灰色背景）之上、普通定位元素（黄色纸张）之下（如图 7-18 所示标注），隐藏了丑陋的细节，展示了完美的边角阴影，实现了最终细腻的样式效果。</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/2020-01-10-11-38-57-beaec9bfafb9af51a8272926007532fd-24d05.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 436px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 75.45871559633028%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAAsSAAALEgHS3X78AAACW0lEQVQoz32Ty27TQBSG81i8BA/QBWxZsGJFJRABgYQKi8KqFaqQShFUoIJoChWqgIakoUnpJW2Sxonj1Lfx2I7v4/HYsRMml9K0XH6Nztia+c75xz6TgkznaLVRyTQP3tT3Xtd2lqrllUbcjZMkpiKEhGHoui596Pf7vVP1h0oxG+3Mzc3P97c+pnOf0rn3N76s3y1YhmuaNsWgqtq2rWma7/sjuD+hVG2dW7m2sfygsPC4tPDwx+x0bnY6/zS9/Wqu7DpOQLBlWYqiCIIgyzIAoNVq0TiGfTPwgLe+fHzn+ub8zM6L+cPFufLCk/23i1UATccLcIDtoTzPo/4dx0EIjeFeMnBS/MbP3trKfj3hdcyKbkvymqJbaTpM202Sc1bP2R4cP+lFYRyRSATebs2o8UYd6gzs1FWd0TUlsHTiXPhUY3jyxUZEgj5n61UsMb5cR1IVCWWnXffEOIl6SUzrRIHZJW4c+t3QPQeP0sqBseOc8IiHflsJREhkjcgGAU5k0FVscajTQAbradXUnyfB3dCMsI4F4DOgUwRKFsAcUAuq/hObbIj0OEJJF1+0PenAJhDik1bhXvPDVGN1il27wq5dPX53mf9+OyTGaFvqrygdSa9LI91aeXlJ3pzRCksw/1zNPjN3M5FiRB3rX5XP6ncaq3LxEarukSMpOGyTfS7Ya+Ltg6DW6v0XHmUYpAjYtpcv+cX9wSgd+MUy/g1f+HsTpQc9QOfYQ9RnZFin0YxsdwxDSPtfxUPRTqadSO8QvQzcUHSJFwVeEhVVlRTAcpwMoSCJtEl/AbmkNMetDThWAAAAAElFTkSuQmCC\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="2020 01 10 11 38 57" title="" data-src="/static/2020-01-10-11-38-57-beaec9bfafb9af51a8272926007532fd-24d05.png" data-srcset="/static/2020-01-10-11-38-57-beaec9bfafb9af51a8272926007532fd-7ab77.png 200w,\n/static/2020-01-10-11-38-57-beaec9bfafb9af51a8272926007532fd-a60d7.png 400w,\n/static/2020-01-10-11-38-57-beaec9bfafb9af51a8272926007532fd-24d05.png 436w" data-sizes="(max-width: 436px) 100vw, 436px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n</li>\n</ol>\n<h1 id="z-index不犯二准则"><a href="#z-index%E4%B8%8D%E7%8A%AF%E4%BA%8C%E5%87%86%E5%88%99" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>z-index“不犯二”准则</h1>\n<p>此准则内容如下：对于非浮层元素，避免设置 z-index 值，z-index 值没有任何道理需要超过 2。</p>\n<ol>\n<li>定位元素一旦设置了 z-index 值，就从普通定位元素变成了层叠上下文元素，相互间的层叠顺序就发生了根本的变化，很容易出现设置了巨大的 z-index 值也无法覆盖其他元素的问题。</li>\n<li>避免 z-index “一山比一山高”的样式混乱问题。此问题多发生在多人协作以及后期维护的时候。例如，A 小图标定位，习惯性写了个 z-index:9；B 一看，自己原来的实现被覆盖了，立马写了个 z-index:99；结果比弹框组件层级还高，那还得了，立马弹框组件来一个 z-index:999999；谁知后来，弹框中又要有出错提示效果……显然，最后项目的 z-index 层级管理就是一团糟。</li>\n</ol>\n<p>如果真的了解了本章的内容，你就会发现，原来自己的代码中很大一部分 z-index 设置都是多余的，不仅浪费代码，还埋下样式问题风险，尤其那种使用 absolute 绝对定位必使用 z-index 的做法是最愚蠢的。</p>\n<p>如果 DOM 顺序确实无法调整，不得不使用 z-index 值，请记住，z-index 不要超过 2，不是不能，而是没有必要。我从业这么多年，遇到很多很复杂的与定位相关的交互场景，但 z-index 最多止步于 2。如果你的定位发现必须 z-index:3 或者以上才能满足效果，建议你检查自己的代码，试试应用“relative 的最小化原则”来实现，试试利用元素原生的层叠顺序进行层级控制，等等。</p>\n<p>很重要的一点，我这里的“不犯二”准则，并不包括那些在页面上飘来飘去的元素定位，弹框、出错提示、一些下拉效果等都不受这一准则限制。</p>\n<p>对于这类 JavaScript 驱动的浮层组件，我会借助“层级计数器”来管理，原因如下：</p>\n<ol>\n<li>总会遇到意想不到的高层级元素；</li>\n<li>组件的覆盖规则具有动态性。</li>\n</ol>\n<p>所谓“层级计数器”，实际上就是一段 JavaScript 脚本，会遍历所有<code class="language-text">&lt;body&gt;</code>处于显示状态的子元素，并得到最大 z-index 值，和默认的 z-index 做比较。如果超出，则显示的组件的 z-index 自动加 1，这样就不会出现有组件被其他组件覆盖的问题；如果不超出，就使用默认的 z-index 值，我习惯设成 9，因为遵循“不犯二”准则的情况下，9 已经是个足够安全的值了，浮层组件根本无须担心会被页面上某个元素层级覆盖。</p>\n<p>此刻大家不妨想想自己的项目，如果所有的浮层相关的组件容器的 z-index 默认值是 9，会不会出现样式问题。如果觉得层级太低不敢想象，则说明你的项目层级这块还有较大改进的空间。页面上主体元素遵循 z-index“不犯二”准则，浮层元素使用 z-index“层级计数器”，双管齐下，从此和 z-index 问题说拜拜！</p>',
excerpt:"所谓“层叠规则”，指的是当网页中的元素发生层叠时的表现规则。 默认情况下，网页内容是没有偏移角的垂直视觉呈现，当内容发生层叠的时候，一定会有一个前后的层叠顺序产生，有点儿类似于真实世界中“论资排辈”的感觉。 z-index 只是 CSS 层叠规则中的一部分 在 CSS 世界中，z…",frontmatter:{date:"2020-01-10 10:19:55",path:"/css-world-stacking-rule/",tags:"前端, CSS, CSS世界, 读书笔记",title:"CSS世界的层叠规则",draft:null}},prePost:{html:'<h1 id="填充的两种规则"><a href="#%E5%A1%AB%E5%85%85%E7%9A%84%E4%B8%A4%E7%A7%8D%E8%A7%84%E5%88%99" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>填充的两种规则</h1>\n<p>只要是路径填充，都有两种规则 nonzero 和 evenodd，无论是 SVG 中的路径填充，还是 Canvas 中的路径填充，如果还有其他和路径相关的技术（甚至设计软件），也离不开这两种填充规则。</p>\n<p>如果我们用 3 个点，连成一个三角形，则这两种填充规则没什么区别，如下对比</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/2020-01-14-16-50-54-634b2c9af2b7fb631c9f18ee72a24ce9-83562.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 315px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 60%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAB50lEQVQoz11Sz2vUQBQe0PaiiIhgxZt3T/4hoie9dItaLW29SC9Cz15FBBFEvYgK4sWLVLRdTHezrWXrstVtzVYX3aINaxqTJpmfid/MlLVteDzee9/7Zt77MoRylTGVZHw75fBxQoMwRoxiaixjtkEkqUbRoyGqmFDkT8SCv7TZ+u4u1OuN1caK9+btXONzuxcyP8g2g6wXUljzS3thqVmtffI6v7digfpWzElCpRAKRrnA8RiEi5xpjwtlClQqGIKECsok6jA0pEwSdBdFwWVe7PpsIlUuVI4Yvtj7IccdBFshee765+6s3J3pzrVCP+K5aRYyB1+pfPTR1/En3tPKZvPndsIkUBgDOTPkjYAdH6uSi+XDVysnJ2vDD1YtzaL3Zrrk/PvBEefY9erpm4svXB9FQHpsM1ox/bJzsOQMTbrkUnnq2ToqTK+noSiTZ24tHRmtHL1WOXRlfrkTazI3ZLvQ2q/0xIQLbGjC/eZnVgg7OeLbr38cGP4wUHIwlJVDj20Fsx1jjz1yYRYeMcbRgkm7ftEN6KkbtYERp9wK95OVIbvtaLDkuF60m9w/+vLDtbPTdSv1jmCWbM/HGvffbdjKzq8yZCvK4nr06mPPpv/Vhip9A9CP7cvtp9Lsz3huXpFG/wEkpn+iJdYH0QAAAABJRU5ErkJggg==\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="2020 01 14 16 50 54" title="" data-src="/static/2020-01-14-16-50-54-634b2c9af2b7fb631c9f18ee72a24ce9-83562.png" data-srcset="/static/2020-01-14-16-50-54-634b2c9af2b7fb631c9f18ee72a24ce9-738c0.png 200w,\n/static/2020-01-14-16-50-54-634b2c9af2b7fb631c9f18ee72a24ce9-83562.png 315w" data-sizes="(max-width: 315px) 100vw, 315px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>如果是两个三角形，并且发生重叠，差异就出现了，如下：</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/2020-01-14-16-51-17-e24da6c822da9f9d233816fd49a58eed-83562.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 315px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 57.77777777777777%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsSAAALEgHS3X78AAACNElEQVQozz1RS2sTURQeVyqiVRQX3bpQ8B+4cSt0J1JEEXzVF7oRqW5duFEXUh8bQVsQSnFTdCMGNebdtBHTPE0zmSQ1NJlJJslkMs977/jdmVoYmDPf45zvnBEGI6fZUirVzbL4t74ppzO5YqUh98bAuwOrr9koFFUvbTQrtRYoRTWAqENbN4kw1N1qfStbqDbqzU5bzmRL+XKt09WhkFVu7muO3BvVREmSGuslSelzM286dgWHMMqY53krNSNUGKJwmedSZrtsbFHOgmZeUhz/KGlgLYc6LoMArIDvbGM0PVeYmImffLimGS73EwYFgqGuK+bsYm335ejxB2nN4AghDIJtc/TPYM+V6NE7yYmZxKMlKdvUVd0llI18aXJDexduix3z7fet5bXuqqihBaUeN2MCFBfflPdejU3eS+27Fjt8K5EWeUKY0QJDLrwuh3J9IN8K/SO3E7mmzlkczPbNoZx6YCY+eTd18EZ8+mURkOPvjA3BLqWU/dfj4eIA9YdYx7ApDXZ2/QVwkjNPc3Bi/tTzPETBwQIWz6nHvw/dTHz+1VuIcjMJzHgF7ReT8q5LkdNPsmdfFD9lekFs2AJ2PtIRzoennuXPzRW/rKsBKxD/sIhhOvTE7Oqrry3MfP+zDdDwJ6NArqFBjt1Pz0faukUWIm0gfDL+IoY7hLdfznQl2UShWxS9TD9ecDOAH1eURtdCoZnEdinCC1DsPIR4trN9J8umCLZDIQUy/mf5LkD+AV8vcwadBTcDAAAAAElFTkSuQmCC\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="2020 01 14 16 51 17" title="" data-src="/static/2020-01-14-16-51-17-e24da6c822da9f9d233816fd49a58eed-83562.png" data-srcset="/static/2020-01-14-16-51-17-e24da6c822da9f9d233816fd49a58eed-738c0.png 200w,\n/static/2020-01-14-16-51-17-e24da6c822da9f9d233816fd49a58eed-83562.png 315w" data-sizes="(max-width: 315px) 100vw, 315px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<h1 id="交叉点"><a href="#%E4%BA%A4%E5%8F%89%E7%82%B9" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>交叉点</h1>\n<p>填充规则的关键，就是确定复杂路径构成的图形，哪些是内部，哪些是外部。内部则填充，外部则透明。</p>\n<p>“nonzero 规则”顾名思意就是“非零规则”，用通俗的话讲，就算计算某些东西是不是 0，如果不是 0 则内部，填充；如果是 0 则外部，不填充。</p>\n<p>“evenodd 规则”顾名思意就是“奇偶规则”，用通俗的话讲，就算计算某些东西是不是奇数，如果是是奇数则内部，填充；如果是偶数则外部，不填充。</p>\n<p>nonzero 规则和 evenodd 规则计算的东西还不一样，nonzero 是计算顺时针逆时针数量，evenodd 是交叉路径数量。</p>\n<h2 id="nonzero-规则"><a href="#nonzero-%E8%A7%84%E5%88%99" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>nonzero 规则</h2>\n<p>起始值为 0，射线会和路径相交，如果路径方向和射线方向形成的是顺时针方向则+1，如果是逆时针方向则-1，最后如果数值为 0，则是路径的外部；如果不是 0，则是路径的内部，因此被称为“非 0 规则”。</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/2020-01-14-16-52-41-00eba3716cad33a43dfc044d84c647d5-ba5d6.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 254px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 107.08661417322833%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAIAAADJt1n/AAAACXBIWXMAAA7DAAAOwwHHb6hkAAADrUlEQVQ4y2P4////3z9/f/768xvIOnfh76ePb6p7LhZ1//jz5z8M/Pv37z82wPD/79//f0Fy/x4/ueOWVJS51CB8jYHfoks7DgMFHz96/OHDh69fv/748QOb5v//v756t3Xx4cDsTVKxO3iSDolmHWNLOd5Qs/br66ez5szbtm3b1atXHz16hOkEhv9T53ZbFSiEb1CM2SqZflAy7aBw5jGZ5L1+QXMu7z12/dbNt6/fAMGnT58gmiEAwmb43zW5UTNFL3GLUfR6m9CltqFLtGM3+fvPSLBs7Gzf/P/np38wG9E8Dtb8//+E9m0GPgtk0w4IZxyVTD2gEbvFIGqdZfDSGJ+J+2atfXHj8f8P7/9//vjv+/ePnz9fv3bt0KFDr1+/fvLkCUjz45PXdCLWOIYsVEjaLZx6RKjsFG/XZcHcE5LZR2ys27RDl/sW71vlXf2wfuKnP78OHzq8cePG+/fvX7lyhQEUIb++lVRt5Y/d4x4yXz5+l2DtWZHeC8L9F/k6LhsXbhbP38SYe5jNc87c1tk/P7779Or1l69f//79++XLFwYgBdR+dcdpsajtQJe7BM2TS9ojknpELOWQSPoR6dxD/hGzYsN6XMpWTrh+tejv373PnwPD/+fPn+DQ/vcPpPvrp6yiDSxpJ2VT9wP1yybvlUo7APQFT+apEO+pXXKRu2fvBap68Ofvh///QTaDkxADJIUByUNrT2r7L1VP2gGMJ8vw5f0GaSnO7Zx55+Tid2SHTP7y9BUohIHJCSnQGeBR/+PDl/muxfH2rTy5Z6RT9hfY1jgGLxLMPsWVeLgtbdb/n1/+/EePLgYIBfH5qSnrlANXiWcdE00/IpF20CFkoVj64UD/GRUmRddO3gIrw6YZavmTF3Ypm/jSjkqlHQTqV0jaZR6+vNisNNCus7p51///P/9gpm0I+AM2dcGkXdwxe6UyDkumHhRIP2aUuGVW2hTBpAM6cZvfXbgJ9TamZojo+2v3DGM3CGYck0k/yJl4KL148//vnxZO3s3ot3nahD1AVX/+YbMZZDlI4m9nyzbOuP3S2UdFIrafWH8cJPHr+8wJe0yCln158BTZchTN/8DB9vDkNa2YTdypR8My1/9/++YvyK/AGPo9vX3Lqo71IOP/YbMZZDmI+FlVt5Uh+tCOxQehYfEPhIBSDzPr/y9bC1b3B4tmSJyd33sx07Dk96XrcOdA4+Pjp//PXv6HRTi6Zojon0+fv+RV/3/+4j9ywviHnqUB8DrHdiRXNVsAAAAASUVORK5CYII=\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="2020 01 14 16 52 41" title="" data-src="/static/2020-01-14-16-52-41-00eba3716cad33a43dfc044d84c647d5-ba5d6.png" data-srcset="/static/2020-01-14-16-52-41-00eba3716cad33a43dfc044d84c647d5-e9711.png 200w,\n/static/2020-01-14-16-52-41-00eba3716cad33a43dfc044d84c647d5-ba5d6.png 254w" data-sizes="(max-width: 254px) 100vw, 254px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>例如上图点 A，我们随便发出一条射线，结果经过了路径 5 和路径 2，我们顺着路径前进方向和射线前进方向，可以看到，合并后的运动方向都是逆时针，逆时针方向-1，因此，最后计算值是-2，不是 0，因此，是内部，fill 时候可以被填充。</p>\n<p>再看外部的例子：</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/2020-01-14-16-53-41-ac5cfceb8f2cae07afde42aaa5a65661-092d7.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 211px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 129.38388625592415%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAaCAIAAAA44esqAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAEsklEQVQ4y3VUa0xTZxg+y8wSROWOQIzIFjUDEbM5HLgxFASGTG4FyymliKUXCrsmm+JlW5aFiYwMfwByvxNAyv1SoFBaStshMQ4QCJqBCht3LNjWnsu3r6eCJRlfzjk53znneZ/3fd7nvAjYXCQAhO4VKVUScPN79uTJiNWRx4bnBAF2WAjACUyP63Hqi45u9XH/zFuiiLC7RwOK835rBQDHSbAz2PhudXm8SX6VX+4TUrA7rm9fksosefgsWoONT1Hk/x8AIebmxUU9sYk1tvT2tzgq85RhR67UMVFygCfdxZQIs9rgR/hOYDKEnmPh5x5d602v+Qi9dzSuzZ4jtefKrJKU0ecyY2MK8WezsCQSxze1IU3SzsxJ/5B/OLbFJb7T82LN6ajKgLCCM5Gl7ozGjJMCt+BSUbHYSA5BuAFLgk0JEXjeTW/3Dsj2YDXDOu05Mni4JHR5MBp8aeWfhhbdpGUs9ih1088ApjUQY5gJMwAvhsfc0Qa/8KIP0HtWfIVDYr8ddwDeWPEU1kmK95htoWdueyW2Cb6uL89sfxmEEt1SA5QgEEMcUpdxXbgrXnY+PP8EKrTkKxw5EhjCMbEfXq35Cn9a2QFW19tshTmrz9czbbKg0YDFCcTYhtne+0fojZYCVWBYngdDaODn9O/nSOHVhic/FtvkH1lyiCeBWoYnNYOlJZIqHvaZNOio3Uj9pvadhAEH3kBgWD7EW1L5QyQMYceR+dDKy9xQmtcvdQUSsGkdhEreoN54s/xgTIuVQGnLHQgMzTvOaLDkK2HnnNh91rxBN2bLH26sK/4/rU/PbdkGMbaOoEyWwK9zQZsPscU2XLlfRNG58MJW58896bVW/EEnnszfL6syTUi1zUTtLXJx9UDaYealoAxzwRDE04KzCt9HITnMfF/K0KmQoo3OXgMXTmwDG31DzC+W+aZ8Elpsw5dDqSDh2YhCmL8FX+nCFsd4/dyUXk8xkdvBmwZuye7czex3Slbt58jsOFJrwZ/BF3KPxHf4RlfWHwwORKuwv59ur9nITe31U9OfRebuYQgdEnsdeHJbZrM9d8A7LJ/58bXU01dt6R2ivK4tJsTU6xhVuYD1HeJ6yfbCHZuLVdZf3LG53ONEqxByM46xRQhbxUioBgsLJIVCYJP1ALwyykb9Ol1lVe/6XLNi1NuzWu2iS8xihFFoHuzFaKPMld5gHtN1v0L82mH/6HRpQ0P8tbXzen07ADMEUVpVzmTd3oO2OMaJHC5L9oaUdWe3G1ObEPY7RzUkpNSDFyuQB9FqNN2treMzM+0ryw+WluTPZztWl4WyIecfui1u9pt9LzrFrl6cml4DYB0zFDXSNHgiqPBBi+qNYHq9fvbJk0cPH2o3NibGxtanxlOvNOz9UmWTLLtVIpkGoIIEcKCVECT8kRR18pyoX8HYI4Sk1FKr1UXFxRUVFbNzc93iXrVuY7Cw0ZbZ4xrfoVb+ZbTRAgAiyE/psnEjHf/qxmuwRqORSqWjI6NarXZyYlKjx1YeT3yL5haE/QhnALblos0hTeox8O+CSZ+hw6F3qAW387qXM9fTMQb/zVg3XeR2k5hGMaiA44vPnwJMv/PYBv8B6N5rupMYvfgAAAAASUVORK5CYII=\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="2020 01 14 16 53 41" title="" data-src="/static/2020-01-14-16-53-41-ac5cfceb8f2cae07afde42aaa5a65661-092d7.png" data-srcset="/static/2020-01-14-16-53-41-ac5cfceb8f2cae07afde42aaa5a65661-6cb69.png 200w,\n/static/2020-01-14-16-53-41-ac5cfceb8f2cae07afde42aaa5a65661-092d7.png 211w" data-sizes="(max-width: 211px) 100vw, 211px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>点 B 再发出一条射线，经过两条路径片段，为路径 2 和路径 3，我们顺着路径前进方向和射线前进方向，可以看到，合并后的运动方向一个是逆时针，-1，一个是顺时针，+1，因此，最后的计算值是 0，是外部，因此，不被填充。</p>\n<h2 id="evenodd-规则"><a href="#evenodd-%E8%A7%84%E5%88%99" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>evenodd 规则</h2>\n<p>起始值为 0，射线会和路径相交，每交叉一条路径，我们计数就+1，最后看我们的总计算数值，如果是奇数，则认为是路径内部，如果是偶数，则认为是路径外部。</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/2020-01-14-16-55-04-64e9f45a8247ace473419aec9f21d09c-4fbd0.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 255px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 106.27450980392157%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAIAAADJt1n/AAAACXBIWXMAAA7DAAAOwwHHb6hkAAADVElEQVQ4y31Ta0hTYRiedPmjZheIBO2H4q9+RH9KCEOzKCJQycx5ZxenzMhLISFYWd4yyxCRhkIkWpn3yeZMq+1sLnGb0jQv003dai5v0+HO3M53vs5l3q2Pw+Gc9/ue73nf93leBty2cAw4MdyFOvBZE1y1rmQ9+aMYIuMAh/stxgYOhxggH+JTKBmOyMh6JAm+UPYwpwmCdQDh/8A4dbV11tL+TsHkNQXeafXiyL0zB/0TxHrlyL/IGQSODLtcc3nl95jVvpHNBxO/ebKQoxzkJF95mimsKGiHEGAY7mbA94JR+6/gqImqRsvMvKReXlzUFZslOsMSx118evVK5cwPA3EEAIDROeL4Vto0fEE/x+PUmYZn3BHr8pLOpBcp35aJ5K+bV0enoM1G8mLY7pqpTsHi0u5z0R/mB8foIuchnAbkhk3zMyq24eZd8Yv8NkN05vqYHlAHNhpGHVoc1gXEd4awO8zqUeJX7cR6XZgQwAnMyi+875Gj9MhQ3Yp57hzXwe1gkpzqW2mhyCNFfp3dPKci+Z1OlxNAG7T3IvW3ubXh/IYHgux213I1hEtwGxhQYkwptEEJwkPpA2EpLRYVyY/Z1ugOIbF5j4NY07pJI4QKgJu2TELjSW40M7cjkNnhw5Zd4nRYJAqYX+L8bSF2hiTqqtx6kmXDGDvBVN8GJJrKgJjzCS2H+arQ6Lq5/ArosBMb6waj+WMX3SCc0nsHmLiPRK9ai+JenUju9UuTeab2XU7tNKvJ+icLqgs5Aghc+L7MlGZktKux3yeu+1S63I8n9WIjYazWxf5haWTO2Wu1E/KRzRx3g93uMZtvcFu9uArfVKk/T3qA+z0jsSY7ScCIR57lCwkRsB1TtYe8SfDFM/6zbxrimy4/wuwW1vc59bPhnDbC7Qvqsd06b3FTYLtuOoTVfpynOMZThLLb7AZCILis1YUmfSop6aZ9wcB3LhpP9+RNeZd38lefxF7BSwlpGBdZp3nEwE+osQzp9k97k3xlcCwoRRzE7VnSuv2IU30yD4yYI1IhijJMJpNSqZTJZAiCaDQaFEXpqaLcCopz3pczy92DQ+XlFnl8Eq6hDKPRSGBUKhXx1mq1DofDPZKUkdaEPet5xZSB8G2CuMv7CzhzF1NVYiZmAAAAAElFTkSuQmCC\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="2020 01 14 16 55 04" title="" data-src="/static/2020-01-14-16-55-04-64e9f45a8247ace473419aec9f21d09c-4fbd0.png" data-srcset="/static/2020-01-14-16-55-04-64e9f45a8247ace473419aec9f21d09c-9c75c.png 200w,\n/static/2020-01-14-16-55-04-64e9f45a8247ace473419aec9f21d09c-4fbd0.png 255w" data-sizes="(max-width: 255px) 100vw, 255px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>例如上图点 A，我们随便发出一条射线，结果经过了路径 5 和路径 2，交叉的路径个数为 2，是偶数，因此，属于路径外，不填充。</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/2020-01-14-16-55-22-f28effae307a0172bb31d7aa650f8fdb-f4849.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 249px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 106.82730923694778%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAIAAADJt1n/AAAACXBIWXMAAA7DAAAOwwHHb6hkAAADf0lEQVQ4y21TW0xTWRS9HxNjjC8wIqCOJibqZCbBmJj4Y5wffMSYjA/QCEh1sFJ8UBXFyENhDGo0YgiaSpyBUWeGh4Va+xKRciktgjAKpmpBkCAR5NFYLKXtvedszzm3Qaicj9vm7Lv2XmvtdTmYerCIEPl52Q5u1/hVlV2W4fWJrIDhu8N9+yuImAHR4GD31t8z5MXr9qlXbrvXbmqll6w0PRizxqP9I6Z/rAlK7YpEY2hSfdiRxhlJNmW6FrxjdDqeDoxFWhJvFt/ZcvaneO2cHY9+2M/PkvGzkxoi5PzG30o+2Oz0Bb8QII8nTxYE8nCfzGmNTUPDw/Z6+4O/6jOz9dHHqzfvKtnz8+nU7MeAvGSCiLGAiDgsdQnQZoJQVnrlvaI60hlh1n946NOLzma19d/c8g9V5i99gzA2StSD3z9Fs+SHg3+1dNt/6ttPAQs+HKAnsmfp5aqomHJZdm2ZomDoeA6e4jbGVLdnVHFGNyvWZLhTQ1ACIk1EwU/h7jfda2Q6LuX/eTu1t06UkCqavCrEuLZU2kITqsPjHxuKnpA7AdMCGy4W/qGN3nxz7Z4Kx7O3EtlJe8aYUneOxKWoZyiaF8YZH6oInm4C0zHwpaktf1nsdbkKkB8Hh4RSoZfGu/URux/+mGIJidHrSp9BWbmgukvRwnhhSpGlspGOZe2mgKWouAeceZuyFBvOzz3WEnbQrNmdCTqDwF4YUD/xvX03kVYuKDSS7U15f6/fdJskLELRsOhAraaYp9t0fb4fm2tR2yYMCgZLK/78ri9Kpp9/2Bop5xckW0N2aTX3bWA2Zy1PPHRaBz43+l5zQDlzo+CKYWZCbWSyJVzOhxy2LjtQ/efeS6vitIvjDF11L4LddgN0A7wGGGHDh1461u43hh6yRSbVhSY3RiXqh57bCwtquZjqnAt6Ka3cRM5HAUgyj5KZAOQ76AR8Kj89TKkNV7bMkRkvX6ygssfH8vMMS7aXfWzrDNBG7FCrmYfEWB9CHoBGXrU67cHs3Pe/ZF6tst5oAOAR+iR4rmRU5Z6rnF6z9NFRS7zjqUoNF29Ly6gAz0AfgAHhJuqKaEot8F5TcV6v1+Fw9PT0dHR0dHV1uVyuQNSZ8ufG1hXRxe36ZikYmGWB9MX9/ahUwzmdTp1Ox/N8TU2NyWTq7e0NpIVJ8Ls9bb8mgNkiZSCI31e5VQ0QXHVGBgAAAABJRU5ErkJggg==\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="2020 01 14 16 55 22" title="" data-src="/static/2020-01-14-16-55-22-f28effae307a0172bb31d7aa650f8fdb-f4849.png" data-srcset="/static/2020-01-14-16-55-22-f28effae307a0172bb31d7aa650f8fdb-4cd05.png 200w,\n/static/2020-01-14-16-55-22-f28effae307a0172bb31d7aa650f8fdb-f4849.png 249w" data-sizes="(max-width: 249px) 100vw, 249px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>点 B 再发出一条射线，经过路径片段路径 2 和路径 3，交叉的路径个数为 2，是偶数，因此，也属于路径外，不填充。</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/2020-01-14-16-56-50-a5f0f6b0f9471fd45397e4263f76f16f-21b91.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 252px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 107.53968253968253%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAWCAIAAABPIytRAAAACXBIWXMAAA7DAAAOwwHHb6hkAAADgklEQVQ4y3VTe0hTURy+RBZpFFTYkvqjfyoIghDpj8qgsuyBYRSmQnOmrOm0Igp8hIqhVPayh6vWw1JhujbXtLWl1uamW74ftTSd7qFp+cjWpm3nntO5965pphfuj3PvOd/v+853zkegWQ8JSVy/DlNjkfhHwQs0/0N4RxBCkoTUaHwUHo8V31bE7b8WtvPqV2M/NctMzQvGL3ANtXTlZ8v2HxEuj1L6JTctjNUV5L2hZsh5mDEnrk6V5gZPuP5QMRH5zofXsCqhfl2ilpVQt+9kmdNkoclJD8c0GEIG/HPHkU52qqFlQHhTlXiufHt8BStasTms6NCWdMF9NV7wG0CAxeMWAMxmnuzqy0goHGB26J4CZotRZ1Q9eyc4+yTl9HPQYcTa8TrspNvLjL9xnynajwd3a4LCi0dbur0dsUpK69h3UfrzMxdfXS9rNEgU6FkxOdMwxsypPvNWjjQ4Rmo11E+iCZuL7CFhLyDNCAmr767MvEPcMa+LevnwaBaacmI8MY5QM0K3EBQhZAETqY95i640B6alSQ1PvyD0EbiNJOiFyOnoPp9euCm6knXitaqinfIfkEQFhUQXEHoEkQ2hnuaaoFjpCr768Omy0aYuRhRJ+9z66oMgICw5WuAaGWP2Rcw8N9pEd25mpS+n1pdr2M0WD3WaUFuHS9dAoSfGsg5mi/MrGdppw9x0BTTDJ60xZntGePjDBdwPBxIqR5IuoeJS5nA+l6hGOr54PfqH2WOx21VxLCV0721/vt6PWxcSUTSibWZc1V8psdS2eS8MMTsXdMs2Wb1/lMKfp1vLVS/h6vdg/V0W1NqYtYGTm6PE7QFEc4AxOdVzfIzNl/rGaQO4GoxfzNGE8l/Xnr0ZGpIfGCN3dHqUE/9fd0CTV79QL4tUsnja1fFqFk+3hq2qulq6L1lJRNSI7imZqMwBZu46HBw+cEqyNJ5WHlvLTZIgl3O0rXtXjHQbR4as1rlkzyAvLajyi3obwK9bGanQirTM1I/OnuDjRSVCzbxg5iRwEoPZEp94/dE4Mfr2Hf8i6TxZ2k05kbfcTR0E7TBJ5xICADx5+Jt+QZ6CiHhfXqjxyoE03i6v+s1PI2w2m0QikclkcrlcqVQODg56tk0vtX40X97Isb/X0zBy2hTMYf9F2O12k8nU399vNptxdTgc03mkLwPIzkPWAQY001Wc1j8E/EIlP58P6wAAAABJRU5ErkJggg==\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="2020 01 14 16 56 50" title="" data-src="/static/2020-01-14-16-56-50-a5f0f6b0f9471fd45397e4263f76f16f-21b91.png" data-srcset="/static/2020-01-14-16-56-50-a5f0f6b0f9471fd45397e4263f76f16f-0777d.png 200w,\n/static/2020-01-14-16-56-50-a5f0f6b0f9471fd45397e4263f76f16f-21b91.png 252w" data-sizes="(max-width: 252px) 100vw, 252px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>最后这个点 C，发出的射线总共和 3 个路径交叉，是奇数。因此，属于路径内，填充。</p>',excerpt:"填充的两种规则 只要是路径填充，都有两种规则 nonzero 和 evenodd，无论是 SVG 中的路径填充，还是 Canvas 中的路径填充，如果还有其他和路径相关的技术（甚至设计软件），也离不开这两种填充规则。 如果我们用…",frontmatter:{date:"2020-01-14 16:48:52",path:"/svg-canvas-nonzero-evenodd/",tags:"前端, CSS, CSS知识点",title:"SVG/Canvas中nonzero和evenodd填充规则",draft:null}}},pathContext:{mainPostPath:"/css-js-scroll-smooth/",nextPostPath:"/css-world-stacking-rule/",prePostPath:"/svg-canvas-nonzero-evenodd/"}}}});