webpackJsonp([0xa69c64884b40],{1622:function(n,a){n.exports={data:{site:{siteMetadata:{title:"女王控的博客",description:'前端工程师，黑猫女王控，欢迎勾搭，技术相关<a href="https://github.com/towavephone" target="_blank">@towavephone</a>，QQ闲聊<a href="tencent://AddContact/?fromId=45&fromSubId=1&subcmd=all&uin=634407147&website=www.oicqzone.com">@towave</a>，bili关注<a href="https://space.bilibili.com/11507708#/" target="_blank">@towave</a>',siteUrl:"https://blog.towavephone.com"}}},pathContext:{posts:[{excerpt:"背景 目前老项目使用的 redux 性能较差且难上手/代码复杂，useContext 虽然使用上简单但性能较差，需要选型一个易上手/性能好/组件化的三方库，以下是 redux/useContext 在处理复杂业务时的缺点 组件间的状态共享只能通过将 state 提升至它们的公共祖先来实现，但这样做可能导致重新渲染一颗巨大的组件树（管理成本和子组件意外渲染问题） Context…",html:'<h1 id="背景"><a href="#%E8%83%8C%E6%99%AF" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>背景</h1>\n<p>目前老项目使用的 redux 性能较差且难上手/代码复杂，useContext 虽然使用上简单但性能较差，需要选型一个易上手/性能好/组件化的三方库，以下是 redux/useContext 在处理复杂业务时的缺点</p>\n<ol>\n<li>组件间的状态共享只能通过将 state 提升至它们的公共祖先来实现，但这样做可能导致重新渲染一颗巨大的组件树（管理成本和子组件意外渲染问题）</li>\n<li>Context 只能存储单一值，无法存储多个各自拥有消费者的值的集合</li>\n<li>以上两种方式都很难将组件树的顶层与子组件进行代码分割</li>\n<li>useContext 也没有提供对异步请求的解决方案，redux 虽然有但较难上手</li>\n</ol>\n<h1 id="目标"><a href="#%E7%9B%AE%E6%A0%87" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>目标</h1>\n<p>提供一种机制来管理和维护 React 应用中的状态，并且使得这些状态能够跨组件共享、状态的变化可以预测</p>\n<ol>\n<li>做到数据共享，兼顾子组件精准渲染</li>\n<li>获取和修改状态</li>\n<li>管理异步工作流</li>\n</ol>\n<h1 id="模式"><a href="#%E6%A8%A1%E5%BC%8F" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式</h1>\n<h2 id="store"><a href="#store" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Store</h2>\n<p>Store 模式通过集中式的存储来管理应用的状态，这种模式的基本思想是将应用的所有状态存储在一个单一的地方，通常称为“store”。组件通过与 store 的交互来读取和更新状态，而不是直接在组件内部管理状态</p>\n<p>Redux、Zustand 正是使用了 store 模式设计，Redux 官网的 gif 很好的演示了 redux 中数据流动的方向及 Store、 Dispach、Action、Reducer 的配合过程</p>\n<p><img src="/static/2025-10-22-18-43-58-edcdc14f32727d2aa89fe335da19034b.gif"></p>\n<h2 id="响应"><a href="#%E5%93%8D%E5%BA%94" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>响应</h2>\n<p>响应模式是一种通过观察（observe）状态变化并自动更新界面的方法。这种模式的核心思想是，当数据发生变化时，界面能够自动地响应并更新显示，可以使得状态管理更加直观、高效和模块化</p>\n<p>MobX、Valtio 都使用了响应模式，MobX 官网流程图很好的解释了其 data flow</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/2025-10-23-10-47-41-ab316e215018c0c656602e5ce3a3f29b-a9fd5.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 21.5625%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsSAAALEgHS3X78AAAApElEQVQI112NzQuCQBDF/ev7eyro2sGTYJEHLwUmJBTiB7qu7syuOzbrB0S/y7zHm8fzpJRN21bp9R2dqiRk2wlxuDx3+/AcZwOnTfN4BUF8zOtUCFnleRbd7r5fJIk3zWjEuviMxhA5a63tFFpLS2qMUTCM1q52HLXWLNbyRJMCVArUDB8EBQBlWfIygnMuGBysiEeItvIPtMGaX5eRPxCx7/svkVzkrDJb6KUAAAAASUVORK5CYII=\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="2025 10 23 10 47 41" title="" data-src="/static/2025-10-23-10-47-41-ab316e215018c0c656602e5ce3a3f29b-fee1c.png" data-srcset="/static/2025-10-23-10-47-41-ab316e215018c0c656602e5ce3a3f29b-a67b7.png 200w,\n/static/2025-10-23-10-47-41-ab316e215018c0c656602e5ce3a3f29b-0b187.png 400w,\n/static/2025-10-23-10-47-41-ab316e215018c0c656602e5ce3a3f29b-fee1c.png 800w,\n/static/2025-10-23-10-47-41-ab316e215018c0c656602e5ce3a3f29b-b1a91.png 1200w,\n/static/2025-10-23-10-47-41-ab316e215018c0c656602e5ce3a3f29b-a9fd5.png 1280w" data-sizes="(max-width: 800px) 100vw, 800px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<h2 id="原子"><a href="#%E5%8E%9F%E5%AD%90" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>原子</h2>\n<p>不同于 Store 模式和响应模式把 State 集中起来管理，状态维护在组件顶部，子组件需要的话通过 selector 按需获取，数据自上向下流动。原子模式提倡把应用的全局状态拆分为多个小的、独立的状态单元——这些状态单元被称为原子（Atom），提供更细粒度的状态管理，以便组件可以更高效地更新和渲染</p>\n<p>原子模式是对 useState + useContext 的升级，原子模式的代表作是 Recoil 和 Jotai</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/2025-10-23-10-56-17-090276aed9e3109dd178671828683c3d-a9fd5.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 51.25000000000001%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsSAAALEgHS3X78AAABqklEQVQoz01SPZPTMBDNf6ajo6SCoaGm4KOAoYAGuoOBYYDhiM85X85OnPgs2Y5iR9+yJX+wtpm7e6NZP8na3bdvtIjjOAgC55rKf6bpXkSvzNGXyUeJv5riBw3fDMPQd+0wfnoI3YR+4ouiKBBCwHR9ImUiGZGs7DunRNV1zijmbANLsOOU3g33sLhl/dDrmtm+ef/80db7+evzu+8fXq5/f/n04slN6L99+pAS9Prxg+j6KoyiPMvGZBAAMpxzEE0jbWfj9Z/jISVJhEKPAtsEklMUXtzgw7ezs0107V2MkFKOnRljwLTWjFFS5nVjhRGMFlpQJSjMp7QpTgrlVYhOcLOqKkJIXddjctu2SinYLJfebh9LxeCwVqeCoEOWCM6LSlrXgkfBBiul72aefQPZnPMsy61tGqestTjZSsmzksS7bYZS8JVUPK8UF1Ir1U+4M2zuD0QqfnnpX/nLKE64aoQsA//varU691braAcSoL4x5r/bc5m5vxACRtrvE4yzNE2hSVmWQLIRGGNEKYU7eZ6DU4vbzP7eG5jJXA4UzX/ntwHRToDzf73vL2xIupl3AAAAAElFTkSuQmCC\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="2025 10 23 10 56 17" title="" data-src="/static/2025-10-23-10-56-17-090276aed9e3109dd178671828683c3d-fee1c.png" data-srcset="/static/2025-10-23-10-56-17-090276aed9e3109dd178671828683c3d-a67b7.png 200w,\n/static/2025-10-23-10-56-17-090276aed9e3109dd178671828683c3d-0b187.png 400w,\n/static/2025-10-23-10-56-17-090276aed9e3109dd178671828683c3d-fee1c.png 800w,\n/static/2025-10-23-10-56-17-090276aed9e3109dd178671828683c3d-b1a91.png 1200w,\n/static/2025-10-23-10-56-17-090276aed9e3109dd178671828683c3d-a9fd5.png 1280w" data-sizes="(max-width: 800px) 100vw, 800px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<h2 id="状态机"><a href="#%E7%8A%B6%E6%80%81%E6%9C%BA" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>状态机</h2>\n<p>状态机是一种数学模型，它描述了在任何给定时间只能处于一种状态的系统，系统在不同的状态之间可以通过确定的事件进行转化</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/2025-10-23-10-56-28-215f7f0632ac27f4ecb13d83e21181c8-180cb.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 780px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 53.84615384615385%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsSAAALEgHS3X78AAAB10lEQVQoz2WS22sTQRTG+4/5KPjkv2EpPlhqoGgUpUR8ExEU9UFp8R68gJKq8YKiqTam2WSz7U67t5nZ2ZnJXjKz2ZhERacJbZMKv4dhON+c7ztnZhBLx0AqvUA4pGPjyPGTq0V+4S5bWmHn79AvjRgFse0nqkCxL5nZV5KwF6V/dtCuUrG0HORu0sXbdP568L7KgzDdtBlLBrwzhHRCPFZqhvvo6erjZ68fFkuf15oy60ciVcis50BefFFevv/8wZNXbz9+w7x7IFZOuPhVKldm506fyRfmTuZu3LrXFkPMJWaSJ/3vG+aJ2YWz5y7NL+QLl6+pTojKA9uj/qmNY1W3A0OPyoYlNoCob4saEABKGHTqhgsc5pHO4cxj1JMWii3I15rsaA4eW0TH8/jIKVhYwYTFACUkHgTJAI7a/ieOB347UylcInRbIQ1HqoPld8E21H/UgN6qr9dI1IeHbCtaumnBCPIM85S09+C749w03dUrFxuf3hgtE7enM8ORZ6Na4Q6IxU9vz9gYlVMO/6baO/C17Ce/0ZRtKv2o39KavlGD6x9iFqitwonPQ8LMQZT4KEm6Hk2nB6bEYW8LuJXSy3pVM50AUTHZWS1W2/J0E1o4mrz/Bx30ODHeQb04AAAAAElFTkSuQmCC\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="2025 10 23 10 56 28" title="" data-src="/static/2025-10-23-10-56-28-215f7f0632ac27f4ecb13d83e21181c8-180cb.png" data-srcset="/static/2025-10-23-10-56-28-215f7f0632ac27f4ecb13d83e21181c8-b84dc.png 200w,\n/static/2025-10-23-10-56-28-215f7f0632ac27f4ecb13d83e21181c8-8d9eb.png 400w,\n/static/2025-10-23-10-56-28-215f7f0632ac27f4ecb13d83e21181c8-180cb.png 780w" data-sizes="(max-width: 780px) 100vw, 780px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<h1 id="选型"><a href="#%E9%80%89%E5%9E%8B" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>选型</h1>\n<table>\n<thead>\n<tr>\n<th>状态库</th>\n<th align="right">响应粒度</th>\n<th align="right">API 简洁度</th>\n<th align="right">性能</th>\n<th align="right">类型支持</th>\n<th align="right">异步处理</th>\n<th align="right">持久化/中间件</th>\n<th align="right">DevTools</th>\n<th align="right">社区生态</th>\n<th align="right">应用规模</th>\n<th>适用场景/特点</th>\n<th>适用具体范围</th>\n<th>优点</th>\n<th>缺点</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Context API</td>\n<td align="right">粗粒度</td>\n<td align="right">简单</td>\n<td align="right">一般</td>\n<td align="right">完善</td>\n<td align="right">需手动</td>\n<td align="right">需手动</td>\n<td align="right">无</td>\n<td align="right">极成熟</td>\n<td align="right">小/中</td>\n<td>全局共享、简单场景，易用</td>\n<td><ol>\n<li>\n应用中全局状态较少、简单的场景；\n</li>\n<li>\n如主题切换、登录状态、国际化等\n</li>\n</ol></td>\n<td><ol>\n<li>\n无需额外安装库，官方内置；\n</li>\n<li>\n简单易用，轻量级；\n</li>\n<li>\n适合简单的全局状态共享（如主题、语言）\n</li>\n</ol></td>\n<td><ol>\n<li>\n性能较差，任何 context 改变会导致所有消费组件重渲染；\n</li>\n<li>\n不适合管理复杂状态\n</li>\n</ol></td>\n</tr>\n<tr>\n<td>Redux</td>\n<td align="right">粗粒度</td>\n<td align="right">复杂</td>\n<td align="right">一般</td>\n<td align="right">完善</td>\n<td align="right">完善</td>\n<td align="right">完善</td>\n<td align="right">强（Redux DevTools）</td>\n<td align="right">极成熟</td>\n<td align="right">中/大</td>\n<td>可预测性、可扩展性、生态强</td>\n<td><ol>\n<li>\n复杂的大型应用，业务逻辑复杂，状态交互频繁；\n</li>\n<li>\n需要时间旅行、调试工具、可预测性强的场景\n</li>\n</ol></td>\n<td><ol>\n<li>\n社区成熟，生态丰富（如 Redux Toolkit）；\n</li>\n<li>\n可预测性强，状态集中管理；\n</li>\n<li>\n易于调试，工具支持好（Redux DevTools）；\n</li>\n<li>\n与 React 以外的框架也可结合使用\n</li>\n</ol></td>\n<td><ol>\n<li>\n写法繁琐（action、reducer、store 等），模板代码多；\n</li>\n<li>\n学习曲线较高；\n</li>\n<li>\n对于简单场景显得“重”\n</li>\n</ol></td>\n</tr>\n<tr>\n<td>MobX</td>\n<td align="right">中等粒度</td>\n<td align="right">简单</td>\n<td align="right">高</td>\n<td align="right">完善</td>\n<td align="right">支持</td>\n<td align="right">支持</td>\n<td align="right">有</td>\n<td align="right">成熟</td>\n<td align="right">中/大</td>\n<td>响应式、面向对象、灵活</td>\n<td><ol>\n<li>\n中小型项目；\n</li>\n<li>\n对响应式编程有需求；\n</li>\n<li>\n不需要严格的状态可预测性\n</li>\n</ol></td>\n<td><ol>\n<li>\n使用简单，代码量少，响应式编程体验好；\n</li>\n<li>\n自动追踪依赖，数据变化自动更新视图；\n</li>\n<li>\n学习成本低，易于集成\n</li>\n</ol></td>\n<td><ol>\n<li>\n状态分散，不易全局管控；\n</li>\n<li>\n调试和开发工具支持较 Redux 差；\n</li>\n<li>\n难以追踪复杂的状态变更\n</li>\n</ol></td>\n</tr>\n<tr>\n<td>Recoil</td>\n<td align="right">原子粒度</td>\n<td align="right">适中</td>\n<td align="right">高</td>\n<td align="right">完善</td>\n<td align="right">完善</td>\n<td align="right">需手动</td>\n<td align="right">有（Recoil DevTools）</td>\n<td align="right">较成熟</td>\n<td align="right">中/大</td>\n<td>原子+选择器、复杂依赖关系</td>\n<td><ol>\n<li>\n中大型应用；\n</li>\n<li>\n需要细粒度状态管理和较高性能的场景\n</li>\n</ol></td>\n<td><ol>\n<li>\n原生支持 React，API 简洁；\n</li>\n<li>\n支持原子化状态管理，细粒度控制；\n</li>\n<li>\n性能优秀，支持异步 selector\n</li>\n</ol></td>\n<td><ol>\n<li>\n社区和生态相对较小；\n</li>\n<li>\n有些高级用法不如 Redux 成熟\n</li>\n</ol></td>\n</tr>\n<tr>\n<td>Zustand</td>\n<td align="right">任意粒度</td>\n<td align="right">极简</td>\n<td align="right">高</td>\n<td align="right">完善</td>\n<td align="right">需手动</td>\n<td align="right">完善</td>\n<td align="right">有（Zustand DevTools）</td>\n<td align="right">极成熟</td>\n<td align="right">小/中/大</td>\n<td>Hook 风格、中间件、极简</td>\n<td><ol>\n<li>\n中小型应用；\n</li>\n<li>\n想要简单高效状态管理的场景；\n</li>\n</ol></td>\n<td><ol>\n<li>\nAPI 极简，零模板代码\n</li>\n<li>\n性能好，支持局部订阅；\n</li>\n<li>\n支持 hooks，易于集成\n</li>\n</ol></td>\n<td><ol>\n<li>\n社区相对较小；\n</li>\n<li>\n功能不如 Redux 完善，如中间件、调试工具等较弱\n</li>\n</ol></td>\n</tr>\n<tr>\n<td>Jotai</td>\n<td align="right">原子粒度</td>\n<td align="right">极简</td>\n<td align="right">高</td>\n<td align="right">完善</td>\n<td align="right">支持</td>\n<td align="right">需手动</td>\n<td align="right">有（Jotai DevTools）</td>\n<td align="right">新兴</td>\n<td align="right">小/中</td>\n<td>函数式、原子化、极简</td>\n<td><ol>\n<li>\n轻量级项目；\n</li>\n<li>\n需要响应式原子状态的场景\n</li>\n</ol></td>\n<td><ol>\n<li>\n响应式原子状态，API 简单；\n</li>\n<li>\n体积小，性能优秀\n</li>\n</ol></td>\n<td><ol>\n<li>\n社区还在成长；\n</li>\n<li>\n功能相对精简\n</li>\n</ol></td>\n</tr>\n<tr>\n<td>XState</td>\n<td align="right">状态机/流程</td>\n<td align="right">复杂</td>\n<td align="right">高</td>\n<td align="right">完善</td>\n<td align="right">完善</td>\n<td align="right">支持</td>\n<td align="right">有</td>\n<td align="right">成熟</td>\n<td align="right">中/大</td>\n<td>复杂业务流程、可视化</td>\n<td>多状态流转、流程编排、复杂异步与副作用管理</td>\n<td><ol>\n<li>\n可视化与状态图；\n</li>\n<li>\n严格的状态流转；\n</li>\n<li>\n适合复杂业务流程建模\n</li>\n</ol></td>\n<td><ol>\n<li>\n学习曲线高；心智模型重；\n</li>\n<li>\n在简单场景偏重\n</li>\n</ol></td>\n</tr>\n<tr>\n<td>Preact Signals</td>\n<td align="right">极细粒度</td>\n<td align="right">极简</td>\n<td align="right">极高</td>\n<td align="right">好</td>\n<td align="right">需手动</td>\n<td align="right">需手动</td>\n<td align="right">有限</td>\n<td align="right">新兴</td>\n<td align="right">小/中</td>\n<td>微秒级响应、性能极致</td>\n<td><ol>\n<li>\n极致性能需求的组件局部状态；\n</li>\n<li>\n频繁更新的 UI\n</li>\n</ol></td>\n<td><ol>\n<li>\n超高性能；\n</li>\n<li>\n信号机制带来精准更新；\n</li>\n<li>\n极小 API\n</li>\n</ol></td>\n<td><ol>\n<li>\n生态有限；\n</li>\n<li>\nDevTools 支持弱；\n</li>\n<li>\n需手动做异步与持久化方案\n</li>\n</ol></td>\n</tr>\n<tr>\n<td>Pinia</td>\n<td align="right">原子/模块粒度</td>\n<td align="right">简单</td>\n<td align="right">高</td>\n<td align="right">完善</td>\n<td align="right">支持</td>\n<td align="right">支持</td>\n<td align="right">有</td>\n<td align="right">成熟</td>\n<td align="right">小/中/大</td>\n<td>Vue 原生、社区有 React 适配</td>\n<td><ol>\n<li>\n跨框架（主要 Vue）或在微前端中复用；\n</li>\n<li>\n模块化状态\n</li>\n</ol></td>\n<td><ol>\n<li>\nAPI 直观；\n</li>\n<li>\n模块/插件生态好；\n</li>\n<li>\n类型友好\n</li>\n</ol></td>\n<td><ol>\n<li>\n在纯 React 项目里并非主流；\n</li>\n<li>\n适配层可能增加复杂度\n</li>\n</ol></td>\n</tr>\n<tr>\n<td>helux</td>\n<td align="right">极细粒度</td>\n<td align="right">丰富</td>\n<td align="right">极高</td>\n<td align="right">极好</td>\n<td align="right">完善</td>\n<td align="right">有限/需手动</td>\n<td align="right">有</td>\n<td align="right">新兴</td>\n<td align="right">小/中</td>\n<td>响应式+按需渲染、类型友好</td>\n<td>需要极细粒度渲染优化与强类型结合场景</td>\n<td><ol>\n<li>\n按需渲染性能优秀；\n</li>\n<li>\n类型支持出色；\n</li>\n<li>\n组合灵活\n</li>\n</ol></td>\n<td><ol>\n<li>\n生态新；\n</li>\n<li>\n文档与社区资源少；\n</li>\n<li>\n部分特性稳定性待验证\n</li>\n</ol></td>\n</tr>\n</tbody>\n</table>\n<h1 id="对比"><a href="#%E5%AF%B9%E6%AF%94" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>对比</h1>\n<h2 id="代码"><a href="#%E4%BB%A3%E7%A0%81" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>代码</h2>\n<h3 id="context-api"><a href="#context-api" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Context API</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="57718828834601620000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`import React, { createContext, useContext, useState } from \'react\';\n\nconst DemoContext = createContext();\n\nconst DemoProvider = ({ children }) => {\n   const [count, setCount] = useState(0);\n   const [name, setName] = useState(\'Anonymous\');\n\n   return <DemoContext.Provider value={{ count, setCount, name, setName }}>{children}</DemoContext.Provider>;\n};\n\nconst GrandSonName = () => {\n   const { name } = useContext(DemoContext);\n   return (\n      <div style={{ border: \'1px #333 solid\' }}>\n         <h3>GrandSonName</h3>\n         <p>name: {name}</p>\n      </div>\n   );\n};\n\nconst GrandSonCount = () => {\n   const { count } = useContext(DemoContext);\n   return (\n      <div style={{ border: \'1px #333 solid\' }}>\n         <h3>GrandSonCount</h3>\n         <p>count: {count}</p>\n      </div>\n   );\n};\n\nconst Son1 = () => {\n   const { count, setCount, name } = useContext(DemoContext);\n\n   return (\n      <div style={{ border: \'1px #333 solid\', padding: 5 }}>\n         <h2>Child 1</h2>\n         <p>Count: {count}</p>\n         <p>Name: {name}</p>\n         <button onClick={() => setCount(count + 1)}>Increment Count</button>\n         <GrandSonName />\n         <GrandSonCount />\n      </div>\n   );\n};\n\nconst Son2 = () => {\n   const { name, setName } = useContext(DemoContext);\n\n   return (\n      <div style={{ border: \'1px #333 solid\', padding: 5, marginTop: 10 }}>\n         <h2>Child 2</h2>\n         <input type=\'text\' value={name} onChange={(e) => setName(e.target.value)} />\n         <GrandSonName />\n      </div>\n   );\n};\n\nconst Son3 = () => {\n   return (\n      <div style={{ border: \'1px #333 solid\', padding: 5, marginTop: 10 }}>\n         <h2>Child 3</h2>\n         <GrandSonName />\n         <GrandSonCount />\n      </div>\n   );\n};\n\nexport default function App() {\n   return (\n      <DemoProvider>\n         <Son1 />\n         <Son2 />\n         <Son3 />\n      </DemoProvider>\n   );\n}`, `57718828834601620000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="jsx"\n              >\n                <span class="gatsby-code-button-language">jsx</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> createContext<span class="token punctuation">,</span> useContext<span class="token punctuation">,</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">\'react\'</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> DemoContext <span class="token operator">=</span> <span class="token function">createContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> <span class="token function-variable function">DemoProvider</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> children <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n   <span class="token keyword">const</span> <span class="token punctuation">[</span>count<span class="token punctuation">,</span> setCount<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n   <span class="token keyword">const</span> <span class="token punctuation">[</span>name<span class="token punctuation">,</span> setName<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">\'Anonymous\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n   <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">DemoContext.Provider</span></span> <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> count<span class="token punctuation">,</span> setCount<span class="token punctuation">,</span> name<span class="token punctuation">,</span> setName <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token punctuation">{</span>children<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">DemoContext.Provider</span></span><span class="token punctuation">></span></span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> <span class="token function-variable function">GrandSonName</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n   <span class="token keyword">const</span> <span class="token punctuation">{</span> name <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span>DemoContext<span class="token punctuation">)</span><span class="token punctuation">;</span>\n   <span class="token keyword">return</span> <span class="token punctuation">(</span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> border<span class="token punctuation">:</span> <span class="token string">\'1px #333 solid\'</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">\n         </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span><span class="token punctuation">></span></span><span class="token plain-text">GrandSonName</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">></span></span><span class="token plain-text">\n         </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">name: </span><span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n   <span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> <span class="token function-variable function">GrandSonCount</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n   <span class="token keyword">const</span> <span class="token punctuation">{</span> count <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span>DemoContext<span class="token punctuation">)</span><span class="token punctuation">;</span>\n   <span class="token keyword">return</span> <span class="token punctuation">(</span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> border<span class="token punctuation">:</span> <span class="token string">\'1px #333 solid\'</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">\n         </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span><span class="token punctuation">></span></span><span class="token plain-text">GrandSonCount</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">></span></span><span class="token plain-text">\n         </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">count: </span><span class="token punctuation">{</span>count<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n   <span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> <span class="token function-variable function">Son1</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n   <span class="token keyword">const</span> <span class="token punctuation">{</span> count<span class="token punctuation">,</span> setCount<span class="token punctuation">,</span> name <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span>DemoContext<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n   <span class="token keyword">return</span> <span class="token punctuation">(</span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> border<span class="token punctuation">:</span> <span class="token string">\'1px #333 solid\'</span><span class="token punctuation">,</span> padding<span class="token punctuation">:</span> <span class="token number">5</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">\n         </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span><span class="token plain-text">Child 1</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span><span class="token plain-text">\n         </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">Count: </span><span class="token punctuation">{</span>count<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">\n         </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">Name: </span><span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">\n         </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">setCount</span><span class="token punctuation">(</span>count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">Increment Count</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">\n         </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">GrandSonName</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">\n         </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">GrandSonCount</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n   <span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> <span class="token function-variable function">Son2</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n   <span class="token keyword">const</span> <span class="token punctuation">{</span> name<span class="token punctuation">,</span> setName <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span>DemoContext<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n   <span class="token keyword">return</span> <span class="token punctuation">(</span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> border<span class="token punctuation">:</span> <span class="token string">\'1px #333 solid\'</span><span class="token punctuation">,</span> padding<span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span> marginTop<span class="token punctuation">:</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">\n         </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span><span class="token plain-text">Child 2</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span><span class="token plain-text">\n         </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">\'</span>text<span class="token punctuation">\'</span></span> <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>name<span class="token punctuation">}</span></span> <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">setName</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">\n         </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">GrandSonName</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n   <span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> <span class="token function-variable function">Son3</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n   <span class="token keyword">return</span> <span class="token punctuation">(</span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> border<span class="token punctuation">:</span> <span class="token string">\'1px #333 solid\'</span><span class="token punctuation">,</span> padding<span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span> marginTop<span class="token punctuation">:</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">\n         </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span><span class="token plain-text">Child 3</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span><span class="token plain-text">\n         </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">GrandSonName</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">\n         </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">GrandSonCount</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n   <span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n   <span class="token keyword">return</span> <span class="token punctuation">(</span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">DemoProvider</span></span><span class="token punctuation">></span></span><span class="token plain-text">\n         </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Son1</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">\n         </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Son2</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">\n         </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Son3</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">DemoProvider</span></span><span class="token punctuation">></span></span>\n   <span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="helux"><a href="#helux" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>helux</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="54206542782679155000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`import { sharex, \\$, useAtom } from \'helux\';\nimport React from \'react\';\n\nconst GlobalModel = sharex({\n   count: 1,\n   name: \'Anonymous\'\n});\n\nconst { state, setState } = GlobalModel;\n\nconst GrandSonName = () => {\n   return (\n      <div style={{ border: \'1px #333 solid\' }}>\n         <h3>GrandSonName</h3>\n         <p>name: {\\$(state.name)}</p>\n      </div>\n   );\n};\n\nconst GrandSonCount = () => {\n   return (\n      <div style={{ border: \'1px #333 solid\' }}>\n         <h3>GrandSonCount</h3>\n         <p>count: {\\$(state.count)}</p>\n      </div>\n   );\n};\n\nconst Son1 = () => {\n   return (\n      <div style={{ border: \'1px #333 solid\', padding: 5 }}>\n         <h2>Child 1</h2>\n         <p>Count: {\\$(state.count)}</p>\n         <p>Name: {\\$(state.name)}</p>\n         <button\n            onClick={() =>\n               setState((draft) => {\n                  draft.count += 1;\n               })\n            }\n         >\n            Increment Count\n         </button>\n         <GrandSonName />\n         <GrandSonCount />\n      </div>\n   );\n};\n\n// 这里需要抽出一个组件，否则依然会有性能问题\nconst Input = () => {\n   const [dictState] = useAtom(state);\n   return (\n      <input\n         type=\'text\'\n         value={dictState.name}\n         onChange={(e) => {\n            setState((draft) => {\n               draft.name = e.target.value;\n            });\n         }}\n      />\n   );\n};\n\nconst Son2 = () => {\n   return (\n      <div style={{ border: \'1px #333 solid\', padding: 5, marginTop: 10 }}>\n         <h2>Child 2</h2>\n         <Input />\n         <GrandSonName />\n      </div>\n   );\n};\n\nconst Son3 = () => {\n   return (\n      <div style={{ border: \'1px #333 solid\', padding: 5, marginTop: 10 }}>\n         <h2>Child 3</h2>\n         <GrandSonName />\n         <GrandSonCount />\n      </div>\n   );\n};\n\nexport default function App() {\n   return (\n      <>\n         <Son1 />\n         <Son2 />\n         <Son3 />\n      </>\n   );\n}`, `54206542782679155000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="jsx"\n              >\n                <span class="gatsby-code-button-language">jsx</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx"><span class="token keyword">import</span> <span class="token punctuation">{</span> sharex<span class="token punctuation">,</span> $<span class="token punctuation">,</span> useAtom <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">\'helux\'</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">\'react\'</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> GlobalModel <span class="token operator">=</span> <span class="token function">sharex</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n   count<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>\n   name<span class="token punctuation">:</span> <span class="token string">\'Anonymous\'</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> <span class="token punctuation">{</span> state<span class="token punctuation">,</span> setState <span class="token punctuation">}</span> <span class="token operator">=</span> GlobalModel<span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> <span class="token function-variable function">GrandSonName</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n   <span class="token keyword">return</span> <span class="token punctuation">(</span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> border<span class="token punctuation">:</span> <span class="token string">\'1px #333 solid\'</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">\n         </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span><span class="token punctuation">></span></span><span class="token plain-text">GrandSonName</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">></span></span><span class="token plain-text">\n         </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">name: </span><span class="token punctuation">{</span><span class="token function">$</span><span class="token punctuation">(</span>state<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n   <span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> <span class="token function-variable function">GrandSonCount</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n   <span class="token keyword">return</span> <span class="token punctuation">(</span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> border<span class="token punctuation">:</span> <span class="token string">\'1px #333 solid\'</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">\n         </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span><span class="token punctuation">></span></span><span class="token plain-text">GrandSonCount</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">></span></span><span class="token plain-text">\n         </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">count: </span><span class="token punctuation">{</span><span class="token function">$</span><span class="token punctuation">(</span>state<span class="token punctuation">.</span>count<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n   <span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> <span class="token function-variable function">Son1</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n   <span class="token keyword">return</span> <span class="token punctuation">(</span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> border<span class="token punctuation">:</span> <span class="token string">\'1px #333 solid\'</span><span class="token punctuation">,</span> padding<span class="token punctuation">:</span> <span class="token number">5</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">\n         </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span><span class="token plain-text">Child 1</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span><span class="token plain-text">\n         </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">Count: </span><span class="token punctuation">{</span><span class="token function">$</span><span class="token punctuation">(</span>state<span class="token punctuation">.</span>count<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">\n         </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">Name: </span><span class="token punctuation">{</span><span class="token function">$</span><span class="token punctuation">(</span>state<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">\n         </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span>\n            <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span>\n               <span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">draft</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n                  draft<span class="token punctuation">.</span>count <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>\n               <span class="token punctuation">}</span><span class="token punctuation">)</span>\n            <span class="token punctuation">}</span></span>\n         <span class="token punctuation">></span></span><span class="token plain-text">\n            Increment Count\n         </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">\n         </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">GrandSonName</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">\n         </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">GrandSonCount</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n   <span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n<span class="token comment">// 这里需要抽出一个组件，否则依然会有性能问题</span>\n<span class="token keyword">const</span> <span class="token function-variable function">Input</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n   <span class="token keyword">const</span> <span class="token punctuation">[</span>dictState<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useAtom</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">;</span>\n   <span class="token keyword">return</span> <span class="token punctuation">(</span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span>\n         <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">\'</span>text<span class="token punctuation">\'</span></span>\n         <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>dictState<span class="token punctuation">.</span>name<span class="token punctuation">}</span></span>\n         <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n            <span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">draft</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n               draft<span class="token punctuation">.</span>name <span class="token operator">=</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">;</span>\n            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n         <span class="token punctuation">}</span><span class="token punctuation">}</span></span>\n      <span class="token punctuation">/></span></span>\n   <span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> <span class="token function-variable function">Son2</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n   <span class="token keyword">return</span> <span class="token punctuation">(</span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> border<span class="token punctuation">:</span> <span class="token string">\'1px #333 solid\'</span><span class="token punctuation">,</span> padding<span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span> marginTop<span class="token punctuation">:</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">\n         </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span><span class="token plain-text">Child 2</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span><span class="token plain-text">\n         </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Input</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">\n         </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">GrandSonName</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n   <span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> <span class="token function-variable function">Son3</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n   <span class="token keyword">return</span> <span class="token punctuation">(</span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> border<span class="token punctuation">:</span> <span class="token string">\'1px #333 solid\'</span><span class="token punctuation">,</span> padding<span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span> marginTop<span class="token punctuation">:</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">\n         </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span><span class="token plain-text">Child 3</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span><span class="token plain-text">\n         </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">GrandSonName</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">\n         </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">GrandSonCount</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n   <span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n   <span class="token keyword">return</span> <span class="token punctuation">(</span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">></span></span><span class="token plain-text">\n         </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Son1</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">\n         </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Son2</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">\n         </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Son3</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">></span></span>\n   <span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="效果"><a href="#%E6%95%88%E6%9E%9C" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>效果</h2>\n<table>\n<thead>\n<tr>\n<th>状态库</th>\n<th>React 层重渲染</th>\n<th>浏览器重渲染</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Context API</td>\n<td><html><head></head><body><video style="max-width: 200px" data-src="/examples/react-global-state-selection/1.mp4" loop="" muted="" autoplay="" width="100%" class="lazy"></video></body></html></td>\n<td><html><head></head><body><video style="max-width: 200px" data-src="/examples/react-global-state-selection/2.mp4" loop="" muted="" autoplay="" width="100%" class="lazy"></video></body></html></td>\n</tr>\n<tr>\n<td>helux</td>\n<td><html><head></head><body><video style="max-width: 200px" data-src="/examples/react-global-state-selection/3.mp4" loop="" muted="" autoplay="" width="100%" class="lazy"></video></body></html></td>\n<td><html><head></head><body><video style="max-width: 200px" data-src="/examples/react-global-state-selection/4.mp4" loop="" muted="" autoplay="" width="100%" class="lazy"></video></body></html></td>\n</tr>\n</tbody>\n</table>\n<h1 id="结论"><a href="#%E7%BB%93%E8%AE%BA" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>结论</h1>\n<p>以 React 层重渲染（即组件是否触发 render）为准，此标准比浏览器重渲染更高，由上面的视频可得出以下结论</p>\n<ol>\n<li>\n<p>虽然最终浏览器重渲染的效果一样，但 helux 对比 Context API 明显在 React 层性能更好，归功于 helux 的 dom 粒度更新</p>\n</li>\n<li>\n<p>helux 的 signal 语法只适用于展示型即普通的 dom 元素，无法适用于 react 组件，需要使用 useAtom 转换为真实状态，但此时就失去了 dom 粒度更新的优势，需要将 react 组件抽出一个单独组件防止性能劣化</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/2025-10-23-14-52-50-918985131cae7518d0d4bfd63ac071fe-2517a.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 66.70190274841438%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsSAAALEgHS3X78AAABV0lEQVQoz5VRi2rCUAztb4z1vl+5r97WWq06piJujLH//52lVoTBcO4QckvJyUlOKhcTFYxqjlFzQiQjimNQzWrOCKF3UCkfSszvm9XbdnkY+kObjl04LvJLVzbOSMbu0CsdUrGwb8dlLJ2PC2vXYAaAhYu9lH+QbcyE0aF0p3G3S6kHP/gwaC1J/VTfHRrJLmXOee/Dx+l8Opx3q822H1Y+eqUYglL2G65kQLKQXAhoCpTWpCLBy9h069E6hxVCCKUkZjmlK+YWlQkRyVorJnDSml78ZfQh4M5JKkkuoP9EZUMUBgC8s0oILjiqTm3mZvPHVIh5ip9kyFlIE1MXG7xOhNQoY53Vbds6hdtqm4oyRoM3IRtU0PK2VhVKeaZsDOFz//q1HvqMl0N9LpXCKfAQQio+PWLylfOb1RPZl4LFAXxqcvCg5/0fHBuV8Qb4syZo9v9s+wYKvGpzilWPowAAAABJRU5ErkJggg==\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="2025 10 23 14 52 50" title="" data-src="/static/2025-10-23-14-52-50-918985131cae7518d0d4bfd63ac071fe-fee1c.png" data-srcset="/static/2025-10-23-14-52-50-918985131cae7518d0d4bfd63ac071fe-a67b7.png 200w,\n/static/2025-10-23-14-52-50-918985131cae7518d0d4bfd63ac071fe-0b187.png 400w,\n/static/2025-10-23-14-52-50-918985131cae7518d0d4bfd63ac071fe-fee1c.png 800w,\n/static/2025-10-23-14-52-50-918985131cae7518d0d4bfd63ac071fe-2517a.png 946w" data-sizes="(max-width: 800px) 100vw, 800px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n</li>\n</ol>\n<h1 id="快速上手"><a href="#%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>快速上手</h1>\n<p><a href="https://heluxjs.github.io/helux/" target="_blank" rel="nofollow noreferrer noopener">https://heluxjs.github.io/helux/</a></p>\n<h2 id="全局状态"><a href="#%E5%85%A8%E5%B1%80%E7%8A%B6%E6%80%81" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>全局状态</h2>\n<p>文件夹结构</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="71950683103709200000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`├── model\n│   ├── actions.js\n│   ├── index.js\n│   └── state.js`, `71950683103709200000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title=""\n              >\n                \n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="text"><pre style="counter-reset: linenumber NaN" class="language-text line-numbers"><code class="language-text">├── model\n│   ├── actions.js\n│   ├── index.js\n│   └── state.js</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>index.js</p>\n<p>导出主入口</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="66030519737152905000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`import { \\$, useAtom } from \'helux\';\n\nimport { GlobalState } from \'./state\';\nimport * as actions from \'./actions\'; // action 函数定义\n\nexport default GlobalState;\n\nexport const action = GlobalState.defineActions()(actions);\n\nconst { state, setState } = GlobalState;\n\nexport { \\$, useAtom, state, setState };`, `66030519737152905000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="js"\n              >\n                <span class="gatsby-code-button-language">js</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="js"><pre style="counter-reset: linenumber NaN" class="language-js line-numbers"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> $<span class="token punctuation">,</span> useAtom <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">\'helux\'</span><span class="token punctuation">;</span>\n\n<span class="token keyword">import</span> <span class="token punctuation">{</span> GlobalState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">\'./state\'</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> actions <span class="token keyword">from</span> <span class="token string">\'./actions\'</span><span class="token punctuation">;</span> <span class="token comment">// action 函数定义</span>\n\n<span class="token keyword">export</span> <span class="token keyword">default</span> GlobalState<span class="token punctuation">;</span>\n\n<span class="token keyword">export</span> <span class="token keyword">const</span> action <span class="token operator">=</span> GlobalState<span class="token punctuation">.</span><span class="token function">defineActions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span>actions<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> <span class="token punctuation">{</span> state<span class="token punctuation">,</span> setState <span class="token punctuation">}</span> <span class="token operator">=</span> GlobalState<span class="token punctuation">;</span>\n\n<span class="token keyword">export</span> <span class="token punctuation">{</span> $<span class="token punctuation">,</span> useAtom<span class="token punctuation">,</span> state<span class="token punctuation">,</span> setState <span class="token punctuation">}</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>state.js</p>\n<p>全局状态定义</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="95620107700690520000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`import { sharex } from \'helux\';\n\nexport const GlobalState = sharex(\n   {\n      key: null,\n      key2: null,\n      jobInfo: {}\n   },\n   { moduleName: \'JobDetailState\' }\n);`, `95620107700690520000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="js"\n              >\n                <span class="gatsby-code-button-language">js</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="js"><pre style="counter-reset: linenumber NaN" class="language-js line-numbers"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> sharex <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">\'helux\'</span><span class="token punctuation">;</span>\n\n<span class="token keyword">export</span> <span class="token keyword">const</span> GlobalState <span class="token operator">=</span> <span class="token function">sharex</span><span class="token punctuation">(</span>\n   <span class="token punctuation">{</span>\n      key<span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>\n      key2<span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>\n      jobInfo<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n   <span class="token punctuation">}</span><span class="token punctuation">,</span>\n   <span class="token punctuation">{</span> moduleName<span class="token punctuation">:</span> <span class="token string">\'JobDetailState\'</span> <span class="token punctuation">}</span>\n<span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>actions.js</p>\n<p>异步 action 定义</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="97813614537466760000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`import { getJobInfo } from \'../services\';\n\nexport async function queryJobInfo({ draft, payload }) {\n   const [error, res] = await getJobInfo({ id: payload.jobId });\n   if (error) {\n      return null;\n   }\n   draft.jobInfo = res;\n   return res;\n}`, `97813614537466760000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="js"\n              >\n                <span class="gatsby-code-button-language">js</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="js"><pre style="counter-reset: linenumber NaN" class="language-js line-numbers"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> getJobInfo <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">\'../services\'</span><span class="token punctuation">;</span>\n\n<span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">queryJobInfo</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> draft<span class="token punctuation">,</span> payload <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n   <span class="token keyword">const</span> <span class="token punctuation">[</span>error<span class="token punctuation">,</span> res<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getJobInfo</span><span class="token punctuation">(</span><span class="token punctuation">{</span> id<span class="token punctuation">:</span> payload<span class="token punctuation">.</span>jobId <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n   <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>\n   <span class="token punctuation">}</span>\n   draft<span class="token punctuation">.</span>jobInfo <span class="token operator">=</span> res<span class="token punctuation">;</span>\n   <span class="token keyword">return</span> res<span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="纯展示类型"><a href="#%E7%BA%AF%E5%B1%95%E7%A4%BA%E7%B1%BB%E5%9E%8B" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>纯展示类型</h2>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="58306366843289210000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`import { \\$, state, setState } from \'./model\';\n\n// 纯展示型即 dom 结点直接使用 signal 语法，即 \\$(state.key)\nexport default function Example() {\n   return (\n      <div>\n         <Button\n            onClick={() =>\n               setState((draft) => {\n                  draft.key += 1;\n               })\n            }\n         >\n            {\\$(state.key)}\n         </Button>\n      </div>\n   );\n}`, `58306366843289210000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="jsx"\n              >\n                <span class="gatsby-code-button-language">jsx</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx"><span class="token keyword">import</span> <span class="token punctuation">{</span> $<span class="token punctuation">,</span> state<span class="token punctuation">,</span> setState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">\'./model\'</span><span class="token punctuation">;</span>\n\n<span class="token comment">// 纯展示型即 dom 结点直接使用 signal 语法，即 $(state.key)</span>\n<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">Example</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n   <span class="token keyword">return</span> <span class="token punctuation">(</span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\n         </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Button</span></span>\n            <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span>\n               <span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">draft</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n                  draft<span class="token punctuation">.</span>key <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>\n               <span class="token punctuation">}</span><span class="token punctuation">)</span>\n            <span class="token punctuation">}</span></span>\n         <span class="token punctuation">></span></span><span class="token plain-text">\n            </span><span class="token punctuation">{</span><span class="token function">$</span><span class="token punctuation">(</span>state<span class="token punctuation">.</span>key<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">\n         </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Button</span></span><span class="token punctuation">></span></span><span class="token plain-text">\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n   <span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="react-状态类型"><a href="#react-%E7%8A%B6%E6%80%81%E7%B1%BB%E5%9E%8B" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>React 状态类型</h2>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="15882736728753754000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`import { \\$, state, setState, useAtom } from \'./model\';\n\n// 这里需要抽出一个组件隔离渲染，即 useAtom 会触发组件重渲染\nconst Input = () => {\n   const [dictState] = useAtom(state); // 由于下面使用了 key2，更新 key2 时才会触发重渲染，即更新 key 时不会触发重渲染\n   return (\n      <input\n         type=\'text\'\n         value={dictState.key2}\n         onChange={(e) => {\n            setState((draft) => {\n               draft.key2 = e.target.value;\n            });\n         }}\n      />\n   );\n};\n\n// React 组件由于需要取到原始值，需要使用 useAtom 包一下取出\nexport default function Example2() {\n   return (\n      <div>\n         <Input />\n         {\\$(state.key2)}\n      </div>\n   );\n}`, `15882736728753754000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="jsx"\n              >\n                <span class="gatsby-code-button-language">jsx</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx"><span class="token keyword">import</span> <span class="token punctuation">{</span> $<span class="token punctuation">,</span> state<span class="token punctuation">,</span> setState<span class="token punctuation">,</span> useAtom <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">\'./model\'</span><span class="token punctuation">;</span>\n\n<span class="token comment">// 这里需要抽出一个组件隔离渲染，即 useAtom 会触发组件重渲染</span>\n<span class="token keyword">const</span> <span class="token function-variable function">Input</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n   <span class="token keyword">const</span> <span class="token punctuation">[</span>dictState<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useAtom</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 由于下面使用了 key2，更新 key2 时才会触发重渲染，即更新 key 时不会触发重渲染</span>\n   <span class="token keyword">return</span> <span class="token punctuation">(</span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span>\n         <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">\'</span>text<span class="token punctuation">\'</span></span>\n         <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>dictState<span class="token punctuation">.</span>key2<span class="token punctuation">}</span></span>\n         <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n            <span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">draft</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n               draft<span class="token punctuation">.</span>key2 <span class="token operator">=</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">;</span>\n            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n         <span class="token punctuation">}</span><span class="token punctuation">}</span></span>\n      <span class="token punctuation">/></span></span>\n   <span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n<span class="token comment">// React 组件由于需要取到原始值，需要使用 useAtom 包一下取出</span>\n<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">Example2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n   <span class="token keyword">return</span> <span class="token punctuation">(</span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\n         </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Input</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">\n         </span><span class="token punctuation">{</span><span class="token function">$</span><span class="token punctuation">(</span>state<span class="token punctuation">.</span>key2<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n   <span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="异步请求类型"><a href="#%E5%BC%82%E6%AD%A5%E8%AF%B7%E6%B1%82%E7%B1%BB%E5%9E%8B" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>异步请求类型</h2>\n<p>这里将请求放到全局状态里面，而不是组件里面，推荐在全局状态和异步请求有关时，优先在这里去请求，理由如下</p>\n<ol>\n<li>\n<p>为了避免组件的重渲染，即如果请求在顶级组件的话，那么所有组件都会重渲染</p>\n</li>\n<li>\n<p>写成 action 也有利于调试，安装 <a href="https://chromewebstore.google.com/detail/redux-devtools/lmhkpmbekcpmknklioeibfkpmmfibljd" target="_blank" rel="nofollow noreferrer noopener">Redux DevTools 插件</a></p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/2025-10-23-16-21-40-d54ab074942669dd475a45e76f6f881e-a9fd5.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 52.96875%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsSAAALEgHS3X78AAABVklEQVQoz42QvUvDQBjG+6cougjSTVFwUEoHP8BKFdQ66SA4+d8I7pZ2kGqyilMGQXBqB6famqSlVtPc5e6SyyXx7SVI+qH48C539/7ueZ83E4ggGpUQgY2JZeNhDRBzfV+E0TRl/EgQ6mCEMMa2bXueN9kUSraH/Nvnr+rTp/aKE5iGvPPRbzZbumHqug78sFvWGNzue9ePvauHnvpiJTBYWo6HmYCSfeGEbaIpYzOXU+YiTAhlYGtZAzYqX0oIAbgIwrgSOP2Tpmm12p2qqkosVb1XlEqlelMuwyFeR3qEzE88uHUwLA4RQmB54Mk5f9eNw9Lpylr+/OKSMjYOp7NRKWBgTvgFUhimmcvvzsxlC8USBPsVhlSxJzBg22g06vV6p9stFI+XVjeOSmcYO385A+ykxLn31mqv57Zn57NbOwfw+l9YxqaQOb9ZXFhc3ts/mYS/AZ4ZWMKvhvwfAAAAAElFTkSuQmCC\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="2025 10 23 16 21 40" title="" data-src="/static/2025-10-23-16-21-40-d54ab074942669dd475a45e76f6f881e-fee1c.png" data-srcset="/static/2025-10-23-16-21-40-d54ab074942669dd475a45e76f6f881e-a67b7.png 200w,\n/static/2025-10-23-16-21-40-d54ab074942669dd475a45e76f6f881e-0b187.png 400w,\n/static/2025-10-23-16-21-40-d54ab074942669dd475a45e76f6f881e-fee1c.png 800w,\n/static/2025-10-23-16-21-40-d54ab074942669dd475a45e76f6f881e-b1a91.png 1200w,\n/static/2025-10-23-16-21-40-d54ab074942669dd475a45e76f6f881e-a9fd5.png 1280w" data-sizes="(max-width: 800px) 100vw, 800px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/2025-10-23-16-22-01-e038724b4b2b091ce38af2aef53bc906-055ed.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 119.09604519774012%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAYCAIAAAB1KUohAAAACXBIWXMAAAsSAAALEgHS3X78AAACQElEQVQ4y51U75OTMBDlP1ex7TnV8aanp//R+fE+6gfHTvlRIAkpkEBIIOAL6MzVoZ71DbNkIG/fZje73ufb7e7u9v7j7sPu/af7Oyzevb1Zr19t3ONvNv7Nxtn12l+t/O12g+fN6qXvv/Bf+174fR8nKcvzoiyLsiqrClbKulGqUe1sZV3zQhRCadO12jRNk6RZmlGPPT4mhJRFcTqdKocSC6UU55wxxidkWRbHMWM0TdI8Z8W0mfPcA8Pa3pgO6Pt+HMcaOpwTQpIkmckce4sCb7iglM5kwMMnFzBQFogHZCkEpIQQ+CKLoqtrU0sDKyVE7DBAo7e9tdYjhOY5p4QiyEoIR5YSZDnhlOd921qtB2tBgh2fwIN6WVawiLYz3TAMSA9iAxO+jTG9NrbrxiVAmUDZ6XMO/qyM04oJSPdgNDwuk13KKSUTGGVN4/IcRRHyDl/B4aCkHC/ASx2ZwQXIyBBEQDsej7DISxiFtVLYtyjtTQX6BTvlAwscFbJYwIuoLytf+jGTwzDkJ94qBXdXk3H4OIqCIEA9rybHcQTx/X6fkmz4dzIKhgsbBg5ZllaiGq8lZxPqplks9d/Cdq2XJJRRrO35xXyejFLP+v9TKq01xNFVdqlOz5CFlFopkPvpkl1BbtGJS+c8IyON9hx976YKTmu07ib8sWGiuJHgYQa4oYFB8hv44losy4hrFjLPtvIJMJEwFx8evni4PWhJ8Kfph1kisBstyhzyefrBzn8xNppafDvkX3+kcRT8BP+TVbxbS3rAAAAAAElFTkSuQmCC\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="2025 10 23 16 22 01" title="" data-src="/static/2025-10-23-16-22-01-e038724b4b2b091ce38af2aef53bc906-fee1c.png" data-srcset="/static/2025-10-23-16-22-01-e038724b4b2b091ce38af2aef53bc906-a67b7.png 200w,\n/static/2025-10-23-16-22-01-e038724b4b2b091ce38af2aef53bc906-0b187.png 400w,\n/static/2025-10-23-16-22-01-e038724b4b2b091ce38af2aef53bc906-fee1c.png 800w,\n/static/2025-10-23-16-22-01-e038724b4b2b091ce38af2aef53bc906-055ed.png 885w" data-sizes="(max-width: 800px) 100vw, 800px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n</li>\n</ol>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="41265758608755876000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`import { \\$, state, setState, action } from \'./model\';\n\nconst JobDetail = ({ jobId }) => {\n   // const { queryJobInfo } = action.useLoading();\n   // console.log(\'useLoading\', queryJobInfo) // 请求的状态\n\n   const handleEvent = () => {\n      console.log(\'state.jobId\', state.jobInfo); // 事件触发的可以直接通过 state 拿到最新值\n   };\n\n   return (\n      <div className={styles.container}>\n         <Button\n            onClick={() =>\n               setState(async (draft) => {\n                  const data = await action.eActions.queryJobInfo({ jobId });\n                  console.log(\'data\', data);\n               })\n            }\n         >\n            {\\$(state.failedFNGPMetrics.total)} // 用 \\$ 或者 useAtom 取到\n         </Button>\n      </div>\n   );\n};\n\nexport default JobDetail;`, `41265758608755876000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="jsx"\n              >\n                <span class="gatsby-code-button-language">jsx</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx"><span class="token keyword">import</span> <span class="token punctuation">{</span> $<span class="token punctuation">,</span> state<span class="token punctuation">,</span> setState<span class="token punctuation">,</span> action <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">\'./model\'</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> <span class="token function-variable function">JobDetail</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> jobId <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n   <span class="token comment">// const { queryJobInfo } = action.useLoading();</span>\n   <span class="token comment">// console.log(\'useLoading\', queryJobInfo) // 请求的状态</span>\n\n   <span class="token keyword">const</span> <span class="token function-variable function">handleEvent</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">\'state.jobId\'</span><span class="token punctuation">,</span> state<span class="token punctuation">.</span>jobInfo<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 事件触发的可以直接通过 state 拿到最新值</span>\n   <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n   <span class="token keyword">return</span> <span class="token punctuation">(</span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>styles<span class="token punctuation">.</span>container<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">\n         </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Button</span></span>\n            <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span>\n               <span class="token function">setState</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">draft</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n                  <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">await</span> action<span class="token punctuation">.</span>eActions<span class="token punctuation">.</span><span class="token function">queryJobInfo</span><span class="token punctuation">(</span><span class="token punctuation">{</span> jobId <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n                  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">\'data\'</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>\n               <span class="token punctuation">}</span><span class="token punctuation">)</span>\n            <span class="token punctuation">}</span></span>\n         <span class="token punctuation">></span></span><span class="token plain-text">\n            </span><span class="token punctuation">{</span><span class="token function">$</span><span class="token punctuation">(</span>state<span class="token punctuation">.</span>failedFNGPMetrics<span class="token punctuation">.</span>total<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text"> // 用 $ 或者 useAtom 取到\n         </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Button</span></span><span class="token punctuation">></span></span><span class="token plain-text">\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n   <span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n<span class="token keyword">export</span> <span class="token keyword">default</span> JobDetail<span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h1 id="参考链接"><a href="#%E5%8F%82%E8%80%83%E9%93%BE%E6%8E%A5" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>参考链接</h1>\n<ol>\n<li><a href="https://juejin.cn/post/7172509907403407391" target="_blank" rel="nofollow noreferrer noopener">全都要!一文带你全面体验八种状态管理库</a></li>\n<li><a href="https://juejin.cn/post/7322840234365059084" target="_blank" rel="nofollow noreferrer noopener">你踩过 react 生态的 signal 坑吗?且看 helux 如何应对</a></li>\n<li><a href="https://juejin.cn/post/7399276698619035657" target="_blank" rel="nofollow noreferrer noopener">Redux、Zustand、Mobx、Valtio、Recoil、jotai、XState 状态管理怎么选</a></li>\n</ol>',
id:"/home/runner/work/GatsbyBlog/GatsbyBlog/blog/React 全局状态库选型/index.md absPath of file >>> MarkdownRemark",timeToRead:10,frontmatter:{date:"2025-10-22 18:34:06",path:"/react-global-state-selection/",tags:"前端, React, 状态库, 预研",title:"React 全局状态库选型",draft:null}}],length:1,tag:"状态库",pagesSum:1,page:1}}}});