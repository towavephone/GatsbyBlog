webpackJsonp([0xf80a150ac436],{1557:function(n,s){n.exports={data:{site:{siteMetadata:{title:"女王控的博客",description:'前端工程师，黑猫女王控，欢迎勾搭，技术相关<a href="https://github.com/towavephone" target="_blank">@towavephone</a>，QQ闲聊<a href="tencent://AddContact/?fromId=45&fromSubId=1&subcmd=all&uin=634407147&website=www.oicqzone.com">@towave</a>，bili关注<a href="https://space.bilibili.com/11507708#/" target="_blank">@towave</a>',siteUrl:"https://blog.towavephone.com"}}},pathContext:{posts:[{excerpt:"翻译转载： Webpack 3, Dynamic Imports, Code Splitting, and Long Term Caching… Made Easy.  在与 Webpack 1.x 升级到 3.x（比我想承认的更长的时间）后，突然点击了一下。看到揭开的奥秘： TL：DR 示例应用程序回购 让我们通过这些配置文件，并揭秘发生了什么事情。 我总是从文件开始查看新的代码库的 package.json。这使我能够在代码中看到它们之前了解依赖关系。 在我们的应用程序中，react…",html:'<p>翻译转载：<a href="https://blog.cloudboost.io/webpack-3-dynamic-imports-code-splitting-and-long-term-caching-made-easy-1892981e0ae7" target="_blank" rel="nofollow noreferrer noopener">Webpack 3, Dynamic Imports, Code Splitting, and Long Term Caching… Made Easy.</a> 在与 Webpack 1.x 升级到 3.x（比我想承认的更长的时间）后，突然点击了一下。看到揭开的奥秘：</p>\n<div>\n          <div\n            class="gatsby-resp-iframe-wrapper"\n            style="padding-bottom: 46.25%; position: relative; height: 0; overflow: hidden;margin-bottom: 2em"\n          >\n            <div align="center"><iframe src="https://giphy.com/embed/xUOxeX2W00FmKjNsUo" frameborder="0" class="giphy-embed" allowfullscreen style="\n            position: absolute;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n          "></iframe><p><a href="https://giphy.com/gifs/code-splitting-dynamic-imports-webpack-3-xUOxeX2W00FmKjNsUo">via GIPHY</a></p></div>\n&#x6F14;&#x793A;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x52A8;&#x6001;&#x52A0;&#x8F7D;&#x591A;&#x4E2A;&#x8DEF;&#x7EBF;&#x3002;&#x8BF7;&#x6CE8;&#x610F;&#x7F16;&#x8F91;&#x201C;&#x9875;&#x9762;2&#x201D;&#x540E;&#x7684;200&#x54CD;&#x5E94;&#xFF0C;&#x800C;&#x672A;&#x66F4;&#x6539;&#x7684;&#x6587;&#x4EF6;&#x5219;&#x4E3A;304&#x3002;\n          </div>\n          </div>\n<p>TL：DR 示例应用程序回购</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="23270615437896590000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// webpack.config.js\nconst webpack = require(\'webpack\');\nconst path = require(\'path\');\nconst HtmlWebpackPlugin = require(\'html-webpack-plugin\');\n\nconst APP_DIR = path.resolve(__dirname, \'./src\');\nconst MODULES_DIR = path.resolve(__dirname, \'./node_modules\');\n\nconst package = require(\'./package.json\');\n\nmodule.exports = {\n  devServer: {\n    historyApiFallback: true\n  },\n  entry: {\n    app: APP_DIR + \'/index.js\',\n    vendor: Object.keys(package.dependencies)\n  },\n  output: {\n    publicPath: \'/\',\n    chunkFilename: \'[name].[chunkhash].js\',\n    filename: \'[name].[chunkhash].js\'\n  },\n  resolve: {\n    extensions: [\'.js\', \'.jsx\'],\n    modules: [APP_DIR, MODULES_DIR]\n  },\n  module: {\n    rules: [\n      {\n        test: /\\.jsx?\\$/,\n        exclude: /node_modules/,\n        include: APP_DIR,\n        use: {\n          loader: \'babel-loader\'\n        }\n      }\n    ]\n  },\n  plugins: [\n    new HtmlWebpackPlugin({\n      title: \'Caching and Code Splitting\',\n      template: APP_DIR + \'/index.html\'\n    }),\n    new webpack.HashedModuleIdsPlugin(),\n    new webpack.optimize.CommonsChunkPlugin({\n      name: \'vendor\',\n      filename: \'vendor.[chunkhash].js\'\n    }),\n    new webpack.optimize.CommonsChunkPlugin({\n      name: \'manifest\'\n    })\n  ]\n};`, `23270615437896590000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="js"\n              >\n                <span class="gatsby-code-button-language">js</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="js"><pre style="counter-reset: linenumber NaN" class="language-js line-numbers"><code class="language-js"><span class="token comment">// webpack.config.js</span>\n<span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'webpack\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'path\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> HtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'html-webpack-plugin\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> <span class="token constant">APP_DIR</span> <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">\'./src\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> <span class="token constant">MODULES_DIR</span> <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">\'./node_modules\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> <span class="token keyword">package</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'./package.json\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\nmodule<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  devServer<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    historyApiFallback<span class="token punctuation">:</span> <span class="token boolean">true</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  entry<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    app<span class="token punctuation">:</span> <span class="token constant">APP_DIR</span> <span class="token operator">+</span> <span class="token string">\'/index.js\'</span><span class="token punctuation">,</span>\n    vendor<span class="token punctuation">:</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token keyword">package</span><span class="token punctuation">.</span>dependencies<span class="token punctuation">)</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  output<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    publicPath<span class="token punctuation">:</span> <span class="token string">\'/\'</span><span class="token punctuation">,</span>\n    chunkFilename<span class="token punctuation">:</span> <span class="token string">\'[name].[chunkhash].js\'</span><span class="token punctuation">,</span>\n    filename<span class="token punctuation">:</span> <span class="token string">\'[name].[chunkhash].js\'</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  resolve<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    extensions<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">\'.js\'</span><span class="token punctuation">,</span> <span class="token string">\'.jsx\'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n    modules<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token constant">APP_DIR</span><span class="token punctuation">,</span> <span class="token constant">MODULES_DIR</span><span class="token punctuation">]</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  module<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>\n      <span class="token punctuation">{</span>\n        test<span class="token punctuation">:</span> <span class="token regex">/\\.jsx?$/</span><span class="token punctuation">,</span>\n        exclude<span class="token punctuation">:</span> <span class="token regex">/node_modules/</span><span class="token punctuation">,</span>\n        include<span class="token punctuation">:</span> <span class="token constant">APP_DIR</span><span class="token punctuation">,</span>\n        use<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n          loader<span class="token punctuation">:</span> <span class="token string">\'babel-loader\'</span>\n        <span class="token punctuation">}</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">]</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>\n    <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n      title<span class="token punctuation">:</span> <span class="token string">\'Caching and Code Splitting\'</span><span class="token punctuation">,</span>\n      template<span class="token punctuation">:</span> <span class="token constant">APP_DIR</span> <span class="token operator">+</span> <span class="token string">\'/index.html\'</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>HashedModuleIdsPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>optimize<span class="token punctuation">.</span>CommonsChunkPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n      name<span class="token punctuation">:</span> <span class="token string">\'vendor\'</span><span class="token punctuation">,</span>\n      filename<span class="token punctuation">:</span> <span class="token string">\'vendor.[chunkhash].js\'</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>optimize<span class="token punctuation">.</span>CommonsChunkPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n      name<span class="token punctuation">:</span> <span class="token string">\'manifest\'</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span>\n  <span class="token punctuation">]</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="40720797966860320000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// .babelrc\n{\n  &quot;presets&quot;: [\n    &quot;react&quot;,\n    [&quot;env&quot;, {\n      &quot;targets&quot;: {\n        &quot;browsers&quot;: [&quot;last 2 versions&quot;]\n      }\n    }],\n    &quot;stage-0&quot;\n  ],\n  &quot;comments&quot;: true\n}`, `40720797966860320000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="javaScript"\n              >\n                <span class="gatsby-code-button-language">javaScript</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="javascript"><pre style="counter-reset: linenumber NaN" class="language-javascript line-numbers"><code class="language-javascript"><span class="token comment">// .babelrc</span>\n<span class="token punctuation">{</span>\n  <span class="token string">"presets"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>\n    <span class="token string">"react"</span><span class="token punctuation">,</span>\n    <span class="token punctuation">[</span><span class="token string">"env"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>\n      <span class="token string">"targets"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>\n        <span class="token string">"browsers"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"last 2 versions"</span><span class="token punctuation">]</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n    <span class="token string">"stage-0"</span>\n  <span class="token punctuation">]</span><span class="token punctuation">,</span>\n  <span class="token string">"comments"</span><span class="token punctuation">:</span> <span class="token boolean">true</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="16226170257938954000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`{\n  &quot;name&quot;: &quot;webpack-cs-ltc&quot;,\n  &quot;version&quot;: &quot;1.0.0&quot;,\n  &quot;description&quot;: &quot;A simple boilerplate for Webpack 3, dynamic imports, code splitting, and long term caching.&quot;,\n  &quot;main&quot;: &quot;index.js&quot;,\n  &quot;scripts&quot;: {\n    &quot;start&quot;: &quot;webpack --config webpack.config.js&quot;,\n    &quot;dev-server&quot;: &quot;webpack-dev-server&quot;,\n    &quot;test&quot;: &quot;echo \\&quot;Error: no test specified\\&quot; && exit 1&quot;\n  },\n  &quot;author&quot;: &quot;Geoff Miller&quot;,\n  &quot;license&quot;: &quot;MIT&quot;,\n  &quot;dependencies&quot;: {\n    &quot;react&quot;: &quot;^16.2.0&quot;,\n    &quot;react-dom&quot;: &quot;^16.2.0&quot;,\n    &quot;react-loadable&quot;: &quot;^5.3.1&quot;,\n    &quot;react-router-dom&quot;: &quot;^4.2.2&quot;\n  },\n  &quot;devDependencies&quot;: {\n    &quot;babel-core&quot;: &quot;^6.26.0&quot;,\n    &quot;babel-loader&quot;: &quot;^7.1.2&quot;,\n    &quot;babel-preset-env&quot;: &quot;^1.6.1&quot;,\n    &quot;babel-preset-react&quot;: &quot;^6.24.1&quot;,\n    &quot;babel-preset-stage-0&quot;: &quot;^6.24.1&quot;,\n    &quot;html-webpack-plugin&quot;: &quot;^2.30.1&quot;,\n    &quot;webpack&quot;: &quot;^3.10.0&quot;,\n    &quot;webpack-dev-server&quot;: &quot;^2.9.7&quot;\n  }\n}`, `16226170257938954000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="js"\n              >\n                <span class="gatsby-code-button-language">js</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="js"><pre style="counter-reset: linenumber NaN" class="language-js line-numbers"><code class="language-js"><span class="token punctuation">{</span>\n  <span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"webpack-cs-ltc"</span><span class="token punctuation">,</span>\n  <span class="token string">"version"</span><span class="token punctuation">:</span> <span class="token string">"1.0.0"</span><span class="token punctuation">,</span>\n  <span class="token string">"description"</span><span class="token punctuation">:</span> <span class="token string">"A simple boilerplate for Webpack 3, dynamic imports, code splitting, and long term caching."</span><span class="token punctuation">,</span>\n  <span class="token string">"main"</span><span class="token punctuation">:</span> <span class="token string">"index.js"</span><span class="token punctuation">,</span>\n  <span class="token string">"scripts"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    <span class="token string">"start"</span><span class="token punctuation">:</span> <span class="token string">"webpack --config webpack.config.js"</span><span class="token punctuation">,</span>\n    <span class="token string">"dev-server"</span><span class="token punctuation">:</span> <span class="token string">"webpack-dev-server"</span><span class="token punctuation">,</span>\n    <span class="token string">"test"</span><span class="token punctuation">:</span> <span class="token string">"echo \\"Error: no test specified\\" &amp;&amp; exit 1"</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token string">"author"</span><span class="token punctuation">:</span> <span class="token string">"Geoff Miller"</span><span class="token punctuation">,</span>\n  <span class="token string">"license"</span><span class="token punctuation">:</span> <span class="token string">"MIT"</span><span class="token punctuation">,</span>\n  <span class="token string">"dependencies"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    <span class="token string">"react"</span><span class="token punctuation">:</span> <span class="token string">"^16.2.0"</span><span class="token punctuation">,</span>\n    <span class="token string">"react-dom"</span><span class="token punctuation">:</span> <span class="token string">"^16.2.0"</span><span class="token punctuation">,</span>\n    <span class="token string">"react-loadable"</span><span class="token punctuation">:</span> <span class="token string">"^5.3.1"</span><span class="token punctuation">,</span>\n    <span class="token string">"react-router-dom"</span><span class="token punctuation">:</span> <span class="token string">"^4.2.2"</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token string">"devDependencies"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    <span class="token string">"babel-core"</span><span class="token punctuation">:</span> <span class="token string">"^6.26.0"</span><span class="token punctuation">,</span>\n    <span class="token string">"babel-loader"</span><span class="token punctuation">:</span> <span class="token string">"^7.1.2"</span><span class="token punctuation">,</span>\n    <span class="token string">"babel-preset-env"</span><span class="token punctuation">:</span> <span class="token string">"^1.6.1"</span><span class="token punctuation">,</span>\n    <span class="token string">"babel-preset-react"</span><span class="token punctuation">:</span> <span class="token string">"^6.24.1"</span><span class="token punctuation">,</span>\n    <span class="token string">"babel-preset-stage-0"</span><span class="token punctuation">:</span> <span class="token string">"^6.24.1"</span><span class="token punctuation">,</span>\n    <span class="token string">"html-webpack-plugin"</span><span class="token punctuation">:</span> <span class="token string">"^2.30.1"</span><span class="token punctuation">,</span>\n    <span class="token string">"webpack"</span><span class="token punctuation">:</span> <span class="token string">"^3.10.0"</span><span class="token punctuation">,</span>\n    <span class="token string">"webpack-dev-server"</span><span class="token punctuation">:</span> <span class="token string">"^2.9.7"</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>让我们通过这些配置文件，并揭秘发生了什么事情。</p>\n<p>我总是从文件开始查看新的代码库的 package.json。这使我能够在代码中看到它们之前了解依赖关系。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="83820997740846680000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// package.json\n&quot;dependencies&quot;: {\n    &quot;react&quot;: &quot;^16.2.0&quot;,\n    &quot;react-dom&quot;: &quot;^16.2.0&quot;,\n    &quot;react-loadable&quot;: &quot;^5.3.1&quot;, <-- dynamic imports for react\n    &quot;react-router-dom&quot;: &quot;^4.2.2&quot;\n  },`, `83820997740846680000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="js"\n              >\n                <span class="gatsby-code-button-language">js</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="js"><pre style="counter-reset: linenumber NaN" class="language-js line-numbers"><code class="language-js"><span class="token comment">// package.json</span>\n<span class="token string">"dependencies"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    <span class="token string">"react"</span><span class="token punctuation">:</span> <span class="token string">"^16.2.0"</span><span class="token punctuation">,</span>\n    <span class="token string">"react-dom"</span><span class="token punctuation">:</span> <span class="token string">"^16.2.0"</span><span class="token punctuation">,</span>\n    <span class="token string">"react-loadable"</span><span class="token punctuation">:</span> <span class="token string">"^5.3.1"</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token operator">--</span> dynamic imports <span class="token keyword">for</span> react\n    <span class="token string">"react-router-dom"</span><span class="token punctuation">:</span> <span class="token string">"^4.2.2"</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>在我们的应用程序中，react-loadable 将完成所有繁重的动态导入工作。这是一个小包装，减少样板和增加一些方便的功能。所以，而不是必须为每个动态导入执行此操作：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="88218714646128310000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class MyComponent extends React.Component {\n  state = {\n    Bar: null\n  };\n\n  componentWillMount() {\n    import(\'./components/Bar\').then((Bar) => {\n      this.setState({ Bar });\n    });\n  }\n\n  render() {\n    let { Bar } = this.state;\n    if (!Bar) {\n      return <div>Loading...</div>;\n    } else {\n      return <Bar />;\n    }\n  }\n}`, `88218714646128310000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="js"\n              >\n                <span class="gatsby-code-button-language">js</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="js"><pre style="counter-reset: linenumber NaN" class="language-js line-numbers"><code class="language-js"><span class="token keyword">class</span> <span class="token class-name">MyComponent</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>\n  state <span class="token operator">=</span> <span class="token punctuation">{</span>\n    Bar<span class="token punctuation">:</span> <span class="token keyword">null</span>\n  <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n  <span class="token function">componentWillMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">\'./components/Bar\'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">Bar</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> Bar <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n\n  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token punctuation">{</span> Bar <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">;</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>Bar<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">></span>Loading<span class="token operator">...</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n      <span class="token keyword">return</span> <span class="token operator">&lt;</span>Bar <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>我们现在可以做到：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="40230896024599190000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`import Loadable from \'react-loadable\';\n\nconst LoadableBar = Loadable({\n  loader: () => import(\'./components/Bar\'),\n  loading() {\n    return <div>Loading...</div>;\n  }\n});\n\nclass MyComponent extends React.Component {\n  render() {\n    return <LoadableBar />;\n  }\n}`, `40230896024599190000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="js"\n              >\n                <span class="gatsby-code-button-language">js</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="js"><pre style="counter-reset: linenumber NaN" class="language-js line-numbers"><code class="language-js"><span class="token keyword">import</span> Loadable <span class="token keyword">from</span> <span class="token string">\'react-loadable\'</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> LoadableBar <span class="token operator">=</span> <span class="token function">Loadable</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  <span class="token function-variable function">loader</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">\'./components/Bar\'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n  <span class="token function">loading</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">></span>Loading<span class="token operator">...</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">class</span> <span class="token class-name">MyComponent</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>\n  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">return</span> <span class="token operator">&lt;</span>LoadableBar <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>好的，到 devDependencies：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="24106701993546050000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// package.json\n&quot;devDependencies&quot;: {\n    &quot;babel-core&quot;: &quot;^6.26.0&quot;,\n    &quot;babel-loader&quot;: &quot;^7.1.2&quot;,\n    &quot;babel-preset-env&quot;: &quot;^1.6.1&quot;,\n    &quot;babel-preset-react&quot;: &quot;^6.24.1&quot;,\n    &quot;babel-preset-stage-0&quot;: &quot;^6.24.1&quot;, <-- needed for dynamic import\n    &quot;html-webpack-plugin&quot;: &quot;^2.30.1&quot;,\n    &quot;webpack&quot;: &quot;^3.10.0&quot;,\n    &quot;webpack-dev-server&quot;: &quot;^2.9.7&quot;\n  }`, `24106701993546050000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="js"\n              >\n                <span class="gatsby-code-button-language">js</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="js"><pre style="counter-reset: linenumber NaN" class="language-js line-numbers"><code class="language-js"><span class="token comment">// package.json</span>\n<span class="token string">"devDependencies"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    <span class="token string">"babel-core"</span><span class="token punctuation">:</span> <span class="token string">"^6.26.0"</span><span class="token punctuation">,</span>\n    <span class="token string">"babel-loader"</span><span class="token punctuation">:</span> <span class="token string">"^7.1.2"</span><span class="token punctuation">,</span>\n    <span class="token string">"babel-preset-env"</span><span class="token punctuation">:</span> <span class="token string">"^1.6.1"</span><span class="token punctuation">,</span>\n    <span class="token string">"babel-preset-react"</span><span class="token punctuation">:</span> <span class="token string">"^6.24.1"</span><span class="token punctuation">,</span>\n    <span class="token string">"babel-preset-stage-0"</span><span class="token punctuation">:</span> <span class="token string">"^6.24.1"</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token operator">--</span> needed <span class="token keyword">for</span> dynamic <span class="token keyword">import</span>\n    <span class="token string">"html-webpack-plugin"</span><span class="token punctuation">:</span> <span class="token string">"^2.30.1"</span><span class="token punctuation">,</span>\n    <span class="token string">"webpack"</span><span class="token punctuation">:</span> <span class="token string">"^3.10.0"</span><span class="token punctuation">,</span>\n    <span class="token string">"webpack-dev-server"</span><span class="token punctuation">:</span> <span class="token string">"^2.9.7"</span>\n  <span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这里唯一不同寻常的软件包是 babel-preset-stage-0。动态导入是第三阶段的建议。如果你想你可以使用 babel-preset-stage-3，但 babel-preset-stage-0 将包括所有的阶段 1，阶段 2 和阶段 3。根据需要将其配置为您的代码库/喜好，你需要的是动态导入功能的阶段 3。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="54046568632650826000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// .babelrc\n{\n  &quot;presets&quot;: [\n    &quot;react&quot;,\n    [&quot;env&quot;, {\n      &quot;targets&quot;: {\n        &quot;browsers&quot;: [&quot;last 2 versions&quot;]\n      }\n    }],\n    &quot;stage-0&quot; <-- no big surprise here\n  ],\n  &quot;comments&quot;: true\n}`, `54046568632650826000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="js"\n              >\n                <span class="gatsby-code-button-language">js</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="js"><pre style="counter-reset: linenumber NaN" class="language-js line-numbers"><code class="language-js"><span class="token comment">// .babelrc</span>\n<span class="token punctuation">{</span>\n  <span class="token string">"presets"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>\n    <span class="token string">"react"</span><span class="token punctuation">,</span>\n    <span class="token punctuation">[</span><span class="token string">"env"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>\n      <span class="token string">"targets"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>\n        <span class="token string">"browsers"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"last 2 versions"</span><span class="token punctuation">]</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n    <span class="token string">"stage-0"</span> <span class="token operator">&lt;</span><span class="token operator">--</span> no big surprise here\n  <span class="token punctuation">]</span><span class="token punctuation">,</span>\n  <span class="token string">"comments"</span><span class="token punctuation">:</span> <span class="token boolean">true</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>确保包含 stage-0 在你的 babel 预设中。有些事情要注意，有几个动态的输入插件 webpack/babel 在那。在这个用例中你不需要使用 Webpack 3（前端只有 react）。如果我错了希望有人能纠正我。请注意”comments”: true 设置。这将帮助我们使用 Webpack 的神奇评论来命名我们的动态导入文件。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="84696394681777520000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// webpack.config.js\n...\nentry: {\n    app: APP_DIR +\'/index.js\',\n    vendor: Object.keys(package.dependencies)\n},\noutput: {\n    publicPath: \'/\',\n    chunkFilename: \'[name].[chunkhash].js\',\n    filename: \'[name].[chunkhash].js\'\n  },\n...\nplugins: [\n    ...\n    new webpack.HashedModuleIdsPlugin(),\n    new webpack.optimize.CommonsChunkPlugin({\n      name:\'vendor\',\n      filename: \'vendor.[chunkhash].js\'\n    }),\n    new webpack.optimize.CommonsChunkPlugin({\n      name:\'manifest\'\n    })\n  ]\n...`, `84696394681777520000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="js"\n              >\n                <span class="gatsby-code-button-language">js</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="js"><pre style="counter-reset: linenumber NaN" class="language-js line-numbers"><code class="language-js"><span class="token comment">// webpack.config.js</span>\n<span class="token operator">...</span>\nentry<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    app<span class="token punctuation">:</span> <span class="token constant">APP_DIR</span> <span class="token operator">+</span><span class="token string">\'/index.js\'</span><span class="token punctuation">,</span>\n    vendor<span class="token punctuation">:</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token keyword">package</span><span class="token punctuation">.</span>dependencies<span class="token punctuation">)</span>\n<span class="token punctuation">}</span><span class="token punctuation">,</span>\noutput<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    publicPath<span class="token punctuation">:</span> <span class="token string">\'/\'</span><span class="token punctuation">,</span>\n    chunkFilename<span class="token punctuation">:</span> <span class="token string">\'[name].[chunkhash].js\'</span><span class="token punctuation">,</span>\n    filename<span class="token punctuation">:</span> <span class="token string">\'[name].[chunkhash].js\'</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n<span class="token operator">...</span>\nplugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>\n    <span class="token operator">...</span>\n    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>HashedModuleIdsPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>optimize<span class="token punctuation">.</span>CommonsChunkPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n      name<span class="token punctuation">:</span><span class="token string">\'vendor\'</span><span class="token punctuation">,</span>\n      filename<span class="token punctuation">:</span> <span class="token string">\'vendor.[chunkhash].js\'</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>optimize<span class="token punctuation">.</span>CommonsChunkPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n      name<span class="token punctuation">:</span><span class="token string">\'manifest\'</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span>\n  <span class="token punctuation">]</span>\n<span class="token operator">...</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这就是“普通”React webpack 安装程序之外所需要的。这里有一些关于这个配置的更多细节。定义您的输入分割点。在我们的例子中，我们需要一个 app.x.js 和一个 vendor.x.js 文件：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="54301044004942864000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`entry: {\n  app: APP_DIR +\'/index.js\',\n  vendor: Object.keys(package.dependencies)\n},`, `54301044004942864000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="js"\n              >\n                <span class="gatsby-code-button-language">js</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="js"><pre style="counter-reset: linenumber NaN" class="language-js line-numbers"><code class="language-js">entry<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n  app<span class="token punctuation">:</span> <span class="token constant">APP_DIR</span> <span class="token operator">+</span><span class="token string">\'/index.js\'</span><span class="token punctuation">,</span>\n  vendor<span class="token punctuation">:</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token keyword">package</span><span class="token punctuation">.</span>dependencies<span class="token punctuation">)</span>\n<span class="token punctuation">}</span><span class="token punctuation">,</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>[chunkhash]在输出中使用您的文件名 hash：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="56159211374040100000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`output: {\n  publicPath: \'/\',\n  chunkFilename: \'[name].[chunkhash].js\',\n  filename: \'[name].[chunkhash].js\'\n},`, `56159211374040100000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="js"\n              >\n                <span class="gatsby-code-button-language">js</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="js"><pre style="counter-reset: linenumber NaN" class="language-js line-numbers"><code class="language-js">output<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n  publicPath<span class="token punctuation">:</span> <span class="token string">\'/\'</span><span class="token punctuation">,</span>\n  chunkFilename<span class="token punctuation">:</span> <span class="token string">\'[name].[chunkhash].js\'</span><span class="token punctuation">,</span>\n  filename<span class="token punctuation">:</span> <span class="token string">\'[name].[chunkhash].js\'</span>\n<span class="token punctuation">}</span><span class="token punctuation">,</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>在插件中，使用：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="51648789365929490000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`new webpack.HashedModuleIdsPlugin();`, `51648789365929490000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="js"\n              >\n                <span class="gatsby-code-button-language">js</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="js"><pre style="counter-reset: linenumber NaN" class="language-js line-numbers"><code class="language-js"><span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>HashedModuleIdsPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>\n<p>那么你的 CommonsChunkPlugin 需要再次 chunkhash：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="62366942252310454000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`new webpack.optimize.CommonsChunkPlugin({\n  name:\'vendor\',\n  filename: \'vendor.[chunkhash].js\'\n}),`, `62366942252310454000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="js"\n              >\n                <span class="gatsby-code-button-language">js</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="js"><pre style="counter-reset: linenumber NaN" class="language-js line-numbers"><code class="language-js"><span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>optimize<span class="token punctuation">.</span>CommonsChunkPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  name<span class="token punctuation">:</span><span class="token string">\'vendor\'</span><span class="token punctuation">,</span>\n  filename<span class="token punctuation">:</span> <span class="token string">\'vendor.[chunkhash].js\'</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>最后，但一个容易忽略的细节：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="52108768661792506000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`new webpack.optimize.CommonsChunkPlugin({\n  name: \'manifest\'\n});`, `52108768661792506000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="js"\n              >\n                <span class="gatsby-code-button-language">js</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="js"><pre style="counter-reset: linenumber NaN" class="language-js line-numbers"><code class="language-js"><span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>optimize<span class="token punctuation">.</span>CommonsChunkPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  name<span class="token punctuation">:</span> <span class="token string">\'manifest\'</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<p>深入了解为什么清单文件在这里很重要。随意跳到 React 代码的下一节。没有 manifest chunk 块，Webpack 将产生这些文件：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="6461201986751374000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`pageOne.58e60ef81ba97426a00d.js 679 bytes\n   home.b65cb7fd922ea7126e95.js 671 bytes\n    app.3c3fcb4d6bcba55f3bb7.js 3.44 kB\nvendor.da901bd61614a0e9f2fe.js 1.25 MB\n                     index.html 397 bytes`, `6461201986751374000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="js"\n              >\n                <span class="gatsby-code-button-language">js</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="js"><pre style="counter-reset: linenumber NaN" class="language-js line-numbers"><code class="language-js">pageOne<span class="token punctuation">.</span><span class="token number">58e60</span>ef81ba97426a00d<span class="token punctuation">.</span>js <span class="token number">679</span> bytes\n   home<span class="token punctuation">.</span>b65cb7fd922ea7126e95<span class="token punctuation">.</span>js <span class="token number">671</span> bytes\n    app<span class="token punctuation">.</span><span class="token number">3</span>c3fcb4d6bcba55f3bb7<span class="token punctuation">.</span>js <span class="token number">3.44</span> kB\nvendor<span class="token punctuation">.</span>da901bd61614a0e9f2fe<span class="token punctuation">.</span>js <span class="token number">1.25</span> <span class="token constant">MB</span>\n                     index<span class="token punctuation">.</span>html <span class="token number">397</span> bytes</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>你可能会想：“太棒了，它正在工作！” 你去做你的事情，改变 home 组件，Webpack 建立你的文件，然后你会伤心的。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="10525746147398762000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`  home.5a5f308381fc5670d102.js  674 bytes <--new hash expected\nvendor.c509e728faa4374eee45.js  1.25 MB <--new hash not expected\n                    index.html  397 bytes`, `10525746147398762000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="js"\n              >\n                <span class="gatsby-code-button-language">js</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="js"><pre style="counter-reset: linenumber NaN" class="language-js line-numbers"><code class="language-js">  home<span class="token punctuation">.</span><span class="token number">5</span>a5f308381fc5670d102<span class="token punctuation">.</span>js  <span class="token number">674</span> bytes <span class="token operator">&lt;</span><span class="token operator">--</span><span class="token keyword">new</span> <span class="token class-name">hash</span> expected\nvendor<span class="token punctuation">.</span>c509e728faa4374eee45<span class="token punctuation">.</span>js  <span class="token number">1.25</span> <span class="token constant">MB</span> <span class="token operator">&lt;</span><span class="token operator">--</span><span class="token keyword">new</span> <span class="token class-name">hash</span> not expected\n                    index<span class="token punctuation">.</span>html  <span class="token number">397</span> bytes</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<p>是什么导致了？你没有给你的 package.json 改变/添加任何东西 。Webpack 文档简要地解释了这里发生了什么。这是非常高的水平，但我想知道什么是实际上改变的代码，以保证生成一个新的哈希 vendors.x.js 文件。</p>\n<p>如果你看看里面的生成，vendor.x.js 你会看到：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="97887995140210130000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`/******/ script.src =\n  __webpack_require__.p +\n  \'\' +\n  ({ \'0\': \'pageOne\', \'1\': \'home\', \'2\': \'app\' }[chunkId] || chunkId) +\n  \'.\' +\n  { \'0\': \'58e60ef81ba97426a00d\', \'1\': \'5a5f308381fc5670d102\', \'2\': \'3c3fcb4d6bcba55f3bb7\' }[chunkId] +\n  \'.js\';`, `97887995140210130000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="js"\n              >\n                <span class="gatsby-code-button-language">js</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="js"><pre style="counter-reset: linenumber NaN" class="language-js line-numbers"><code class="language-js"><span class="token comment">/******/</span> script<span class="token punctuation">.</span>src <span class="token operator">=</span>\n  __webpack_require__<span class="token punctuation">.</span>p <span class="token operator">+</span>\n  <span class="token string">\'\'</span> <span class="token operator">+</span>\n  <span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string">\'0\'</span><span class="token punctuation">:</span> <span class="token string">\'pageOne\'</span><span class="token punctuation">,</span> <span class="token string">\'1\'</span><span class="token punctuation">:</span> <span class="token string">\'home\'</span><span class="token punctuation">,</span> <span class="token string">\'2\'</span><span class="token punctuation">:</span> <span class="token string">\'app\'</span> <span class="token punctuation">}</span><span class="token punctuation">[</span>chunkId<span class="token punctuation">]</span> <span class="token operator">||</span> chunkId<span class="token punctuation">)</span> <span class="token operator">+</span>\n  <span class="token string">\'.\'</span> <span class="token operator">+</span>\n  <span class="token punctuation">{</span> <span class="token string">\'0\'</span><span class="token punctuation">:</span> <span class="token string">\'58e60ef81ba97426a00d\'</span><span class="token punctuation">,</span> <span class="token string">\'1\'</span><span class="token punctuation">:</span> <span class="token string">\'5a5f308381fc5670d102\'</span><span class="token punctuation">,</span> <span class="token string">\'2\'</span><span class="token punctuation">:</span> <span class="token string">\'3c3fcb4d6bcba55f3bb7\'</span> <span class="token punctuation">}</span><span class="token punctuation">[</span>chunkId<span class="token punctuation">]</span> <span class="token operator">+</span>\n  <span class="token string">\'.js\'</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>啊哈！这是所有我们的[chunkhash]价值观。因为我们改变了 home 组件，所以生成了一个新的散列，并将其添加到“webpack 样板文件”中，然后将其反转到我们的 vendor.x.js 文件中。不完全是我们想要发生的，看到我们的 vendor 文件不会经常更改，通常是我们构建的最大的文件。让我们用一个 webpack manifest 文件运行相同的练习。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="3489663172606572000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`pageOne.58e60ef81ba97426a00d.js 679 bytes\n    home.5a5f308381fc5670d102.js 674 bytes\n  vendor.db2436c7653388db768a.js 1.24 MB\n     app.8e527bb7a890edfc1ef3.js 3.44 kB\nmanifest.2b89533b2a3dea66348d.js 5.96 kB`, `3489663172606572000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="js"\n              >\n                <span class="gatsby-code-button-language">js</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="js"><pre style="counter-reset: linenumber NaN" class="language-js line-numbers"><code class="language-js">pageOne<span class="token punctuation">.</span><span class="token number">58e60</span>ef81ba97426a00d<span class="token punctuation">.</span>js <span class="token number">679</span> bytes\n    home<span class="token punctuation">.</span><span class="token number">5</span>a5f308381fc5670d102<span class="token punctuation">.</span>js <span class="token number">674</span> bytes\n  vendor<span class="token punctuation">.</span>db2436c7653388db768a<span class="token punctuation">.</span>js <span class="token number">1.24</span> <span class="token constant">MB</span>\n     app<span class="token punctuation">.</span><span class="token number">8e527</span>bb7a890edfc1ef3<span class="token punctuation">.</span>js <span class="token number">3.44</span> kB\nmanifest<span class="token punctuation">.</span><span class="token number">2</span>b89533b2a3dea66348d<span class="token punctuation">.</span>js <span class="token number">5.96</span> kB</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>改变 home</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="4236556324441398300"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`    home.b65cb7fd922ea7126e95.js  671 bytes\nmanifest.c4a2e5b1ff1dcfbe35ae.js    5.96 kB`, `4236556324441398300`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="js"\n              >\n                <span class="gatsby-code-button-language">js</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="js"><pre style="counter-reset: linenumber NaN" class="language-js line-numbers"><code class="language-js">    home<span class="token punctuation">.</span>b65cb7fd922ea7126e95<span class="token punctuation">.</span>js  <span class="token number">671</span> bytes\nmanifest<span class="token punctuation">.</span>c4a2e5b1ff1dcfbe35ae<span class="token punctuation">.</span>js    <span class="token number">5.96</span> kB</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>\n<p>🎉 只有一个 home 组件和 manifest 产生新的散列 。让我们看看 manifest 文件里面：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="23277221078817157000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`/******/ script.src =\n  __webpack_require__.p +\n  \'\' +\n  ({ \'0\': \'pageOne\', \'1\': \'home\', \'2\': \'vendor\', \'3\': \'app\' }[chunkId] || chunkId) +\n  \'.\' +\n  {\n    \'0\': \'58e60ef81ba97426a00d\',\n    \'1\': \'b65cb7fd922ea7126e95\',\n    \'2\': \'db2436c7653388db768a\',\n    \'3\': \'8e527bb7a890edfc1ef3\'\n  }[chunkId] +\n  \'.js\';`, `23277221078817157000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="js"\n              >\n                <span class="gatsby-code-button-language">js</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="js"><pre style="counter-reset: linenumber NaN" class="language-js line-numbers"><code class="language-js"><span class="token comment">/******/</span> script<span class="token punctuation">.</span>src <span class="token operator">=</span>\n  __webpack_require__<span class="token punctuation">.</span>p <span class="token operator">+</span>\n  <span class="token string">\'\'</span> <span class="token operator">+</span>\n  <span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string">\'0\'</span><span class="token punctuation">:</span> <span class="token string">\'pageOne\'</span><span class="token punctuation">,</span> <span class="token string">\'1\'</span><span class="token punctuation">:</span> <span class="token string">\'home\'</span><span class="token punctuation">,</span> <span class="token string">\'2\'</span><span class="token punctuation">:</span> <span class="token string">\'vendor\'</span><span class="token punctuation">,</span> <span class="token string">\'3\'</span><span class="token punctuation">:</span> <span class="token string">\'app\'</span> <span class="token punctuation">}</span><span class="token punctuation">[</span>chunkId<span class="token punctuation">]</span> <span class="token operator">||</span> chunkId<span class="token punctuation">)</span> <span class="token operator">+</span>\n  <span class="token string">\'.\'</span> <span class="token operator">+</span>\n  <span class="token punctuation">{</span>\n    <span class="token string">\'0\'</span><span class="token punctuation">:</span> <span class="token string">\'58e60ef81ba97426a00d\'</span><span class="token punctuation">,</span>\n    <span class="token string">\'1\'</span><span class="token punctuation">:</span> <span class="token string">\'b65cb7fd922ea7126e95\'</span><span class="token punctuation">,</span>\n    <span class="token string">\'2\'</span><span class="token punctuation">:</span> <span class="token string">\'db2436c7653388db768a\'</span><span class="token punctuation">,</span>\n    <span class="token string">\'3\'</span><span class="token punctuation">:</span> <span class="token string">\'8e527bb7a890edfc1ef3\'</span>\n  <span class="token punctuation">}</span><span class="token punctuation">[</span>chunkId<span class="token punctuation">]</span> <span class="token operator">+</span>\n  <span class="token string">\'.js\'</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>现在我们在 manifest 中的[chunkhash]值正与我们的 vendor 文件混淆起来。在你的 vendor 文件中搜索这个代码，你会发现它已经消失了。感觉不错。最后是 React 代码。这可能是最酷的部分。我可以看到如此多的反应可加载的潜力。正常导入看起来像：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="35682143453313507000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`import Home from \'./home\';`, `35682143453313507000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="js"\n              >\n                <span class="gatsby-code-button-language">js</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="js"><pre style="counter-reset: linenumber NaN" class="language-js line-numbers"><code class="language-js"><span class="token keyword">import</span> Home <span class="token keyword">from</span> <span class="token string">\'./home\'</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>\n<p>所有我们必须做的，以获得正确的动态导入：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="28350679991262773000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`import Loadable from \'react-loadable\'\nimport Loading from \'./loading\'\nconst Home = Loadable({\n  loader: () => import(\'./home\' /* webpackChunkName: \'home\' */),\n  loading: Loading, <-- a &quot;loading&quot; comp required by react-loadable\n})`, `28350679991262773000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="js"\n              >\n                <span class="gatsby-code-button-language">js</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="js"><pre style="counter-reset: linenumber NaN" class="language-js line-numbers"><code class="language-js"><span class="token keyword">import</span> Loadable <span class="token keyword">from</span> <span class="token string">\'react-loadable\'</span>\n<span class="token keyword">import</span> Loading <span class="token keyword">from</span> <span class="token string">\'./loading\'</span>\n<span class="token keyword">const</span> Home <span class="token operator">=</span> <span class="token function">Loadable</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  <span class="token function-variable function">loader</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">\'./home\'</span> <span class="token comment">/* webpackChunkName: \'home\' */</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n  loading<span class="token punctuation">:</span> Loading<span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token operator">--</span> a <span class="token string">"loading"</span> comp required by react<span class="token operator">-</span>loadable\n<span class="token punctuation">}</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这里的所有都是它的。用 react-loadable 方式包装导入，并使用新的 import()语法。注意到 Webpack 中的评论/_ webpackChunkName: ‘your<em>component</em>name’ _/ 。无需指定 0.db2436c7653388db768a.js 的文件名。</p>',
id:"/home/runner/work/GatsbyBlog/GatsbyBlog/blog/Webpack3代码拆分/index.md absPath of file >>> MarkdownRemark",timeToRead:6,frontmatter:{date:"2017-12-13 14:50:16",path:"/webpack-code-split/",tags:"前端, 前端构建工具, webpack",title:"Webpack3代码拆分",draft:null}}],length:11,tag:"前端构建工具",pagesSum:3,page:3}}}});