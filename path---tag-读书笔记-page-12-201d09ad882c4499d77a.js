webpackJsonp([0x7e5b8e377c87],{1621:function(n,a){n.exports={data:{site:{siteMetadata:{title:"女王控的博客",description:'前端工程师，黑猫女王控，欢迎勾搭，技术相关<a href="https://github.com/towavephone" target="_blank">@towavephone</a>，QQ闲聊<a href="tencent://AddContact/?fromId=45&fromSubId=1&subcmd=all&uin=634407147&website=www.oicqzone.com">@towave</a>，bili关注<a href="https://space.bilibili.com/11507708#/" target="_blank">@towave</a>',siteUrl:"https://blog.towavephone.com"}}},pathContext:{posts:[{excerpt:"适配器模式(Adapter) 将一个类的接口转换成客户希望的另外一个接口。Adapter 模式使得原本由于接口不兼容而不能一起工作的那些类可以一起工作。 问题背景 在 NBA 我需要翻译 姚明刚来到 NBA，身材够高，球技够好 但是英语不是很懂，听不懂教练的战术安排 球员分为前锋、中锋和后卫 教练会给球员分配进攻、防守任务 模式动机 通常，客户类(client of class)通过类的接口访问它提供的服务。有时现有的类(existing class…",html:'<h2 id="适配器模式adapter"><a href="#%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8Fadapter" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>适配器模式(Adapter)</h2>\n<p>将一个类的接口转换成客户希望的另外一个接口。Adapter 模式使得原本由于接口不兼容而不能一起工作的那些类可以一起工作。</p>\n<h3 id="问题背景"><a href="#%E9%97%AE%E9%A2%98%E8%83%8C%E6%99%AF" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题背景</h3>\n<p>在 NBA 我需要翻译</p>\n<ul>\n<li>姚明刚来到 NBA，身材够高，球技够好</li>\n<li>但是英语不是很懂，听不懂教练的战术安排</li>\n<li>球员分为前锋、中锋和后卫</li>\n<li>教练会给球员分配进攻、防守任务</li>\n</ul>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/微信截图_20180416133847-4df2b77c2c24025f39aa81b19ad514e4-fc791.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 46.23655913978495%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAAB0UlEQVQoz5VSPWiaURR9X76pkKlLQpq0JAj5WTuGQAtpOzqEbM4ubs4OKoZgCtJKimIWnSrFRXAQFJWA6KCigh+o8f+P+PuhVTGKr+eZBEIhJB543MvlvnPPPe8R8h8ikQjHYjgcPshkMhd+v/8M8TwUCu2wOiJHlkE6neZZTCQSpxQYDod0NpvRWCz2ldWTySS/FGE0GuUfFJ4MBgMqiuKCUBCE46cDnwUucqlUioMYdkir1Vqs5PP5Psbj8T8YcF2tVn+j54DVoZRXq9UkGAxyDoeDc7lcHPIFV6lUelmxXC7fec1m7Xb7PvF4PJs6nU6i1+t3TSbTmkwmW7XZbBKFQrFvsVj2pVLpG6vVum42m/eMRqMEyjeUSiVvt9s3tVrtB4PBsO10Ot8+PBghtVqtkcvl7jCB1uv1S6/Xe9Ttdmk2mx31+30aCAS+NBqNn6PRiKKXNptNQaPRbFUqlSIeblYsFinu/2CE8/l8hZTLZZGZz4CmK7fb/Wk8HtPHGgi/wRszyyeTCe10OnmVSvUevt6yIQz5fP4XI0S6QmD2Df5ZF41zKDPA6EOo+1soFNq9Xm+Kb/IZ5zsusQ0wZxCBPe+gTgCpOJ1O76Bc/0j4D7xYT+8PkZYSAAAAAElFTkSuQmCC\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="     20180416133847" title="" data-src="/static/微信截图_20180416133847-4df2b77c2c24025f39aa81b19ad514e4-fee1c.png" data-srcset="/static/微信截图_20180416133847-4df2b77c2c24025f39aa81b19ad514e4-a67b7.png 200w,\n/static/微信截图_20180416133847-4df2b77c2c24025f39aa81b19ad514e4-0b187.png 400w,\n/static/微信截图_20180416133847-4df2b77c2c24025f39aa81b19ad514e4-fee1c.png 800w,\n/static/微信截图_20180416133847-4df2b77c2c24025f39aa81b19ad514e4-fc791.png 930w" data-sizes="(max-width: 800px) 100vw, 800px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<h3 id="模式动机"><a href="#%E6%A8%A1%E5%BC%8F%E5%8A%A8%E6%9C%BA" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式动机</h3>\n<ul>\n<li>通常，客户类(client of class)通过类的接口访问它提供的服务。有时现有的类(existing class)可以提供客户类的功能需要，但是它所提供的接口不一定是客户类所期望的。这是由于现有的接口名称与客户类所查找的不同等诸多不同原因导致的。</li>\n<li>在这种情况下， 现有的接口需要转化 (convert) 为客户类期望的接口，这样保证了对现有类的重用。适配器模式(Adapter Pattern)可以完成这样的转化。</li>\n</ul>\n<h3 id="模式定义"><a href="#%E6%A8%A1%E5%BC%8F%E5%AE%9A%E4%B9%89" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式定义</h3>\n<p>适配器模式(Adapter Pattern)： 将一个接口转换成客户希望的另一个接口，适配器模式使接口不兼容的那些类可以一起工作，其别名为包装器(Wrapper)。适配器模式既可以作为类结构型模式，也可以作为对象结构型模式。</p>\n<h3 id="模式结构"><a href="#%E6%A8%A1%E5%BC%8F%E7%BB%93%E6%9E%84" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式结构</h3>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/微信截图_20180416135051-3ac83aefa401daeae91a2ad72b73ce7f-63438.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 38.49416755037115%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsSAAALEgHS3X78AAABUklEQVQoz4VSu06EQBTlEbOJdn6FfgGFjVbG1t6YEMPGxg/Qktp/wEYTE+MWiCE2FiQsBYGF8Eae2WYDzXYUu3hnAkbdbJgEDnPu3Hsu9wyh6/pTGIaPjuMcELDatqUR5nl+YxjGq+u6L0EQnHYcRQyttluKopyhPc/zewg9z/vsY1DwDnHz+ZweLLhcLh8Wi4WgqiruUBCEHYSapo1ns9lHlmVvURSddAWHO/zXLcamaTCyLLvPMMwu+rYsi+zPVVVFJUlCT6dTuq5ruhfC+fAi0bNarX4KS5K0ISbL8h/Rbc0Qtm0TYAwhiiLegwm4E9/3j2Gu16ZpjuM4PvydVJblOcz4CuKX0B2KH20V6wefpun7er3GpoDILeI4jhsBjOBMhXiYPY6D+89dwc0Zg6OYhCtzD4ZkkPQF3AXiJpMJEqPgr6SiKGIQNQELiPNdQfIbWBb1qlHuMKsAAAAASUVORK5CYII=\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="     20180416135051" title="" data-src="/static/微信截图_20180416135051-3ac83aefa401daeae91a2ad72b73ce7f-fee1c.png" data-srcset="/static/微信截图_20180416135051-3ac83aefa401daeae91a2ad72b73ce7f-a67b7.png 200w,\n/static/微信截图_20180416135051-3ac83aefa401daeae91a2ad72b73ce7f-0b187.png 400w,\n/static/微信截图_20180416135051-3ac83aefa401daeae91a2ad72b73ce7f-fee1c.png 800w,\n/static/微信截图_20180416135051-3ac83aefa401daeae91a2ad72b73ce7f-63438.png 943w" data-sizes="(max-width: 800px) 100vw, 800px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<ul>\n<li>Target：目标抽象类</li>\n<li>Adapter：适配器类</li>\n<li>Adaptee：适配者类（被适配）</li>\n<li>Client：客户类</li>\n</ul>\n<p><strong>篮球运动员</strong></p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/微信截图_20180416135031-581740fc917aea1dfa0f4e44737db470-ce704.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 767px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 60.104302477183836%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsSAAALEgHS3X78AAACO0lEQVQoz5VTS4iSURi9OlA5NkkGM0xRWLSJNrlXV7V0US1auNFaWKibwqWhSxMCeywKXZQLQRAUVyKKiPh+4PuF7wc+IkmZiYSw8/+pzEBJXbj8fOf+3/nud879SLPZfBsMBj91Op2PLpfrkKxWNBpltVotfSKRMLfb7ddut5tL4V6vl2xd0+l0uV5Wq/XOCt7R6XSHKPKDwieTyRLFblAHIGZsJUSSYTabfRiNRm8CgcD+Gnc6nReLxWJ9MBgscd4PhULXKBz8NKHP5yN+v5+BQoxkMkn0ev1fa2xuYDabr5tMpkd2u/3WSVwgEPzxloVC4XfF+Xy+azQaD9Rq9YFCoTiv0Wj2JBLJZbFYfAn/sXg83q5MJrui1Wr35XI5G9gZ6M40GAwclUrFsdlse6lU6lTbL6vV6hH2d1SRUTEMOa7VasfZbPZhv99/hfio0Wh8q9frD6icUql0E2c9tPu1UqlElUola0NYLpffrY0B6Qto934do8BjnH9exyB+QuWEw+Hbw+GQxmDsF5FIxN4QxmKxp0iMdbvdJAjvw4BnIE0gjuN7LxKJPMeN4ogjILxL5cCQq+l02tvr9aLj8dgqFArPkZVr5H8Xl8s9e8KknTUulUrJhnTbhoaMlTRsaGhDBykMhCeXy9FPyePxME9VxA8kk8kQiEvi8TiBgwSCUwSUVgQO0oQOh4ODlgeLxWKJ9/kT7tKDkM/nmXw+/99bxLjRhBaL5QL0ruJ2SxgyxSBQ75NA5827/AWR+5aVMAo2xAAAAABJRU5ErkJggg==\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="     20180416135031" title="" data-src="/static/微信截图_20180416135031-581740fc917aea1dfa0f4e44737db470-ce704.png" data-srcset="/static/微信截图_20180416135031-581740fc917aea1dfa0f4e44737db470-6b8f1.png 200w,\n/static/微信截图_20180416135031-581740fc917aea1dfa0f4e44737db470-35c41.png 400w,\n/static/微信截图_20180416135031-581740fc917aea1dfa0f4e44737db470-ce704.png 767w" data-sizes="(max-width: 767px) 100vw, 767px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="39817411502719975000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`abstract class Player    //篮球运动员\n{\n    protected string name;\n    public Player(string name)\n    {\n        this.name = name;\n    }\n    public abstract void Attack();\n    public abstract void Defense();\n}\nclass Forwards : Player   //前锋\n{\n    public Forwards(string name) : base(name)\n    {\n    }\n    public override void Attack()\n    {\n        Console.WriteLine(&quot;前锋 {0} 进攻&quot;, name);\n    }\n    public override void Defense()\n    {\n        Console.WriteLine(&quot;前锋 {0} 防守&quot;, name);\n    }\n}\nclass ForeignCenter   //外籍中锋\n{\n    private string name;\n    public string Name\n    {\n        get { return name; }\n        set { name = value; }\n    }\n    public void 进攻()\n    {\n        Console.WriteLine(&quot;外籍中锋 {0} 进攻&quot;, name);\n    }\n    public void 防守()\n    {\n        Console.WriteLine(&quot;外籍中锋 {0} 防守&quot;, name);\n    }\n}\nstatic void Main(string[] args)\n{\n    Player pp = new Forwards(&quot;Patrick Patterson&quot;);\n    pp.Attack();\n\n    Player tw = new Guards(&quot;Terrence Williams&quot;);\n    tw.Attack();\n\n    ForeignCenter ym = new ForeignCenter(&quot;姚明&quot;);\n    ym.进攻();\n\n    Console.Read();\n}\nclass Translator : Player   //翻译者\n{\n    private ForeignCenter wjzf = new ForeignCenter();\n\n    public Translator(string name) : base(name)\n    {\n        wjzf.Name = name;\n    }\n\n    public override void Attack()\n    {\n        wjzf.进攻();\n    }\n\n    public override void Defense()\n    {\n        wjzf.防守();\n    }\n}\nstatic void Main(string[] args)\n{\n    Player pp = new Forwards(&quot;Patrick Patterson&quot;);\n    pp.Attack();\n\n    Player tw = new Guards(&quot;Terrence Williams&quot;);\n    tw.Attack();\n\n    Player ym = new Translator (&quot;姚明&quot;);\n    ym.Attack ();\n\n    Console.Read();\n}`, `39817411502719975000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="cpp"\n              >\n                <span class="gatsby-code-button-language">cpp</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp">abstract <span class="token keyword">class</span> <span class="token class-name">Player</span>    <span class="token comment">//篮球运动员</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">protected</span> string name<span class="token punctuation">;</span>\n    <span class="token keyword">public</span> <span class="token function">Player</span><span class="token punctuation">(</span>string name<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> abstract <span class="token keyword">void</span> <span class="token function">Attack</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">public</span> abstract <span class="token keyword">void</span> <span class="token function">Defense</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">class</span> <span class="token class-name">Forwards</span> <span class="token operator">:</span> Player   <span class="token comment">//前锋</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token function">Forwards</span><span class="token punctuation">(</span>string name<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">base</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> override <span class="token keyword">void</span> <span class="token function">Attack</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"前锋 {0} 进攻"</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> override <span class="token keyword">void</span> <span class="token function">Defense</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"前锋 {0} 防守"</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">class</span> <span class="token class-name">ForeignCenter</span>   <span class="token comment">//外籍中锋</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">private</span> string name<span class="token punctuation">;</span>\n    <span class="token keyword">public</span> string Name\n    <span class="token punctuation">{</span>\n        get <span class="token punctuation">{</span> <span class="token keyword">return</span> name<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n        set <span class="token punctuation">{</span> name <span class="token operator">=</span> value<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> 进攻<span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"外籍中锋 {0} 进攻"</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> 防守<span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"外籍中锋 {0} 防守"</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    Player pp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Forwards</span><span class="token punctuation">(</span><span class="token string">"Patrick Patterson"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    pp<span class="token punctuation">.</span><span class="token function">Attack</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Player tw <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Guards</span><span class="token punctuation">(</span><span class="token string">"Terrence Williams"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    tw<span class="token punctuation">.</span><span class="token function">Attack</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    ForeignCenter ym <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">ForeignCenter</span><span class="token punctuation">(</span><span class="token string">"姚明"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    ym<span class="token punctuation">.</span>进攻<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Console<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">class</span> <span class="token class-name">Translator</span> <span class="token operator">:</span> Player   <span class="token comment">//翻译者</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">private</span> ForeignCenter wjzf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">ForeignCenter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">public</span> <span class="token function">Translator</span><span class="token punctuation">(</span>string name<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">base</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        wjzf<span class="token punctuation">.</span>Name <span class="token operator">=</span> name<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">public</span> override <span class="token keyword">void</span> <span class="token function">Attack</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        wjzf<span class="token punctuation">.</span>进攻<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">public</span> override <span class="token keyword">void</span> <span class="token function">Defense</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        wjzf<span class="token punctuation">.</span>防守<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    Player pp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Forwards</span><span class="token punctuation">(</span><span class="token string">"Patrick Patterson"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    pp<span class="token punctuation">.</span><span class="token function">Attack</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Player tw <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Guards</span><span class="token punctuation">(</span><span class="token string">"Terrence Williams"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    tw<span class="token punctuation">.</span><span class="token function">Attack</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Player ym <span class="token operator">=</span> <span class="token keyword">new</span> Translator <span class="token punctuation">(</span><span class="token string">"姚明"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    ym<span class="token punctuation">.</span>Attack <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Console<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><strong>鸭子适配器</strong></p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="21446193518122648000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`interface Duck\n{\n    public void quack();\n    public void fly();\n}\n// 野鸭子类\nclass MallardDuck : Duck\n{\n    public void quack()\n    {\n        Console.WriteLine(&quot;嘎嘎嘎...&quot;);\n    }\n\n    public void fly()\n    {\n        Console.WriteLine(&quot;我在飞哦！&quot;);\n    }\n}\ninterface Turkey\n{\n    public void gobble();\n    public void fly();\n}\n// 野火鸡类\nclass WildTurkey : Turkey\n{\n    public void gobble()\n    {\n        Console.WriteLine(&quot;咕咕咕...&quot;);\n    }\n\n    public void fly()\n    {\n        Console.WriteLine(&quot;我在飞，不过飞不远。&quot;);\n    }\n}\n// 火鸡适配器\nclass TurkeyAdapter : Duck\n{\n    Turkey turkey;\n    public TurkeyAdapter(Turkey turkey)\n    {\n        this.turkey = turkey;\n    }\n    public void quack()\n    {\n        turkey.gobble();\n    }\n    public void fly()\n    {\n        turkey.fly();\n    }\n}\n// 使用适配器\nstatic void Main(string[] args)\n{\n    MallardDuck duck = new MallardDuck();\n    WildTurkey turkey = new WildTurkey();\n    Duck turkeyAdapter = new TurkeyAdapter(turkey);\n\n    turkey.gobble();\n    turkey.fly();\n\n    testDuck(duck);\n    testDuck(turkeyAdapter);\n}\nstatic void testDuck(Duck duck)\n{\n    duck.quack();\n    duck.fly();\n}`, `21446193518122648000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="cpp"\n              >\n                <span class="gatsby-code-button-language">cpp</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp">interface Duck\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">quack</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">fly</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n<span class="token comment">// 野鸭子类</span>\n<span class="token keyword">class</span> <span class="token class-name">MallardDuck</span> <span class="token operator">:</span> Duck\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">quack</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"嘎嘎嘎..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">fly</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"我在飞哦！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\ninterface Turkey\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">gobble</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">fly</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n<span class="token comment">// 野火鸡类</span>\n<span class="token keyword">class</span> <span class="token class-name">WildTurkey</span> <span class="token operator">:</span> Turkey\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">gobble</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"咕咕咕..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">fly</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"我在飞，不过飞不远。"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token comment">// 火鸡适配器</span>\n<span class="token keyword">class</span> <span class="token class-name">TurkeyAdapter</span> <span class="token operator">:</span> Duck\n<span class="token punctuation">{</span>\n    Turkey turkey<span class="token punctuation">;</span>\n    <span class="token keyword">public</span> <span class="token function">TurkeyAdapter</span><span class="token punctuation">(</span>Turkey turkey<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>turkey <span class="token operator">=</span> turkey<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">quack</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        turkey<span class="token punctuation">.</span><span class="token function">gobble</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">fly</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        turkey<span class="token punctuation">.</span><span class="token function">fly</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token comment">// 使用适配器</span>\n<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    MallardDuck duck <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">MallardDuck</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    WildTurkey turkey <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">WildTurkey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Duck turkeyAdapter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">TurkeyAdapter</span><span class="token punctuation">(</span>turkey<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    turkey<span class="token punctuation">.</span><span class="token function">gobble</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    turkey<span class="token punctuation">.</span><span class="token function">fly</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">testDuck</span><span class="token punctuation">(</span>duck<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">testDuck</span><span class="token punctuation">(</span>turkeyAdapter<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">testDuck</span><span class="token punctuation">(</span>Duck duck<span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    duck<span class="token punctuation">.</span><span class="token function">quack</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    duck<span class="token punctuation">.</span><span class="token function">fly</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><strong>类适配器与对象适配器</strong></p>\n<p>假设我们在软件开发中要记录日志，包括数据库记录日志 DatabaseLog 和文本文件记录日志 WriteLog</p>\n<p>开发过程需要引入一个新的日志接口，但新的日志接口和以前的不一样</p>\n<p><em>类适配器方式如下</em></p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/微信截图_20180416141540-8255832a64faa7da5fea3259a1490d39-d1477.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 536px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 84.88805970149254%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAIAAABSJhvpAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACWklEQVQ4y41SbXOaQBDm//+Vth860zaTTpMYNbYx+NKAeryICPKiICrHwXHHYVfMOJl8SLNzLDsP9+wuz650fGVZXiZpkaR5vMsSTFNSHt816fyq6xq8Zke3fededq47ekv2RmjTfPoYOYx34+nseYb8TbTebsM4+VjlxicHrJnGcDxy/VVWkCRN/0OuT/bSW3IonBAbdoSs9TLEYZwBKMTrzuuLQXxpW1SciYoJUZWUspIe6wqQWtTvVQaFScF3B5LlDE7JKkAp45iU+7TAWZnTqqAcwEpAkNMyx+RAS8J4IXVHzm3f+3w1/N5CN31/4e3hnrnaXT9YX66Gn37IX3/NxloEIHBU+2nm/mnJ31S7p/uyhCx38FedaKYfxW4YJWmWZdgJopGKRsrUCUJvEwdRAv9IWY4WiqINkaXEqRelKymMY3OuIWN2yPaUEUxyKLLH2dK1pzM1jIKSFynBlag5p+HGR9oEPPRMaSatwoNmhePJwnITN8S79Eym5jJWkYPMwA3SdSM7r8rtwXcC0w3MJA3gvKjNGKMnK0B4IQQ8p9ucM1aC/o2JE94MDfBzIF10L4qcEHIZ5RmEcYkm0Qss6kuKExlSquamN7Taj6jd1+RpiAmDMoqx6Q3mXdm4603ufk8Vc8u4eDtnXomH0eJnR73pTTtPRne4hD0DsDtYXLeV1qPe7uv3j3pf9WizAq+XRoIiju/quur5tjgWWQGal6Ct4ztIU4K1U9U5FwTne15VbysDee5Eg2d9YrhBnNneDnaOV7Xlxk9jNJt7QYy9TboMdoy/Jf8DJWm/SCpS/SYAAAAASUVORK5CYII=\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="     20180416141540" title="" data-src="/static/微信截图_20180416141540-8255832a64faa7da5fea3259a1490d39-d1477.png" data-srcset="/static/微信截图_20180416141540-8255832a64faa7da5fea3259a1490d39-bb263.png 200w,\n/static/微信截图_20180416141540-8255832a64faa7da5fea3259a1490d39-9a78f.png 400w,\n/static/微信截图_20180416141540-8255832a64faa7da5fea3259a1490d39-d1477.png 536w" data-sizes="(max-width: 536px) 100vw, 536px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="13125411306159830000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class DatabaseLogAdapter : DatabaseLog, Ilog\n{\n    public void Write()\n    {\n        this.WirteLog();\n    }\n}\nclass FileLogAdapter : FileLog, Ilog\n{\n    public void Write()\n    {\n        this.WirteLog();\n    }\n}`, `13125411306159830000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="cpp"\n              >\n                <span class="gatsby-code-button-language">cpp</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">DatabaseLogAdapter</span> <span class="token operator">:</span> DatabaseLog<span class="token punctuation">,</span> Ilog\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Write</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">WirteLog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">class</span> <span class="token class-name">FileLogAdapter</span> <span class="token operator">:</span> FileLog<span class="token punctuation">,</span> Ilog\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Write</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">WirteLog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><em>对象适配器</em></p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/微信截图_20180416141951-6ef137141ef0134cc8f0ab1d710c55b4-eca56.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 554px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 51.44404332129964%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABkUlEQVQoz3VRf2+bMBDl+3+cSWv/mLZmS7u1JF1+uRASjAPEEIjBYMABXNNh0nTRpD2dT/K9O53eO+3tX3RD/AcXUkrZyU57Lw6lKCkMhwJI5mYAYBqS8u29WaWKl5gg/7gBmylOtgkLPoYV7Yb0xwSOp7a+8iYveBfQyzLFFhUFjr60H6fGGEYLTLaX4YFOGbNsY7ma5QVpX8vyVHVXCurmBNF2vpwl9NgIXvFcu1aUFbXjxcBCloP9MDum7JptxOmYYeRbB+KnRZSX5K9mKV+bpq14k7OqrHhKWZ6zrq8qCPVEe6orIZoh11IKTQ5yOed1XfcOKhP7UCZ0bQ8h5DAvB/TffoGyetCjQT+9X8Q3d6vb0ct4HsN91ldtn37TvdvvxucR+PrkHhJ+NnVmxXe6++nL7GZk/lxEmhcmD8/rx9/mGgUmCv1IDaN98uvZfJgAE2LDCUhWnqUBG9/rq8nS2roH2481yhhybQdt+kvUbUkL1Zfmubd3INqUPGtEbzs/32yHD2C9tne7JM9IRv8AlM8wnKdpoIsAAAAASUVORK5CYII=\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="     20180416141951" title="" data-src="/static/微信截图_20180416141951-6ef137141ef0134cc8f0ab1d710c55b4-eca56.png" data-srcset="/static/微信截图_20180416141951-6ef137141ef0134cc8f0ab1d710c55b4-77254.png 200w,\n/static/微信截图_20180416141951-6ef137141ef0134cc8f0ab1d710c55b4-789d0.png 400w,\n/static/微信截图_20180416141951-6ef137141ef0134cc8f0ab1d710c55b4-eca56.png 554w" data-sizes="(max-width: 554px) 100vw, 554px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="16807320769299538000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class LogAdapter : Ilog\n{\n    private Log log;\n    public LogAdapter(Log log)\n    {\n        this.log = log;\n    }\n    public void Write()\n    {\n        log.WriteLog();\n    }\n}`, `16807320769299538000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="cpp"\n              >\n                <span class="gatsby-code-button-language">cpp</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">LogAdapter</span> <span class="token operator">:</span> Ilog\n<span class="token punctuation">{</span>\n    <span class="token keyword">private</span> Log log<span class="token punctuation">;</span>\n    <span class="token keyword">public</span> <span class="token function">LogAdapter</span><span class="token punctuation">(</span>Log log<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>log <span class="token operator">=</span> log<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Write</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        log<span class="token punctuation">.</span><span class="token function">WriteLog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>上面两种适配方式，可以看出在类适配方式中，是通过类的继承来实现的，同时也具有接口 ILog 的所有行为，这些就违背了面向对象设计原则中的类的单一职责原则，而对象适配器则是通过对象组合的方式来实现的，则符合面向对象的精神，所以推荐用对象适配的模式。</p>\n<h3 id="优缺点"><a href="#%E4%BC%98%E7%BC%BA%E7%82%B9" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>优缺点</h3>\n<ul>\n<li><em>将目标类和适配者类解耦</em>，通过引入一个适配器类来重用现有的适配者类，而无须修改原有代码。</li>\n<li><em>增加了类的透明性和复用性</em>，将具体的实现封装在适配者类中，对于客户端类来说是透明的，而且提高了适配者的复用性。</li>\n<li><em>灵活性和扩展性都非常好</em>，通过使用配置文件，可以很方便地更换适配器，也可以在不修改原有代码的基础上增加新的适配器类，完全符合“开闭原则”。</li>\n</ul>\n<h3 id="模式使用"><a href="#%E6%A8%A1%E5%BC%8F%E4%BD%BF%E7%94%A8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式使用</h3>\n<ul>\n<li>系统需要使用的类的接口不符合系统的要求。</li>\n<li>想要建立一个可以重复使用的类，用于与一些彼此之间没有太大关联的一些类，包括一些可能在将来引进的类一起工作。这些源类不一定有很复杂的接口。</li>\n<li>（对象适配器而言）在设计里，需要改变多个已有子类的接口，如果使用类的适配器模式，就要针对每一个子类做一个适配器，而这不太实际。</li>\n</ul>\n<h2 id="桥接模式bridge"><a href="#%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8Fbridge" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>桥接模式(Bridge)</h2>\n<p>将抽象部分与它的实现部分分离，使它们都可以独立地变化。</p>\n<h3 id="问题背景-1"><a href="#%E9%97%AE%E9%A2%98%E8%83%8C%E6%99%AF-1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题背景</h3>\n<p>凭什么你的手机游戏我不能玩？</p>\n<ul>\n<li>M 品牌手机的游戏，N 品牌不能玩</li>\n<li>不同品牌手机操作系统不同，软件不通用</li>\n<li>用程序模拟，N 品牌手机，有一个游戏，运行游戏的程序如何写</li>\n</ul>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="51405617575076020000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`static void Main(string[] args)\n{\n    MobilePhoneNGame game = new MobilePhoneNGame();\n    game.Run();\n\n    Console.Read();\n}\n\nclass MobilePhoneNGame\n{\n    public void Run()\n    {\n        Console.WriteLine(&quot;运行N品牌手机游戏&quot;);\n    }\n}`, `51405617575076020000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="cpp"\n              >\n                <span class="gatsby-code-button-language">cpp</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    MobilePhoneNGame game <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">MobilePhoneNGame</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    game<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Console<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">class</span> <span class="token class-name">MobilePhoneNGame</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"运行N品牌手机游戏"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>如果有一个 M 品牌手机，也有游戏可以运行，如何设计？</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="71217926134728290000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class MobilePhoneGame\n{\n    public virtual void Run()\n    {\n    }\n}\n\nclass MobilePhoneNGame : MobilePhoneGame\n{\n    public override void Run()\n    {\n        Console.WriteLine(&quot;运行N品牌手机游戏&quot;);\n    }\n}\n\nclass MobilePhoneMGame : MobilePhoneGame\n{\n    public override void Run()\n    {\n        Console.WriteLine(&quot;运行M品牌手机游戏&quot;);\n    }\n}`, `71217926134728290000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="cpp"\n              >\n                <span class="gatsby-code-button-language">cpp</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">MobilePhoneGame</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">class</span> <span class="token class-name">MobilePhoneNGame</span> <span class="token operator">:</span> MobilePhoneGame\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> override <span class="token keyword">void</span> <span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"运行N品牌手机游戏"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">class</span> <span class="token class-name">MobilePhoneMGame</span> <span class="token operator">:</span> MobilePhoneGame\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> override <span class="token keyword">void</span> <span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"运行M品牌手机游戏"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>如果 M 品牌和 N 品牌手机，都添加了通讯录怎么办？</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/微信截图_20180416151749-4e8ca1dbf819980b48c9cbf865b06839-9bee3.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 57.4698795180723%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAACVklEQVQoz3VSS2taQRS+ei2UJrWSFGMruGz/hG5cdCPSRBD6IEsXWXZbCkJxk1QUXbY7UdtQYlERF12okGjV+H6ERI3Wd1GbaBORCN5+c3uTNpIODOebb74558w5h6LmFk3TVK/XowlutVpJhlvAXwkHSC8tLVH/XYeHh6ztdrtULpfjHx0d8fv9voBwwG+q1Wq8Xq9Hy+XyK86hAJgfCoXofD7Pvk2n09ednpyc3BSLzVKj0UjlcrmY427NixD0OpFIJFibyWRu7+/vr9nt9ud+v/8l+Afzjx0Ox51UKrXqdDpfuN3uZ9A8JPze3h7v3y/zOIfSZrPJkD0ejxnwq4RvNBoCPOAT7PF4ZKjlrNPpMCgLUygUtISHpa8chsNhVry7uytpt9vfR6PRcDAYXCDAk0ux1+vlcxlK0bDKcDj8Bc0Zaq7ifinggv/9jkwmo4LB4Aq+vOZyuR4FAgHBDXXlQSOx2WxPUZbHPp/vSmM2m/8Ai8Ui0uv1yxsbGxKVSiVaXFxcUCqVwvX1dbHBYBBvbm7eNZlM94CXdTqdRK1Wi8Ri8YJCoRBqtdqVra2t+0ajUUh8Wa1Wikomk7lYLNYpFosN4B+RSGQ7m81W4/F48+Dg4CfGw4tmBaDpY0zqaEoPd19QkiK0bdhBNBr1EYcoGUWhwKPZbMY2giw4Dp6enjKTyYQ912q1BBpRIvj8/JwhWjTsGzRn0+n0cujT3IzyKGTz/vj4+BOG1QG7jea8LpVKNpydGGoXsnuLLN7hbgecHXefkZke9gPOHyuVyg7uDZxD6jdT7KIwEos+LAAAAABJRU5ErkJggg==\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="     20180416151749" title="" data-src="/static/微信截图_20180416151749-4e8ca1dbf819980b48c9cbf865b06839-fee1c.png" data-srcset="/static/微信截图_20180416151749-4e8ca1dbf819980b48c9cbf865b06839-a67b7.png 200w,\n/static/微信截图_20180416151749-4e8ca1dbf819980b48c9cbf865b06839-0b187.png 400w,\n/static/微信截图_20180416151749-4e8ca1dbf819980b48c9cbf865b06839-fee1c.png 800w,\n/static/微信截图_20180416151749-4e8ca1dbf819980b48c9cbf865b06839-9bee3.png 830w" data-sizes="(max-width: 800px) 100vw, 800px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>如果再添加 Mp3 音乐播放功能，怎么修改？</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/微信截图_20180416151933-22a537db32ca20956f2fefc94f314a48-46608.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 39.54635108481263%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsSAAALEgHS3X78AAABh0lEQVQoz31QuWoCURS9EwVNM50kTf4lfZqAheWU/kEKIUVqSZHlC1KIEwNhIJEQhDQpFNxmRlxGQQv3PS64EV7OG54QJeTC5Z533rn3vXOJEJZl8ULz+Zw0TSNVVWkymUicq9frV6VSqVqpVC75uVgsSqFQiCKRCPX7fRIc7QRjzK61Ws3GIu2BaLqZzWas2+1eC6207cEjO/07kUwm9yknT6/X6woGgyc+n8+Ns0Pw0laUSCR2u0zTpHw+z4XUarVOgROFQuE1FovJQiL9rqlUyl0ulx+y2axZrVbPOQe9Y/tbarfbEr5sD4Sts8FgsBqNRlY8HpeFnQOR9sDpdOqC5hM7Zr1eTxEaJ4bSn6EoyrHH4zmkf0KWZbff7z/a5wOBAJGu62HDMN5gQYXdu0wmEwX3hBfv0+n0C1aiCf4Z/Dt0d9CHcRcFvs3lco+4+4DugoTNr8ViwWBjjB0a6/WaDYfDFbAJ6988m82mybnlcsmAdWgnm82GNRoNHfwYllmn01H5vB8KXiUaagt21wAAAABJRU5ErkJggg==\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="     20180416151933" title="" data-src="/static/微信截图_20180416151933-22a537db32ca20956f2fefc94f314a48-fee1c.png" data-srcset="/static/微信截图_20180416151933-22a537db32ca20956f2fefc94f314a48-a67b7.png 200w,\n/static/微信截图_20180416151933-22a537db32ca20956f2fefc94f314a48-0b187.png 400w,\n/static/微信截图_20180416151933-22a537db32ca20956f2fefc94f314a48-fee1c.png 800w,\n/static/微信截图_20180416151933-22a537db32ca20956f2fefc94f314a48-46608.png 1014w" data-sizes="(max-width: 800px) 100vw, 800px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>如果再添加 S 品牌手机，并且有相同功能，怎么修改？</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/微信截图_20180416152431-569d0ec23f082fb846e48716e7a3df03-41931.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 27.015706806282726%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsSAAALEgHS3X78AAABDUlEQVQY02NgwAH+///PCKIfPXpkcP369RdXrlwJhIozMeAD7e3tIEUwLjMrEAgLC7Nqa2uzAfmMa9askTh16lTO7t27VUEKDA0N2Xh4eFiVlJRYgVwWqCUMJSUlDJ8/f2Zg+PPnD1jw9u3bBVevXr108eJFSRB///79IA0MDx480AGKnb106ZIniA80GCz++/dvFqDLd127dm0yzOVbt25FuBTIsTh+/HiGjIwMB7IPOjs7xU6ePFm0du1aFXTfHTlyJObAgQMeKIIXLlzYDgyfbUB6ARCvBrKXXL58ee/58+cXA/l7zp07txCIVwNdOA+I9wPFFgNdvB1ILwHSK4G+WgpkbwDqWQG0mAsAKfiam5jRZf8AAAAASUVORK5CYII=\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="     20180416152431" title="" data-src="/static/微信截图_20180416152431-569d0ec23f082fb846e48716e7a3df03-fee1c.png" data-srcset="/static/微信截图_20180416152431-569d0ec23f082fb846e48716e7a3df03-a67b7.png 200w,\n/static/微信截图_20180416152431-569d0ec23f082fb846e48716e7a3df03-0b187.png 400w,\n/static/微信截图_20180416152431-569d0ec23f082fb846e48716e7a3df03-fee1c.png 800w,\n/static/微信截图_20180416152431-569d0ec23f082fb846e48716e7a3df03-41931.png 955w" data-sizes="(max-width: 800px) 100vw, 800px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>怎么这么麻烦，换一种方式试一下</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/微信截图_20180416152545-bcadd1180f179aa7bf4411ef086e4866-8fcb4.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 26.769230769230766%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsSAAALEgHS3X78AAABI0lEQVQY02NgAIKMjAwGdPD//39GEP3s2TPpmzdvvrl69WoSVJwJXS0nJyeCM3nyZIYPHz6AmCAD2FRUVFgFBARYNTU1WYF8phkzZvCdOnUq5+jRozogRZaWlmxCQkKsIHXMzMxsIDVASxgaGhoYPn/+DLaRGaTwzp07xbdv375y5MgRXhB/7dq1YPGHDx9KAF14ESgXDuKfOHGCGWQACNy/f3/L3bt3FyH7CATAGnft2mV98uTJbC4ggIqBFDAWFBQIAMVLt23bZgBVzwSVZwa6OurgwYPBUHEWMHn58uUdwPDZef78+UVAvPLixYvLr1+/fuTKlSsLgHjPpUuXFgLF1pw7d24OUN0+oPqlQPn9QFevB6pfCpRbDBTfBMTrgGwBAMdQm0rrU4T1AAAAAElFTkSuQmCC\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="     20180416152545" title="" data-src="/static/微信截图_20180416152545-bcadd1180f179aa7bf4411ef086e4866-fee1c.png" data-srcset="/static/微信截图_20180416152545-bcadd1180f179aa7bf4411ef086e4866-a67b7.png 200w,\n/static/微信截图_20180416152545-bcadd1180f179aa7bf4411ef086e4866-0b187.png 400w,\n/static/微信截图_20180416152545-bcadd1180f179aa7bf4411ef086e4866-fee1c.png 800w,\n/static/微信截图_20180416152545-bcadd1180f179aa7bf4411ef086e4866-8fcb4.png 975w" data-sizes="(max-width: 800px) 100vw, 800px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>违背了面向对象单一职责原则</p>\n<p>为什么抽象了手机品牌，或抽象了手机软件，当需求变化时，感觉如此不稳定？</p>\n<h3 id="模式动机-1"><a href="#%E6%A8%A1%E5%BC%8F%E5%8A%A8%E6%9C%BA-1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式动机</h3>\n<p>桥接模式的用意是“将抽象化(Abstraction)与实现化(Implementation)脱耦，使得二者可以独立地变化”。</p>\n<h3 id="模式定义-1"><a href="#%E6%A8%A1%E5%BC%8F%E5%AE%9A%E4%B9%89-1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式定义</h3>\n<p>将抽象部分与它的实现部分分离，使它们都可以独立地变化。它是一种对象结构型模式，又称为柄体(Handle and Body)模式或接口(Interface)模式。</p>\n<h3 id="解耦变化"><a href="#%E8%A7%A3%E8%80%A6%E5%8F%98%E5%8C%96" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>解耦变化</h3>\n<p>我们需要解耦这两个方向的变化，把它们之间的强耦合关系改成弱联系。我们把手机品牌和手机软件的实现分别当作两个独立的部分来对待。</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/微信截图_20180416153811-b489329fc09671d4aa2356316cf81060-63a9f.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 46.559633027522935%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsSAAALEgHS3X78AAABCUlEQVQoz02RSQ9EUBCE/f//JY4EFweJEOvYxr7PfHktog50d6l69Zr2U9i2reu6JEniOG7b9jzP3wuwfd9D8QGfHcchc+26Ll7f77eqKtd1HceJoqhpGoaHAgV2ZVk6Cnmej+PIEOEtbhSWZVnXNU1T9By+KqDHt65raamHYbjFEmCaJvIEQYCSFPu+v2NjChuGIckpsLhjy0vOxx7uaR88LL6Xwi3GZp5nwhBbark/FyMwEZhAEXVRwJ0V7Ara5/Pxfd8wDJZRFAWt53m6rtu23SqQ1jRN9gTL2igsy2JOEI1GzORnIKblcNkwEaSGZR1Zlr1Z7aF5opSL0RJVCibyL0oFiloB6g+66f3IGHdkfAAAAABJRU5ErkJggg==\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="     20180416153811" title="" data-src="/static/微信截图_20180416153811-b489329fc09671d4aa2356316cf81060-fee1c.png" data-srcset="/static/微信截图_20180416153811-b489329fc09671d4aa2356316cf81060-a67b7.png 200w,\n/static/微信截图_20180416153811-b489329fc09671d4aa2356316cf81060-0b187.png 400w,\n/static/微信截图_20180416153811-b489329fc09671d4aa2356316cf81060-fee1c.png 800w,\n/static/微信截图_20180416153811-b489329fc09671d4aa2356316cf81060-63a9f.png 872w" data-sizes="(max-width: 800px) 100vw, 800px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>这时对于手机品牌和手机软件这两个类都可以独立的变化了！我们要做的工作就是把这两部分之间连接起来，那如何连接呢？Bridge 使用了对象聚合的方式，像一座桥。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="4932079776223874000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`abstract class MobilePhoneSoft  //手机软件\n{\n\n    public abstract void Run();\n}\nclass MobilePhoneGame : MobilePhoneSoft   //手机游戏\n{\n    public override void Run()\n    {\n        Console.WriteLine(&quot;运行手机游戏&quot;);\n    }\n}\nclass MobilePhoneAddressList : MobilePhoneSoft    //手机通讯录\n{\n    public override void Run()\n    {\n        Console.WriteLine(&quot;运行手机通讯录&quot;);\n    }\n}\nclass MobilePhoneMP3 : MobilePhoneSoft    //手机MP3播放\n{\n    public override void Run()\n    {\n        Console.WriteLine(&quot;运行手机MP3播放&quot;);\n    }\n}\nabstract class MobilePhoneBrand //手机品牌\n{\n    protected MobilePhoneSoft soft;\n\n    //设置手机软件\n    public void SetHandsetSoft(MobilePhoneSoft soft)\n    {\n        this.soft = soft;\n    }\n    //运行\n    public abstract void Run();\n}\nclass MobilePhoneN : MobilePhoneBrand //手机品牌N\n{\n    public override void Run()\n    {\n        soft.Run();\n    }\n}\nstatic void Main(string[] args)\n{\n    MobilePhoneBrand ab;\n    ab = new MobilePhoneN();\n\n    ab.SetHandsetSoft(new MobilePhoneGame());\n    ab.Run();\n\n    ab.SetHandsetSoft(new MobilePhoneAddressList());\n    ab.Run();\n\n    Console.Read();\n}`, `4932079776223874000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="cpp"\n              >\n                <span class="gatsby-code-button-language">cpp</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp">abstract <span class="token keyword">class</span> <span class="token class-name">MobilePhoneSoft</span>  <span class="token comment">//手机软件</span>\n<span class="token punctuation">{</span>\n\n    <span class="token keyword">public</span> abstract <span class="token keyword">void</span> <span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">class</span> <span class="token class-name">MobilePhoneGame</span> <span class="token operator">:</span> MobilePhoneSoft   <span class="token comment">//手机游戏</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> override <span class="token keyword">void</span> <span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"运行手机游戏"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">class</span> <span class="token class-name">MobilePhoneAddressList</span> <span class="token operator">:</span> MobilePhoneSoft    <span class="token comment">//手机通讯录</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> override <span class="token keyword">void</span> <span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"运行手机通讯录"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">class</span> <span class="token class-name">MobilePhoneMP3</span> <span class="token operator">:</span> MobilePhoneSoft    <span class="token comment">//手机MP3播放</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> override <span class="token keyword">void</span> <span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"运行手机MP3播放"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\nabstract <span class="token keyword">class</span> <span class="token class-name">MobilePhoneBrand</span> <span class="token comment">//手机品牌</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">protected</span> MobilePhoneSoft soft<span class="token punctuation">;</span>\n\n    <span class="token comment">//设置手机软件</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">SetHandsetSoft</span><span class="token punctuation">(</span>MobilePhoneSoft soft<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>soft <span class="token operator">=</span> soft<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token comment">//运行</span>\n    <span class="token keyword">public</span> abstract <span class="token keyword">void</span> <span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">class</span> <span class="token class-name">MobilePhoneN</span> <span class="token operator">:</span> MobilePhoneBrand <span class="token comment">//手机品牌N</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> override <span class="token keyword">void</span> <span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        soft<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    MobilePhoneBrand ab<span class="token punctuation">;</span>\n    ab <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">MobilePhoneN</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    ab<span class="token punctuation">.</span><span class="token function">SetHandsetSoft</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">MobilePhoneGame</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    ab<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    ab<span class="token punctuation">.</span><span class="token function">SetHandsetSoft</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">MobilePhoneAddressList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    ab<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Console<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="模式结构-1"><a href="#%E6%A8%A1%E5%BC%8F%E7%BB%93%E6%9E%84-1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式结构</h3>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/微信截图_20180416154303-e82358905699d76485998cc03faf86af-99684.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 39.08174692049272%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsSAAALEgHS3X78AAABqUlEQVQoz31STUsCURQdxRYRBBUt8lf0A1rlwm1RexctDVq1CqwfEKELbVBDdFEgCNIi3Y0fjOMw4ajoqPgdBjpudGMS4nSuqJRRBy7n3XfuO++9+x6TTCZvY7HYXTqdvsf4hAE0TdNR0LhSqRxUq9XHRCLB8jzPKoryVCqVzKSB9cwqxuOxNplMNEIul0uZTKZtTOttNts66djMRtpoNNKoltBsNq9J63Q6hl+G9Xr9vd1uDyB+lMtlF815PB59NBpdozHHcWcw+Gw0GipYBU9wynPSZFk22O12xmKxzLysVivD+P3+3UAgcATeFwRhY37lWRDcbvemz+fbczgch06n04xaIzbc+taaZe2C/4NuHn9pSyzNcGweJ0sWCoUYmixFIpFjURQfcC0xk8nEJUni8vm8jLkrXN9aLBZl5BzyOJjWhlmWpb4zwWBw5vwDKLhEP98W+XQ6nTF694xN3av13W536vV6jWQYDod1TK1Wk1As9Hq91HA4zONrnGaz2QAeK4vvIiD4wWCgtFqtG3ydC+QKNB4PKPT7/VdVVV9cLtcOGYZCId0XhYBdMXVs8HwAAAAASUVORK5CYII=\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="     20180416154303" title="" data-src="/static/微信截图_20180416154303-e82358905699d76485998cc03faf86af-fee1c.png" data-srcset="/static/微信截图_20180416154303-e82358905699d76485998cc03faf86af-a67b7.png 200w,\n/static/微信截图_20180416154303-e82358905699d76485998cc03faf86af-0b187.png 400w,\n/static/微信截图_20180416154303-e82358905699d76485998cc03faf86af-fee1c.png 800w,\n/static/微信截图_20180416154303-e82358905699d76485998cc03faf86af-99684.png 893w" data-sizes="(max-width: 800px) 100vw, 800px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<ul>\n<li>Abstraction：抽象类</li>\n<li>RefinedAbstraction：扩充抽象类</li>\n<li>Implementor：实现类接口</li>\n<li>ConcreteImplementor：具体实现类</li>\n</ul>\n<p>在桥接模式中不仅 Implementor 具有变化(ConcreateImplementior)，而且 Abstraction 也可以发生变化(RefinedAbstraction)，这是一个多对多的关系，而且两者的变化是完全独立的。RefinedAbstraction 与 ConcreateImplementior 之间松散耦合，它们仅仅通过 Abstraction 与 Implementor 之间的聚合关系联系起来。</p>\n<h3 id="模式范例"><a href="#%E6%A8%A1%E5%BC%8F%E8%8C%83%E4%BE%8B" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式范例</h3>\n<p>考虑不同平台的日志记录，对于操作数据库、写入文本文件所调用的方式可能是不一样的，为此对于不同的日志记录方式，我们需要提供各种不同平台上的实现，对上面的类做进一步的设计得到了下面的结构图</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/微信截图_20180416154514-80797985756448c8c5a9362f30dd3fc0-bb574.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 410px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 52.926829268292686%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABzElEQVQoz3VSO2/TUBT276jEjASqVNhQBn4LO1XVdENMFQ0MiEe3zu2AaFRVYmJJlw6gKBUIYeJrJ7br67cT+9rX1En84LPTB5XgDEfnnO98557HFaq/pCxLaN/3J5NJEASSJAWNwK3+JcIVq6jKoixyOJZl2bYNjt9IXcj3lzmXabfJt14GVZKIruuEEE3TUCiM2H9fXmQ8sQmzZGN4ZpMz3xwlnIdhqCgKYyyOE1cfmtLAJN9iS05dZTG/uCGz8VfSefhjp/X9RUvpPLA+v6obQIdXmh5u/Npe+/myJXYeqW8fJ7a0hGpyRE6DnTv83T3+fpV1VpxPz5dYPUWzBfvgCeJ8d5W/ueu9vh9b4g15ei7Sblv/2CYH685R2/zyoajnb8jNDo2TPbu7Odx/anS36PGzyNPAKopcmM1mLE6ysvJZagXR77y6mOdJklzvD2Mjks5L6k1DnmVFhY3MsqyeWRnVYlIjz+sOcRVZJrIsq6oKjZ2NxmNNHYfTKdA8X+iaiiBu0e/3BdM0KaVwsqaY4zg4D21EFEXDMFzXBep5HlDkoCgoOH6v1xPSNOWcw0H/gGFEUYQIOkcV9AwDGpcDihx8mziOYQwGgz8o7VBQhoiXggAAAABJRU5ErkJggg==\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="     20180416154514" title="" data-src="/static/微信截图_20180416154514-80797985756448c8c5a9362f30dd3fc0-bb574.png" data-srcset="/static/微信截图_20180416154514-80797985756448c8c5a9362f30dd3fc0-0fa18.png 200w,\n/static/微信截图_20180416154514-80797985756448c8c5a9362f30dd3fc0-c3228.png 400w,\n/static/微信截图_20180416154514-80797985756448c8c5a9362f30dd3fc0-bb574.png 410w" data-sizes="(max-width: 410px) 100vw, 410px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>现在的这种设计方案本身是没有任何错误的，假如现在我们要引入一种新的 xml 文件的记录方式，则上面的类结构图会变成</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/微信截图_20180416154617-359e9d394aa362af00e82891db4b6159-37d31.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 624px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 34.77564102564102%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsSAAALEgHS3X78AAABUklEQVQY001Qy07DMBDMP3ApHPgiPoYzB1qQEJy4c0DiAyqVG1SAKEiIEwIJWlH6SNv4lcQxTUvjOLEdNgEhRnuwZ3dmVusUAGut0YU1ZVVQSgW+TzCiGPEw0Fr/8NYWxhbagKD8OsU/AAdzxhgpE8w4CmMSLfl8qVQKbGUB7vZvvhTL0KXt49H5Abk/TVWWyiTNbdS9+mjWB806714rXYCdzmTrKdhrDQ8vyLO3+hXH7x20v0ka6/hkqzQ05ZLh5QFtbOB6LWwfVVwZu91ktV28tjM7exSl2Bgbc8r7D/T1RrgvSSJhMZVpgQes24ESqJ/r8hYqlT1P3L75d71g6s+Nzh13PJ7O0OIrgTYNxLQCQp6HWZZrlWt4YIwJIZPJxKcIrPM0YQQNhyMHGkEQxPNPOLjPqBDCdd0oihilECWTlc8YkJ7ncc7BA7aIF0sYgIxvEGl64OF3p/AAAAAASUVORK5CYII=\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="     20180416154617" title="" data-src="/static/微信截图_20180416154617-359e9d394aa362af00e82891db4b6159-37d31.png" data-srcset="/static/微信截图_20180416154617-359e9d394aa362af00e82891db4b6159-89539.png 200w,\n/static/微信截图_20180416154617-359e9d394aa362af00e82891db4b6159-cb00c.png 400w,\n/static/微信截图_20180416154617-359e9d394aa362af00e82891db4b6159-37d31.png 624w" data-sizes="(max-width: 624px) 100vw, 624px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>我们新增加了一个继承于 Log 基类的子类，而没有修改其它的子类，这样也符合了开放-封闭原则。如果我们引入一种新的平台，比如说我们现在开发的日志记录工具还需要支持 Borland 平台，此时该类结构又变成</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/微信截图_20180416154718-ba3b8415467957cebd1ed76eabba1675-bb96f.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 512px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 42.3828125%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAA7DAAAOwwHHb6hkAAABcklEQVQY021Qv0vDQBTuXyE4dXJwEJwcFAQ3/RP0H3Byt4WiICjSiovgppODDkILXXQTFHQpVNC2Sa+55JL7laRteomaJqlJiq1DP467x/ve9973LjP6QxSFUZicOAqCgFJqmiaEkHMexykfpGw4kWRGsxCGoaIouq5jjAkhcZeZZVOx7/W/erRH1S7VBgMnHmgYhizLjDHLsntctzF0beILO4qif+LUCS7npZMVqbTRudj6EdZ4k8mt3ey2i2tyaR1dbYdhMF40k7SJgpjHd3vG8QI5W1bPV78dPhWnD7rewaeLpLiELjf94TDNRslkz/OE6wkOu+1X1nxxyacQTpwc2/N93xkIwYAN3njz2aOScN2YTWwDABQFmgxLxC1UcK5Mqu+9QZe3AUAIwQQqw6gGrMMq26/Qh49+lxNV1eLvyLRaLd3ANtUfayh7AOZycv5eEZYONaRpWqPR0JDeN/HtUytbkOYL8KjSsYlKKKvX679kUqmxsvk5QQAAAABJRU5ErkJggg==\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="     20180416154718" title="" data-src="/static/微信截图_20180416154718-ba3b8415467957cebd1ed76eabba1675-bb96f.png" data-srcset="/static/微信截图_20180416154718-ba3b8415467957cebd1ed76eabba1675-7728b.png 200w,\n/static/微信截图_20180416154718-ba3b8415467957cebd1ed76eabba1675-23f96.png 400w,\n/static/微信截图_20180416154718-ba3b8415467957cebd1ed76eabba1675-bb96f.png 512w" data-sizes="(max-width: 512px) 100vw, 512px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>Bridge 模式粉墨登场，我们需要解耦这两个方向的变化，把它们之间的强耦合关系改成弱联系。我们把日志记录方式和不同平台上的实现分别当作两个独立的部分来对待</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/微信截图_20180416154820-4d98120973fd1418b3e9a2172ec43dbd-aa6cd.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 597px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 25.29313232830821%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAAsSAAALEgHS3X78AAABEElEQVQY0yWOv0rEQBDG8yBiIRxY2PkEdtr7Bgc24hscqKiFiIWCjZ1iddgKllYiaKGNgWTvspLLP8zlvNvsbW43u+uXy8B8zAzzm/kcu4yqqpIkCcMQmqZplmVQzjnmYs6r2qZPx/Sk8322OTrfYIM3IEbXTguXZem6rud5URSBRyulrJvQStXS2uD5yr3Y8q536M32ZPhhrNVaO0isMsaEEEVRoEaBFlx712hpFjOjRDkXefEn5cJKrgQD7sCq7/tQOGy38zwnhAT0xyrxSkX3IezeDS9fprVuztFxtf/4u3c/OOiPGhgP4zjGT7s0A9vgozgxsuy/5ys9snoY7N4GSsG+/aSTtSPSOQ3Xe1//ljwGEgcEssUAAAAASUVORK5CYII=\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="     20180416154820" title="" data-src="/static/微信截图_20180416154820-4d98120973fd1418b3e9a2172ec43dbd-aa6cd.png" data-srcset="/static/微信截图_20180416154820-4d98120973fd1418b3e9a2172ec43dbd-b82a2.png 200w,\n/static/微信截图_20180416154820-4d98120973fd1418b3e9a2172ec43dbd-6c81a.png 400w,\n/static/微信截图_20180416154820-4d98120973fd1418b3e9a2172ec43dbd-aa6cd.png 597w" data-sizes="(max-width: 597px) 100vw, 597px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<ul>\n<li>这样的设计是脆弱的，它在遵循开放-封闭原则的同时，违背了类的单一职责原则，即一个类只有一个引起它变化的原因，而这里引起 Log 类变化的原因却有两个，即日志记录方式的变化和日志记录平台的变化。</li>\n<li>重复代码会很多，不同的日志记录方式在不同的平台上也会有一部分的代码是相同的；再次是类的结构过于复杂，继承关系太多，难于维护，最致命的一点是扩展性太差。上面我们分析的变化只是沿着某一个方向，如果变化沿着日志记录方式和不同的运行平台两个方向变化，我们会看到这个类的结构会迅速的变庞大。</li>\n</ul>\n<h3 id="优缺点-1"><a href="#%E4%BC%98%E7%BC%BA%E7%82%B9-1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>优缺点</h3>\n<ul>\n<li>\n<p>优点</p>\n<ul>\n<li>分离接口及其实现部分。桥接模式使用“对象间的组合关系”解耦了抽象和实现之间固有的绑定关系，使得抽象和实现可以沿着各自的维度来变化。 所谓抽象和实现沿着各自维度的变化，即“子类化”它们，得到各个子类之后，从而获得不同平台上的不同型号。</li>\n<li>桥接模式的应用一般在“两个非常强的变化维度”，有时候即使有两个变化的维度，但是某个方向的变化维度并不剧烈——换言之两个变化不会导致纵横交错的结果，并不一定要使用桥接模式。桥接模式提高了系统的可扩充性。</li>\n<li>实现细节对客户透明，可以对用户隐藏实现细节。</li>\n<li>桥接模式有时候类似于多继承方案，但是多继承方案往往违背了类的单一职责原则（即一个类只有一个变化的原因），复用性比较差。桥接模式是比多继承方案更好的解决方法。</li>\n</ul>\n</li>\n</ul>\n<h3 id="模式使用-1"><a href="#%E6%A8%A1%E5%BC%8F%E4%BD%BF%E7%94%A8-1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式使用</h3>\n<ul>\n<li>如果一个系统需要在构件的抽象化角色和具体化角色之间增加更多的灵活性， 避免在两个层次之间建立静态的联系。</li>\n<li>设计要求实现化角色的任何改变不应当影响客户端，或者说实现化角色的改变对客户端是完全透明的。</li>\n<li>一个构件有多于一个的抽象化角色和实现化角色，系统需要它们之间进行动态耦合。</li>\n<li>虽然在系统中使用继承是没有问题的，但是由于抽象化角色和具体化角色需要独立变化，设计要求需要独立管理这两者。</li>\n</ul>\n<h3 id="模式应用"><a href="#%E6%A8%A1%E5%BC%8F%E5%BA%94%E7%94%A8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式应用</h3>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/微信截图_20180416155625-92c170b6deb7e08b12defeaa9b4bb110-ac14c.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 674px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 43.02670623145401%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsSAAALEgHS3X78AAABjElEQVQozz1RyW7bMBTU/39M20MaB+gpgLPUaXqwkcK25GpJtJm7LIkiRfH1SYUzIHh482YGHAYAMAyDahrVXJRSUkrGGKX0sGC73YZhxBZQypRqlFS676dpQmEgOBdSHtPy5S36uU9f/lYOwPspTZIoCrMsJeQMC3o77k4fz2GZVEwwau0YEEKQCPn4VAx3cfcl0ufWW+dHADRHI+tR5s3oM+U2pblJXd7D0DYYGvAFB2Y35+mRwpqBdnOOR7Gf7/8HIS38ov4udWF9kYwYawPvfa815bysRV4IQmcvIUTXdcaYQWtsg19RVqIo+aVt8c3oGMAVbvRa28mNc5KfnNFd22CF1piF92601kyT+1RAcHyvXw/pLqO9ASRka045fUvK32GeS40bTW/+xMUuI61xuGDMnBnl7FhfgodErEJ5c+rUvAnvwjzG/D6WX/cc68HJuR3vQ/JtLzLpsENrPcask2YV98Ezhx81rEpo7SwuethwWFP4XsErmye1hicOtxUUHVz/DB4I3JbwD0vR+MDodfMBAAAAAElFTkSuQmCC\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="     20180416155625" title="" data-src="/static/微信截图_20180416155625-92c170b6deb7e08b12defeaa9b4bb110-ac14c.png" data-srcset="/static/微信截图_20180416155625-92c170b6deb7e08b12defeaa9b4bb110-2d27a.png 200w,\n/static/微信截图_20180416155625-92c170b6deb7e08b12defeaa9b4bb110-cc70c.png 400w,\n/static/微信截图_20180416155625-92c170b6deb7e08b12defeaa9b4bb110-ac14c.png 674w" data-sizes="(max-width: 674px) 100vw, 674px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<h2 id="组合模式composite"><a href="#%E7%BB%84%E5%90%88%E6%A8%A1%E5%BC%8Fcomposite" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>组合模式(Composite)</h2>\n<p>将对象组合成树形结构以表示”部分-整体”的层次结构，“Composite 使得用户对单个对象和组合对象的使用具有一致性。”</p>\n<h3 id="模式背景"><a href="#%E6%A8%A1%E5%BC%8F%E8%83%8C%E6%99%AF" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式背景</h3>\n<p>设计一个绘图程序</p>\n<ul>\n<li>绘制基本图元线对象(Line)、圆对象(Circle)、矩形对象(Rectangle)</li>\n<li>绘制组合对象(Picture)，可包含任意基本图元的组合</li>\n</ul>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="86082404444172650000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`public class Line\n{\n    public void Draw()\n    {\n        Console.WriteLine(&quot;Draw a Line&quot;);\n    }\n}\n\npublic class Circle\n{\n    public void Draw()\n    {\n        Console.WriteLine(&quot;Draw a Circle&quot;);\n    }\n}\n\npublic class Rectangle\n{\n    public void Draw()\n    {\n        Console.WriteLine(&quot;Draw a Rectangle&quot;);\n    }\n}\n\npublic class Picture\n{\n    protected ArrayList picList = new ArrayList();\n\n    public void Add(object pic)\n    {\n        picList.Add(pic);\n    }\n    public void Remove(object pic)\n    {\n        picList.Remove(pic);\n    }\n    public ArrayList GetChilds()\n    {\n        return picList;\n    }\n}\n\nstatic void Main(string[] args)\n{\n    Picture root = new Picture();\n    Picture branch1 = new Picture();\n    Picture branch2 = new Picture();\n\n    Line line1 = new Line();\n    Circle circle1 = new Circle();\n    Rectangle rect1 = new Rectangle();\n\n    Line line2 = new Line();\n    Circle circle2 = new Circle();\n    Rectangle rect2 = new Rectangle();\n\n    root.Add(line1);\n    root.Add(circle1);\n    root.Add(branch1);\n    branch1.Add(line2);\n    branch1.Add(branch2);\n    branch2.Add(circle2);\n    branch2.Add(rect2);\n    root.Add(rect1);\n\n    Display(root.GetChilds());\n\n    Console.Read();\n}\npublic static void Display(ArrayList root)\n{\n    for (int i = 0; i < root.Count; i++)\n    {\n        if (root[i] is Line)\n        {\n            ((Line)root[i]).Draw();\n        }\n        else if (root[i] is Circle)\n        {\n            ((Circle)root[i]).Draw();\n        }\n        else if (root[i] is Rectangle)\n        {\n            ((Rectangle)root[i]).Draw();\n        }\n        else if (root[i] is Picture)\n        {\n            Display(((Picture)root[i]).GetChilds());\n        }\n    }\n}`, `86082404444172650000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="cpp"\n              >\n                <span class="gatsby-code-button-language">cpp</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Line</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"Draw a Line"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Circle</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"Draw a Circle"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Rectangle</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"Draw a Rectangle"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Picture</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">protected</span> ArrayList picList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">ArrayList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Add</span><span class="token punctuation">(</span>object pic<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        picList<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>pic<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Remove</span><span class="token punctuation">(</span>object pic<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        picList<span class="token punctuation">.</span><span class="token function">Remove</span><span class="token punctuation">(</span>pic<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> ArrayList <span class="token function">GetChilds</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> picList<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    Picture root <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Picture</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Picture branch1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Picture</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Picture branch2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Picture</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Line line1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Line</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Circle circle1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Circle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Rectangle rect1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Rectangle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Line line2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Line</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Circle circle2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Circle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Rectangle rect2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Rectangle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    root<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>line1<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    root<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>circle1<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    root<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>branch1<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    branch1<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>line2<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    branch1<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>branch2<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    branch2<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>circle2<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    branch2<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>rect2<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    root<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>rect1<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">Display</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span><span class="token function">GetChilds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Console<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Display</span><span class="token punctuation">(</span>ArrayList root<span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> root<span class="token punctuation">.</span>Count<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">if</span> <span class="token punctuation">(</span>root<span class="token punctuation">[</span>i<span class="token punctuation">]</span> is Line<span class="token punctuation">)</span>\n        <span class="token punctuation">{</span>\n            <span class="token punctuation">(</span><span class="token punctuation">(</span>Line<span class="token punctuation">)</span>root<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>root<span class="token punctuation">[</span>i<span class="token punctuation">]</span> is Circle<span class="token punctuation">)</span>\n        <span class="token punctuation">{</span>\n            <span class="token punctuation">(</span><span class="token punctuation">(</span>Circle<span class="token punctuation">)</span>root<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>root<span class="token punctuation">[</span>i<span class="token punctuation">]</span> is Rectangle<span class="token punctuation">)</span>\n        <span class="token punctuation">{</span>\n            <span class="token punctuation">(</span><span class="token punctuation">(</span>Rectangle<span class="token punctuation">)</span>root<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>root<span class="token punctuation">[</span>i<span class="token punctuation">]</span> is Picture<span class="token punctuation">)</span>\n        <span class="token punctuation">{</span>\n            <span class="token function">Display</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>Picture<span class="token punctuation">)</span>root<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">GetChilds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>实现判断太麻烦！</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/微信截图_20180416161233-62e581e5bc981b183e875802513d162e-cb2f0.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 38.59470468431772%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsSAAALEgHS3X78AAABaUlEQVQoz7VSz0vCcBRfzj+ja3QI6iZ06uChQCjw0LVTRNSlQ7e0f6L+hA67eQqmjdiYTFC2BH9vTJ0i6HIqkynFXJ8nJZ0igh58+b69z9vnffZ5Y5hv0e/3Q3S32+2T8Xj8VC6XU41GI4U8YxjGEWG9Xi/E/DYqlUqY7lKpdBcgXNcNPM+jNADxDWEgZn8ksW07hH46a3SoJoridq1Wi+dyuUtN084Hg0EcQzYJ++xj6TiOw+Jrws1mk2X+IyKRCMOoqhrNZrMHmLQrCMI6fItyHLdfKBRipKpare4Ui8VYOp2mnj2e5ze63e417EnKspywLOtW1/XTFavv+0uPhsOhA5IrymHDstZqte47nc4j5dPpNFgsFoGiKBfA36iGZS37YImxIsRLz6Zpypj0gOmH9XpdgoIM6nks4gwESeB5PAsg5yVJOoa/r/gjSMR8NpuRAPXPPmFRW1jCfDKZkMJ3UjgajV6+8A+jUyYOD2KOXQAAAABJRU5ErkJggg==\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="     20180416161233" title="" data-src="/static/微信截图_20180416161233-62e581e5bc981b183e875802513d162e-fee1c.png" data-srcset="/static/微信截图_20180416161233-62e581e5bc981b183e875802513d162e-a67b7.png 200w,\n/static/微信截图_20180416161233-62e581e5bc981b183e875802513d162e-0b187.png 400w,\n/static/微信截图_20180416161233-62e581e5bc981b183e875802513d162e-fee1c.png 800w,\n/static/微信截图_20180416161233-62e581e5bc981b183e875802513d162e-cb2f0.png 982w" data-sizes="(max-width: 800px) 100vw, 800px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="94552506790269300000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`public abstract class Graphics\n{\n    public abstract void Draw();\n}\n\npublic class Line : Graphics\n{\n    public override void Draw()\n    {\n        Console.WriteLine(&quot;Draw a Line&quot;);\n    }\n}\n\npublic class Circle : Graphics\n{\n    public override void Draw()\n    {\n        Console.WriteLine(&quot;Draw a Circle&quot;);\n    }\n}\n\npublic class Rectangle : Graphics\n{\n    public override void Draw()\n    {\n        Console.WriteLine(&quot;Draw a Rectangle&quot;);\n    }\n}\n\npublic class Picture : Graphics\n{\n    protected ArrayList picList = new ArrayList();\n\n    public override void Draw()\n    {\n        Display(picList);\n    }\n    public void Display(ArrayList root)\n    {\n        for (int i = 0; i < root.Count; i++)\n        {\n            if (root[i] is Line)\n            {\n                ((Line)root[i]).Draw();\n            }\n            else if (root[i] is Circle)\n            {\n                ((Circle)root[i]).Draw();\n            }\n            else if (root[i] is Rectangle)\n            {\n                ((Rectangle)root[i]).Draw();\n            }\n            else if (root[i] is Picture)\n            {\n                Display(((Picture)root[i]).GetChilds());\n            }\n        }\n    }\n}\n\nstatic void Main(string[] args)\n{\n    Picture root = new Picture();\n    Picture branch1 = new Picture();\n    Picture branch2 = new Picture();\n\n    Line line1 = new Line();\n    Circle circle1 = new Circle();\n    Rectangle rect1 = new Rectangle();\n\n    Line line2 = new Line();\n    Circle circle2 = new Circle();\n    Rectangle rect2 = new Rectangle();\n\n    root.Add(line1);\n    root.Add(circle1);\n    root.Add(branch1);\n    branch1.Add(line2);\n    branch1.Add(branch2);\n    branch2.Add(circle2);\n    branch2.Add(rect2);\n    root.Add(rect1);\n\n    root.Draw();\n\n    Console.Read();\n}`, `94552506790269300000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="cpp"\n              >\n                <span class="gatsby-code-button-language">cpp</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token keyword">public</span> abstract <span class="token keyword">class</span> <span class="token class-name">Graphics</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> abstract <span class="token keyword">void</span> <span class="token function">Draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Line</span> <span class="token operator">:</span> Graphics\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> override <span class="token keyword">void</span> <span class="token function">Draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"Draw a Line"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Circle</span> <span class="token operator">:</span> Graphics\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> override <span class="token keyword">void</span> <span class="token function">Draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"Draw a Circle"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Rectangle</span> <span class="token operator">:</span> Graphics\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> override <span class="token keyword">void</span> <span class="token function">Draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"Draw a Rectangle"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Picture</span> <span class="token operator">:</span> Graphics\n<span class="token punctuation">{</span>\n    <span class="token keyword">protected</span> ArrayList picList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">ArrayList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">public</span> override <span class="token keyword">void</span> <span class="token function">Draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token function">Display</span><span class="token punctuation">(</span>picList<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Display</span><span class="token punctuation">(</span>ArrayList root<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> root<span class="token punctuation">.</span>Count<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>\n        <span class="token punctuation">{</span>\n            <span class="token keyword">if</span> <span class="token punctuation">(</span>root<span class="token punctuation">[</span>i<span class="token punctuation">]</span> is Line<span class="token punctuation">)</span>\n            <span class="token punctuation">{</span>\n                <span class="token punctuation">(</span><span class="token punctuation">(</span>Line<span class="token punctuation">)</span>root<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n            <span class="token punctuation">}</span>\n            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>root<span class="token punctuation">[</span>i<span class="token punctuation">]</span> is Circle<span class="token punctuation">)</span>\n            <span class="token punctuation">{</span>\n                <span class="token punctuation">(</span><span class="token punctuation">(</span>Circle<span class="token punctuation">)</span>root<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n            <span class="token punctuation">}</span>\n            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>root<span class="token punctuation">[</span>i<span class="token punctuation">]</span> is Rectangle<span class="token punctuation">)</span>\n            <span class="token punctuation">{</span>\n                <span class="token punctuation">(</span><span class="token punctuation">(</span>Rectangle<span class="token punctuation">)</span>root<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n            <span class="token punctuation">}</span>\n            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>root<span class="token punctuation">[</span>i<span class="token punctuation">]</span> is Picture<span class="token punctuation">)</span>\n            <span class="token punctuation">{</span>\n                <span class="token function">Display</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>Picture<span class="token punctuation">)</span>root<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">GetChilds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n            <span class="token punctuation">}</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    Picture root <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Picture</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Picture branch1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Picture</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Picture branch2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Picture</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Line line1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Line</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Circle circle1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Circle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Rectangle rect1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Rectangle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Line line2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Line</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Circle circle2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Circle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Rectangle rect2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Rectangle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    root<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>line1<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    root<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>circle1<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    root<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>branch1<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    branch1<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>line2<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    branch1<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>branch2<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    branch2<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>circle2<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    branch2<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>rect2<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    root<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>rect1<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    root<span class="token punctuation">.</span><span class="token function">Draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Console<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>拥有了公共的 Draw 方法，统一了绘制图形接口</p>\n<p>以上代码没有错误，就是优秀的设计吗？</p>\n<p>可以将判断代码依赖于抽象编程，将类型转换为抽象类 Graphics</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="19709824006902840000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`public class Picture : Graphics\n{\n    protected ArrayList picList = new ArrayList();\n\n    public override void Draw()\n    {\n        for (int i = 0; i < picList.Count; i++)\n        {\n            ((Graphics)picList[i]).Draw();\n        }\n    }\n}`, `19709824006902840000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="cpp"\n              >\n                <span class="gatsby-code-button-language">cpp</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Picture</span> <span class="token operator">:</span> Graphics\n<span class="token punctuation">{</span>\n    <span class="token keyword">protected</span> ArrayList picList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">ArrayList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">public</span> override <span class="token keyword">void</span> <span class="token function">Draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> picList<span class="token punctuation">.</span>Count<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>\n        <span class="token punctuation">{</span>\n            <span class="token punctuation">(</span><span class="token punctuation">(</span>Graphics<span class="token punctuation">)</span>picList<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这种思想就是组合模式。</p>\n<h3 id="模式动机-2"><a href="#%E6%A8%A1%E5%BC%8F%E5%8A%A8%E6%9C%BA-2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式动机</h3>\n<ul>\n<li>对于树形结构，当容器对象（如文件夹）的某一个方法被调用时，将遍历整个树形结构，寻找也包含这个方法的成员对象（可以是容器对象，也可以是叶子对象，如子文件夹和文件）并调用执行。（递归调用）</li>\n<li>由于容器对象和叶子对象在功能上的区别，在使用这些对象的客户端代码中必须有区别地对待容器对象和叶子对象，而对于这些对象的区别对待将会使得程序非常复杂。</li>\n<li>组合模式描述了如何将容器对象和叶子对象进行递归组合，使得用户在使用时无须对它们进行区分，可以一致地对待容器对象和叶子对象，这就是组合模式的模式动机。</li>\n</ul>\n<h3 id="模式定义-2"><a href="#%E6%A8%A1%E5%BC%8F%E5%AE%9A%E4%B9%89-2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式定义</h3>\n<p>组合多个对象形成树形结构以表示“整体—部分”的结构层次。组合模式对单个对象（即叶子对象）和组合对象（即容器对象）的使用具有一致性。组合模式又可以称为“整体—部分”(Part-Whole)模式，属于对象的结构模式，它将对象组织到树结构中，可以用来描述整体与部分的关系。</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/微信截图_20180416164242-6894bc4aa8e8764f02638c997ff93c02-d152b.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 55.56872037914692%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAACPUlEQVQoz3VTS4uSYRT+vDZTTVP+gJhl0KZVP8AfMAshRqrZGAa5CBfZZEQztEhw48qloBvB8BYSoysRQTQ1FW94x0veb+B10Onreb/RmhF84HB4z3u+55zznuejSqXSSSKROPP5fKe1Wu0sFAodUIDJZOIUCoVXrVbrUyAQOHG5XB8ymcz7RqPxJZlMPiU5NE2zqE1Mp1P6Ovx+/yGJi8XiB+Vy+TeJjcdjejKZ0IvFgskB8SnJQRE+HOuaUVQ+n/+GLs5hP9DhudfrfULiGo3mdjwe/4UY3ev1pv1+/6Lb7Y4JYTQa/UxylErlDhxvZYScQ22DzWbjp9PpPOlsPp8zHXY6HabDdrv9cTXyPwIWwBAjeMOq1SqLeHTKDgaDh+jyGPYGXX0F0VG9Xn+NQo8JSS6XYxsMBuY7gA3jUuFwmMpms1QsFltfbMPmOLyN8xUhgU6nY7xarWa53e5dVL0jk8n2nU7nntVqvafVarkWi4WNd+UrFIoduVzOk0qluzhzhUIhWyQSsQUCwX9CSIbZkMPhOMBYSVgeUsrAF/EEAaPReJfcF4vFo9FoFMcCfZFI5Cck58c5gvP3VZdXhB6PhyG02+2PBoMBIw+yCIJms7lEx/vkHkXeLZdLGhunSR5ZFEGlUhlKJJL7q7EpCuMwXq/X70GHzyHul6lU6gV0eIwFPDObzbfIPRbzFgUI4QUIlxD5guh4OBx2VCrVwxsvij9j6zagRc6aEOPRsOVsNvsDfV6SSTB2eZ37FweYqlLirq4NAAAAAElFTkSuQmCC\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="     20180416164242" title="" data-src="/static/微信截图_20180416164242-6894bc4aa8e8764f02638c997ff93c02-fee1c.png" data-srcset="/static/微信截图_20180416164242-6894bc4aa8e8764f02638c997ff93c02-a67b7.png 200w,\n/static/微信截图_20180416164242-6894bc4aa8e8764f02638c997ff93c02-0b187.png 400w,\n/static/微信截图_20180416164242-6894bc4aa8e8764f02638c997ff93c02-fee1c.png 800w,\n/static/微信截图_20180416164242-6894bc4aa8e8764f02638c997ff93c02-d152b.png 844w" data-sizes="(max-width: 800px) 100vw, 800px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<ul>\n<li>Component：抽象构件（接口或抽象类）</li>\n<li>Leaf：叶子构件</li>\n<li>Composite：容器构件</li>\n<li>Client：客户类</li>\n</ul>\n<p>应该是在 Graphic(Component)中声明这些集合操作，并使得这些操作对 Leaf 类有意义，还是只应该在 Picture(Composite)和它的子类中声明并定义这些操作呢？这就要分为以下两种方式。</p>\n<p><strong>安全方式</strong></p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/微信截图_20180416164816-d6c0c1cf517ac1c384dfd8b075c46cd4-d12a8.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 39.83822042467139%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsSAAALEgHS3X78AAABdElEQVQoz51SPUvDUBR9bVb/gIOro6CbTp1UdHHVySEg2mIpTk6CCFGo9ac4uLh0SIfWlpTSln6HpClJ2/STkrYRQn2eF4y4CNULF+6797zzzjvvEfIjBEEglFIfq3u93u1oNBILhcJLu91+7ff7z9lsdpXNarWajywTPM8zQj+rZVkWUdPhcEgXiwUdj8cUhOtsJkmS/1cSRVG4brfLMaKv9ImiSBKJxGa5XN6Nx+N8sVg8qNfrgXw+v8L2MAzS3dPpdDjDMLhcLrec6r8EDiZE07TTSqVyViqVwo1G4wiebUFZCCovsA6n0+mNVqt1guteos8w+6i34WsEsxB6QV3Xg5lMZs1lnUwm1IvBYADrZIHVs9nM7VWr1WvTNL9B8PQNJDHP3/l87uEOXcJkMnnDSPByj8hzeBaA2piqqnfwN5pKpXaQV8A8QN0TvDyGmnsczgS84yc4lmVRzPb+7RUsitq2TXE7ZzqdfjiOQ5vNpkv4CW6mNxISGRIvAAAAAElFTkSuQmCC\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="     20180416164816" title="" data-src="/static/微信截图_20180416164816-d6c0c1cf517ac1c384dfd8b075c46cd4-fee1c.png" data-srcset="/static/微信截图_20180416164816-d6c0c1cf517ac1c384dfd8b075c46cd4-a67b7.png 200w,\n/static/微信截图_20180416164816-d6c0c1cf517ac1c384dfd8b075c46cd4-0b187.png 400w,\n/static/微信截图_20180416164816-d6c0c1cf517ac1c384dfd8b075c46cd4-fee1c.png 800w,\n/static/微信截图_20180416164816-d6c0c1cf517ac1c384dfd8b075c46cd4-d12a8.png 989w" data-sizes="(max-width: 800px) 100vw, 800px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>在 Composite 类中定义管理子部件的方法具有良好的安全性，因为在 C++这样的静态类型语言中，在编译时任何从 Leaf 中增加或删除对象的尝试都将被发现。但是这又损失了透明性，因为 Leaf 和 Composite 显然具有不同的接口。</p>\n<p><strong>透明方式</strong></p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/微信截图_20180416164944-62d0c153a3ca5e626b5dd3c14c83f37e-a311f.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 42.189054726368155%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsSAAALEgHS3X78AAABeElEQVQoz61Su04CURC9wPIXhMKEnzCxseEHKC0sLIS1IcHKwtgp0UJDghpNTLCytPITpJGwyxuW8M6yLMsSFpWHrGeujxArCieZzOydOWdey9gfKZfL3Iqi6Or3+wetVusmm83GDMO4q9Vq6xRrNBpOtqqk02luI5GIGwSKDRmNRmTsZrMZpFi73RZWJkwkEg6y4XDYnclk5PF4bA8GgzkRdjqdHYpVq1XB4/Ewr9fLfD4fC4VCzO/3fxHMZjMBuaSub3WSLhYLAd1uyrK8nUwmxUqlEigWi2uEWcr7wRDewf5bOCkWf6SqahQdnMI/zufzAYx4kkqlYoVC4UrX9UPEthC7xXHONU2L4yjBbre7hxVcYoIz0zSvse8Nzoor2hjPns/5mmyA7nu93u/3cDjUJUl6IN+yLP6GozwrivKy/IYi+5wQ1TX8Eu8Avk6nU6tUKl3U63UVVd+Q/IEdS+g2TkXQuTmZTMg+5nK5J+DIN4gQne8S3yeXiUn6nINuDAAAAABJRU5ErkJggg==\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="     20180416164944" title="" data-src="/static/微信截图_20180416164944-62d0c153a3ca5e626b5dd3c14c83f37e-fee1c.png" data-srcset="/static/微信截图_20180416164944-62d0c153a3ca5e626b5dd3c14c83f37e-a67b7.png 200w,\n/static/微信截图_20180416164944-62d0c153a3ca5e626b5dd3c14c83f37e-0b187.png 400w,\n/static/微信截图_20180416164944-62d0c153a3ca5e626b5dd3c14c83f37e-fee1c.png 800w,\n/static/微信截图_20180416164944-62d0c153a3ca5e626b5dd3c14c83f37e-a311f.png 1005w" data-sizes="(max-width: 800px) 100vw, 800px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>在类层级结构的根部定义子节点管理接口的方法具有良好的透明性，因为你可以一致地使用所有的组件，但是这一方法以安全性为代价，因为客户有可能会做一些无意义的事情，例如在 Leaf 中增加和删除对象。</p>\n<h3 id="优缺点-2"><a href="#%E4%BC%98%E7%BC%BA%E7%82%B9-2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>优缺点</h3>\n<ul>\n<li>\n<p>优点</p>\n<ul>\n<li>使客户端调用简单，客户端可以一致的使用组合结构或其中单个对象，用户就不必关系自己处理的是单个对象还是整个组合结构，这就简化了客户端代码。</li>\n<li>定义了包含叶子对象和容器对象的类层次结构，叶子对象可以被组合成更复杂的容器对象，而这个容器对象又可以被组合，这样不断地递归下去。客户代码中，任何用到叶子对象的地方都可以使用容器对象。</li>\n<li>客户端不必因为加入了新的对象构件而更改代码。</li>\n</ul>\n</li>\n<li>\n<p>缺点</p>\n<ul>\n<li>组合模式的缺陷是使得设计变得更加抽象，对象的商业规则如果很复杂，则实现组合模式较困难。</li>\n<li>此外，不是所有的方法都与叶子构件子类都有关联</li>\n<li>有时候我们希望一个容器中只能有某些特定的构件。使用组合模式时，不能依赖类型系统来施加这些约束，因为它们都来自于相同的抽象层，在这种情况下，必须通过在运行时进行类型检查来实现。</li>\n</ul>\n</li>\n</ul>\n<h3 id="模式使用-2"><a href="#%E6%A8%A1%E5%BC%8F%E4%BD%BF%E7%94%A8-2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式使用</h3>\n<ul>\n<li>需要表示一个对象整体或部分层次。</li>\n<li>想让客户能够忽略不同对象层次的变化。</li>\n<li>对象的结构是动态的并且复杂程度不一样，但客户需要一致地处理它们。</li>\n</ul>\n<h3 id="模式应用-1"><a href="#%E6%A8%A1%E5%BC%8F%E5%BA%94%E7%94%A8-1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式应用</h3>\n<p><strong>XML 文档解析</strong></p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/微信截图_20180416165525-7e155896825f31d818f6db71273bf937-84ce9.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 581px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 49.741824440619624%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABu0lEQVQoz3VSy27TQBT1p8Iu3ZQKCSq6ASEBOzaoi24QX4AEixCSJrysKoAql4iySBpjTx527Njz9tjj8ZixIxUB4mp0dedx7jlzZqz6r9CVSWLjgO4N0L2ZR9+uF/8N609gKelSYg+myzD0zUBwVWJPsbWu1P/BWpskWYi/PkT2AfcHZmrokumrRb+zObtf8njXXrdhqhZsKqPKrLbMdSmklHlRYMYgJZQzwjBhFFJKOJNK7fA7lHVNqyiIPz8O7SPsvyNCVm273zfSVaZq6H1Yvz+Mxk8UDxrmqqDGH8HhNo3Dq1E47cFkQTPBOdH5thJxpWSrV9UlZvFl6H4MXFsSX0tioYvjZb+TXBzz0EnGD+j5IzAfR1yz+PtieBsMDvLNuQEX6Ww5uuP197PQYfPXq8Eecp5aWhUwWckiMyeyDEfTt+DLSeC8EF6PwIDT7c6bBp8hlAaNj5VsIDm3tORp/NNsGGUZ2wazIZp1kXtKgI0TwNC6Ni62ugWN0tirdamVSGJXCmjhyYn3pkMunxfxJPp0L7KPyvRH809SF4wO3d4+XZw1r4iuwPCuP7gl1uNs/jI43aOTZ78AOYYkPBohhocAAAAASUVORK5CYII=\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="     20180416165525" title="" data-src="/static/微信截图_20180416165525-7e155896825f31d818f6db71273bf937-84ce9.png" data-srcset="/static/微信截图_20180416165525-7e155896825f31d818f6db71273bf937-1b05b.png 200w,\n/static/微信截图_20180416165525-7e155896825f31d818f6db71273bf937-f343a.png 400w,\n/static/微信截图_20180416165525-7e155896825f31d818f6db71273bf937-84ce9.png 581w" data-sizes="(max-width: 581px) 100vw, 581px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p><strong>文件目录操作</strong></p>\n<p>操作系统中的目录结构是一个树形结构，因此在对文件和文件夹进行操作时可以应用组合模式，例如杀毒软件在查毒或杀毒时，既可以针对一个具体文件，也可以针对一个目录。如果是对目录查毒或杀毒，将递归处理目录中的每一个子目录和文件。</p>\n<h2 id="装饰模式decorator"><a href="#%E8%A3%85%E9%A5%B0%E6%A8%A1%E5%BC%8Fdecorator" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>装饰模式(Decorator)</h2>\n<p>动态地给一个对象添加一些额外的职责。就增加功能来说，Decorator 模式相比生成子类更为灵活</p>\n<h3 id="模式背景-1"><a href="#%E6%A8%A1%E5%BC%8F%E8%83%8C%E6%99%AF-1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式背景</h3>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/微信截图_20180416172449-c8afc55c3052334ccdfb4aaae99516db-010a0.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 238px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 146.6386554621849%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAdCAIAAAAl5NuSAAAACXBIWXMAAAsSAAALEgHS3X78AAACdUlEQVQ4y5WU147iQBRE/f8fwgsSAiGQyHnImSHDsmSWHEX2nJkeDQu2Yfc+GGP37apbVW1Jr9fHYrFQKPSmqGAw+KZR4XDYbrdL0WhUluXL5SL/VdfrlWuz2UylUlpvO52OBKzW68FgkMvlzuezfF+3ZoPBUKvVCoXC+33xpFQqVSoVrVc+n09yOBzL5XI4HP5Rq9FopPpwOp1CSorH40raz0vQ7vV6ksViAfb3VzFGu90WV/62Wq1faoWQLEBpyWQylctlm82Gci6Xy+PxOJ3OZDKZSCQYTCx9qEajwdaRSETy+/2bzSadToPPGCiEEmCy93w+/yGprrbwmU6WjsfjyWSCfrPZbLfbYdJFrYR5kJLgiYCBQKBYLMJWp9PhRLfb1YL9eQhziawJ6VarFYD1er3f79N5OByeq/3dDE80AB/beJTNZtmLLdbr9ZOZP5tJPyQzmQy+IxUKIx7BRLPFYvGiWWSbTmijMCzQDM7AKlP92Ox2u8k2pwfpyTmesx2w1WqVHf8JGauAAhOHYAsyRPb7/el0etbMnKzGbTRjckKfz+fhQua4Ipty8lszDh+PR4K13W4JCcgi2xw9OgUjzWaRMEAwmf8g0wZ/aEP++lWatDkMOIzbiIRthMxoNBIVtmML1dP6iCwIw1wknHtOi9Yhv0NmMDDJNiJxY7VaxbljkBdWcSy5gzNQpJIRCBxt4GPVC2S+2LAFlk5OGZ0MwrQox/MXyF6vF2FpwBhY4BkfdNz6j2xzEliKvWwEYa7AYhWzaH23v5H5QSc4YxLZNpvN+MQgyMYrZcJvzZDkDzqRJJC5QXwa4AKsyDkLlJ8h5voABKc7XxR948wAAAAASUVORK5CYII=\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="     20180416172449" title="" data-src="/static/微信截图_20180416172449-c8afc55c3052334ccdfb4aaae99516db-010a0.png" data-srcset="/static/微信截图_20180416172449-c8afc55c3052334ccdfb4aaae99516db-279da.png 200w,\n/static/微信截图_20180416172449-c8afc55c3052334ccdfb4aaae99516db-010a0.png 238w" data-sizes="(max-width: 238px) 100vw, 238px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="44073154424934380000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class Person\n{\n    private string name;\n    public Person(string name)\n    {\n        this.name = name;\n    }\n    public void WearTShirts()\n    {\n        Console.Write(&quot;T恤 &quot;);\n    }\n    public void WearJeans()\n    {\n        Console.Write(&quot;牛仔裤 &quot;);\n    }\n    public void WearSneakers()\n    {\n        Console.Write(&quot;球鞋 &quot;);\n    }\n    public void WearSuit()\n    {\n        Console.Write(&quot;西装 &quot;);\n    }\n    public void WearTrousers()\n    {\n        Console.Write(&quot;西裤 &quot;);\n    }\n    public void WearLeatherShoes()\n    {\n        Console.Write(&quot;皮鞋 &quot;);\n    }\n    public void Show()\n    {\n        Console.WriteLine(&quot;装扮的{0}&quot;, name);\n    }\n}\nstatic void Main(string[] args)\n{\n    Person zs = new Person(&quot;张三&quot;);\n\n    Console.WriteLine(&quot;\\n第一种装扮：&quot;);\n    zs.WearTShirts();\n    zs.WearJeans();\n    zs.WearSneakers();\n    zs.Show();\n\n    Console.WriteLine(&quot;\\n第二种装扮：&quot;);\n    zs.WearSuit();\n    zs.WearTrousers();\n    zs.WearLeatherShoes();\n    zs.Show();\n\n    Console.Read();\n}`, `44073154424934380000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="cpp"\n              >\n                <span class="gatsby-code-button-language">cpp</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Person</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">private</span> string name<span class="token punctuation">;</span>\n    <span class="token keyword">public</span> <span class="token function">Person</span><span class="token punctuation">(</span>string name<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">WearTShirts</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">"T恤 "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">WearJeans</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">"牛仔裤 "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">WearSneakers</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">"球鞋 "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">WearSuit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">"西装 "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">WearTrousers</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">"西裤 "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">WearLeatherShoes</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">"皮鞋 "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"装扮的{0}"</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    Person zs <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token string">"张三"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"\\n第一种装扮："</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    zs<span class="token punctuation">.</span><span class="token function">WearTShirts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    zs<span class="token punctuation">.</span><span class="token function">WearJeans</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    zs<span class="token punctuation">.</span><span class="token function">WearSneakers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    zs<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"\\n第二种装扮："</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    zs<span class="token punctuation">.</span><span class="token function">WearSuit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    zs<span class="token punctuation">.</span><span class="token function">WearTrousers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    zs<span class="token punctuation">.</span><span class="token function">WearLeatherShoes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    zs<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Console<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>不断添加新的衣服怎么办? 原则?</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/微信截图_20180416173121-6a86e986d94ef612e49088550e4c7a34-4a0d2.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 27.923387096774192%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsSAAALEgHS3X78AAABf0lEQVQY04VRu04CQRRdwMJCLdFgbElEYqGFDdZ+AN9gIV+wlluwhoK4xYIQAiHS2FiQbLIhFBYSILBLs0HeyCs8oxIhrMRiPEOMsTHeZHJmzj05M/cMk8lk1geDwd1kMnno9/uiw+EwEkKMDGo8Hp83Go3Her0ut9vtE8oVi8VV789Kp9NbtVrtEyak1+s9e73eNWxNtFetVoOUXywWBBon5ebzuQmU4XsxFDVNM2SzWcOPqSzLp6lU6gyvPf59mSRJe/F4/CKZTDoTicQG80/RC5hAIGD3+/1mj8ezyfO8NRQKHYiiaAHa3W63zeVymVmWtXAcd+jz+ayRSGRXEISjcDhsi0ajO7FYbB9oLxQK2yvX6XRKut2ugvyCy+WSjEajGXK7Gg6Hb7quE+R7gyge6dhAFbprjE2AH9DxyPmFnqG7XRm2Wq1X5COpqsoj/Fmn06nk8/nLJxQ+YlapVHhFUe6bzaYOrZzL5bhyuTzDIxrQsaVSSQP/DnOB+n0BwoAMlw3psu0AAAAASUVORK5CYII=\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="     20180416173121" title="" data-src="/static/微信截图_20180416173121-6a86e986d94ef612e49088550e4c7a34-fee1c.png" data-srcset="/static/微信截图_20180416173121-6a86e986d94ef612e49088550e4c7a34-a67b7.png 200w,\n/static/微信截图_20180416173121-6a86e986d94ef612e49088550e4c7a34-0b187.png 400w,\n/static/微信截图_20180416173121-6a86e986d94ef612e49088550e4c7a34-fee1c.png 800w,\n/static/微信截图_20180416173121-6a86e986d94ef612e49088550e4c7a34-4a0d2.png 992w" data-sizes="(max-width: 800px) 100vw, 800px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="55323035489861930000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class Person\n{\n    private string name;\n    public Person(string name)\n    {\n        this.name = name;\n    }\n\n    public void Show()\n    {\n        Console.WriteLine(&quot;装扮的{0}&quot;, name);\n    }\n}\nabstract class Finery   //服饰\n{\n    public abstract void Show();\n}\n\nclass TShirts : Finery   //T恤\n{\n    public override void Show()\n    {\n        Console.Write(&quot;T恤 &quot;);\n    }\n}\nclass Jeans : Finery   //牛仔裤\n{\n    public override void Show()\n    {\n\n        Console.Write(&quot;牛仔裤 &quot;);\n    }\n}\nclass Sneakers : Finery   //球鞋\n{\n    public override void Show()\n    {\n\n        Console.Write(&quot;球鞋 &quot;);\n    }\n}\nstatic void Main(string[] args)\n{\n    Person zs = new Person(&quot;张三&quot;);\n\n    Console.WriteLine(&quot;\\n第一种装扮：&quot;);\n    Finery tx = new TShirts();\n    Finery nzk = new Jeans();\n    Finery qx = new Sneakers();\n\n    tx.Show();\n    nzk.Show();\n    qx.Show();\n    zs.Show();\n\n    Console.WriteLine(&quot;\\n第二种装扮：&quot;);\n    Finery xz = new Suit();\n    Finery xk = new Trousers();\n    Finery px = new LeatherShoes();\n\n    xz.Show();\n    xk.Show();\n    px.Show();\n    zs.Show();\n\n    Console.Read();\n}`, `55323035489861930000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="cpp"\n              >\n                <span class="gatsby-code-button-language">cpp</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Person</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">private</span> string name<span class="token punctuation">;</span>\n    <span class="token keyword">public</span> <span class="token function">Person</span><span class="token punctuation">(</span>string name<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"装扮的{0}"</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\nabstract <span class="token keyword">class</span> <span class="token class-name">Finery</span>   <span class="token comment">//服饰</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> abstract <span class="token keyword">void</span> <span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">class</span> <span class="token class-name">TShirts</span> <span class="token operator">:</span> Finery   <span class="token comment">//T恤</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> override <span class="token keyword">void</span> <span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">"T恤 "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">class</span> <span class="token class-name">Jeans</span> <span class="token operator">:</span> Finery   <span class="token comment">//牛仔裤</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> override <span class="token keyword">void</span> <span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n\n        Console<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">"牛仔裤 "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">class</span> <span class="token class-name">Sneakers</span> <span class="token operator">:</span> Finery   <span class="token comment">//球鞋</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> override <span class="token keyword">void</span> <span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n\n        Console<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">"球鞋 "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    Person zs <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token string">"张三"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"\\n第一种装扮："</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Finery tx <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">TShirts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Finery nzk <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Jeans</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Finery qx <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Sneakers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    tx<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    nzk<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    qx<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    zs<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"\\n第二种装扮："</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Finery xz <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Suit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Finery xk <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Trousers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Finery px <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">LeatherShoes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    xz<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    xk<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    px<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    zs<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Console<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>期望：内部组装完毕，再显示出来，这就要用到装饰模式。</p>\n<h3 id="模式动机-3"><a href="#%E6%A8%A1%E5%BC%8F%E5%8A%A8%E6%9C%BA-3" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式动机</h3>\n<ul>\n<li>有时我们希望给某个对象而不是整个类添加一些功能。例如：一个图形用户界面工具箱允许我们对任意一个用户界面组件添加一些新的特性，如增加一个边框；或者增加一些行为，如窗口的滚动。</li>\n<li>一种较为灵活的方式是将组件嵌入另一个对象中，由这个对象来添加边框。我们称这个嵌入的对象为装饰器（Decorator）。这个装饰与它所装饰的组件接口一致，因此它对使用该组件的客户透明。它将客户请求转发给该组件，并且可能在转发前后执行一些额外的动作。这种透明性使得我们可以递归嵌套多个装饰，从而可以添加任意多的功能。</li>\n</ul>\n<h3 id="模式定义-3"><a href="#%E6%A8%A1%E5%BC%8F%E5%AE%9A%E4%B9%89-3" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式定义</h3>\n<p>动态地给一个对象增加一些额外的职责（Responsibility），就增加对象功能来说，装饰模式比生成子类实现更为灵活。其别名为包装器(Wrapper)。装饰模式是一种对象结构型模 式。</p>\n<h3 id="模式结构-2"><a href="#%E6%A8%A1%E5%BC%8F%E7%BB%93%E6%9E%84-2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式结构</h3>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/微信截图_20180416173909-5fbaed95ad3c66357ffa0605ccb6aaa1-55e1c.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 689px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 71.26269956458636%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsSAAALEgHS3X78AAAChUlEQVQ4y5VTT2iSYRxWv6+MiXSIqIiI5i2inTqNbkG1hRUsqUPRocMg6NB9jIisiB06hLstiY0hsyamiKJu/pnTDXXzH9v0oMic5lREhx7m2/P7/BaL2sAf/Hg/3uf7nu95fs/7SiRiRSIRGa2xWGwwGo3qHQ6HbmVl5VsqlXpG+4wxSU+1tbXF0bqxsTGKj9nOzg4tDD/6iW2ZRqOR8zwvx/NJNK38sYRer1cg9Pv9z3O5HEM3qtUqg+KvtG80GjmFQkEupGKf+i8RFHBra2t8pVIR/uhyuS6ib87NzY253e7h9fX1K2QXze3t7fGNRkMYjVQqlUt6LMVRwPb2tlS0/m+FQqHXsDUWDAbHYXcMgbzDs+YA9/l81+DgTSAQGE8kEm+TyeRD2u/v7+8T58iLI+gWQmiWy2UhhHQ6zer1OsOHPw7weDz+pNVq0UxZs9lkIAyq1erTgJRyufwc1jPoE38IMaP67u4uKxaLjEKgQuLfD3DM8TH9MJ/Pd4gQbjwqlUpx5FFyOp1qJKxBP4K1Eah8ivM3eAi/DNsjdrv98+Li4igE3BDJZBiNbGFhgZufn5eK7/YUkvI4EBeh+7C0tMStrq7ysC0zmUx9UHIHSm5PTU3dm56eHp6dnX2g0+mu07tarfbszMzMfewNTU5Oqq1W6y2z2XxXr9dfIhxKu6Qej0eQbLFYzofD4X0ERcOnWXZKpRLDCN4TDosD2WxWCCiTyQhNOMb16vBtI5UCoc1mu0BkhUJBCIjSpdrc3JwQj9gAhUchUtdqtX3CcRJeEt5ut7m//BsMBiVUfMDgJxDQJyj4CPIvUD1E+PLy8lXcrAbUV4BVoO4XSMjRC8I7nY7sNzSfwWKfisfVAAAAAElFTkSuQmCC\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="     20180416173909" title="" data-src="/static/微信截图_20180416173909-5fbaed95ad3c66357ffa0605ccb6aaa1-55e1c.png" data-srcset="/static/微信截图_20180416173909-5fbaed95ad3c66357ffa0605ccb6aaa1-f8f03.png 200w,\n/static/微信截图_20180416173909-5fbaed95ad3c66357ffa0605ccb6aaa1-d8034.png 400w,\n/static/微信截图_20180416173909-5fbaed95ad3c66357ffa0605ccb6aaa1-55e1c.png 689w" data-sizes="(max-width: 689px) 100vw, 689px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<ul>\n<li>Component：组件</li>\n<li>ConcreteComponent：具体组件</li>\n<li>Decorator：抽象装饰类</li>\n<li>ConcreteDecorator：具体装饰类</li>\n</ul>\n<p><strong>穿衣服</strong></p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/微信截图_20180416174138-490c8cb7c6d01fe3160aff36b0a1f5ad-5d178.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 44.88752556237218%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAABzElEQVQoz41Su0tCcRS+tzfagyjFsSCXIBr8A8LNraCloSHa3BTEzSBQyiBoMATDaHAQdNMpkQsqPhbx/X5raCIOtviCX9/PDGrJfnD4fee79373nO8chpken8/HEEImuF6v36dSqXAmk3mhuUQiYYVCIcv858Tj8ckdCoVYCM4Dsvl8nhsMBqRWqxWQryiVymWpVLoEvKRSqWaLRqPRX7lOpxOZTKZju92+95MXi8WLM8Visdi3qKharZ6Fw+FLtL9DOaPRyAsEAucul+uiUqnsU85ms/3dOnxaoHcikTgh0wMPlZQrlUoHvV5vwmWzWRvlAOccDgfrdDpZjuMYt9vNBoNBFsX8Fga56/f7r/ADLbw7pBxe4ns8nttIJPJSLpePZnU7Ho8Zxuv1rmu1WoFCoeBN+WWZTMYzm80bcrl8mw6CBqa8qtfrtwwGw5parRZoNBoBMJ9+a7FYNjHEL3/hTRRVdRFPwNZisThKp9N2VPkAblgoFF4Rd8Af2IgQ8DW24A1rVQJWwZZyLpfrgDudCOLBR7/fJ61Wy5FMJrnRaESazaYfnlnRAul2u0m0/Ey97HQ67+AfG40GabfbBCI3ECTD4ZD6fkn1PgGxYCqbl3B6agAAAABJRU5ErkJggg==\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="     20180416174138" title="" data-src="/static/微信截图_20180416174138-490c8cb7c6d01fe3160aff36b0a1f5ad-fee1c.png" data-srcset="/static/微信截图_20180416174138-490c8cb7c6d01fe3160aff36b0a1f5ad-a67b7.png 200w,\n/static/微信截图_20180416174138-490c8cb7c6d01fe3160aff36b0a1f5ad-0b187.png 400w,\n/static/微信截图_20180416174138-490c8cb7c6d01fe3160aff36b0a1f5ad-fee1c.png 800w,\n/static/微信截图_20180416174138-490c8cb7c6d01fe3160aff36b0a1f5ad-5d178.png 978w" data-sizes="(max-width: 800px) 100vw, 800px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="7217359094558695000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`abstract class Appearance\n{\n    public abstract void Show();\n}\nclass Person : Appearance\n{\n    private string name;\n\n    public Person(string name)\n    {\n        this.name = name;\n    }\n\n    public override void Show()\n    {\n        Console.WriteLine(&quot;装扮的{0}&quot;, name);\n    }\n}\nabstract class Finery : Appearance\n{\n    protected Appearance component;\n\n    public void Decorate(Appearance component)\n    {\n        this.component = component;\n    }\n\n    public override void Show()\n    {\n        if (component != null)\n        {\n            component.Show();\n        }\n    }\n}\nclass TShirts : Finery\n{\n    public override void Show()\n    {\n        base.Show();\n        Console.Write(&quot;T恤&quot;);\n\n    }\n}\nclass Jeans : Finery\n{\n    public override void Show()\n    {\n        base.Show();\n        Console.Write(&quot;牛仔裤&quot;);\n    }\n}\nclass Sneakers : Finery\n{\n    public override void Show()\n    {\n        base.Show();\n        Console.Write(&quot;球鞋&quot;);\n    }\n}\nstatic void Main(string[] args)\n{\n    Person xc = new Person(&quot;小菜&quot;);\n\n    Console.WriteLine(&quot;\\n第一种装扮：&quot;);\n\n    Sneakers qx = new Sneakers();\n    Jeans nzk = new Jeans();\n    TShirts tx = new TShirts();\n\n    tx.Decorate(xc);\n    nzk.Decorate(tx);\n    qx.Decorate(nzk);\n\n    qx.Show();\n\n    Console.Read();\n}`, `7217359094558695000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="cpp"\n              >\n                <span class="gatsby-code-button-language">cpp</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp">abstract <span class="token keyword">class</span> <span class="token class-name">Appearance</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> abstract <span class="token keyword">void</span> <span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token operator">:</span> Appearance\n<span class="token punctuation">{</span>\n    <span class="token keyword">private</span> string name<span class="token punctuation">;</span>\n\n    <span class="token keyword">public</span> <span class="token function">Person</span><span class="token punctuation">(</span>string name<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">public</span> override <span class="token keyword">void</span> <span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"装扮的{0}"</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\nabstract <span class="token keyword">class</span> <span class="token class-name">Finery</span> <span class="token operator">:</span> Appearance\n<span class="token punctuation">{</span>\n    <span class="token keyword">protected</span> Appearance component<span class="token punctuation">;</span>\n\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Decorate</span><span class="token punctuation">(</span>Appearance component<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>component <span class="token operator">=</span> component<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">public</span> override <span class="token keyword">void</span> <span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">if</span> <span class="token punctuation">(</span>component <span class="token operator">!=</span> null<span class="token punctuation">)</span>\n        <span class="token punctuation">{</span>\n            component<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">class</span> <span class="token class-name">TShirts</span> <span class="token operator">:</span> Finery\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> override <span class="token keyword">void</span> <span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        base<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        Console<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">"T恤"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">class</span> <span class="token class-name">Jeans</span> <span class="token operator">:</span> Finery\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> override <span class="token keyword">void</span> <span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        base<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        Console<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">"牛仔裤"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">class</span> <span class="token class-name">Sneakers</span> <span class="token operator">:</span> Finery\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> override <span class="token keyword">void</span> <span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        base<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        Console<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">"球鞋"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    Person xc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token string">"小菜"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"\\n第一种装扮："</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Sneakers qx <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Sneakers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Jeans nzk <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Jeans</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    TShirts tx <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">TShirts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    tx<span class="token punctuation">.</span><span class="token function">Decorate</span><span class="token punctuation">(</span>xc<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    nzk<span class="token punctuation">.</span><span class="token function">Decorate</span><span class="token punctuation">(</span>tx<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    qx<span class="token punctuation">.</span><span class="token function">Decorate</span><span class="token punctuation">(</span>nzk<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    qx<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Console<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="模式应用-2"><a href="#%E6%A8%A1%E5%BC%8F%E5%BA%94%E7%94%A8-2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式应用</h3>\n<p><strong>星巴克咖啡订单管理系统管理</strong></p>\n<ul>\n<li>如果有一张订单：“双倍摩卡豆浆奶泡拿铁咖啡”，应该如何进行设计？</li>\n<li>如果有一张订单：“奶泡摩卡加冰浓缩咖啡”，应该如何进行设计？</li>\n</ul>\n<p><em>实现一</em></p>\n<p>类爆炸</p>\n<ul>\n<li>调料的增加/删除</li>\n<li>调料价格的修改</li>\n</ul>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/微信截图_20180416175157-1aca7bfbf4ed11934773f14d628b9e5e-19cac.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 58.91891891891892%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsSAAALEgHS3X78AAABvElEQVQoz4VS226CQBTc//8GP6A2adM+tE0fqjYFUQRvuLuAclEEjBrEaxUL7ShpX2zTkw2Xw8zOnFnI50UdDocwDIMgYJT5gT+dTjljafpxiSSXrePxyDmzbWu32223281mozTkJDngU5Zl/5DTNB17HsSjKNq/v+/3+1azmSTJn+TsXKDhOY7j4tVVoVC4Lhbv7+5ub25KLy+wk8OAyb6L5LefzeBzMBj0+33TNIfnsm3bdV1EsFqtflFGa71eL+MYVnWue54H2+AYhoErXkejke/7+SCnJINgPp8vooggj8lkghfHcYAYui7VNDT98Rid2WwGQXiBODCgoZ+XqigECMe2aa/X0zSd8zqqVkNCTVVFxzQMrdvlnGMSnFm5VHp+ehIF4fHhwbYsAqggvCmNhnk2CXHLsnRdR6cqCjAl1+uvlUq1KvZNYxKGiAOyYEKSgICNa5IEGkzSkwMNiOVyiQkhK8syNHHmjFIs+EeKhq5jazIaDvNJ2q2WpnXb7Ta8YIGmqqp1Th58TIhZsDCfJElVUcQHAsGTlHkq/IZY0WKBHBRFgYtKuYycgKGUooMoGGMYynWcTqfzBfZsgkCl7S84AAAAAElFTkSuQmCC\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="     20180416175157" title="" data-src="/static/微信截图_20180416175157-1aca7bfbf4ed11934773f14d628b9e5e-fee1c.png" data-srcset="/static/微信截图_20180416175157-1aca7bfbf4ed11934773f14d628b9e5e-a67b7.png 200w,\n/static/微信截图_20180416175157-1aca7bfbf4ed11934773f14d628b9e5e-0b187.png 400w,\n/static/微信截图_20180416175157-1aca7bfbf4ed11934773f14d628b9e5e-fee1c.png 800w,\n/static/微信截图_20180416175157-1aca7bfbf4ed11934773f14d628b9e5e-b1a91.png 1200w,\n/static/微信截图_20180416175157-1aca7bfbf4ed11934773f14d628b9e5e-19cac.png 1295w" data-sizes="(max-width: 800px) 100vw, 800px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p><em>实现二</em></p>\n<p>使用实例变量和继承，跟踪这些调料</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/微信截图_20180416175322-0972d827b1f7f53729e6364b2225238c-78894.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 61.877394636015325%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsSAAALEgHS3X78AAABcklEQVQoz4WS226CUBBF+f+PsonyJhbqi9ESvHA/cFDEKheBLiBaa9N2AjJ4Zs+s2aq4rns8Htfr9WSizufz/X5Pvlgs2rat67osy/NHF+fz+Xq9tt9D2W63y+WSFoc+qA6CQNOmnFVVJcIwjqLhqCrLZ/Guj6au8zynmmlSSm06ZQ6v9Gqapv0lFCDXlkUGWFEUaKIo0nWdJD0c+PKYpomUrAM883nliuM4TdNOvFqtLMtCw/Kn08m2bU3TaGTvdmEQ0AIW3/dR0iISYrgC31fCMHQchzOGAAk2XQ1Dh5kunuehoKnnuo5jRyLKsgwQ3/M6MQNN8/3RD3jeDKOGXwhKQbhcLrInT5IE5u4hJUln2GQ8RkzRXWzoOskfVn25raoqPxjtB/1dzArAD5Nxq7yhNbdQWOxlNDJNs+qDCiHEbDY7ZZmMu4CQT+4iz58nswx6ppUPO+v6K/5h1T/YzMHSzWYDPzl/FSzEsPvOd8if4k/9NabbWwyt2wAAAABJRU5ErkJggg==\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="     20180416175322" title="" data-src="/static/微信截图_20180416175322-0972d827b1f7f53729e6364b2225238c-fee1c.png" data-srcset="/static/微信截图_20180416175322-0972d827b1f7f53729e6364b2225238c-a67b7.png 200w,\n/static/微信截图_20180416175322-0972d827b1f7f53729e6364b2225238c-0b187.png 400w,\n/static/微信截图_20180416175322-0972d827b1f7f53729e6364b2225238c-fee1c.png 800w,\n/static/微信截图_20180416175322-0972d827b1f7f53729e6364b2225238c-78894.png 1044w" data-sizes="(max-width: 800px) 100vw, 800px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p><em>实现三</em></p>\n<p>应用以上的装饰模式</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/微信截图_20180416175553-0b41751d7a523b4959a4cbfce5042581-ff4c9.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 51.288056206088996%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsSAAALEgHS3X78AAAByklEQVQozz1SSW+bQBjl3ze35JRKqVKlzSFNQmsj1WzGNoqBHNK0Akv44FRg7GG1wQs29nhpH6UJ0qBh+N7yvW+YP6/P8Xg8HA5FUYRhOJlM4jgmZDydTler1Xw+n81meZ7v93vUvEEYrO12myQJqsfjcRRFYMEhpRTI5XKZZmn1NwyDOIrAAoHdjpZgkOFH9HoKdVCYpvnQ7TYVRW429UfD9/1ZlhHfT9MUjKiEnRK8KQrXdfq2vftn6cfTk6bpum602+1OR8XiBeFbrd7v94F0HQfUge/DUQmmdJvnC9P8RQgB6O7+Hpo3N184juN5AeKqqkqSfHn50fNGi8UCTtHmDr4pZWDVsqyzs1NN00RJ0o1HQRS/NxoiPmS5o6pKq4UNwCgIgmAwGAyHQ2Q5Go0Y27Y/XV39fnmBDejohmFZvQbP12p1URS7WtkEy369uPgQRhFiRzqIAJ0jV9imcFIlDMp3JycsywqCUOc4RWkpioIWzs/fPz//zLIMSGgmcVINhSnTyzKECFaM13EcWZZbsCpJEPx8fX17e9fr9UC9Xq+RE6LG5v+cqzbwxh3wPK+aASpcdwgiQvzNZjNJEnRIcAvCEBm93ZO/XTEId0MxPycAAAAASUVORK5CYII=\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="     20180416175553" title="" data-src="/static/微信截图_20180416175553-0b41751d7a523b4959a4cbfce5042581-fee1c.png" data-srcset="/static/微信截图_20180416175553-0b41751d7a523b4959a4cbfce5042581-a67b7.png 200w,\n/static/微信截图_20180416175553-0b41751d7a523b4959a4cbfce5042581-0b187.png 400w,\n/static/微信截图_20180416175553-0b41751d7a523b4959a4cbfce5042581-fee1c.png 800w,\n/static/微信截图_20180416175553-0b41751d7a523b4959a4cbfce5042581-b1a91.png 1200w,\n/static/微信截图_20180416175553-0b41751d7a523b4959a4cbfce5042581-ff4c9.png 1281w" data-sizes="(max-width: 800px) 100vw, 800px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<h3 id="优缺点-3"><a href="#%E4%BC%98%E7%BC%BA%E7%82%B9-3" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>优缺点</h3>\n<ul>\n<li>\n<p>优点</p>\n<ul>\n<li>装饰模式与继承关系的目的都是要扩展对象的功能，但是装饰模式可以提供比继承更多的灵活性。</li>\n<li>通过使用不同的具体装饰类以及这些装饰类的排列组合，设计师可以创造出很多不同行为的组合。</li>\n<li>这种比继承更加灵活机动的特性，也同时意味着装饰模式比继承更加易于出错。</li>\n</ul>\n</li>\n<li>\n<p>缺点</p>\n<ul>\n<li>采用装饰模式进行系统设计往往会产生许多看上去类似的小对象，这些对象仅仅在他们相互连接的方式上有所不同，而不是它们的类或是它们的属性值有所不同。尽管对于那些了解这些系统的人来说，很容易对它们进行定制，但是很难学习这些系统，排错也很困难。</li>\n</ul>\n</li>\n</ul>\n<h3 id="模式使用-3"><a href="#%E6%A8%A1%E5%BC%8F%E4%BD%BF%E7%94%A8-3" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式使用</h3>\n<ul>\n<li>在不影响其它对象的情况下，以动态、透明的方式给单个对象添加职责。 需要动态地给一个对象增加功能，这些功能可以再动态地被撤销。</li>\n<li>当不能采用生成子类的方法进行扩充时。一种情况是，可能有大量独立的扩展，每一种组合将产生大量的子类，使得子类数目呈爆炸性增长。另一种情况可能是因为类定义不能继承(final 类)，或类不能用于生成子类。</li>\n</ul>\n<h3 id="需要注意的问题"><a href="#%E9%9C%80%E8%A6%81%E6%B3%A8%E6%84%8F%E7%9A%84%E9%97%AE%E9%A2%98" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>需要注意的问题</h3>\n<ul>\n<li>一个装饰类的接口必须与被装饰类的接口保持相同，对于客户端来说无论是装饰之前的对象还是装饰之后的对象都可以一致对待。</li>\n<li>尽量保持具体构件类 Component 作为一个“轻”类，也就是说不要把太多的逻辑和状态放在具体构件类中，可以通过装饰类对其进行扩展。</li>\n</ul>',
id:"/home/runner/work/GatsbyBlog/GatsbyBlog/blog/设计模式之结构型模式（一）/index.md absPath of file >>> MarkdownRemark",timeToRead:15,frontmatter:{date:"2018-04-19 00:04:24",path:"/design-pattern-structure-1/",tags:"面试, 设计模式, 读书笔记",title:"设计模式之结构型模式（一）",draft:null}},{excerpt:"根据其目的（模式是用来做什么的）可分为创建型(Creational)，结构型(Structural)和行为型(Behavioral)三种： 创建型模式主要用于创建对象。 结构型模式主要用于处理类或对象的组合。 行为型模式主要用于描述对类或对象怎样交互和怎样分配职责。 创建型模式 单例模式(Singleton…",html:'<p>根据其目的（模式是用来做什么的）可分为创建型(Creational)，结构型(Structural)和行为型(Behavioral)三种：</p>\n<ul>\n<li>创建型模式主要用于创建对象。</li>\n<li>结构型模式主要用于处理类或对象的组合。</li>\n<li>行为型模式主要用于描述对类或对象怎样交互和怎样分配职责。</li>\n</ul>\n<h1 id="创建型模式"><a href="#%E5%88%9B%E5%BB%BA%E5%9E%8B%E6%A8%A1%E5%BC%8F" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>创建型模式</h1>\n<h2 id="单例模式singleton"><a href="#%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8Fsingleton" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>单例模式(Singleton)</h2>\n<p>保证一个类仅有一个实例，并提供一个访问它的全局访问点。</p>\n<h3 id="模式动机"><a href="#%E6%A8%A1%E5%BC%8F%E5%8A%A8%E6%9C%BA" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式动机</h3>\n<p>对于系统中的某些类来说，有且只能有一个实例。例如：一个系统只能有一个窗口管理器。系统中可以有许多打印机，但是只能有一个打印机正在工作。</p>\n<h3 id="模式定义"><a href="#%E6%A8%A1%E5%BC%8F%E5%AE%9A%E4%B9%89" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式定义</h3>\n<p>单例模式确保某一个类只有一个实例，而且自行实例化并向整个系统提供这个实例，这个类称为单例类，它提供全局访问的方法。</p>\n<p>单例模式的要点有三个：</p>\n<ol>\n<li>一是某个类只能有一个实例；</li>\n<li>是它必须自行创建这个实例；</li>\n<li>是它必须自行向整个系统提供这个实例，单例模式是一种对象创建型模式。</li>\n</ol>\n<h3 id="模式结构"><a href="#%E6%A8%A1%E5%BC%8F%E7%BB%93%E6%9E%84" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式结构</h3>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/微信截图_20180414223904-868c28dcaedda7cd82b789e0ce757643-fee1c.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 51.25000000000001%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsSAAALEgHS3X78AAABKUlEQVQoz52RyY6DQAxE+f8P4xRBFMQqhmUggMSBJSxhS8+jW4zmPHVAttuuKhttmibP88qyfF7I89xxnDAMgyD4kojj+PkHRVHwuq6rNgwDiRDi8/kIiX3fGbjdbrqup2lq2zZc4oJqg2Ke53PYNM0sy74lVMA3SRLf9wmQJYaFOJdADMZlWbRxHNGBiRma8MMbrKxDXSnXdR1FET2Y2rYNZShOZYbv97viTiSUCIJ0wEhKoBypnauqYpH3+30Ou66rbmNZFpdDPJZAfJagj/MsEqSIo3EO00Ff13V930NJ2jRN27aQEhzHgVXuQuUlQR0Ktdo5zMEejweCfHGBPovw/zgYRvDMk2EYtDkSXAGn58HwwDwelEkV/6aDhCrOFyYJzqbhSvwXP2fxJsyrZ2vyAAAAAElFTkSuQmCC\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="     20180414223904" title="" data-src="/static/微信截图_20180414223904-868c28dcaedda7cd82b789e0ce757643-fee1c.png" data-srcset="/static/微信截图_20180414223904-868c28dcaedda7cd82b789e0ce757643-a67b7.png 200w,\n/static/微信截图_20180414223904-868c28dcaedda7cd82b789e0ce757643-0b187.png 400w,\n/static/微信截图_20180414223904-868c28dcaedda7cd82b789e0ce757643-fee1c.png 800w" data-sizes="(max-width: 800px) 100vw, 800px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="94696168866755380000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`public class Singleton\n{\n    //4：定义一个变量来存储创建好的类实例\n    //5：因为这个变量要在静态方法中使用，所以需要加上static修饰\n    private static Singleton instance = null;\n    //1：私有化构造方法，便于在内部控制创建实例的数目\n    private Singleton()\n    {\n    }\n    //2：定义一个方法来为客户端提供类实例\n    //3：这个方法需要定义成类方法，也就是要加static\n    public static Singleton GetInstance(){\n        //6：判断存储实例的变量是否有值\n        if(instance == null){\n          //6.1：如果没有，就创建一个类实例，并把值赋给存储类实例的变量\n          instance = new Singleton();\n        }\n        //6.2：如果有值，那就直接使用\n        return instance;\n    }\n}`, `94696168866755380000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="cpp"\n              >\n                <span class="gatsby-code-button-language">cpp</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Singleton</span>\n<span class="token punctuation">{</span>\n    <span class="token comment">//4：定义一个变量来存储创建好的类实例</span>\n    <span class="token comment">//5：因为这个变量要在静态方法中使用，所以需要加上static修饰</span>\n    <span class="token keyword">private</span> <span class="token keyword">static</span> Singleton instance <span class="token operator">=</span> null<span class="token punctuation">;</span>\n    <span class="token comment">//1：私有化构造方法，便于在内部控制创建实例的数目</span>\n    <span class="token keyword">private</span> <span class="token function">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n    <span class="token punctuation">}</span>\n    <span class="token comment">//2：定义一个方法来为客户端提供类实例</span>\n    <span class="token comment">//3：这个方法需要定义成类方法，也就是要加static</span>\n    <span class="token keyword">public</span> <span class="token keyword">static</span> Singleton <span class="token function">GetInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>\n        <span class="token comment">//6：判断存储实例的变量是否有值</span>\n        <span class="token keyword">if</span><span class="token punctuation">(</span>instance <span class="token operator">==</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>\n          <span class="token comment">//6.1：如果没有，就创建一个类实例，并把值赋给存储类实例的变量</span>\n          instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n        <span class="token comment">//6.2：如果有值，那就直接使用</span>\n        <span class="token keyword">return</span> instance<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="优缺点"><a href="#%E4%BC%98%E7%BC%BA%E7%82%B9" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>优缺点</h3>\n<ul>\n<li>\n<p>优点</p>\n<ul>\n<li>提供了对唯一实例的受控访问。</li>\n<li>由于系统中只存在一个对象，因此可以节约系统资源，对于一些需要频繁创建和销毁的对象，单例模式无疑可以提高系统的性能。</li>\n<li>允许可变数目的实例。可以对单例模式进行扩展，设计指定个数的实例对象，即节省系统资源，又解决了由于单例对象共享过多有损性能的问题</li>\n</ul>\n</li>\n<li>\n<p>缺点</p>\n<ul>\n<li>由于单例模式中没有抽象层，因此单例类的扩展有很大困难。</li>\n<li>单例类的职责过重，在一定程度上违背了单一职责原则。因为单例模式既提供业务方法，又提供了创建对象的方法，将对象功能和创建耦合在一起。</li>\n<li>很多面向对象语言的 GC 垃圾回收技术，实例化的对象长期不使用，系统会认为是垃圾，自动销毁并回收资源，这将导致共享的单例对象状态的丢失。</li>\n</ul>\n</li>\n</ul>\n<h3 id="模式使用"><a href="#%E6%A8%A1%E5%BC%8F%E4%BD%BF%E7%94%A8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式使用</h3>\n<ul>\n<li>系统只需要一个实例对象。例如，系统要求提供一个唯一的系列号生成器或资源管理器，或资源消耗太大而只允许创建一个对象。</li>\n<li>客户调用类的单个实例只允许使用一个公共访问点。</li>\n</ul>\n<p><strong>例子一</strong></p>\n<p>问： 我的一个系统需要一些“全局”变量。学习了单例模式后，我发现可以使用一个单例类盛放所有的“全局”变量。请问这样做对吗？</p>\n<p>答：这样做是违背单例模式的用意的。单例模式只应当在有真正的“单一实例”的需求时才可使用。</p>\n<blockquote>\n<p>设计得当的系统不应当有所谓的“全局”变量，这些变量一个应当放到它们所描述的实体所对应的类中去。将这些变量从它们所描述的实体类中抽出来，放到一个不相干的单例类中去，会使得这些变量产生错误的依赖关系和耦合关系。</p>\n</blockquote>\n<p><strong>例子二</strong></p>\n<p>问：我的一个系统需要管理与数据库的连接。学习了单例模式后，我发现可以使用一个单例类包装一个 Connection 对象，并在 finalize() 方法中关闭这个 Connection 对象。这样的话，在这个单例类的实例没有被人引用时，这个 finalize()对象就会被调用，因此，Connection 对象就会被释放。这多妙啊。</p>\n<p>答：这样做是不恰当的。除非有单一实例的需求，不然不要使用单例模式。在这里 Connection 对象可以同时有几个实例共存，不需要是单一实例。</p>\n<blockquote>\n<p>单例模式有很多的错误使用案例都与此例子相似，它们都是试图使用单例模式管理共享资源的生命周期，这是不恰当的。</p>\n</blockquote>\n<h3 id="模式应用"><a href="#%E6%A8%A1%E5%BC%8F%E5%BA%94%E7%94%A8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式应用</h3>\n<ul>\n<li>数据库主键编号分配</li>\n</ul>\n<h3 id="单例模式扩展"><a href="#%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F%E6%89%A9%E5%B1%95" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>单例模式扩展</h3>\n<ul>\n<li>高并发、线程不安全</li>\n<li>懒汉式单例</li>\n<li>饿汉式单例</li>\n<li>单例模式—管理多个对象</li>\n</ul>\n<p><strong>懒汉式单例</strong></p>\n<ul>\n<li>单例模式在整个应用程序的生命周期中只存在一个实例</li>\n<li>懒汉式单例就是这个单例类的这个唯一实例 new 是在第一次使用 GetInstance()时实例化的</li>\n<li>如果不调用 GetInstance() 的话，这个实例是不会存在的，即为 null</li>\n<li>形象点说呢，就是你不去动它的话，它自己是不会实例化的，所以可以称之为懒汉。</li>\n<li>前面在介绍单例模式的这几个 Demo 中都是使用的懒汉式单例</li>\n</ul>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="67143637983452440000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`public class Singleton\n{\n    private static Singleton singleton;\n    //定义一个只读静态对象\n    //且这个对象是在程序运行时创建的\n    private static readonly object syncObject = new object();\n    private Singleton()\n    {}\n    public static Singleton GetInstance()\n    {\n        //第一重 singleton == null，为了性能，解释如下\n        if (singleton == null)\n        {\n            // 单线程\n            lock (syncObject)\n            {\n                //第二重 singleton == null，为了单一实例\n                if (singleton == null)\n                {\n                    singleton = new Singleton();\n                }\n            }\n        }\n        return singleton;\n    }\n}`, `67143637983452440000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="cpp"\n              >\n                <span class="gatsby-code-button-language">cpp</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Singleton</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">private</span> <span class="token keyword">static</span> Singleton singleton<span class="token punctuation">;</span>\n    <span class="token comment">//定义一个只读静态对象</span>\n    <span class="token comment">//且这个对象是在程序运行时创建的</span>\n    <span class="token keyword">private</span> <span class="token keyword">static</span> readonly object syncObject <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">private</span> <span class="token function">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span><span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token keyword">static</span> Singleton <span class="token function">GetInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token comment">//第一重 singleton == null，为了性能，解释如下</span>\n        <span class="token keyword">if</span> <span class="token punctuation">(</span>singleton <span class="token operator">==</span> null<span class="token punctuation">)</span>\n        <span class="token punctuation">{</span>\n            <span class="token comment">// 单线程</span>\n            lock <span class="token punctuation">(</span>syncObject<span class="token punctuation">)</span>\n            <span class="token punctuation">{</span>\n                <span class="token comment">//第二重 singleton == null，为了单一实例</span>\n                <span class="token keyword">if</span> <span class="token punctuation">(</span>singleton <span class="token operator">==</span> null<span class="token punctuation">)</span>\n                <span class="token punctuation">{</span>\n                    singleton <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n                <span class="token punctuation">}</span>\n            <span class="token punctuation">}</span>\n        <span class="token punctuation">}</span>\n        <span class="token keyword">return</span> singleton<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<blockquote>\n<p>如果没有第一重 singleton == null 的话，每一次有线程调用 GetInstance（）时，均会执行锁定操作来实现线程同步，这是非常耗费性能的。而如果加上第一重 singleton == null 的话，那么就只有在第一次，也就是 singleton ==null 成立时的情况下执行一次锁定以实现线程同步，而以后的话，便只要直接返回 Singleton 实例就 OK 了而根本无需再进入 lock 语句块了，这样就可以解决由线程同步带来的性能问题了。</p>\n</blockquote>\n<p><strong>饿汉式单例</strong></p>\n<ul>\n<li>饿汉式单例的话，则刚好相反，</li>\n<li>其由于肚子饿了，所以到处找东西吃，人也变得主动了很多，所以根本就不需要别人来催他实例化单例类的为一实例，</li>\n<li>其自己就会主动实例化单例类的这个唯一类。</li>\n</ul>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="465037846633720200"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`//\npublic class Singleton\n{\n    private static readonly Singleton singleton = new Singleton();\n\n    private Singleton()\n    {\n    }\n\n    public static Singleton GetInstance()\n    {\n        return singleton;\n    }\n}`, `465037846633720200`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="cpp"\n              >\n                <span class="gatsby-code-button-language">cpp</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token comment">//</span>\n<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Singleton</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">private</span> <span class="token keyword">static</span> readonly Singleton singleton <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">private</span> <span class="token function">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">public</span> <span class="token keyword">static</span> Singleton <span class="token function">GetInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> singleton<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<ul>\n<li>C# 与 CLR 会自动解决前面提到的懒汉式单例类时出现的多线程同步问题</li>\n<li>上面的饿汉式单例类中可以看到，当整个类被加载的时候，就会自行初始化 singleton 这个静态只读变量。</li>\n<li>而非在第一次调用 GetInstance（）时再来实例化单例类的唯一实例，所以这就是一种饿汉式的单例类。</li>\n<li>在 C# 中，可以用特殊的方式实现饿汉式单例，即使用静态初始化来完成饿汉式单例模式。</li>\n</ul>\n<p><strong>单例模式—管理多个对象</strong></p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="32968115603780858000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`public class Singleton\n{\n    private static int maxTeacherNum = 5;\n    private static IList<Singleton> Singletons;\n    private Singleton()\n    {  }\n    public static Singleton GetInstance()\n    {\n        if (Singletons == null)\n        {\n            Singletons = new List<Singleton>();\n            for (int i = 0; i < maxTeacherNum; i++)\n            {\n                Singletons.Add(new Singleton());\n            }\n        }\n        Random random = new Random();\n        int k = random.Next(0, maxTeacherNum);\n        Console.WriteLine(&quot;ID=&quot;+ k);\n        return Singletons[k];\n    }\n}\nstatic void Main(string[] args)\n{\n    Singleton singletonOne = Singleton.GetInstance();\n\n    for (int i = 0; i < 2; i++)\n    {\n        Singleton singletonTwo = Singleton.GetInstance();\n        if (singletonOne.Equals(singletonTwo))\n        {\n            Console.WriteLine(&quot;singletonOne 和 singletonTwo 代表的是同一个实例&quot;);\n        }\n        else\n        {\n            Console.WriteLine(&quot;singletonOne 和 singletonTwo 代表的是不同实例&quot;);\n        }\n    }\n    Console.ReadKey();\n}`, `32968115603780858000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="cpp"\n              >\n                <span class="gatsby-code-button-language">cpp</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Singleton</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">int</span> maxTeacherNum <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>\n    <span class="token keyword">private</span> <span class="token keyword">static</span> IList<span class="token operator">&lt;</span>Singleton<span class="token operator">></span> Singletons<span class="token punctuation">;</span>\n    <span class="token keyword">private</span> <span class="token function">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>  <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token keyword">static</span> Singleton <span class="token function">GetInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">if</span> <span class="token punctuation">(</span>Singletons <span class="token operator">==</span> null<span class="token punctuation">)</span>\n        <span class="token punctuation">{</span>\n            Singletons <span class="token operator">=</span> <span class="token keyword">new</span> List<span class="token operator">&lt;</span>Singleton<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> maxTeacherNum<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>\n            <span class="token punctuation">{</span>\n                Singletons<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n            <span class="token punctuation">}</span>\n        <span class="token punctuation">}</span>\n        Random random <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">int</span> k <span class="token operator">=</span> random<span class="token punctuation">.</span><span class="token function">Next</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> maxTeacherNum<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"ID="</span><span class="token operator">+</span> k<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">return</span> Singletons<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    Singleton singletonOne <span class="token operator">=</span> Singleton<span class="token punctuation">.</span><span class="token function">GetInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">2</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Singleton singletonTwo <span class="token operator">=</span> Singleton<span class="token punctuation">.</span><span class="token function">GetInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">if</span> <span class="token punctuation">(</span>singletonOne<span class="token punctuation">.</span><span class="token function">Equals</span><span class="token punctuation">(</span>singletonTwo<span class="token punctuation">)</span><span class="token punctuation">)</span>\n        <span class="token punctuation">{</span>\n            Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"singletonOne 和 singletonTwo 代表的是同一个实例"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n        <span class="token keyword">else</span>\n        <span class="token punctuation">{</span>\n            Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"singletonOne 和 singletonTwo 代表的是不同实例"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n    Console<span class="token punctuation">.</span><span class="token function">ReadKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="工厂方法模式factory-method"><a href="#%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8Ffactory-method" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>工厂方法模式(Factory Method)</h2>\n<p>定义一个用于创建对象的接口，让子类决定实例化哪一个类。</p>\n<h3 id="简单工厂问题背景"><a href="#%E7%AE%80%E5%8D%95%E5%B7%A5%E5%8E%82%E9%97%AE%E9%A2%98%E8%83%8C%E6%99%AF" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>简单工厂问题背景</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="25327419394295260000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class Operation\n{\n    public static double GetResult(double numberA, double numberB, string operate)\n    {\n        double result = 0;\n        switch (operate)\n        {\n            case &quot;+&quot;:\n                result = numberA + numberB;\n                break;\n            case &quot;-&quot;:\n                result = numberA - numberB;\n                break;\n            case &quot;*&quot;:\n                result = numberA * numberB;\n                break;\n            case &quot;/&quot;:\n                result = numberA / numberB;\n                break;\n        }\n        return result;\n    }\n}`, `25327419394295260000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="cpp"\n              >\n                <span class="gatsby-code-button-language">cpp</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Operation</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">double</span> <span class="token function">GetResult</span><span class="token punctuation">(</span><span class="token keyword">double</span> numberA<span class="token punctuation">,</span> <span class="token keyword">double</span> numberB<span class="token punctuation">,</span> string operate<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">double</span> result <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>\n        <span class="token keyword">switch</span> <span class="token punctuation">(</span>operate<span class="token punctuation">)</span>\n        <span class="token punctuation">{</span>\n            <span class="token keyword">case</span> <span class="token string">"+"</span><span class="token operator">:</span>\n                result <span class="token operator">=</span> numberA <span class="token operator">+</span> numberB<span class="token punctuation">;</span>\n                <span class="token keyword">break</span><span class="token punctuation">;</span>\n            <span class="token keyword">case</span> <span class="token string">"-"</span><span class="token operator">:</span>\n                result <span class="token operator">=</span> numberA <span class="token operator">-</span> numberB<span class="token punctuation">;</span>\n                <span class="token keyword">break</span><span class="token punctuation">;</span>\n            <span class="token keyword">case</span> <span class="token string">"*"</span><span class="token operator">:</span>\n                result <span class="token operator">=</span> numberA <span class="token operator">*</span> numberB<span class="token punctuation">;</span>\n                <span class="token keyword">break</span><span class="token punctuation">;</span>\n            <span class="token keyword">case</span> <span class="token string">"/"</span><span class="token operator">:</span>\n                result <span class="token operator">=</span> numberA <span class="token operator">/</span> numberB<span class="token punctuation">;</span>\n                <span class="token keyword">break</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n        <span class="token keyword">return</span> result<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Switch 中添加一个分支就可以了，运算 + - * / 的代码 GetResult 是正确的，却需要在修改的时候暴露，违反了开放封闭原则，继续改进。</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/简单工厂20180415131811-b6a57d96c2ba2be0bfe8b059255a28d0-f5f2a.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 683px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 57.68667642752562%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsSAAALEgHS3X78AAACFUlEQVQoz41TyYoTURQtU7EF485tQHEIqNtubRChy477hl75CcGFfoKCAyL0InsXQWgQoYPRBCQuUlYkkyHzPM/zSCY3eZ5bdIHR0N0XHm84t847755bHIeoVqvnaM7lctvj8fig0Wi8ttlsb4rF4qter3cQDAZvEd5sNuW8UyOTyfA0J5PJZ4vFgs1mM9ZqtRjIGAWI9wkHxp+JMBKJyInRaPQpkfT7fTaZTFin01khrNVqpxN2u10VnqSmdSgU2o7H42/D4fBLjKN8Pv8C+3e46Dbh4OYxVBjytwaDgTtzaDSaKyfhWq32wlqgUqnsmEwmAeMRnqaPxWJ3dTrdRcIcDselVCq1k81mBaPRqDebzbswUO/3++8AVitKV4JqhNqwer0u12s4HP7CsVyrRCJxdTqdTui8VCrJRlGgxp+UEvxHSCaMRiPZ2fl8TgaEcbxBGGp7E630WzEJLcWWyyUrl8ufjwk3kM+n02m5nQqFAsd5vV4BZghQ8EAUxU2Px3P97wvdbvemz+d7CHMEPP2+0+nccrlc2n+FgWy1Ry0Wy2Uo/YCnH1qt1i/oTfNgMPgGNftKDkiv4ewjLj+02+1fof4I6r9j3iMcalXUzOdpEwgE7rE1gQveK4T4YG9dDjx4Tjj+MDUHx2SpkiTdgKqfGFK73ZbQnyLWAdz+RCFEb27BdR/OfqD2EghE7INQ/Pj42fwfnfe9AoILz5AAAAAASUVORK5CYII=\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="    20180415131811" title="" data-src="/static/简单工厂20180415131811-b6a57d96c2ba2be0bfe8b059255a28d0-f5f2a.png" data-srcset="/static/简单工厂20180415131811-b6a57d96c2ba2be0bfe8b059255a28d0-d96b4.png 200w,\n/static/简单工厂20180415131811-b6a57d96c2ba2be0bfe8b059255a28d0-b52f8.png 400w,\n/static/简单工厂20180415131811-b6a57d96c2ba2be0bfe8b059255a28d0-f5f2a.png 683w" data-sizes="(max-width: 683px) 100vw, 683px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="96448194305887730000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class Operation\n{\n    private double _numberA = 0;\n    private double _numberB = 0;\n\n    public double NumberA\n    {\n        get\n        { return _numberA;}\n        set\n        { _numberA = value;}\n    }\n    public double NumberB\n    {\n        get\n        { return _numberB;}\n        set\n        { _numberB = value;}\n    }\n    public virtual double GetResult()\n    {\n        return 0;\n    }\n}\n\n// 加法类，其他同理\nclass OperationAdd : Operation\n{\n    public override double GetResult()\n    {\n        double result = 0;\n        result = NumberA + NumberB;\n        return result;\n    }\n}\n\n// 调用\nOperationAdd add = new OperationAdd();\nadd.NumberA = double.Parse(strNumberA);\nadd.NumberB = double.Parse(strNumberB);\nstrResult = add.GetResult().ToString();`, `96448194305887730000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="cpp"\n              >\n                <span class="gatsby-code-button-language">cpp</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Operation</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">private</span> <span class="token keyword">double</span> _numberA <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>\n    <span class="token keyword">private</span> <span class="token keyword">double</span> _numberB <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">public</span> <span class="token keyword">double</span> NumberA\n    <span class="token punctuation">{</span>\n        get\n        <span class="token punctuation">{</span> <span class="token keyword">return</span> _numberA<span class="token punctuation">;</span><span class="token punctuation">}</span>\n        set\n        <span class="token punctuation">{</span> _numberA <span class="token operator">=</span> value<span class="token punctuation">;</span><span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token keyword">double</span> NumberB\n    <span class="token punctuation">{</span>\n        get\n        <span class="token punctuation">{</span> <span class="token keyword">return</span> _numberB<span class="token punctuation">;</span><span class="token punctuation">}</span>\n        set\n        <span class="token punctuation">{</span> _numberB <span class="token operator">=</span> value<span class="token punctuation">;</span><span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token keyword">virtual</span> <span class="token keyword">double</span> <span class="token function">GetResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// 加法类，其他同理</span>\n<span class="token keyword">class</span> <span class="token class-name">OperationAdd</span> <span class="token operator">:</span> Operation\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> override <span class="token keyword">double</span> <span class="token function">GetResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">double</span> result <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>\n        result <span class="token operator">=</span> NumberA <span class="token operator">+</span> NumberB<span class="token punctuation">;</span>\n        <span class="token keyword">return</span> result<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// 调用</span>\nOperationAdd add <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">OperationAdd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nadd<span class="token punctuation">.</span>NumberA <span class="token operator">=</span> <span class="token keyword">double</span><span class="token punctuation">.</span><span class="token function">Parse</span><span class="token punctuation">(</span>strNumberA<span class="token punctuation">)</span><span class="token punctuation">;</span>\nadd<span class="token punctuation">.</span>NumberB <span class="token operator">=</span> <span class="token keyword">double</span><span class="token punctuation">.</span><span class="token function">Parse</span><span class="token punctuation">(</span>strNumberB<span class="token punctuation">)</span><span class="token punctuation">;</span>\nstrResult <span class="token operator">=</span> add<span class="token punctuation">.</span><span class="token function">GetResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>设计带来的新问题：虽然满足了开放封闭原则，单一职责原则，但是对于众多类，客户端使用起来非常不方便，这时就要用到简单工厂模式，以下类来负责创建对象。</p>\n<h3 id="简单工厂范例"><a href="#%E7%AE%80%E5%8D%95%E5%B7%A5%E5%8E%82%E8%8C%83%E4%BE%8B" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>简单工厂范例</h3>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/微信截图20180415125801-5781d32b9af47843906035f1823c9c7d-e95f4.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 51.53234960272417%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAACB0lEQVQoz41SO2haYRT+4zXx0ZpobEsthUJom+7d2rljthRCh16qQ12kdShSAi4uKlqwLkGqFacQMHQuxUGdxPdbfA4+8B0dRL2COedyb2lIAznwc/77ncf/ne9cUq/XCZrL5RJ2u93v8P2rWCyeDwaDn8FgUISxbDZLbm3lclmAPh6Pi/P5/MUajGGY9XQ6XUNTGcYAYnM0Gg1bA3kEYhQ8RMGd6vf7VLPZ3LjWPBwOH8RisS+pVOor+MP/ESgUCjeS63Q6G6TX6z32+/17Xq/3GTSU80GPx6NwOBwvwO+HQqEnKpVKbDAYWBYgiXw0Gh3Bw+/S6fTRcDh83263n7KF4/GYwfEWiwWOObZYLLJcLiebTCbT2WzG432TybRjt9sprIEmL1erFSsNxtEajcYnwgW/VSoVV61WO4H7Mc8wmUyaqtXqD8QzmQzifzWKRCK7iUSCBt0/wBJpYPwRcp5fmb9UKr0Goc+i0egZyPAb9HjDbfgV4KegKeJ/Wq3W25s0BKKEwGhb+AGUPy+XyzVsbIkjQKERcWCpm8/niDOIwzZZHDS/o9VqRXq9XqTT6cROp1Pwb3OB2WwW+3y+Xbfb/QCS7wUCAfYfpGn6rtVqvW+z2R4ajcZHarV6G2ChRCJBIkKshUNdoapUKikuQDit8FAKhQKbbnIxHhdKpVLEsSHvN/lel3KWPay5CUftAAAAAElFTkSuQmCC\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="    20180415125801" title="" data-src="/static/微信截图20180415125801-5781d32b9af47843906035f1823c9c7d-fee1c.png" data-srcset="/static/微信截图20180415125801-5781d32b9af47843906035f1823c9c7d-a67b7.png 200w,\n/static/微信截图20180415125801-5781d32b9af47843906035f1823c9c7d-0b187.png 400w,\n/static/微信截图20180415125801-5781d32b9af47843906035f1823c9c7d-fee1c.png 800w,\n/static/微信截图20180415125801-5781d32b9af47843906035f1823c9c7d-e95f4.png 881w" data-sizes="(max-width: 800px) 100vw, 800px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="32660822722820650000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class OperationFactory\n{\n    public static Operation createOperate(string operate)\n    {\n        Operation oper = null;\n        switch (operate)\n        {\n            case &quot;+&quot;:\n                {\n                    oper = new OperationAdd();\n                    break;\n                }\n            case &quot;-&quot;:\n                {\n                    oper = new OperationSub();\n                    break;\n                }\n                ……\n        }\n        return oper;\n    }\n}\n\n// 调用\nOperation oper;\noper = OperationFactory.createOperate(strOperate);\noper.NumberA = Convert.ToDouble(strNumberA);\noper.NumberB = Convert.ToDouble(strNumberB);\nstrResult = oper.GetResult().ToString();`, `32660822722820650000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="cpp"\n              >\n                <span class="gatsby-code-button-language">cpp</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">OperationFactory</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token keyword">static</span> Operation <span class="token function">createOperate</span><span class="token punctuation">(</span>string operate<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Operation oper <span class="token operator">=</span> null<span class="token punctuation">;</span>\n        <span class="token keyword">switch</span> <span class="token punctuation">(</span>operate<span class="token punctuation">)</span>\n        <span class="token punctuation">{</span>\n            <span class="token keyword">case</span> <span class="token string">"+"</span><span class="token operator">:</span>\n                <span class="token punctuation">{</span>\n                    oper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">OperationAdd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n                    <span class="token keyword">break</span><span class="token punctuation">;</span>\n                <span class="token punctuation">}</span>\n            <span class="token keyword">case</span> <span class="token string">"-"</span><span class="token operator">:</span>\n                <span class="token punctuation">{</span>\n                    oper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">OperationSub</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n                    <span class="token keyword">break</span><span class="token punctuation">;</span>\n                <span class="token punctuation">}</span>\n                ……\n        <span class="token punctuation">}</span>\n        <span class="token keyword">return</span> oper<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// 调用</span>\nOperation oper<span class="token punctuation">;</span>\noper <span class="token operator">=</span> OperationFactory<span class="token punctuation">.</span><span class="token function">createOperate</span><span class="token punctuation">(</span>strOperate<span class="token punctuation">)</span><span class="token punctuation">;</span>\noper<span class="token punctuation">.</span>NumberA <span class="token operator">=</span> Convert<span class="token punctuation">.</span><span class="token function">ToDouble</span><span class="token punctuation">(</span>strNumberA<span class="token punctuation">)</span><span class="token punctuation">;</span>\noper<span class="token punctuation">.</span>NumberB <span class="token operator">=</span> Convert<span class="token punctuation">.</span><span class="token function">ToDouble</span><span class="token punctuation">(</span>strNumberB<span class="token punctuation">)</span><span class="token punctuation">;</span>\nstrResult <span class="token operator">=</span> oper<span class="token punctuation">.</span><span class="token function">GetResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>以上代码只需简单参数即可获得所需对象，实现对象的创建和使用的分离，这就是简单工厂模式。</p>\n<h3 id="简单工厂概述"><a href="#%E7%AE%80%E5%8D%95%E5%B7%A5%E5%8E%82%E6%A6%82%E8%BF%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>简单工厂概述</h3>\n<p><strong>定义</strong></p>\n<p>简单工厂模式(Simple Factory Pattern)：又称为静态工厂方法(Static Factory Method)模式，属于类的创建型模式，通过它根据自变量的不同返回不同的类的实例。简单工厂模式专门定义一个类来负责创建其它类的实例，被创建的实例通常都具有共同的父类。</p>\n<p><strong>模式结构</strong></p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/简单工厂20180415134957-5ca7662d7c827d2a29c2678a960dce83-a50a8.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 794px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 57.93450881612091%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsSAAALEgHS3X78AAACM0lEQVQoz5VSO4taQRide9WY7LIhYLGCAYsUNslmN0WqlYCFCOlsDCiykLBLqqA/wMoFGwtREBQEMY2IhSgovkDBV+Eb32/BrTQ2LgbicvPN4BU32Q3kwPAN5zBnvjnzoXK5TCNAsVj8MBgMftTr9Zt+v3/Xbre/YL7VanHRFgzD7CosznZxYVE7vdlsEsNarSZfrVbMaDRiMKbT6TfMj8fjneG+6Z9gTVEikSCbYDB4nMlkjGD6sVAoXIfD4beYj8fjFHsIXkFqqVR6XqlUrrPZrLnRaNihmXeYh2Zo9D+AGIh5Pp9/uVwuGRa9Xu8z5ufzORdFo1E6FotRMpmMDwI9m81wLpRCoeDr9XoaIqH8fj/t9XpRtVolhnDmGKLoLhaLG8BP6FaJ+clkwvmrC5vNRj3Woc/n2+Wo0+mOQqHQM4PBcGS324lRIBBAyOVyvTGbzacOh+MU9iIsWCyWF263+wTqmdVqPYEDr51O51OsGY1G1p/Ni7r3WTAqd/DUW2idgSfZMQef8mk4HDKgrTudzi949m06nT7DWjKZJEZCoZDn8XiQWCzmyeVy4mUymYgzs9lsSLhg8h0LYHDB7GG9XjOpVOo91iKRCNsZb1vvjRX+6ksY5iuYu68Q7jnmcrncK8zDSFxBl5dw0QV8hABrcDn6p+GjA/oARCIRPszZmjxs2O12uWq1+kCr1R5IpVIcPE8ikfA1Gg3hVCrVoVKpPBQIBHzQnlAUhSvZbxdv3+83AXpQoTsxUwYAAAAASUVORK5CYII=\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="    20180415134957" title="" data-src="/static/简单工厂20180415134957-5ca7662d7c827d2a29c2678a960dce83-a50a8.png" data-srcset="/static/简单工厂20180415134957-5ca7662d7c827d2a29c2678a960dce83-158a7.png 200w,\n/static/简单工厂20180415134957-5ca7662d7c827d2a29c2678a960dce83-dcfde.png 400w,\n/static/简单工厂20180415134957-5ca7662d7c827d2a29c2678a960dce83-a50a8.png 794w" data-sizes="(max-width: 794px) 100vw, 794px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="90914349618328030000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`public class OperationFactory //工厂角色\n{\n    public static Operation createOperate(string operate)\n    {\n        Operation oper = null;// 抽象产品角色\n        switch (operate)\n        {\n            case &quot;+&quot;:\n                {\n                    oper = new OperationAdd();// 具体产品角色\n                    break;\n                }\n            case &quot;-&quot;:\n                {\n                    oper = new OperationSub();\n                    break;\n                }\n         }\n        return oper;\n    }\n}`, `90914349618328030000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="cpp"\n              >\n                <span class="gatsby-code-button-language">cpp</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OperationFactory</span> <span class="token comment">//工厂角色</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token keyword">static</span> Operation <span class="token function">createOperate</span><span class="token punctuation">(</span>string operate<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Operation oper <span class="token operator">=</span> null<span class="token punctuation">;</span><span class="token comment">// 抽象产品角色</span>\n        <span class="token keyword">switch</span> <span class="token punctuation">(</span>operate<span class="token punctuation">)</span>\n        <span class="token punctuation">{</span>\n            <span class="token keyword">case</span> <span class="token string">"+"</span><span class="token operator">:</span>\n                <span class="token punctuation">{</span>\n                    oper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">OperationAdd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 具体产品角色</span>\n                    <span class="token keyword">break</span><span class="token punctuation">;</span>\n                <span class="token punctuation">}</span>\n            <span class="token keyword">case</span> <span class="token string">"-"</span><span class="token operator">:</span>\n                <span class="token punctuation">{</span>\n                    oper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">OperationSub</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n                    <span class="token keyword">break</span><span class="token punctuation">;</span>\n                <span class="token punctuation">}</span>\n         <span class="token punctuation">}</span>\n        <span class="token keyword">return</span> oper<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><strong>优缺点</strong></p>\n<ul>\n<li>\n<p>优点：</p>\n<ul>\n<li>工厂类含有必要的判断逻辑，可以决定在什么时候创建哪一个产品类的实例，客户端可以免除直接创建产品对象的责任，而仅仅“消费”产品。简单工厂模式通过这种做法实现了对象创建和使用的分离</li>\n<li>客户端代码简洁，无需知道所创建具体产品的类名，只需知道对应的参数，可以减少使用者的记忆量。</li>\n</ul>\n</li>\n<li>\n<p>缺点：</p>\n<ul>\n<li>工厂类集中了所有产品创建逻辑，一旦不能正常工作，整个系统都要受到影响。</li>\n<li>增加了系统中类的数量，增加了系统的复杂度和理解难度。</li>\n<li>系统扩展困难，一旦添加新产品就不得不修改工厂逻辑，有可能造成工厂逻辑过于复杂，不利于扩展。</li>\n<li>简单工厂模式通常使用静态工厂方法，造成工厂角色无法形成基于继承的等级结构。</li>\n</ul>\n</li>\n</ul>\n<p><strong>模式应用</strong></p>\n<ul>\n<li>根据各类算法的密码生成器。</li>\n<li>根据各类数据进行图表绘制。</li>\n</ul>\n<h3 id="工厂方法问题背景"><a href="#%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95%E9%97%AE%E9%A2%98%E8%83%8C%E6%99%AF" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>工厂方法问题背景</h3>\n<p>简单工厂中的工厂类随着新方法的添加需要修改代码，同样违反了开放封闭原则，抽象化如下图。</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/工厂方法20180415130256-1d2c2002dcc59d67fabdb93c990bb283-50858.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 44.455544455544455%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAACD0lEQVQoz11RzYtScRR9Pn0f42YUZZwcaTCwIFy40K34JygauCxIwV3ms0VDi4JJhYLUlYJL3UluREgQQiWjWkj4geb3t4ML+wPGzs/eDDNz4fJ+93DuveeeRw2HQxmFGAwGz/r9/s9er/d9s9mcEWy9XtM+n488qU6nIxF5p41G40mz2XxM6lqtRut0Ouo6yuUyTb71el3odruXo9Hocjqdxgm22+32HIvFQt77gYvF4ul2u92B91bk0NTNEJsYlUrFud1uVSAQOCY1krfZbJzBYGAJh2EYcgnncDgOQqHQqcfj4VEfaDQa3mg0slarVbofOJvNfuPMETZ3KpXKo1ardQiFgHpTYN+y2ew9woOiL5PJZI4vWUil02k53h1gX4PBoPRaYbvdPoePn5CxTCbzsFqtHsGvj+PxOApP38disRPxVAGefsjlckdEPaziV6vVOfKV0+mU2+12+a3ToSoPwy/m8/kK+QCQBOp/YNHFcrn8k8/n1YSHJZ+B/8WCk6te9P0Cp5tKpbi92YlEQg6lL6AqhAHv0HQ/mUwe4vw3qMM4/6xYLB6LFj3HsEipVFKipAuFAgflL5GvcbrsaomUuh3kj7J3ME6v1/M3AZPJdLfvfygUCokgCLJ4PM6Ew2HGbDbTarVaEo1GZS6Xi4dHvFKpJH9e6vf7mUgkwmi1WjKMZllW6vV6WYKRWf8Ak6MfVTA1SG0AAAAASUVORK5CYII=\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="    20180415130256" title="" data-src="/static/工厂方法20180415130256-1d2c2002dcc59d67fabdb93c990bb283-fee1c.png" data-srcset="/static/工厂方法20180415130256-1d2c2002dcc59d67fabdb93c990bb283-a67b7.png 200w,\n/static/工厂方法20180415130256-1d2c2002dcc59d67fabdb93c990bb283-0b187.png 400w,\n/static/工厂方法20180415130256-1d2c2002dcc59d67fabdb93c990bb283-fee1c.png 800w,\n/static/工厂方法20180415130256-1d2c2002dcc59d67fabdb93c990bb283-50858.png 1001w" data-sizes="(max-width: 800px) 100vw, 800px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="4554396365413837300"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 工厂方法\ninterface IFactory\n{\n    Operation CreateOperation();\n}\n\n// 专门负责生产“+”的工厂，其他同理\nclass AddFactory : IFactory\n{\n    public Operation CreateOperation()\n    {\n        return new OperationAdd();\n    }\n}\n\n// 调用\nIFactory operFactory = new AddFactory();\nOperation oper = operFactory.CreateOperation();\noper.NumberA = Convert.ToDouble(strNumberA);\noper.NumberB = Convert.ToDouble(strNumberB);\nstrResult = oper.GetResult().ToString();`, `4554396365413837300`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="cpp"\n              >\n                <span class="gatsby-code-button-language">cpp</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token comment">// 工厂方法</span>\ninterface IFactory\n<span class="token punctuation">{</span>\n    Operation <span class="token function">CreateOperation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// 专门负责生产“+”的工厂，其他同理</span>\n<span class="token keyword">class</span> <span class="token class-name">AddFactory</span> <span class="token operator">:</span> IFactory\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> Operation <span class="token function">CreateOperation</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token function">OperationAdd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// 调用</span>\nIFactory operFactory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">AddFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nOperation oper <span class="token operator">=</span> operFactory<span class="token punctuation">.</span><span class="token function">CreateOperation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\noper<span class="token punctuation">.</span>NumberA <span class="token operator">=</span> Convert<span class="token punctuation">.</span><span class="token function">ToDouble</span><span class="token punctuation">(</span>strNumberA<span class="token punctuation">)</span><span class="token punctuation">;</span>\noper<span class="token punctuation">.</span>NumberB <span class="token operator">=</span> Convert<span class="token punctuation">.</span><span class="token function">ToDouble</span><span class="token punctuation">(</span>strNumberB<span class="token punctuation">)</span><span class="token punctuation">;</span>\nstrResult <span class="token operator">=</span> oper<span class="token punctuation">.</span><span class="token function">GetResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="工厂方法概述"><a href="#%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95%E6%A6%82%E8%BF%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>工厂方法概述</h3>\n<p><strong>定义</strong></p>\n<p>工厂方法模式(Factory Method Pattern)：工厂方法模式又简称为工厂模式，也叫虚拟构造器(Virtual Constructor)模式或者多态模式，属于类的创建型模式。在工厂方法模式中，父类负责定义创建对象的公共接口，而子类则负责生成具体的对象，这样做的目的是将类的实例化操作延迟到子类中完成，即由子类来决定究竟应该实例化(创建) 哪一个类。</p>\n<p><strong>模式结构</strong></p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/微信截图_20180415145051-1e07ff1dfe9bab8df2a9bc7315ef60c9-e95f4.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 43.81384790011351%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAAB3klEQVQoz42SS2taQRTHR1OzSLZNCJSGLgJpA1k06y6yz6bfpMt+gBBidwFxoULvxYBVk+Cz4ANEFEUEFQUV34/4qELro+Lj3pjb/7EqodDSA4czM+c3M2fmf1ir1foUi8UuA4HAZblcvmg2m1eYnzIYxhsUvV7vbqVS0XS7Xb5YLH72+/18LpfjOp0O12g09Dab7SVx2Cdj0tJEUVwNJWw6J2A8HisohkKhw9FotM7P53PpqeHCE+JwiZwNh8Mfg8HgO+JPxDb8IZ/PfyCg1+s9o+jxeF6lUqkC1lvpdPq+UCgM6/V6I5vN3pdKpW9ut/sNcYlEQs4MBsOOXq9/rdPpzjiOe475C7VavU2A0+mkwBwOB+N5XqHVahUqlWpTo9G8w3iL1oxG46bZbJYRZ7FY2FPbYH8xvIpctnJi/1hbc+xfh5DVajX2P7Y+DP9wG4/HzeFw+CYSiXyB6l8zmcz7JbSo2ufz7UHNa4h1AyVN0Wj0Fm7C/5mg9J3dbt8nLplM/lZ5Op1Ks9lMWikJAS4IUCqVWxStVutRv99f5IgTBEGaTCZrlV0u19tlcXKG5CMOFOAifEGhHz8u+3DRNsFg8ADKDlDlHDmh3W6L6AaxWq0KqFDC646JwwvkvwDGApPtStss8QAAAABJRU5ErkJggg==\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="     20180415145051" title="" data-src="/static/微信截图_20180415145051-1e07ff1dfe9bab8df2a9bc7315ef60c9-fee1c.png" data-srcset="/static/微信截图_20180415145051-1e07ff1dfe9bab8df2a9bc7315ef60c9-a67b7.png 200w,\n/static/微信截图_20180415145051-1e07ff1dfe9bab8df2a9bc7315ef60c9-0b187.png 400w,\n/static/微信截图_20180415145051-1e07ff1dfe9bab8df2a9bc7315ef60c9-fee1c.png 800w,\n/static/微信截图_20180415145051-1e07ff1dfe9bab8df2a9bc7315ef60c9-e95f4.png 881w" data-sizes="(max-width: 800px) 100vw, 800px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<ul>\n<li>Product：抽象产品</li>\n<li>ConcreteProduct：具体产品</li>\n<li>Factory：抽象工厂</li>\n<li>ConcreteFactory：具体工厂</li>\n</ul>\n<p>工厂方法模式是简单工厂模式的延伸，它继承了简单工厂模式的优点，同时还弥补了简单工厂模式的不足。工厂方法模式是使用频率最高的设计模式之一，是很多开源框架和 API 类库的核心模式。</p>\n<p><strong>优缺点</strong></p>\n<ul>\n<li>\n<p>优点</p>\n<ul>\n<li>在工厂方法模式中，工厂方法用来创建客户所需要的产品，同时还向客户隐藏了哪种具体产品类被实例化这一细节，用户只需要关心所需产品对应的工厂，无需关心创建产品的细节，甚至无需知道产品类的类名。</li>\n<li>基于工厂角色和产品角色的多态性设计是工厂方法模式的关键。它能够使工厂可以自主确定创建何种产品对象，而如何创建这个对象的细节则完全封装在具体工厂内部。</li>\n<li>使用工厂方法模式的另一个优点是在系统中加入新产品时，无需修改抽象工厂和抽象产品提供的接口，无需修改客户端，也无需修改其它的具体工厂和具体产品，而只要添加一个新的具体工厂和具体产品即可。</li>\n</ul>\n</li>\n<li>\n<p>缺点</p>\n<ul>\n<li>在添加新产品时，需要编写新的具体产品类，而且还要提供与之对应的具体工厂类，类成对增加，将导致系统设计较为庞大，且运行时系统会有额外的开销。</li>\n<li>由于考虑到系统的可扩展性，需要引入抽象层，在客户端代码中均使用抽象层进行定义，增加了系统的抽象性和理解难度，且在实现的时候可能需要用到反射等技术，增加了系统的实现难度。</li>\n</ul>\n</li>\n</ul>\n<p><strong>模式使用</strong></p>\n<ul>\n<li>不能清楚知道所必须创建的对象的类。</li>\n<li>一个类希望由它的子类来指定它所创建的对象。</li>\n<li>将创建对象的职责委托给多个子类中的某一个，且不同子类提供不同实现。</li>\n</ul>\n<h2 id="抽象工厂模式abstract-factory"><a href="#%E6%8A%BD%E8%B1%A1%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8Fabstract-factory" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>抽象工厂模式(Abstract Factory)</h2>\n<p>提供一个创建一系列相关或相互依赖对象的接口，而无需指定它们具体的类。</p>\n<h3 id="问题背景"><a href="#%E9%97%AE%E9%A2%98%E8%83%8C%E6%99%AF" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题背景</h3>\n<p>不能不换数据库？</p>\n<ul>\n<li>以前基于 Access 的数据库项目，需要修改为 SQL Server</li>\n<li>SQL 语言函数不一样，参数格式不一样</li>\n<li>如 SQL Server 中 GetDate()，Access 中为 Now()</li>\n</ul>\n<p>最简单的数据库程序</p>\n<ul>\n<li>假定使用 SQL Server 数据库</li>\n<li>数据库中有用户表(User)，用户类有 2 个字段 ID 和 Name</li>\n<li>程序中有用户管理，可以对用户添加和查询</li>\n</ul>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="95480204756050510000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 用户类，假定用户只有ID 和 Name两个字段\nclass User\n{\n    private int _id;\n    public int ID\n    {\n        get { return _id; }\n        set { _id = value; }\n    }\n\n    private string _name;\n    public string Name\n    {\n        get { return _name; }\n        set { _name = value; }\n    }\n}\n\n// SqlserverUser类，用于操作User表,假定用户只有新增用户和得到用户方法，具体语句省略\nclass SqlserverUser\n{\n    public void Insert(User user)\n    {\n        Console.WriteLine(&quot;在Sqlserver中给User表增加一条记录&quot;);\n    }\n\n    public User GetUser(int id)\n    {\n        Console.WriteLine(&quot;在Sqlserver中根据ID得到User表一条记录&quot;);\n        return null;\n    }\n}\n\n// Su对象框死在Sqlserver数据库上了，加入要换Access数据库，跟Su对象相关的代码都要修改\nstatic void Main(string[] args)\n{\n    User user = new User();\n\n    SqlserverUser su = new SqlserverUser();\n\n    su.Insert(user);\n\n    su.GetUser(1);\n\n    Console.Read();\n}`, `95480204756050510000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="cpp"\n              >\n                <span class="gatsby-code-button-language">cpp</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token comment">// 用户类，假定用户只有ID 和 Name两个字段</span>\n<span class="token keyword">class</span> <span class="token class-name">User</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">private</span> <span class="token keyword">int</span> _id<span class="token punctuation">;</span>\n    <span class="token keyword">public</span> <span class="token keyword">int</span> ID\n    <span class="token punctuation">{</span>\n        get <span class="token punctuation">{</span> <span class="token keyword">return</span> _id<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n        set <span class="token punctuation">{</span> _id <span class="token operator">=</span> value<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">private</span> string _name<span class="token punctuation">;</span>\n    <span class="token keyword">public</span> string Name\n    <span class="token punctuation">{</span>\n        get <span class="token punctuation">{</span> <span class="token keyword">return</span> _name<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n        set <span class="token punctuation">{</span> _name <span class="token operator">=</span> value<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// SqlserverUser类，用于操作User表,假定用户只有新增用户和得到用户方法，具体语句省略</span>\n<span class="token keyword">class</span> <span class="token class-name">SqlserverUser</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Insert</span><span class="token punctuation">(</span>User user<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"在Sqlserver中给User表增加一条记录"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">public</span> User <span class="token function">GetUser</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"在Sqlserver中根据ID得到User表一条记录"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">return</span> null<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// Su对象框死在Sqlserver数据库上了，加入要换Access数据库，跟Su对象相关的代码都要修改</span>\n<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    User user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    SqlserverUser su <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">SqlserverUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    su<span class="token punctuation">.</span><span class="token function">Insert</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    su<span class="token punctuation">.</span><span class="token function">GetUser</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Console<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>利用上面学习到的工厂方法修改代码如下：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="75290132698251770000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`interface IUser\n{\n    void Insert(User user);\n\n    User GetUser(int id);\n}\nclass SqlserverUser : IUser\n{\n    public void Insert(User user)\n    {\n        Console.WriteLine(&quot;在Sqlserver中给User表增加一条记录&quot;);\n    }\n\n    public User GetUser(int id)\n    {\n        Console.WriteLine(&quot;在Sqlserver中根据ID得到User表一条记录&quot;);\n        return null;\n    }\n}\nclass AccessUser : IUser\n{\n    public void Insert(User user)\n    {\n        Console.WriteLine(&quot;在Access中给User表增加一条记录&quot;);\n    }\n\n    public User GetUser(int id)\n    {\n        Console.WriteLine(&quot;在Access中根据ID得到User表一条记录&quot;);\n        return null;\n    }\n}\ninterface IFactory\n{\n    IUser CreateUser();\n}\nclass SqlServerFactory : IFactory\n{\n    public IUser CreateUser()\n    {\n        return new SqlserverUser();\n    }\n}\nclass AccessFactory : IFactory\n{\n    public IUser CreateUser()\n    {\n        return new AccessUser();\n    }\n}\nstatic void Main(string[] args)\n{\n    User user = new User();\n\n    IFactory factory = new AccessFactory();   //SqlServerFactory();\n\n    IUser iu = factory.CreateUser();\n\n    iu.Insert(user);\n    iu.GetUser(1);\n\n    Console.Read();\n}`, `75290132698251770000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="cpp"\n              >\n                <span class="gatsby-code-button-language">cpp</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp">interface IUser\n<span class="token punctuation">{</span>\n    <span class="token keyword">void</span> <span class="token function">Insert</span><span class="token punctuation">(</span>User user<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    User <span class="token function">GetUser</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">class</span> <span class="token class-name">SqlserverUser</span> <span class="token operator">:</span> IUser\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Insert</span><span class="token punctuation">(</span>User user<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"在Sqlserver中给User表增加一条记录"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">public</span> User <span class="token function">GetUser</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"在Sqlserver中根据ID得到User表一条记录"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">return</span> null<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">class</span> <span class="token class-name">AccessUser</span> <span class="token operator">:</span> IUser\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Insert</span><span class="token punctuation">(</span>User user<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"在Access中给User表增加一条记录"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">public</span> User <span class="token function">GetUser</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"在Access中根据ID得到User表一条记录"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">return</span> null<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\ninterface IFactory\n<span class="token punctuation">{</span>\n    IUser <span class="token function">CreateUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">class</span> <span class="token class-name">SqlServerFactory</span> <span class="token operator">:</span> IFactory\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> IUser <span class="token function">CreateUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token function">SqlserverUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">class</span> <span class="token class-name">AccessFactory</span> <span class="token operator">:</span> IFactory\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> IUser <span class="token function">CreateUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token function">AccessUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    User user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    IFactory factory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">AccessFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//SqlServerFactory();</span>\n\n    IUser iu <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">CreateUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    iu<span class="token punctuation">.</span><span class="token function">Insert</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    iu<span class="token punctuation">.</span><span class="token function">GetUser</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Console<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<ul>\n<li>数据库只有一个表吗？</li>\n<li>假如增加部门表，如何处理？</li>\n</ul>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="53659877258434420000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class Department\n{\n    private int _id;\n    public int ID\n    {\n        get { return _id; }\n        set { _id = value; }\n    }\n\n    private string _deptName;\n    public string DeptName\n    {\n        get { return _deptName; }\n        set { _deptName = value; }\n    }\n}\ninterface IDepartment\n{\n    void Insert(Department department);\n    Department GetDepartment(int id);\n}\nclass SqlserverDepartment : IDepartment\n{\n    public void Insert(Department department)\n    {\n        Console.WriteLine(&quot;在Sqlserver中给Department表增加一条记录&quot;);\n    }\n    public Department GetDepartment(int id)\n    {\n        Console.WriteLine(&quot;在Sqlserver中根据ID得到Department表一条记录&quot;);  return null;\n    }\n}\nclass AccessDepartment : IDepartment\n{\n    public void Insert(Department department)\n    {\n        Console.WriteLine(&quot;在Access中给Department表增加一条记录&quot;);\n    }\n    public Department GetDepartment(int id)\n    {\n        Console.WriteLine(&quot;在Access中根据ID得到Department表一条记录&quot;);   return null;\n    }\n}\ninterface IFactory\n{\n    IUser CreateUser();\n\n    IDepartment CreateDepartment();\n}\nclass SqlServerFactory : IFactory\n{\n    public IUser CreateUser()\n    {\n        return new SqlserverUser();\n    }\n    public IDepartment CreateDepartment()\n    {\n        return new SqlserverDepartment();\n    }\n}\nclass AccessFactory : IFactory\n{\n    public IUser CreateUser()\n    {\n        return new AccessUser();\n    }\n    public IDepartment CreateDepartment()\n    {\n        return new AccessDepartment();\n    }\n}\nstatic void Main(string[] args)\n{\n    User user = new User();\n    Department dept = new Department();\n\n    IFactory factory = new AccessFactory();  //SqlServerFactory();\n\n    IUser iu = factory.CreateUser();\n    iu.Insert(user);\n    iu.GetUser(1);\n\n    IDepartment id = factory.CreateDepartment();\n    id.Insert(dept);\n    id.GetDepartment(1);\n\n    Console.Read();\n}`, `53659877258434420000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="cpp"\n              >\n                <span class="gatsby-code-button-language">cpp</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Department</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">private</span> <span class="token keyword">int</span> _id<span class="token punctuation">;</span>\n    <span class="token keyword">public</span> <span class="token keyword">int</span> ID\n    <span class="token punctuation">{</span>\n        get <span class="token punctuation">{</span> <span class="token keyword">return</span> _id<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n        set <span class="token punctuation">{</span> _id <span class="token operator">=</span> value<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">private</span> string _deptName<span class="token punctuation">;</span>\n    <span class="token keyword">public</span> string DeptName\n    <span class="token punctuation">{</span>\n        get <span class="token punctuation">{</span> <span class="token keyword">return</span> _deptName<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n        set <span class="token punctuation">{</span> _deptName <span class="token operator">=</span> value<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\ninterface IDepartment\n<span class="token punctuation">{</span>\n    <span class="token keyword">void</span> <span class="token function">Insert</span><span class="token punctuation">(</span>Department department<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Department <span class="token function">GetDepartment</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">class</span> <span class="token class-name">SqlserverDepartment</span> <span class="token operator">:</span> IDepartment\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Insert</span><span class="token punctuation">(</span>Department department<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"在Sqlserver中给Department表增加一条记录"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> Department <span class="token function">GetDepartment</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"在Sqlserver中根据ID得到Department表一条记录"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> null<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">class</span> <span class="token class-name">AccessDepartment</span> <span class="token operator">:</span> IDepartment\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Insert</span><span class="token punctuation">(</span>Department department<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"在Access中给Department表增加一条记录"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> Department <span class="token function">GetDepartment</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"在Access中根据ID得到Department表一条记录"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token keyword">return</span> null<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\ninterface IFactory\n<span class="token punctuation">{</span>\n    IUser <span class="token function">CreateUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    IDepartment <span class="token function">CreateDepartment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">class</span> <span class="token class-name">SqlServerFactory</span> <span class="token operator">:</span> IFactory\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> IUser <span class="token function">CreateUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token function">SqlserverUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> IDepartment <span class="token function">CreateDepartment</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token function">SqlserverDepartment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">class</span> <span class="token class-name">AccessFactory</span> <span class="token operator">:</span> IFactory\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> IUser <span class="token function">CreateUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token function">AccessUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> IDepartment <span class="token function">CreateDepartment</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token function">AccessDepartment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    User user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Department dept <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Department</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    IFactory factory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">AccessFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//SqlServerFactory();</span>\n\n    IUser iu <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">CreateUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    iu<span class="token punctuation">.</span><span class="token function">Insert</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    iu<span class="token punctuation">.</span><span class="token function">GetUser</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    IDepartment id <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">CreateDepartment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    id<span class="token punctuation">.</span><span class="token function">Insert</span><span class="token punctuation">(</span>dept<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    id<span class="token punctuation">.</span><span class="token function">GetDepartment</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Console<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/微信截图_20180415163014-dd09d2e48111ce706a568805e3f6982a-a3696.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 63.26530612244898%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAACQklEQVQ4y41TS4hSYRS+Xl85m0qhlGpli1YuJJEhcDMz0FAUQVQrd66CGJSsvbt21a42IwiDLVy5EFyID3yj+H4/EB+jgqIgiEi374hTd2SgOfBzz/k85ztPmdVqxTocDkGz2fQuFguu1+u9ZyD4Sj0eD6lMMBgUcBwnIX00Grk6nQ7X7/c56J+2mLharTKXJJVKfQFpeTgcHvPxbDYr4NuFQsEMLNpqtUIgfsr/rVQqMUw4HH7tdrv3YQvxpDqd7gYqehGPx4+SyaSUHCuVyv1MJvMMvq98Pp8OkMBgMNxMJBKHkUjkZb1eP8jlcnsbVrTCtdvtKC/LvclkQq1zCHhAGAJOMBpypTbThA0Gg4fn5+cc4fP5nIPPow1Bo9FwTafTEwgLfwZV3UZbPxDwFRXdIp9YLGZABacYySmSfyTM6/XexZi+12q1n91u9xt47jDXEKFarRbvgnq9nsYj2MWpIMZkMrFOp3MvnU4/9/v975B1Xwix2WxilUpFgaxWqxWGQiHWbrcLLRaLiEdA18EajUbJcrn8x7xerxXlcvk3hM7Bu3UWUwC/ArlczspkMkrCKBQKxmw2b6oCJrJarZfLxfbeYH6fsWE9H8d58ElJZ68azV+tWCye4a7OotGommycy2Ngv/L5vAvfJ9ulXJCw/yXktoLtvSUbRB8uMGzPRNhsNhNdu0K0eoS2DsbjsZzsQCCgxDvEyRzjfJSEYegsL1DEIxZsn+jKG9FoNJLdzEqlUkb/oO0jXcxrneURb+QPkl9bnqqjrwQAAAAASUVORK5CYII=\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="     20180415163014" title="" data-src="/static/微信截图_20180415163014-dd09d2e48111ce706a568805e3f6982a-fee1c.png" data-srcset="/static/微信截图_20180415163014-dd09d2e48111ce706a568805e3f6982a-a67b7.png 200w,\n/static/微信截图_20180415163014-dd09d2e48111ce706a568805e3f6982a-0b187.png 400w,\n/static/微信截图_20180415163014-dd09d2e48111ce706a568805e3f6982a-fee1c.png 800w,\n/static/微信截图_20180415163014-dd09d2e48111ce706a568805e3f6982a-a3696.png 833w" data-sizes="(max-width: 800px) 100vw, 800px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>以上就是抽象工厂模式。</p>\n<h3 id="模式动机-1"><a href="#%E6%A8%A1%E5%BC%8F%E5%8A%A8%E6%9C%BA-1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式动机</h3>\n<p>在工厂方法模式中具体工厂负责生产具体的产品，每一个具体工厂对应一种具体产品，工厂方法也具有唯一性，一般情况下，一个具体工厂中只有一个工厂方法或者一组重载的工厂方法。但是有时候我们需要一个工厂可以提供多个产品对象，而不是单一的产品对象。</p>\n<h3 id="模式定义-1"><a href="#%E6%A8%A1%E5%BC%8F%E5%AE%9A%E4%B9%89-1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式定义</h3>\n<p>提供一个创建一系列相关或相互依赖对象的接口，而无需指定它们具体的类。抽象工厂模式又称为 Kit 模式，属于对象创建型模式。</p>\n<h3 id="模式结构-1"><a href="#%E6%A8%A1%E5%BC%8F%E7%BB%93%E6%9E%84-1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式结构</h3>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/微信截图_20180415162141-fa346879acafeed61c004670b7002e4f-180da.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 61.68108776266996%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsSAAALEgHS3X78AAACSElEQVQoz3VTS6gSYRT+Z+6MjiVBrhOjQHosgoFA9MIFycJdLoyEkIhWLsKtrXQRVNpG8d4WQRsXrmqliagpKvjMt/gWQcVcpBC0EZnOP3fGuhfvgcM/5zv//53noPF43B0Oh2m73X4JIUQJSoCSoDRBEDRJkjT+tlqt+A4RiUTYer2+bDQaf9rt9lPAULfbleATTSaTT7PZ7K3b7cZEqNfrSWu12hW4IFer1aRATgDZARLE5XLJi8Xil2q1Gq9UKndFHN6hnTidThwdlcvl161Wi4MM8hzHUaDEcrkkBd+jbDb7Pp1OvxIqQIlE4nkmk/Hk8/knPJHFYmG8Xq9EJA4EAjeTyeTLeDz+QMTW6zWfHQT6DAE4aNOvQqFwFWOdTqeFsX6/n+Av63Q6KT4h/RelUukrnDdEIrDfQVYfw+GwDNsQ6DoEOgT83nw+54OAfSeVSh1CADX/yGQy8YTT6fTNYrH4CdE12IZByeHRN9AfPp9PjvaIQqEg9uG0wWDY6xAE+3BLJCqVSsay7GWtViuVyWQ4wwOj0UjbbDbabDZTp7dhLbDD7/dLhNKfwTrEYWLHMGlqMBgQHo/nTAAQ8hxAnsGUSiUtfudyucfNZvM7TPnD/4+CweCODSdwIeFms+FPaOrtaDRqcjgcu36FQqEjaPpDaDpfDgxT5LyYcLvd8k4o7WS1WnFwHmEbvpnRaFSFIf2OxWIKkZA4lfMl/8OEqJjwGkz2Piwtn6FGoyFht25BT1m9Xs/gX5JhGEoYkFQoW1RKXPS/XoccVjMBETwAAAAASUVORK5CYII=\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="     20180415162141" title="" data-src="/static/微信截图_20180415162141-fa346879acafeed61c004670b7002e4f-fee1c.png" data-srcset="/static/微信截图_20180415162141-fa346879acafeed61c004670b7002e4f-a67b7.png 200w,\n/static/微信截图_20180415162141-fa346879acafeed61c004670b7002e4f-0b187.png 400w,\n/static/微信截图_20180415162141-fa346879acafeed61c004670b7002e4f-fee1c.png 800w,\n/static/微信截图_20180415162141-fa346879acafeed61c004670b7002e4f-180da.png 809w" data-sizes="(max-width: 800px) 100vw, 800px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<ul>\n<li>AbstractFactory：抽象工厂</li>\n<li>ConcreteFactory：具体工厂</li>\n<li>AbstractProduct：抽象产品</li>\n<li>Product：具体产品</li>\n<li>Client：客户类</li>\n</ul>\n<h3 id="优缺点-1"><a href="#%E4%BC%98%E7%BC%BA%E7%82%B9-1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>优缺点</h3>\n<ul>\n<li>\n<p>优点</p>\n<ul>\n<li>抽象工厂模式的主要优点是隔离了具体类的生成，使得客户并不需要知道什么被创建。由于这种隔离，更换一个具体工厂就变得相对容易。</li>\n<li>所有的具体工厂都实现了抽象工厂中定义的那些公共接口，因此只需改变具体工厂的实例，就可以在某种程度上改变整个软件系统的行为。另外，应用抽象工厂模式可以实现高内聚低耦合的设计目的，因此抽象工厂模式得到了广泛的应用。</li>\n</ul>\n</li>\n<li>\n<p>缺点</p>\n<ul>\n<li>抽象工厂模式的缺点是在添加新的产品对象时，难以扩展抽象工厂以便生产新种类的产品，这是因为在抽象工厂角色中规定了所有可能被创建的产品集合，要支持新种类的产品就意味着要对该接口进行扩展，而这将涉及到对抽象工厂角色及其所有子类的修改，显然会带来很多不便。</li>\n<li>开闭原则的倾斜性（增加新的工厂和产品族容易，增加新的产品等级结构麻烦）</li>\n</ul>\n</li>\n</ul>\n<h3 id="模式使用-1"><a href="#%E6%A8%A1%E5%BC%8F%E4%BD%BF%E7%94%A8-1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式使用</h3>\n<ul>\n<li>一个系统不应当依赖于产品类实例如何被创建、组合和表达的细节，这对于所有形态的工厂模式都很重要。</li>\n<li>系统有多于一个的产品族，而客户端只消费其中某一产品族。</li>\n<li>系统提供一个产品类的库，所有的产品以同样的接口出现，从而使客户端不依赖于实现。</li>\n</ul>\n<h2 id="建造者模式builder"><a href="#%E5%BB%BA%E9%80%A0%E8%80%85%E6%A8%A1%E5%BC%8Fbuilder" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>建造者模式(Builder)</h2>\n<p>将一个复杂对象的构建与它的表示分离，使得同样的构建过程可以创建不同的表示。</p>\n<h3 id="模式背景"><a href="#%E6%A8%A1%E5%BC%8F%E8%83%8C%E6%99%AF" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式背景</h3>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/微信截图_20180415164857-b5f81abc422203d20ec6facdd7ea3bd3-d879c.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 264px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 92.8030303030303%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAIAAAAf7rriAAAACXBIWXMAAAsSAAALEgHS3X78AAACsElEQVQ4y5WSS0wTYRDHv33QApUtr+LBRA4keOFiYsLBk4kxvrXEA1wEKVQFjBpPxmjQ8IgcfFwUxEgMQiUSQNCkIKUB2wIK2Ja2u9vW8t6+u4WiKCdnaQRLIMKX/04mm/3tzHzzRwev04crrXsrgrKyYEZ5UKoM7CkNJCljRCkDiQrf/hvBI1U/j9YunXnyW1FDP7jThQ4V6AuqNftK3dllcwcqOLE8gE6F0OmQEP8KOxtGJxcziiLH7i4fvxeWP1x9VdXO3S5EpY9m3gzzzTpeZQipDHyrgVcNC7HVEI6qRc839M7Vq2dfqmc6h6ZUA67mPmdXr1H9QY96tFMdr+8X5p+4prxQXpIHunIpr1yRF83LFPKbV/N57qtnwcywxr6+9+bJUYfD5JimndM29E7DFV88hxAiCALFHgzDIJJxYrPx85jFqh2xNTS1ffykHxwxjRqdIxPfUIeWu1wsh4/EYhFJEjIZIZUKMS4OROI4RlGU1azz+xxW2uiaou1OC2M3s3bT3KxNgEuKzkcr4zhKTxdqpqUhkhRqwyORSCZNuuVFV9jPhAMgdjHIRkJ2D8dswFAWolSKcnNRSspG21F4if/u5Wi/hwH5PEzQy7gX6M1wairKyUEy2Rawz00HvAzI72VCvliYwGFIoe3MTAGG/N+2/wNjGFwVSkxEWVkoKUnofxcwtA3LkkhQdrbwC8h30fb6hUFZmHyXM6+tKnpVsKo1y+wYxnEiIQFRlAAnJ4NndgavOyw+XjAWHIhiMUGSaw6TUhbzNnC7ZiHqbXIbb4tEoomxwXDQ5Z63eTkGBN7yu5n5Wag8MP1lqOXp48rG+toXz2s2qeFZdVNjHe+bXP3hXFlif0XsoJWIfXXZHuFZdKtuXK21dPezPRpmS3X30209E2+7YwRvWjrH/wB3bCawxjLeUAAAAABJRU5ErkJggg==\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="     20180415164857" title="" data-src="/static/微信截图_20180415164857-b5f81abc422203d20ec6facdd7ea3bd3-d879c.png" data-srcset="/static/微信截图_20180415164857-b5f81abc422203d20ec6facdd7ea3bd3-a4cf3.png 200w,\n/static/微信截图_20180415164857-b5f81abc422203d20ec6facdd7ea3bd3-d879c.png 264w" data-sizes="(max-width: 264px) 100vw, 264px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="47443882263112335000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`private void button1_Click(object sender, EventArgs e)\n{\n    Graphics person = pictureBox1.CreateGraphics();\n    Pen p = new Pen(Color.Yellow);\n    person.DrawEllipse(p, 50, 20, 30, 30);\n    person.DrawRectangle(p, 60, 50, 10, 50);\n    person.DrawLine(p, 60, 50, 40, 100);\n    person.DrawLine(p, 70, 50, 90, 100);\n    person.DrawLine(p, 60, 100, 45, 150);\n    person.DrawLine(p, 70, 100, 85, 150);\n}`, `47443882263112335000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="cpp"\n              >\n                <span class="gatsby-code-button-language">cpp</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">button1_Click</span><span class="token punctuation">(</span>object sender<span class="token punctuation">,</span> EventArgs e<span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    Graphics person <span class="token operator">=</span> pictureBox1<span class="token punctuation">.</span><span class="token function">CreateGraphics</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Pen p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Pen</span><span class="token punctuation">(</span>Color<span class="token punctuation">.</span>Yellow<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    person<span class="token punctuation">.</span><span class="token function">DrawEllipse</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    person<span class="token punctuation">.</span><span class="token function">DrawRectangle</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    person<span class="token punctuation">.</span><span class="token function">DrawLine</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    person<span class="token punctuation">.</span><span class="token function">DrawLine</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    person<span class="token punctuation">.</span><span class="token function">DrawLine</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    person<span class="token punctuation">.</span><span class="token function">DrawLine</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">85</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>需求改变，再画一个胖一点的小人</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/微信截图_20180415165000-90731e0e065659f1cf624674c5e8cd04-d897f.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 429px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 57.10955710955711%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsSAAALEgHS3X78AAACIUlEQVQoz2Oon3Olf/Wl9qWXaxZcrZh/rWoBCLWsvF+76GblvKuV86+BBEHoevPK+00rH/evvz9/x8Mdey8tn7GJYcGyLcbaEhpK4kZa4oaa4npq4trKogd3zE+MdFWW4TPUkjTWFtdXl9BUFNq5ceabl7f2H9h+9vzpx09vHD13naFvxjoONkYGBgZmVgY2dgYIWLRopoWFCZDBys7EwsbAwgJSMG/ulNevH167fvHGzSsvnl/ff+Qiw4RZ67g4mBgYGOXkGEVFgYpA6pYvnWVtbQZkiIkxS0kxcnEBFTAsXjjt9/cnb15ee/vqxvePt6CaITbLyzMIC0NtBmq2tDAFMsTFmdjZgUaAFCxaMPXH1ycvnl59+ezGl/c39x+FaWZiYpCSYhAQYGBmhmq2sgRpFhBg4uNj4OEBaV44f+rPb09ePrv66vmNLx9uotjMz88AVAe32coKpJmHh4mDgwHiF6DN6Jonzl7PzcnCzs7Mw8PMy8sMZACVrlg229bGHKhBSIiVhYWZlZUF4uefXx+jaO6dtoaDjQENLJg/zczMCMhgYmICkyCb58ye9O3z42ePrzx/cv3j2xt7Dl1g2Ljz+ISeiraWis62ig4wam8pv3Zp3+IFE5obizvbKoEine0Vrc2lVy7s+fPj/tePN798uPX/5+3jZy4z2IVtjczdH5a9PxwJ+SVtD8nYE5GDLugZu8krbrNn7GbfhC02gesByg4PNrL1aQUAAAAASUVORK5CYII=\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="     20180415165000" title="" data-src="/static/微信截图_20180415165000-90731e0e065659f1cf624674c5e8cd04-d897f.png" data-srcset="/static/微信截图_20180415165000-90731e0e065659f1cf624674c5e8cd04-b0eaf.png 200w,\n/static/微信截图_20180415165000-90731e0e065659f1cf624674c5e8cd04-3e28a.png 400w,\n/static/微信截图_20180415165000-90731e0e065659f1cf624674c5e8cd04-d897f.png 429w" data-sizes="(max-width: 429px) 100vw, 429px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>晕，少画了一条腿，难道每次都要重新写一遍代码？</p>\n<p>如何设计？使得凡是绘制小人，都必须有头、身、两个手和两个脚？</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/微信截图_20180415170236-927c40926c1115319c89738facbe4b3e-f0556.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 596px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 95.63758389261746%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAIAAAAf7rriAAAACXBIWXMAAAsSAAALEgHS3X78AAABlklEQVQ4y43T5Y7bUBCGYd//vUWKwszMDE3i9omt3WztSvX8sA5879AZB79TFobhdDptNBrNZrNSqdTr9X6/fzwe08ogffR8PsfjMaDVajUjGw6H6/U69vsf+PV6AQQfjUa8LJfL+Xy+WCwywRRy7nQ6pVJJ8Mvl4mS73WZKW2SMVPGS32w29/t9t9tlheM6u90uL3hh9/t9JliSYEyv18OrXKuzRo5rFrNWq+XzeY60LSscv5avarmweDweiT5/4DAypf76Ybbn8/lwOFjwhXeoc9bhl30ix9ffXu5/m0NXyNvt9ol8vV7VpkjlFQqFarVaLpfT89Rut2m8PBkBhCaQmJXaqpGZZHeTySQB0+gcQTzt1jSBwoze8cskcjqdVqtVAjath8jcQsho3rBMOMvlchKzTcDxt1gsCkspsltdMPOB0TWGcjAPfgBb3Yrn6WdkGq89GAzMjDfXOWP3hoV1+v337SNLwK66kRFrHpKLd9qy5c+FkZzNZtz9Ex5ERuaLesNK5wkssXjhDdJw7JrRWCsb/Af+GzYJ1j+SxAAAAABJRU5ErkJggg==\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="     20180415170236" title="" data-src="/static/微信截图_20180415170236-927c40926c1115319c89738facbe4b3e-f0556.png" data-srcset="/static/微信截图_20180415170236-927c40926c1115319c89738facbe4b3e-ae33b.png 200w,\n/static/微信截图_20180415170236-927c40926c1115319c89738facbe4b3e-daf23.png 400w,\n/static/微信截图_20180415170236-927c40926c1115319c89738facbe4b3e-f0556.png 596w" data-sizes="(max-width: 596px) 100vw, 596px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="50564210413531095000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`abstract class PersonBuilder\n{\n    protected Graphics g;\n    protected Pen p;\n\n    public PersonBuilder(Graphics g, Pen p)\n    {\n        this.g = g;\n        this.p = p;\n    }\n\n    public abstract void BuildHead();\n    public abstract void BuildBody();\n    public abstract void BuildArmLeft();\n    public abstract void BuildArmRight();\n    public abstract void BuildLegLeft();\n    public abstract void BuildLegRight();\n}\nclass PersonThinBuilder : PersonBuilder\n{\n    public PersonThinBuilder(Graphics g, Pen p)\n        : base(g, p) { }\n    public override void BuildHead()\n    {\n        g.DrawEllipse(p, 50, 20, 30, 30);\n    }\n    public override void BuildBody()\n    {\n        g.DrawRectangle(p, 60, 50, 10, 50);\n    }\n    public override void BuildArmLeft()\n    {\n        g.DrawLine(p, 60, 50, 40, 100);\n    }\n    public override void BuildArmRight()\n    {\n        g.DrawLine(p, 70, 50, 90, 100);\n    }\n    public override void BuildLegLeft()\n    {\n        g.DrawLine(p, 60, 100, 45, 150);\n    }\n    public override void BuildLegRight()\n    {\n        g.DrawLine(p, 70, 100, 85, 150);\n    }\n}\nclass PersonFatBuilder : PersonBuilder\n{\n    public PersonFatBuilder(Graphics g, Pen p)\n        : base(g, p) { }\n    public override void BuildHead()\n    {\n        g.DrawEllipse(p, 50, 20, 30, 30);\n    }\n    public override void BuildBody()\n    {\n        g.DrawEllipse(p, 45, 50, 40, 50);\n    }\n    public override void BuildArmLeft()\n    {\n        g.DrawLine(p, 50, 50, 30, 100);\n    }\n    public override void BuildArmRight()\n    {\n        g.DrawLine(p, 80, 50, 100, 100);\n    }\n    public override void BuildLegLeft()\n    {\n        g.DrawLine(p, 60, 100, 45, 150);\n    }\n    public override void BuildLegRight()\n    {\n        g.DrawLine(p, 70, 100, 85, 150);\n    }\n}`, `50564210413531095000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="cpp"\n              >\n                <span class="gatsby-code-button-language">cpp</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp">abstract <span class="token keyword">class</span> <span class="token class-name">PersonBuilder</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">protected</span> Graphics g<span class="token punctuation">;</span>\n    <span class="token keyword">protected</span> Pen p<span class="token punctuation">;</span>\n\n    <span class="token keyword">public</span> <span class="token function">PersonBuilder</span><span class="token punctuation">(</span>Graphics g<span class="token punctuation">,</span> Pen p<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>g <span class="token operator">=</span> g<span class="token punctuation">;</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>p <span class="token operator">=</span> p<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">public</span> abstract <span class="token keyword">void</span> <span class="token function">BuildHead</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">public</span> abstract <span class="token keyword">void</span> <span class="token function">BuildBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">public</span> abstract <span class="token keyword">void</span> <span class="token function">BuildArmLeft</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">public</span> abstract <span class="token keyword">void</span> <span class="token function">BuildArmRight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">public</span> abstract <span class="token keyword">void</span> <span class="token function">BuildLegLeft</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">public</span> abstract <span class="token keyword">void</span> <span class="token function">BuildLegRight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">class</span> <span class="token class-name">PersonThinBuilder</span> <span class="token operator">:</span> PersonBuilder\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token function">PersonThinBuilder</span><span class="token punctuation">(</span>Graphics g<span class="token punctuation">,</span> Pen p<span class="token punctuation">)</span>\n        <span class="token operator">:</span> <span class="token function">base</span><span class="token punctuation">(</span>g<span class="token punctuation">,</span> p<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> override <span class="token keyword">void</span> <span class="token function">BuildHead</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        g<span class="token punctuation">.</span><span class="token function">DrawEllipse</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> override <span class="token keyword">void</span> <span class="token function">BuildBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        g<span class="token punctuation">.</span><span class="token function">DrawRectangle</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> override <span class="token keyword">void</span> <span class="token function">BuildArmLeft</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        g<span class="token punctuation">.</span><span class="token function">DrawLine</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> override <span class="token keyword">void</span> <span class="token function">BuildArmRight</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        g<span class="token punctuation">.</span><span class="token function">DrawLine</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> override <span class="token keyword">void</span> <span class="token function">BuildLegLeft</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        g<span class="token punctuation">.</span><span class="token function">DrawLine</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> override <span class="token keyword">void</span> <span class="token function">BuildLegRight</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        g<span class="token punctuation">.</span><span class="token function">DrawLine</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">85</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">class</span> <span class="token class-name">PersonFatBuilder</span> <span class="token operator">:</span> PersonBuilder\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token function">PersonFatBuilder</span><span class="token punctuation">(</span>Graphics g<span class="token punctuation">,</span> Pen p<span class="token punctuation">)</span>\n        <span class="token operator">:</span> <span class="token function">base</span><span class="token punctuation">(</span>g<span class="token punctuation">,</span> p<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> override <span class="token keyword">void</span> <span class="token function">BuildHead</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        g<span class="token punctuation">.</span><span class="token function">DrawEllipse</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> override <span class="token keyword">void</span> <span class="token function">BuildBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        g<span class="token punctuation">.</span><span class="token function">DrawEllipse</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> override <span class="token keyword">void</span> <span class="token function">BuildArmLeft</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        g<span class="token punctuation">.</span><span class="token function">DrawLine</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> override <span class="token keyword">void</span> <span class="token function">BuildArmRight</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        g<span class="token punctuation">.</span><span class="token function">DrawLine</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> override <span class="token keyword">void</span> <span class="token function">BuildLegLeft</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        g<span class="token punctuation">.</span><span class="token function">DrawLine</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> override <span class="token keyword">void</span> <span class="token function">BuildLegRight</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        g<span class="token punctuation">.</span><span class="token function">DrawLine</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">85</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>继承自抽象类，如果不重写抽象方法，编译器都不通过?</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="59157541805709870000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`private void button2_Click(object sender, EventArgs e)\n{\n    Pen p = new Pen(Color.Yellow);\n    PersonThinBuilder thin = new PersonThinBuilder(pictureBox1.CreateGraphics(),p);\n    thin.BuildHead();\n    thin.BuildBody();\n    thin.BuildArmLeft();\n    thin.BuildArmRight();\n    thin.BuildLegLeft();\n    thin.BuildLegRight();\n\n}`, `59157541805709870000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="cpp"\n              >\n                <span class="gatsby-code-button-language">cpp</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">button2_Click</span><span class="token punctuation">(</span>object sender<span class="token punctuation">,</span> EventArgs e<span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    Pen p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Pen</span><span class="token punctuation">(</span>Color<span class="token punctuation">.</span>Yellow<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    PersonThinBuilder thin <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">PersonThinBuilder</span><span class="token punctuation">(</span>pictureBox1<span class="token punctuation">.</span><span class="token function">CreateGraphics</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    thin<span class="token punctuation">.</span><span class="token function">BuildHead</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    thin<span class="token punctuation">.</span><span class="token function">BuildBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    thin<span class="token punctuation">.</span><span class="token function">BuildArmLeft</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    thin<span class="token punctuation">.</span><span class="token function">BuildArmRight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    thin<span class="token punctuation">.</span><span class="token function">BuildLegLeft</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    thin<span class="token punctuation">.</span><span class="token function">BuildLegRight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>用户调用创建类对象绘制小人，还需要知道头、手、脚这些方法？以下是解决方法。</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/微信截图_20180415171210-993d4f8922f75b2095ea00d0dd5d4f08-c4b55.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 776px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 66.23711340206185%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAACa0lEQVQ4y31TyauSURT3e9rT5hbRKpIgqG3QIuoZUQRCYIsM3j+gG12IYIRBW0VEcyG4cuPGjSQiiAgJzmYOz3lAc9aFA+b0TOx27pdfONGBy7mce8/v/s45v0vz+/0ngUDgeTgcfgHrMW3DEEKkr1Qqt3K53GksFnsbjUZPC4XCS+pcrVbTtiybzf6s1Wqo1WohSBrBhdsQJthsNpPH47HwHYfD8W4ymaByuYz6/T6CBxIUoEaj2QbM5/MtAJw3Go1fpVKprlQqb+I4l8s90mq1DLy32Wxver0egnvnq9UKDYfDEAWo0+m2Aa1W6z273X4fWDxwOp13N8/G4/ER9tCSV/AgSqfT89FohKbTaZACNBgMtP+aQqH4t08kEnTsvV7v6/l8jhki7AeDQYoC1Ov12wAul4uABMLn8xFut5vAMRgUDQZEtNttkqHH43lULBa/xuPxb9CiMLD9TAHivGAwSBOLxYcZWiyW3RBBbQQCwR1wl3bjlDGZzO2A2WwmvdFoZABblkgkui6Xy69JpdIrHA7neA3C4PP5LJlMdlUoFN6AHl4GlscH2UUiEbJnUIIgk8n8SPy1YjKZtEGYDiVSLXmYSqXycHYGqwTri8lkYu4BgiZJmQDAJ9x8rM3lcomazWYVwhcAkOxpKBR6hvXY6XTQYrFA9Xq9BNVc3AOEV+lrwA9wCcEDc6w7SMrgUimGMKSnMCQEAzrHgp/NZmcSiYS1Bwhfir5m+hHrrVqtLkFzWHeFTUBoyUm328UVrEDk+PdkQOCsQyXT10zfY4bAYoTLhqTEDuATOFvBFxyDNn8D+HeVSkUC/gHqWLk17vGDTAAAAABJRU5ErkJggg==\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="     20180415171210" title="" data-src="/static/微信截图_20180415171210-993d4f8922f75b2095ea00d0dd5d4f08-c4b55.png" data-srcset="/static/微信截图_20180415171210-993d4f8922f75b2095ea00d0dd5d4f08-97928.png 200w,\n/static/微信截图_20180415171210-993d4f8922f75b2095ea00d0dd5d4f08-afe85.png 400w,\n/static/微信截图_20180415171210-993d4f8922f75b2095ea00d0dd5d4f08-c4b55.png 776w" data-sizes="(max-width: 776px) 100vw, 776px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="81564548336626300000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class PersonDirector\n{\n    private PersonBuilder pb;\n    public void CreatePerson()\n    {\n        pb.BuildHead();\n        pb.BuildBody();\n        pb.BuildArmLeft();\n        pb.BuildArmRight();\n        pb.BuildLegLeft();\n        pb.BuildLegRight();\n    }\n    public PersonDirector(PersonBuilder pb)\n    {\n        this.pb = pb;\n    }\n}\nprivate void button3_Click(object sender, EventArgs e)\n{\n    Pen p = new Pen(Color.Yellow);\n    PersonThinBuilder pb = new PersonThinBuilder(pictureBox1.CreateGraphics(), p);\n    PersonDirector pd = new PersonDirector(pb);\n    pd.CreatePerson();\n}\nprivate void button3_Click(object sender, EventArgs e)\n{\n    Pen p = new Pen(Color.Yellow);\n    PersonFatBuilder pb = new PersonFatBuilder(pictureBox1.CreateGraphics(), p);\n    PersonDirector pd = new PersonDirector(pb);\n    pd.CreatePerson();\n}`, `81564548336626300000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="cpp"\n              >\n                <span class="gatsby-code-button-language">cpp</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">PersonDirector</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">private</span> PersonBuilder pb<span class="token punctuation">;</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">CreatePerson</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        pb<span class="token punctuation">.</span><span class="token function">BuildHead</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        pb<span class="token punctuation">.</span><span class="token function">BuildBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        pb<span class="token punctuation">.</span><span class="token function">BuildArmLeft</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        pb<span class="token punctuation">.</span><span class="token function">BuildArmRight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        pb<span class="token punctuation">.</span><span class="token function">BuildLegLeft</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        pb<span class="token punctuation">.</span><span class="token function">BuildLegRight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token function">PersonDirector</span><span class="token punctuation">(</span>PersonBuilder pb<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>pb <span class="token operator">=</span> pb<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">button3_Click</span><span class="token punctuation">(</span>object sender<span class="token punctuation">,</span> EventArgs e<span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    Pen p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Pen</span><span class="token punctuation">(</span>Color<span class="token punctuation">.</span>Yellow<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    PersonThinBuilder pb <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">PersonThinBuilder</span><span class="token punctuation">(</span>pictureBox1<span class="token punctuation">.</span><span class="token function">CreateGraphics</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    PersonDirector pd <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">PersonDirector</span><span class="token punctuation">(</span>pb<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    pd<span class="token punctuation">.</span><span class="token function">CreatePerson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">button3_Click</span><span class="token punctuation">(</span>object sender<span class="token punctuation">,</span> EventArgs e<span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    Pen p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Pen</span><span class="token punctuation">(</span>Color<span class="token punctuation">.</span>Yellow<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    PersonFatBuilder pb <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">PersonFatBuilder</span><span class="token punctuation">(</span>pictureBox1<span class="token punctuation">.</span><span class="token function">CreateGraphics</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    PersonDirector pd <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">PersonDirector</span><span class="token punctuation">(</span>pb<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    pd<span class="token punctuation">.</span><span class="token function">CreatePerson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>建造者模式中，添加了一个很重要的类，指挥者类(Director)，用它来控制建造过程，也用它来隔离用户与建造过程之间的关联</p>\n<h3 id="模式动机-2"><a href="#%E6%A8%A1%E5%BC%8F%E5%8A%A8%E6%9C%BA-2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式动机</h3>\n<p>在某些情况下，一个对象会有一些重要的属性，在它们没有恰当的值之前，对象不能作为一个完整的产品使用。比如，一个电子邮件有发件人地址、收件人地址、主题、内容、附录等部分，而在最起码的收件人地址未被赋值之前，这个电子邮件不能发出。</p>\n<h3 id="模式定义-2"><a href="#%E6%A8%A1%E5%BC%8F%E5%AE%9A%E4%B9%89-2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式定义</h3>\n<p>将一个复杂对象的构建与它的表示分离，使得同样的构建过程可以创建不同的表示。建造者模式是一步一步创建一个复杂的对象，它允许用户只通过指定复杂对象的类型和内容就可以构建它们，用户不需要知道内部的具体构建细节。建造者模式属于对象创建型模式。</p>\n<h3 id="模式结构-2"><a href="#%E6%A8%A1%E5%BC%8F%E7%BB%93%E6%9E%84-2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式结构</h3>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/微信截图_20180415172543-9c6701f1804e118f5ab3747f39330676-35569.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 47.878787878787875%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAABv0lEQVQoz41SPWvCUBR98YNiQdqh9Af4Azp1aju5duki+QPSoUNBRKVDUSsimrljELS0dVJDcHAQRUEjKOJH/KpVqoJoLE4Bp/S+YEQp2h4I975zkvNe3rkol8vRlUrlrdls3iCAJElqXFut1nW5XH7NZrNB0KhkMqnDfLFYRHshrVCr1RhY6gKBwAHmC4XCs6JNJhORYZhjzDcaDWKvYa/X++z3+zM45SNep9NpLa6ZTOa+3W5/dzod/ORYltVjvlQq7TcEaLSAjROvBbPZfOL3+89x73a7ZSODwYD+DfjdzasgVuYa3MfjcULZkCRJFIlEEOZisRgRDoflbxKJBEI0TaNQKCTXvwAB7dQoivpNulyudQ93eAbBXEaj0at8Pn+RSqVOMT8ajZDP50N2u/3QYrHobTab3mq1ykE6nc5tQ6/Xq7QqSJ2fTqcSz/MSmEgcx91iYTabER6P5wCCZCHIDwjuC/oHrImiqNoyhADWhoPBoLVcLqX5fC6PTrVavcOCyWTSGo3Go+FwKChjBZMi3xe8r94Vigp2f6/X641ut8stFgseqjL4hMPh0MAoPY3H4yCc/gU2I7EmCALxA/61ExsPxnYAAAAAAElFTkSuQmCC\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="     20180415172543" title="" data-src="/static/微信截图_20180415172543-9c6701f1804e118f5ab3747f39330676-fee1c.png" data-srcset="/static/微信截图_20180415172543-9c6701f1804e118f5ab3747f39330676-a67b7.png 200w,\n/static/微信截图_20180415172543-9c6701f1804e118f5ab3747f39330676-0b187.png 400w,\n/static/微信截图_20180415172543-9c6701f1804e118f5ab3747f39330676-fee1c.png 800w,\n/static/微信截图_20180415172543-9c6701f1804e118f5ab3747f39330676-35569.png 825w" data-sizes="(max-width: 800px) 100vw, 800px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="61926811275875980000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class Product\n{\n    private string partA;\n    private string partB;\n    private string partC;\n    public string PartA\n    {\n        set { partA = value; }\n        get { return partA; }\n    }\n    public string PartB\n    {\n        set { partB = value; }\n        get { return partB; }\n    }\n    public string PartC\n    {\n        set { partC = value; }\n        get { return partC; }\n    }\n    public void Introduce()\n    {\n        Console.WriteLine(PartA);\n        Console.WriteLine(PartB);\n        Console.WriteLine(PartC);\n        Console.WriteLine();\n    }\n}\nabstract class Builder\n{\n    protected Product product = new Product();\n    public abstract void BuildPartA();\n    public abstract void BuildPartB();\n    public abstract void BuildPartC();\n    public Product GetResult()\n    {\n        return product;\n    }\n}\nclass ConcreteBuilderOne : Builder\n{\n    public override void BuildPartA()\n    {\n        product.PartA = &quot;Finish PartA for ProductOne&quot;;\n    }\n    public override void BuildPartB()\n    {\n        product.PartB = &quot;Finish PartB for ProductOne&quot;;\n    }\n    public override void BuildPartC()\n    {\n        product.PartC = &quot;Finish PartC for ProductOne&quot;;\n    }\n}\nclass ConcreteBuilderTwo : Builder\n{\n    public override void BuildPartA()\n    {\n        product.PartA = &quot;完成第二个产品PartA&quot;;\n    }\n    public override void BuildPartB()\n    {\n        product.PartB = &quot;完成第二个产品PartB&quot;;\n    }\n    public override void BuildPartC()\n    {\n        product.PartC = &quot;完成第二个产品PartC&quot;;\n    }\n}\nclass Director\n{\n    private Builder builder;\n    public Director(Builder builder)\n    {\n        this.builder = builder;\n    }\n    public void SetBuilder(Builder builder)\n    {\n        this.builder = builder;\n    }\n    public void Construct()\n    {\n        builder.BuildPartA();\n        builder.BuildPartB();\n        builder.BuildPartC();\n    }\n}\nstatic void Main(string[] args)\n{\n    Product pt;\n    Builder bd = new ConcreteBuilderOne();\n    Director dt = new Director(bd);\n    dt.Construct();\n    pt = bd.GetResult();\n    pt.Introduce();\n\n    bd = new ConcreteBuilderTwo();\n    dt.SetBuilder(bd);\n    dt.Construct();\n    pt = bd.GetResult();\n    pt.Introduce();\n\n    Console.ReadKey();\n}`, `61926811275875980000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="cpp"\n              >\n                <span class="gatsby-code-button-language">cpp</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Product</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">private</span> string partA<span class="token punctuation">;</span>\n    <span class="token keyword">private</span> string partB<span class="token punctuation">;</span>\n    <span class="token keyword">private</span> string partC<span class="token punctuation">;</span>\n    <span class="token keyword">public</span> string PartA\n    <span class="token punctuation">{</span>\n        set <span class="token punctuation">{</span> partA <span class="token operator">=</span> value<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n        get <span class="token punctuation">{</span> <span class="token keyword">return</span> partA<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> string PartB\n    <span class="token punctuation">{</span>\n        set <span class="token punctuation">{</span> partB <span class="token operator">=</span> value<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n        get <span class="token punctuation">{</span> <span class="token keyword">return</span> partB<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> string PartC\n    <span class="token punctuation">{</span>\n        set <span class="token punctuation">{</span> partC <span class="token operator">=</span> value<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n        get <span class="token punctuation">{</span> <span class="token keyword">return</span> partC<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Introduce</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>PartA<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>PartB<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>PartC<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\nabstract <span class="token keyword">class</span> <span class="token class-name">Builder</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">protected</span> Product product <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Product</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">public</span> abstract <span class="token keyword">void</span> <span class="token function">BuildPartA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">public</span> abstract <span class="token keyword">void</span> <span class="token function">BuildPartB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">public</span> abstract <span class="token keyword">void</span> <span class="token function">BuildPartC</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">public</span> Product <span class="token function">GetResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> product<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">class</span> <span class="token class-name">ConcreteBuilderOne</span> <span class="token operator">:</span> Builder\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> override <span class="token keyword">void</span> <span class="token function">BuildPartA</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        product<span class="token punctuation">.</span>PartA <span class="token operator">=</span> <span class="token string">"Finish PartA for ProductOne"</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> override <span class="token keyword">void</span> <span class="token function">BuildPartB</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        product<span class="token punctuation">.</span>PartB <span class="token operator">=</span> <span class="token string">"Finish PartB for ProductOne"</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> override <span class="token keyword">void</span> <span class="token function">BuildPartC</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        product<span class="token punctuation">.</span>PartC <span class="token operator">=</span> <span class="token string">"Finish PartC for ProductOne"</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">class</span> <span class="token class-name">ConcreteBuilderTwo</span> <span class="token operator">:</span> Builder\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> override <span class="token keyword">void</span> <span class="token function">BuildPartA</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        product<span class="token punctuation">.</span>PartA <span class="token operator">=</span> <span class="token string">"完成第二个产品PartA"</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> override <span class="token keyword">void</span> <span class="token function">BuildPartB</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        product<span class="token punctuation">.</span>PartB <span class="token operator">=</span> <span class="token string">"完成第二个产品PartB"</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> override <span class="token keyword">void</span> <span class="token function">BuildPartC</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        product<span class="token punctuation">.</span>PartC <span class="token operator">=</span> <span class="token string">"完成第二个产品PartC"</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">class</span> <span class="token class-name">Director</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">private</span> Builder builder<span class="token punctuation">;</span>\n    <span class="token keyword">public</span> <span class="token function">Director</span><span class="token punctuation">(</span>Builder builder<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>builder <span class="token operator">=</span> builder<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">SetBuilder</span><span class="token punctuation">(</span>Builder builder<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>builder <span class="token operator">=</span> builder<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        builder<span class="token punctuation">.</span><span class="token function">BuildPartA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        builder<span class="token punctuation">.</span><span class="token function">BuildPartB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        builder<span class="token punctuation">.</span><span class="token function">BuildPartC</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    Product pt<span class="token punctuation">;</span>\n    Builder bd <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">ConcreteBuilderOne</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Director dt <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Director</span><span class="token punctuation">(</span>bd<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    dt<span class="token punctuation">.</span><span class="token function">Construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    pt <span class="token operator">=</span> bd<span class="token punctuation">.</span><span class="token function">GetResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    pt<span class="token punctuation">.</span><span class="token function">Introduce</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    bd <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">ConcreteBuilderTwo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    dt<span class="token punctuation">.</span><span class="token function">SetBuilder</span><span class="token punctuation">(</span>bd<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    dt<span class="token punctuation">.</span><span class="token function">Construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    pt <span class="token operator">=</span> bd<span class="token punctuation">.</span><span class="token function">GetResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    pt<span class="token punctuation">.</span><span class="token function">Introduce</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Console<span class="token punctuation">.</span><span class="token function">ReadKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<ul>\n<li>Builder：抽象建造者</li>\n<li>ConcreteBuilder：具体建造者</li>\n<li>Director：指挥者</li>\n<li>Product：产品角色</li>\n</ul>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/微信截图_20180415174352-a1fedcb9260996ece4092ecb4a8354f8-a5624.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 60.45081967213115%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsSAAALEgHS3X78AAACWklEQVQoz2O4//jN//////379x8M/v77AyRPPlq0YG/Q8iPpy88kbzqYtfBYyPajHRAFpyfOWNbVeGXThpsT5zL8+v3r67dvP/78/f73N1DuD1jzkjuLA7ZFxOyJjtmfEbkzNmJ3TNmhGojmCy39bQkhK9NTL+fWMbw6tXTCxPYF03tvLZ0ElPv9F6z51rzAbe5ZO2Oi9wRlb48M2eXXerzqP9hx5+ctbArxXlCc/+T4aYbP2+ouBtttdNFZXJH68/evn79+/Pv1f8v1SZ1b3Tp3BffsDOxc7ddwyG/h0SqIzTdvXW3NSFo/qf/Xjx8MTTnBhyKMblX6zZta9+37j7///wJVTLu6xGpHbMDuFM+9mZH7c+pP1DSfnQAKGlDg/Pv15/fvP3+ATIYd6xZeP7/5/9czP5+cgoXa/w+/Pl59duXGk+sPPz968/H5z++vv31//x8Z/AMhBgT/718U2X///oJF4CZiAgZQJP37C0KwCHv37t2du7ffvH1z9/7dR08f/QCGAjisvnz+9Pr545fPn71/8/zjm2efP75nQDbpzx9QUG/cvCE+I6G2vS4jO66sLLuxuebjp09A8VmTJrlpsBupC+VWNEd6e1Xlp6NohrjzwP7duflJ5SUFJXGBZsoSvoF+z549B4rP62tpCuPe0qF+sNurNFBv9fRcLJqPnjwcGu2T4OdnoKelKSce4+r79MkzoPjW7pqd2cbPrixam+Z/es2Us0c2YdF85NiRzLz05IhwBxursqCggy3dr96+BYp/PLjt9pLp92+ePL1++sMrR959eg8AMz8q/wf1tKMAAAAASUVORK5CYII=\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="     20180415174352" title="" data-src="/static/微信截图_20180415174352-a1fedcb9260996ece4092ecb4a8354f8-fee1c.png" data-srcset="/static/微信截图_20180415174352-a1fedcb9260996ece4092ecb4a8354f8-a67b7.png 200w,\n/static/微信截图_20180415174352-a1fedcb9260996ece4092ecb4a8354f8-0b187.png 400w,\n/static/微信截图_20180415174352-a1fedcb9260996ece4092ecb4a8354f8-fee1c.png 800w,\n/static/微信截图_20180415174352-a1fedcb9260996ece4092ecb4a8354f8-a5624.png 976w" data-sizes="(max-width: 800px) 100vw, 800px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<h3 id="优缺点-2"><a href="#%E4%BC%98%E7%BC%BA%E7%82%B9-2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>优缺点</h3>\n<ul>\n<li>建造者模式的使用使得产品的内部组成可以独立的变化，使用建造者模式可以使客户端不必知道产品内部组成的细节。</li>\n<li>每一个 Builder 都相对独立，而与其他的 Builder 无关。</li>\n<li>模式所建造的最终产品更易于控制。</li>\n</ul>\n<h3 id="模式使用-2"><a href="#%E6%A8%A1%E5%BC%8F%E4%BD%BF%E7%94%A8-2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式使用</h3>\n<ul>\n<li>需要生成的产品对象有复杂的内部结构。</li>\n<li>需要生成的产品对象的属性相互依赖，建造者模式可以强迫生成顺序。</li>\n<li>在对象创建过程中会使用到系统中的一些其他对象，这些对象在产品对象的创建过程中不易得到。</li>\n</ul>\n<h3 id="模式应用-1"><a href="#%E6%A8%A1%E5%BC%8F%E5%BA%94%E7%94%A8-1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式应用</h3>\n<p>Mail（一步一步构造一个完整的邮件对象，然后发送）</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="39447911152125960000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`public void set主题(String 主题) {\n    this.主题 = 主题;}\npublic void set发件人(Email地址 发件人) {\n    this.发件人 = 发件人;}\npublic void set抄送人(List<Email地址> 抄送人) {\n    this.抄送人 = 抄送人; }\npublic void set收件人(List<Email地址> 收件人) {\n    this.收件人 = 收件人;}\npublic void set正文(String 正文) {\n    this.正文 = 正文;}\npublic void set邮件时间(Date time) {\n    this.邮件时间 = time;}\npublic void set附件(List<File> files) {\n    this.附件 = files;}`, `39447911152125960000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="cpp"\n              >\n                <span class="gatsby-code-button-language">cpp</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token keyword">public</span> <span class="token keyword">void</span> set主题<span class="token punctuation">(</span>String 主题<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>主题 <span class="token operator">=</span> 主题<span class="token punctuation">;</span><span class="token punctuation">}</span>\n<span class="token keyword">public</span> <span class="token keyword">void</span> set发件人<span class="token punctuation">(</span>Email地址 发件人<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>发件人 <span class="token operator">=</span> 发件人<span class="token punctuation">;</span><span class="token punctuation">}</span>\n<span class="token keyword">public</span> <span class="token keyword">void</span> set抄送人<span class="token punctuation">(</span>List<span class="token operator">&lt;</span>Email地址<span class="token operator">></span> 抄送人<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>抄送人 <span class="token operator">=</span> 抄送人<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n<span class="token keyword">public</span> <span class="token keyword">void</span> set收件人<span class="token punctuation">(</span>List<span class="token operator">&lt;</span>Email地址<span class="token operator">></span> 收件人<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>收件人 <span class="token operator">=</span> 收件人<span class="token punctuation">;</span><span class="token punctuation">}</span>\n<span class="token keyword">public</span> <span class="token keyword">void</span> set正文<span class="token punctuation">(</span>String 正文<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>正文 <span class="token operator">=</span> 正文<span class="token punctuation">;</span><span class="token punctuation">}</span>\n<span class="token keyword">public</span> <span class="token keyword">void</span> set邮件时间<span class="token punctuation">(</span>Date time<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>邮件时间 <span class="token operator">=</span> time<span class="token punctuation">;</span><span class="token punctuation">}</span>\n<span class="token keyword">public</span> <span class="token keyword">void</span> set附件<span class="token punctuation">(</span>List<span class="token operator">&lt;</span>File<span class="token operator">></span> files<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>附件 <span class="token operator">=</span> files<span class="token punctuation">;</span><span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="原型模式prototype"><a href="#%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8Fprototype" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>原型模式(Prototype)</h2>\n<p>用原型实例指定创建对象的种类，并且通过拷贝这些原型创建新的对象。</p>\n<h3 id="模式背景-1"><a href="#%E6%A8%A1%E5%BC%8F%E8%83%8C%E6%99%AF-1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式背景</h3>\n<p><strong>简历投递</strong></p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="76026415797053000000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class Resume     //简历类\n{\n    private string name, sex , age , timeArea, company , AimCompany;\n    public Resume(string name)\n    {\n        this.name = name;\n    }\n    public void SetPersonalInfo(string sex, string age)    //设置个人信息\n    {\n        this.sex = sex;     this.age = age;\n    }\n    public void SetWorkExperience(string timeArea, string company)    //设置工作经历\n    {\n        this.timeArea = timeArea;     this.company = company;\n    }\n    public void SetAimCompany(string AimCompany)    //设置目标公司名称\n    {\n        this.AimCompany = AimCompany;\n    }\n    public void Display()     //显示\n    {\n        Console.WriteLine(&quot;尊敬的&quot; + AimCompany + &quot;公司领导，您好：&quot;)\n        Console.WriteLine(&quot;{0} {1} {2}&quot;, name, sex, age);\n        Console.WriteLine(&quot;工作经历：{0} {1}&quot;, timeArea, company);\n    }\n}`, `76026415797053000000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="cpp"\n              >\n                <span class="gatsby-code-button-language">cpp</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Resume</span>     <span class="token comment">//简历类</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">private</span> string name<span class="token punctuation">,</span> sex <span class="token punctuation">,</span> age <span class="token punctuation">,</span> timeArea<span class="token punctuation">,</span> company <span class="token punctuation">,</span> AimCompany<span class="token punctuation">;</span>\n    <span class="token keyword">public</span> <span class="token function">Resume</span><span class="token punctuation">(</span>string name<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">SetPersonalInfo</span><span class="token punctuation">(</span>string sex<span class="token punctuation">,</span> string age<span class="token punctuation">)</span>    <span class="token comment">//设置个人信息</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>sex <span class="token operator">=</span> sex<span class="token punctuation">;</span>     <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">SetWorkExperience</span><span class="token punctuation">(</span>string timeArea<span class="token punctuation">,</span> string company<span class="token punctuation">)</span>    <span class="token comment">//设置工作经历</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>timeArea <span class="token operator">=</span> timeArea<span class="token punctuation">;</span>     <span class="token keyword">this</span><span class="token punctuation">.</span>company <span class="token operator">=</span> company<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">SetAimCompany</span><span class="token punctuation">(</span>string AimCompany<span class="token punctuation">)</span>    <span class="token comment">//设置目标公司名称</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>AimCompany <span class="token operator">=</span> AimCompany<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Display</span><span class="token punctuation">(</span><span class="token punctuation">)</span>     <span class="token comment">//显示</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"尊敬的"</span> <span class="token operator">+</span> AimCompany <span class="token operator">+</span> <span class="token string">"公司领导，您好："</span><span class="token punctuation">)</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"{0} {1} {2}"</span><span class="token punctuation">,</span> name<span class="token punctuation">,</span> sex<span class="token punctuation">,</span> age<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"工作经历：{0} {1}"</span><span class="token punctuation">,</span> timeArea<span class="token punctuation">,</span> company<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>内容相似只能 Ctrl+C, Ctrl+V?</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="82415300327962800000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`static void Main(string[] args)\n{\n    Resume a = new Resume(“张三&quot;);\n    a.SetPersonalInfo(&quot;男&quot;, &quot;22&quot;);\n    a.SetWorkExperience(&quot;1998-2000&quot;, “XX 公司&quot;);\n    a.SetAimCompany(&quot;Google&quot;);\n\n    Resume b = a;\n\n    a.Display();\n    b.Display();\n\n    b.SetAimCompany(“Baidu&quot;);\n\n    a.Display();\n    b.Display();\n\n    Console.Read();\n}`, `82415300327962800000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="cpp"\n              >\n                <span class="gatsby-code-button-language">cpp</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    Resume a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Resume</span><span class="token punctuation">(</span>“张三"<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    a<span class="token punctuation">.</span><span class="token function">SetPersonalInfo</span><span class="token punctuation">(</span><span class="token string">"男"</span><span class="token punctuation">,</span> <span class="token string">"22"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    a<span class="token punctuation">.</span><span class="token function">SetWorkExperience</span><span class="token punctuation">(</span><span class="token string">"1998-2000"</span><span class="token punctuation">,</span> “XX 公司"<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    a<span class="token punctuation">.</span><span class="token function">SetAimCompany</span><span class="token punctuation">(</span><span class="token string">"Google"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Resume b <span class="token operator">=</span> a<span class="token punctuation">;</span>\n\n    a<span class="token punctuation">.</span><span class="token function">Display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    b<span class="token punctuation">.</span><span class="token function">Display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    b<span class="token punctuation">.</span><span class="token function">SetAimCompany</span><span class="token punctuation">(</span>“Baidu"<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    a<span class="token punctuation">.</span><span class="token function">Display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    b<span class="token punctuation">.</span><span class="token function">Display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Console<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/微信截图_20180416124727-5128778bc862f11d52c1014eabec2d62-65498.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 409px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 92.90953545232274%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAAAsSAAALEgHS3X78AAAC4ElEQVQ4y5WUyUsjURDGO4pO6IOzO5A5DAODepKcBC8echAvcxLHYcBbvHuYP8GTt4AgJnoRogcxGgVtt6gJKLjEBcUt7mnjFndwSXdq6nskEqcnOhYUr/L61e9VfZVuSUqxhoYGsTY2NmYrivKOQxPbV15z2T+wf2T/wv6JPUt6zurr601Ym5ubv3V3d/9GnJOTk8vQtwkI3ML+/r+AKZaVSHq5+f1+yefzSSMjI1JLS4vYs1gs2WazGS1LZWVlGTU1NSa73W6qrq42VVVVmfLz8198Twb7m6cO2Gy2fz8oLi6WCwsLZbfbLdfW1sp1dXXm8vLy16WlpZ+J6BX2pqen5crKStlqtcpFRUVyXl5eJnILCgqMwIODg6iqquHJyUl1aWlJXV1dVVdWVvbHxsYig4OD6tzc3D5LooZCIZXPhjc2NqI8tO/IbWtryzQAKWELCwvEUJqYmKChoSEaHx8n1pcWFxdFfHV1lTxK7e3tP5Hb29trBJ6cnND29nYsHA7r8L29PT0Zp/7e3d1FrO3s7JDL5apALsuUtkKdnrd48lxXV9cP5LIkRmAkEiHWRWfdUCmhAvjm5ib2hW9tbRFrGGetUS01NTUJYGtrqxF4dHSEBH1tbY24JQFbX18XQFwGDXkYiB8q7OjoEMD+/n4jEGLzYR0A6MlTFmCuhqLRKB0fHxMu5Wfxs7Mz/ebmhnp6egRwYGDACLy8vEQyRKfDw0PRIirDBefn5yLGM4bGLy4u9NvbW/J6vemBp6enlJgmoW3otby8TNAUMTTDpalD8Xg8TwO5Mh06oU20jRgQVHN3d0eaplGcDUAsnZ2d6YFok1u6x3+MK9IYprGuGic/chiv97FYDBVWpB0KWmCxHypKmq7rQlMM7fr6+tEfkr+Vv5A7PDxsBM7MzPj4ve3jz5fCr50yOzurzM/PK1NTU0ogEFBGR0fFfjAYVPhd7+MPhc/hcJQg1+l0ZvzN+wNLcdZEubpNxgAAAABJRU5ErkJggg==\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="     20180416124727" title="" data-src="/static/微信截图_20180416124727-5128778bc862f11d52c1014eabec2d62-65498.png" data-srcset="/static/微信截图_20180416124727-5128778bc862f11d52c1014eabec2d62-67408.png 200w,\n/static/微信截图_20180416124727-5128778bc862f11d52c1014eabec2d62-5cbc3.png 400w,\n/static/微信截图_20180416124727-5128778bc862f11d52c1014eabec2d62-65498.png 409w" data-sizes="(max-width: 409px) 100vw, 409px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>以下做原型模式的改进</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="59183948162019290000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class Resume: Icloneable //简历类\n{\n    private string name, sex , age , timeArea, company , AimCompany;\n    public Resume(string name)\n    {\n        this.name = name;\n    }\n    public void SetPersonalInfo(string sex, string age)    //设置个人信息\n    {\n        this.sex = sex;     this.age = age;\n    }\n    public void SetWorkExperience(string timeArea, string company)    //设置工作经历\n    {\n        this.timeArea = timeArea;     this.company = company;\n    }\n    public void SetAimCompany(string AimCompany)    //设置目标公司名称\n    {\n        this.AimCompany = AimCompany;\n    }\n    public void Display()     //显示\n    {\n        Console.WriteLine(&quot;尊敬的&quot; + AimCompany + &quot;公司领导，您好：&quot;)\n        Console.WriteLine(&quot;{0} {1} {2}&quot;, name, sex, age);\n        Console.WriteLine(&quot;工作经历：{0} {1}&quot;, timeArea, company);\n    }\n    public Object Clone()\n    {\n        return this.MemberwiseClone();\n    }\n}\n\nstatic void Main(string[] args)\n{\n    Resume a = new Resume(“张三&quot;);\n    a.SetPersonalInfo(&quot;男&quot;, &quot;22&quot;);\n    a.SetWorkExperience(&quot;1998-2000&quot;, “XX 公司&quot;);\n    a.SetAimCompany(&quot;Google&quot;);\n\n    Resume b = (Resume)a.Clone();\n\n    a.Display();\n    b.Display();\n\n    b.SetAimCompany(“Baidu&quot;);\n\n    a.Display();\n    b.Display();\n\n    Console.Read();\n}`, `59183948162019290000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="cpp"\n              >\n                <span class="gatsby-code-button-language">cpp</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Resume</span><span class="token operator">:</span> Icloneable <span class="token comment">//简历类</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">private</span> string name<span class="token punctuation">,</span> sex <span class="token punctuation">,</span> age <span class="token punctuation">,</span> timeArea<span class="token punctuation">,</span> company <span class="token punctuation">,</span> AimCompany<span class="token punctuation">;</span>\n    <span class="token keyword">public</span> <span class="token function">Resume</span><span class="token punctuation">(</span>string name<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">SetPersonalInfo</span><span class="token punctuation">(</span>string sex<span class="token punctuation">,</span> string age<span class="token punctuation">)</span>    <span class="token comment">//设置个人信息</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>sex <span class="token operator">=</span> sex<span class="token punctuation">;</span>     <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">SetWorkExperience</span><span class="token punctuation">(</span>string timeArea<span class="token punctuation">,</span> string company<span class="token punctuation">)</span>    <span class="token comment">//设置工作经历</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>timeArea <span class="token operator">=</span> timeArea<span class="token punctuation">;</span>     <span class="token keyword">this</span><span class="token punctuation">.</span>company <span class="token operator">=</span> company<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">SetAimCompany</span><span class="token punctuation">(</span>string AimCompany<span class="token punctuation">)</span>    <span class="token comment">//设置目标公司名称</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>AimCompany <span class="token operator">=</span> AimCompany<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Display</span><span class="token punctuation">(</span><span class="token punctuation">)</span>     <span class="token comment">//显示</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"尊敬的"</span> <span class="token operator">+</span> AimCompany <span class="token operator">+</span> <span class="token string">"公司领导，您好："</span><span class="token punctuation">)</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"{0} {1} {2}"</span><span class="token punctuation">,</span> name<span class="token punctuation">,</span> sex<span class="token punctuation">,</span> age<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"工作经历：{0} {1}"</span><span class="token punctuation">,</span> timeArea<span class="token punctuation">,</span> company<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> Object <span class="token function">Clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">MemberwiseClone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    Resume a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Resume</span><span class="token punctuation">(</span>“张三"<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    a<span class="token punctuation">.</span><span class="token function">SetPersonalInfo</span><span class="token punctuation">(</span><span class="token string">"男"</span><span class="token punctuation">,</span> <span class="token string">"22"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    a<span class="token punctuation">.</span><span class="token function">SetWorkExperience</span><span class="token punctuation">(</span><span class="token string">"1998-2000"</span><span class="token punctuation">,</span> “XX 公司"<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    a<span class="token punctuation">.</span><span class="token function">SetAimCompany</span><span class="token punctuation">(</span><span class="token string">"Google"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Resume b <span class="token operator">=</span> <span class="token punctuation">(</span>Resume<span class="token punctuation">)</span>a<span class="token punctuation">.</span><span class="token function">Clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    a<span class="token punctuation">.</span><span class="token function">Display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    b<span class="token punctuation">.</span><span class="token function">Display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    b<span class="token punctuation">.</span><span class="token function">SetAimCompany</span><span class="token punctuation">(</span>“Baidu"<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    a<span class="token punctuation">.</span><span class="token function">Display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    b<span class="token punctuation">.</span><span class="token function">Display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Console<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><strong>配钥匙</strong></p>\n<p>前几天，我很不幸把大门的钥匙给弄丢了，结果进不了家门。万幸的是，同学那儿还有一把，于是第二天我拿了他的那把去配钥匙。另外，他还让我顺便给他配一把房间的钥匙。现在配个钥匙真是简单，把钥匙给他，他直接找一个合适的钥匙胚子，把我的钥匙夹在配钥匙机的一端，胚子夹在另一端，一开电源，一把标尺比着我的钥匙齿型走一遍，砂轮就在胚子上复制出一把钥匙来！一分钟不到，两把新钥匙就搞定了！</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/微信截图_20180416122107-470b6e020e79e7ede5735471308d2eb6-4d589.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 713px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 48.2468443197756%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAACfElEQVQoz32SW0jTURzHj26Y0Y1eIgqCHqKHHnropd6Keg6iLNDSlTVvYQn1kJAhXogglEgHm7fN0kYaSJCU6UCCLhJt/8u2nHOX//7738/ftv80vP06/0mBD/aDD7/fOed3+R7OQeU9bKDEQX0jzJhccVDfba7ACUTM3k8Vmr7Wwxy60c9mSxy0cambyhIyF7up5csOKtjk9e82c+rcgQLTo84pEVrezhNiedreJaBpNFyC0HVUOxjag05PWTrG5465fPH1ro8xeD4RM/2ac5oHx2Qs/sJHcoj1TUU2GgKx5ZUVWFldg1XCOlnHeOW8eTb+I1Vseh1rR7K5JcDZ36BlFsHILZplsGhkpHA0udfM4QWpoNTFIJSStNucqFX/JSmqtcm0fHBjWDZ/5QWsHoinVX8kpfrDnMrGBY0WFJ3lJe09O5fYZeZEEmn0X2sdm7Xa3UHrzYGg9ZqL3tbwktnZ9JrdXuVm99kHmP2NXqa4fpDZUdHLFNl6GUtFD2O199OFCGPdSrCY6LoJtkyH5IKtBp3tYIuONlPWLZWUudh/1HsC6GSXlN+3D7CVVe5gJ1HwpNRJPy1z0m1E6bNbfdThGjdziqhvr/YEG4my1qtO+iGhubKXurCp+f1hGpWPGvm4YTj8qcWXg4aRJNR4Ca8ScG/cAPKFzt0dCj1q9i3Bg7EU3BnhwD4Uh7pREcigN5saRjkRzS3ARsyrE7KxBtE0Bk7+BUkRg7EKMM8rZyKc0qiQhw4l1fWooMO8gCGtL8EsJ3s3NUwJEiI1+VhS8OOUhD8nBG1CVPCkhvUPqqbP8KJyXNU0W1rGPzlJ+yIoeAbr+lesL/hFWW3/AxP6s8vXIbLdAAAAAElFTkSuQmCC\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="     20180416122107" title="" data-src="/static/微信截图_20180416122107-470b6e020e79e7ede5735471308d2eb6-4d589.png" data-srcset="/static/微信截图_20180416122107-470b6e020e79e7ede5735471308d2eb6-b9753.png 200w,\n/static/微信截图_20180416122107-470b6e020e79e7ede5735471308d2eb6-7c7b5.png 400w,\n/static/微信截图_20180416122107-470b6e020e79e7ede5735471308d2eb6-4d589.png 713w" data-sizes="(max-width: 713px) 100vw, 713px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="79973684837417550000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`public abstract class Key\n{\n    private string name;\n    public string Name\n    {\n        get { return name; }\n        set { name = value; }\n    }\n\n    private string owner;\n    public string Owner\n    {\n        get { return owner; }\n        set { owner = value; }\n    }\n\n    public Key(string name, string owner)\n    {\n        this.name = name;\n        this.owner = owner;\n    }\n    //钥匙复制自身的抽象定义\n    public abstract Key Clone();\n    public override String ToString()\n    {\n        return this.Name + &quot;, 属于 &quot; + this.Owner;\n    }\n}\n\n//大门钥匙\npublic class GateKey : Key\n{\n    public GateKey(string owner) : base(&quot;大门 钥匙&quot;, owner) { }\n\n    public override Key Clone()\n    {\n        return new GateKey(this.Owner);\n    }\n}\n\n//橱柜钥匙\npublic class CabinetKey : Key\n{\n    public CabinetKey(string owner) : base(&quot;房间 钥匙&quot;, owner) { }\n\n    public override Key Clone()\n    {\n        return new CabinetKey(this.Owner);\n    }\n}\n\npublic static void Main(string[] args)\n{\n    Key oldGateKey, newGateKey, oldCabinetKey, newCabinetKey;\n    oldGateKey = new GateKey(&quot;同学&quot;);\n    newGateKey = oldGateKey.Clone();\n    newGateKey.Owner = &quot;我&quot;;\n\n    oldCabinetKey = new CabinetKey(&quot;我&quot;);\n    newCabinetKey = oldCabinetKey.Clone();\n    newCabinetKey.Owner = &quot;同学&quot;;\n\n    Console.WriteLine(oldGateKey.ToString());\n    Console.WriteLine(newGateKey.ToString());\n    Console.WriteLine(oldCabinetKey.ToString());\n    Console.WriteLine(newCabinetKey.ToString());\n    Console.Read();\n}`, `79973684837417550000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="cpp"\n              >\n                <span class="gatsby-code-button-language">cpp</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token keyword">public</span> abstract <span class="token keyword">class</span> <span class="token class-name">Key</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">private</span> string name<span class="token punctuation">;</span>\n    <span class="token keyword">public</span> string Name\n    <span class="token punctuation">{</span>\n        get <span class="token punctuation">{</span> <span class="token keyword">return</span> name<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n        set <span class="token punctuation">{</span> name <span class="token operator">=</span> value<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">private</span> string owner<span class="token punctuation">;</span>\n    <span class="token keyword">public</span> string Owner\n    <span class="token punctuation">{</span>\n        get <span class="token punctuation">{</span> <span class="token keyword">return</span> owner<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n        set <span class="token punctuation">{</span> owner <span class="token operator">=</span> value<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">public</span> <span class="token function">Key</span><span class="token punctuation">(</span>string name<span class="token punctuation">,</span> string owner<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>owner <span class="token operator">=</span> owner<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token comment">//钥匙复制自身的抽象定义</span>\n    <span class="token keyword">public</span> abstract Key <span class="token function">Clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">public</span> override String <span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>Name <span class="token operator">+</span> <span class="token string">", 属于 "</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>Owner<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">//大门钥匙</span>\n<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GateKey</span> <span class="token operator">:</span> Key\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token function">GateKey</span><span class="token punctuation">(</span>string owner<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">base</span><span class="token punctuation">(</span><span class="token string">"大门 钥匙"</span><span class="token punctuation">,</span> owner<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>\n\n    <span class="token keyword">public</span> override Key <span class="token function">Clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token function">GateKey</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Owner<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">//橱柜钥匙</span>\n<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CabinetKey</span> <span class="token operator">:</span> Key\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token function">CabinetKey</span><span class="token punctuation">(</span>string owner<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">base</span><span class="token punctuation">(</span><span class="token string">"房间 钥匙"</span><span class="token punctuation">,</span> owner<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>\n\n    <span class="token keyword">public</span> override Key <span class="token function">Clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token function">CabinetKey</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Owner<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    Key oldGateKey<span class="token punctuation">,</span> newGateKey<span class="token punctuation">,</span> oldCabinetKey<span class="token punctuation">,</span> newCabinetKey<span class="token punctuation">;</span>\n    oldGateKey <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">GateKey</span><span class="token punctuation">(</span><span class="token string">"同学"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    newGateKey <span class="token operator">=</span> oldGateKey<span class="token punctuation">.</span><span class="token function">Clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    newGateKey<span class="token punctuation">.</span>Owner <span class="token operator">=</span> <span class="token string">"我"</span><span class="token punctuation">;</span>\n\n    oldCabinetKey <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">CabinetKey</span><span class="token punctuation">(</span><span class="token string">"我"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    newCabinetKey <span class="token operator">=</span> oldCabinetKey<span class="token punctuation">.</span><span class="token function">Clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    newCabinetKey<span class="token punctuation">.</span>Owner <span class="token operator">=</span> <span class="token string">"同学"</span><span class="token punctuation">;</span>\n\n    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>oldGateKey<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>newGateKey<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>oldCabinetKey<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>newCabinetKey<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Console<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="模式动机-3"><a href="#%E6%A8%A1%E5%BC%8F%E5%8A%A8%E6%9C%BA-3" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式动机</h3>\n<p>有些对象的创建过程较为复杂，而且有时候需要频繁创建，原型模式通过给出一个原型对象来指明所要创建的对象的类型，然后用复制这个原型对象的办法创建出更多同类型的对象。这就是原型模式的动机。</p>\n<h3 id="模式定义-3"><a href="#%E6%A8%A1%E5%BC%8F%E5%AE%9A%E4%B9%89-3" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式定义</h3>\n<p>它是一种对象创建型模式，用原型实例指定创建对象的种类，并且通过拷贝这些原型创建新的对象。原型模式允许一个对象再创建另外一个可定制的对象，无需知道任何创建的细节。</p>\n<p>通过将一个原型对象传给那个要发动创建的对象，这个要发动创建的对象通过请求原型对象拷贝原型自己来实现创建过程。</p>\n<h3 id="模式结构-3"><a href="#%E6%A8%A1%E5%BC%8F%E7%BB%93%E6%9E%84-3" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式结构</h3>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/微信截图_20180416120752-4c61276a4c5e876e548cefa7a7745afd-6604a.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 35.73113207547169%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsSAAALEgHS3X78AAABeElEQVQoz5VRz0sCURB+KpZBhwj6JwIhqEP9D10DQboFhRAkSASeOwZdu+whJGIPduggKO5FUVtFF3UX2RVBxfUHIorKrmROM+Z2kQ4NPL433/fezJvvsVqt9pTP519UVeVxHTEMALCtkICVy2W3LMvBXC53h3gjCMIO8YhsLbrdLliBF86J83g8WwhOr9dLyLDhLemz2QxM04REIrFPfCQSsa8VbDQaz+Px+K3f778XCoVj4nie3+Q4zhmPxzcoTyaTh5IkPZZKpVdd14PRaHSP+Pl87sCpHNlsdlkYG7L/xvZfgqZpPxvyiTyzfAuHw7uKolygV5c46hXur1Op1InlbSgUcomieIa8j/RKpeLD/JR0wzAYy2QyZDqNZV/5ctBqtaDT6UCz2YTpdAo47oNV0O/3u7CZNhqNAO2C4XAIxWLxY/Uftt8np9PpZRKLxdx48LPX631NJhOTPqNer99bBQOBgKtarUqDwQDQe2OxWEC73RYs/RsgnAjpFoQkogAAAABJRU5ErkJggg==\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="     20180416120752" title="" data-src="/static/微信截图_20180416120752-4c61276a4c5e876e548cefa7a7745afd-fee1c.png" data-srcset="/static/微信截图_20180416120752-4c61276a4c5e876e548cefa7a7745afd-a67b7.png 200w,\n/static/微信截图_20180416120752-4c61276a4c5e876e548cefa7a7745afd-0b187.png 400w,\n/static/微信截图_20180416120752-4c61276a4c5e876e548cefa7a7745afd-fee1c.png 800w,\n/static/微信截图_20180416120752-4c61276a4c5e876e548cefa7a7745afd-6604a.png 848w" data-sizes="(max-width: 800px) 100vw, 800px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<ul>\n<li>Prototype：抽象原型类</li>\n<li>ConcretePrototype：具体原型类</li>\n<li>Client：客户</li>\n</ul>\n<p><strong>抽象原型类</strong></p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="34646882589791228000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`abstract class Prototype\n{\n    private string id;\n\n    // Constructor\n    public Prototype(string id)\n    {\n        this.id = id;\n    }\n\n    // Property\n    public string Id\n    {\n        get { return id; }\n    }\n\n    public abstract Prototype Clone();\n}`, `34646882589791228000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="cpp"\n              >\n                <span class="gatsby-code-button-language">cpp</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp">abstract <span class="token keyword">class</span> <span class="token class-name">Prototype</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">private</span> string id<span class="token punctuation">;</span>\n\n    <span class="token comment">// Constructor</span>\n    <span class="token keyword">public</span> <span class="token function">Prototype</span><span class="token punctuation">(</span>string id<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token comment">// Property</span>\n    <span class="token keyword">public</span> string Id\n    <span class="token punctuation">{</span>\n        get <span class="token punctuation">{</span> <span class="token keyword">return</span> id<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">public</span> abstract Prototype <span class="token function">Clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><strong>具体原型类</strong></p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="51317095288357970000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class ConcretePrototype1 : Prototype\n{\n    // Constructor\n    public ConcretePrototype1(string id) : base(id)\n    {\n    }\n\n    public override Prototype Clone()\n    {\n        // Shallow copy\n        return (Prototype) new ConcretePrototype1(this.Id);\n    }\n}`, `51317095288357970000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="cpp"\n              >\n                <span class="gatsby-code-button-language">cpp</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">ConcretePrototype1</span> <span class="token operator">:</span> Prototype\n<span class="token punctuation">{</span>\n    <span class="token comment">// Constructor</span>\n    <span class="token keyword">public</span> <span class="token function">ConcretePrototype1</span><span class="token punctuation">(</span>string id<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">base</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">public</span> override Prototype <span class="token function">Clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token comment">// Shallow copy</span>\n        <span class="token keyword">return</span> <span class="token punctuation">(</span>Prototype<span class="token punctuation">)</span> <span class="token keyword">new</span> <span class="token function">ConcretePrototype1</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Id<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><strong>客户端代码</strong></p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="31638123343616664000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`static void Main(string[] args)\n{\n    Prototype p1, c1;\n\n    p1 = new ConcretePrototype1(“Design Pattern&quot;);\n\n    c1 = p1.Clone();\n\n    Console.WriteLine(&quot;Cloned: {0}&quot;, c1.Id);\n\n    Console.Read();\n}`, `31638123343616664000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="cpp"\n              >\n                <span class="gatsby-code-button-language">cpp</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    Prototype p1<span class="token punctuation">,</span> c1<span class="token punctuation">;</span>\n\n    p1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">ConcretePrototype1</span><span class="token punctuation">(</span>“Design Pattern"<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    c1 <span class="token operator">=</span> p1<span class="token punctuation">.</span><span class="token function">Clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"Cloned: {0}"</span><span class="token punctuation">,</span> c1<span class="token punctuation">.</span>Id<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Console<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="模式解析"><a href="#%E6%A8%A1%E5%BC%8F%E8%A7%A3%E6%9E%90" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式解析</h3>\n<ul>\n<li>对于.Net 而言，其他许多语言同理，原型抽象类 Prototype 是用不着的，因为克隆实在太常用了，所以.Net 在 System 命名空间中提供了 Icloneable 接口，其中就是一个唯一的方法 Clone()，这样，只用实现这个接口就可以完成原型模式了。</li>\n<li>另一方面，所有的 Java 类都继承自 java.lang.Object，而 Object 类提供一个 clone()方法，可以将一个 Java 对象复制一份。但是，这个 Java 类必须实现一个标识接口 Cloneable，标识这个 Java 类支持复制。</li>\n</ul>\n<p><strong>深克隆与浅克隆</strong></p>\n<p>接上例中的简历内容，给 Resume 添加一些新的内容</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="90308381023115640000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`public class IDInfo\n{\n    public int IdNumber;\n    public IDInfo(int IdNumber)\n    {\n        this.IdNumber = IdNumber;\n    }\n}\n//简历\nclass Resume : ICloneable\n{\n    private string name;\n    private string sex;\n    private string age;\n    private string timeArea;\n    private string company;\n    public IDInfo idinfo;\n\n    public Resume(string name)\n    {\n        this.name = name;\n        idinfo = new IDInfo(123456);\n    }\n    public void Display()\n    {\n        Console.WriteLine(&quot;尊敬的&quot; + AimCompany + &quot;公司领导，您好：&quot;);\n        Console.WriteLine(&quot;{0} {1} {2}&quot;, name, sex, age);\n        Console.WriteLine(&quot;工作经历：{0} {1}&quot;, timeArea, company);\n        Console.WriteLine(&quot;ID号码:&quot; + idinfo.IdNumber.ToString());\n        Console.WriteLine(&quot;&quot;);\n    }\n}\nstatic void Main(string[] args)\n{\n    Resume a = new Resume(“张三&quot;);\n    a.SetPersonalInfo(&quot;男&quot;, &quot;22&quot;);\n    a.SetWorkExperience(&quot;1998-2000&quot;, “XX 公司&quot;);\n    a.SetAimCompany(&quot;Google&quot;);\n\n    Resume b = (Resume)a.Clone();\n\n    a.Display();\n    b.Display();\n\n    b.SetAimCompany(“Baidu&quot;);\n    b.idinfo.IdNumber = 56789;\n\n    a.Display();\n    b.Display();\n\n    Console.Read();\n}`, `90308381023115640000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="cpp"\n              >\n                <span class="gatsby-code-button-language">cpp</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">IDInfo</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token keyword">int</span> IdNumber<span class="token punctuation">;</span>\n    <span class="token keyword">public</span> <span class="token function">IDInfo</span><span class="token punctuation">(</span><span class="token keyword">int</span> IdNumber<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>IdNumber <span class="token operator">=</span> IdNumber<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token comment">//简历</span>\n<span class="token keyword">class</span> <span class="token class-name">Resume</span> <span class="token operator">:</span> ICloneable\n<span class="token punctuation">{</span>\n    <span class="token keyword">private</span> string name<span class="token punctuation">;</span>\n    <span class="token keyword">private</span> string sex<span class="token punctuation">;</span>\n    <span class="token keyword">private</span> string age<span class="token punctuation">;</span>\n    <span class="token keyword">private</span> string timeArea<span class="token punctuation">;</span>\n    <span class="token keyword">private</span> string company<span class="token punctuation">;</span>\n    <span class="token keyword">public</span> IDInfo idinfo<span class="token punctuation">;</span>\n\n    <span class="token keyword">public</span> <span class="token function">Resume</span><span class="token punctuation">(</span>string name<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>\n        idinfo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">IDInfo</span><span class="token punctuation">(</span><span class="token number">123456</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Display</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"尊敬的"</span> <span class="token operator">+</span> AimCompany <span class="token operator">+</span> <span class="token string">"公司领导，您好："</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"{0} {1} {2}"</span><span class="token punctuation">,</span> name<span class="token punctuation">,</span> sex<span class="token punctuation">,</span> age<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"工作经历：{0} {1}"</span><span class="token punctuation">,</span> timeArea<span class="token punctuation">,</span> company<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"ID号码:"</span> <span class="token operator">+</span> idinfo<span class="token punctuation">.</span>IdNumber<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    Resume a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Resume</span><span class="token punctuation">(</span>“张三"<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    a<span class="token punctuation">.</span><span class="token function">SetPersonalInfo</span><span class="token punctuation">(</span><span class="token string">"男"</span><span class="token punctuation">,</span> <span class="token string">"22"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    a<span class="token punctuation">.</span><span class="token function">SetWorkExperience</span><span class="token punctuation">(</span><span class="token string">"1998-2000"</span><span class="token punctuation">,</span> “XX 公司"<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    a<span class="token punctuation">.</span><span class="token function">SetAimCompany</span><span class="token punctuation">(</span><span class="token string">"Google"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Resume b <span class="token operator">=</span> <span class="token punctuation">(</span>Resume<span class="token punctuation">)</span>a<span class="token punctuation">.</span><span class="token function">Clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    a<span class="token punctuation">.</span><span class="token function">Display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    b<span class="token punctuation">.</span><span class="token function">Display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    b<span class="token punctuation">.</span><span class="token function">SetAimCompany</span><span class="token punctuation">(</span>“Baidu"<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    b<span class="token punctuation">.</span>idinfo<span class="token punctuation">.</span>IdNumber <span class="token operator">=</span> <span class="token number">56789</span><span class="token punctuation">;</span>\n\n    a<span class="token punctuation">.</span><span class="token function">Display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    b<span class="token punctuation">.</span><span class="token function">Display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Console<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/微信截图_20180416130349-fb13c66a6fb9390d379d74395962898e-3f6d7.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 65.36180308422301%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABYUlEQVQoz5WRTU/CQBCGF0jbZRP6ZVvb3SKmEKlEEz2YmGgUI35gjAdO/grvXEyAEBJjokgQAxTl8+DNuz/OqTXqCeubOczM5tl3JoMmb53OqOHHuNF+qT8Maq3nerNfbXq1ple971fuehW/7FegA2VvdvP0eju+vnqvl9FFqehms7ncKmOUUmvRNDR9gRc4HBcw9kPAfJB8deKYEIxJvO21UL6wI8sKpcyyrEQiQQiJxWIohLreIzo82TN0w07asiyLokg+NYeJRCJBMpoO0FExz5idTjuMMVVV4QtBEMLAw4nnjy2KkmmagIEnkDzPh4WPzw5SqeVMJgM767quKErIsQPnXUVRYWZYGGwxxt/Pf8OF0zyjNlxJ0zSwlSQpGo2Gh/ctizqOYxgGkHCtf+y8tb0BGcdxv5/nCOYK+OHUQ+ubLmTQQeH04wx3Ll2e59bcFTedTFG2ZIYMmjSHs+4HE5ZVUtblyLkAAAAASUVORK5CYII=\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="     20180416130349" title="" data-src="/static/微信截图_20180416130349-fb13c66a6fb9390d379d74395962898e-fee1c.png" data-srcset="/static/微信截图_20180416130349-fb13c66a6fb9390d379d74395962898e-a67b7.png 200w,\n/static/微信截图_20180416130349-fb13c66a6fb9390d379d74395962898e-0b187.png 400w,\n/static/微信截图_20180416130349-fb13c66a6fb9390d379d74395962898e-fee1c.png 800w,\n/static/微信截图_20180416130349-fb13c66a6fb9390d379d74395962898e-3f6d7.png 843w" data-sizes="(max-width: 800px) 100vw, 800px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>结果错误！张三的 ID 也跟着变了！</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/微信截图_20180416131200-a7536eccc26505fe3ec17df0c141fdf1-9b502.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 73.14095449500554%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsSAAALEgHS3X78AAAD40lEQVQ4y0WU2U9bRxSH/WdV7UOjtsoeVVEf+tKXqm9VpSqKUhkogcRAgACmYGNsJywui5drGxvvBtsBgw1egoES4svFmD1hMZtTJa3y9cY8dKTRzDn6nW/OzDkahbR3hrhVYm33HHHnjPzOKdLuqWyfsl96R7lc5tM4vnhf8a3tnCDuniHtXVxqZVvaP2f/6Ix///mAwtyfYMK7gt0UwjUSY9q7xKR3GedwGrM1wfb+mwowHMtjG0wSkbU+S1ze+4mNLxIaX8Y+OIfgTnIuH64I9E0w2dCP05XC507h8S8R6nLgbTJhCS6xsblzCczuEm63ElRbcXkX8I4l8fgWiTYN4tK4ECYWOCqdolh1TSDVqZgvnJDJHzC3XWbdYELs1hNYOURaL8LHj0SlM4q9/bzSGEnKmox4wHzxlO3GVpYdfjzZIoeHxyieZK3oMk4ask45iw26FqN0pK1oXjqpitpYXStUMmxOB1FnhMpsTnuYXNiiJeelOyXw9KWd2oCFk6NzFJ9NK/luTs3nESXjiTW+n+riy4kabs028YWzhtfiJfBuTM3VWRU3Ek1cDzfgTW3wVaSOW7FGrkzXckdQUT7+G0W1r5eesS7uRy0IL0Qez4Rp8fbQPq7l53ELheLlG1bHArS5NLTJfmXEhSMuUR13o5Nj63x6lON2Lk7fofD3hliq0+Ka3cM3t4krc0j6D4FEiwmtv3BZlI/Q/2KHZMso82ozY+kD/LLWPfeGVyojgV4/hsBrTk7konQqA5ieRNG2T+HJ7TIwnEP/MEyfKkLD00nEze1KhppnKXQ1QZ49DGEwzuFZ2kOvSfC8PiT7Q7TqIpTOz+QrX3uO6qqRR784ELLb6HQpar8xUH/VQNVvY0jbuxVgZ+cM1bdNVF3rp70xjHNxj47aCWpuD1J1fYDGNh+l8gWKDhmgbotjtGWxzm5hCubpkX3t7XGa/0wiFrYqwO7AGo4aM5YHA2h9qwxHJfS+PKH7fRjrBFptKUqlExR6IY3LHKE2VKBz4S1dyR2G7AlGhVmahUXyUrEC7PGLBAwOgv0OeoMSz2SoMSAyox/BNhSmzZbm+BNwUOth+l493zpXuRte52agwJDKgPdRDw8t/wOr3Xl+Tb6lNXfIY88qOtdf3PNIKLNHNKXe8PtIktKxDKw25XgiB7bYV/jJs8GD0QVazDnqLSs0D89T3LpsG1W0yBWnyE3PGj8Ov6TDtswPdpEbvnW+Fl6hHJnmfVlu7EH3LJ3yp9A9GkM7NIlGXrvMU3SPRJmMZzg+OqoA16VN1P4MddZpnlun0Ntn6BPiPHKnabO/IJvO8eHDe/4D63e1u8scorAAAAAASUVORK5CYII=\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="     20180416131200" title="" data-src="/static/微信截图_20180416131200-a7536eccc26505fe3ec17df0c141fdf1-fee1c.png" data-srcset="/static/微信截图_20180416131200-a7536eccc26505fe3ec17df0c141fdf1-a67b7.png 200w,\n/static/微信截图_20180416131200-a7536eccc26505fe3ec17df0c141fdf1-0b187.png 400w,\n/static/微信截图_20180416131200-a7536eccc26505fe3ec17df0c141fdf1-fee1c.png 800w,\n/static/微信截图_20180416131200-a7536eccc26505fe3ec17df0c141fdf1-9b502.png 901w" data-sizes="(max-width: 800px) 100vw, 800px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<ul>\n<li>在浅克隆中，被复制对象的所有变量都具有与原来的对象相同的值，而所有对其它对象的引用仍然指向原来的对象。换言之，浅克隆仅仅复制所考虑的对象，而不复制它所引用的对象，也就是说其中的成员对象并不复制。在浅克隆中，当对象被复制时它所包含的成员对象却没有被复制。</li>\n<li>在深克隆中，对象在复制的同时其成员对象也将复制。</li>\n</ul>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="6216695920861026000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 将代码加入Resume类中\npublic Object DeepClone()\n{\n    Resume rsm = (Resume)this.MemberwiseClone();\n    rsm.idinfo = new IDInfo(this.idinfo.IdNumber);\n    return rsm;\n}\n// 调用\nResume b = (Resume)a.DeepClone();`, `6216695920861026000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="cpp"\n              >\n                <span class="gatsby-code-button-language">cpp</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token comment">// 将代码加入Resume类中</span>\n<span class="token keyword">public</span> Object <span class="token function">DeepClone</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    Resume rsm <span class="token operator">=</span> <span class="token punctuation">(</span>Resume<span class="token punctuation">)</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">MemberwiseClone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    rsm<span class="token punctuation">.</span>idinfo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">IDInfo</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>idinfo<span class="token punctuation">.</span>IdNumber<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">return</span> rsm<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n<span class="token comment">// 调用</span>\nResume b <span class="token operator">=</span> <span class="token punctuation">(</span>Resume<span class="token punctuation">)</span>a<span class="token punctuation">.</span><span class="token function">DeepClone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="优缺点-3"><a href="#%E4%BC%98%E7%BC%BA%E7%82%B9-3" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>优缺点</h3>\n<ul>\n<li>\n<p>优点</p>\n<ul>\n<li>当创建新的对象实例较为复杂时，使用原型模式可以简化的对象的创建过程，通过复制一个已有实例可以提高新实例的创建效率。</li>\n<li>原型模式允许动态增加或减少产品类。</li>\n<li>原型模式具有给一个应用软件动态加载新功能的能力。</li>\n<li>产品类不需要非得有任何事先确定的等级结构 。</li>\n</ul>\n</li>\n<li>\n<p>缺点</p>\n<ul>\n<li>原型模式的最主要缺点就是每一个类必须配备一个克隆方法。而且这个克隆方法需要对类的功能进行通盘考虑，这对全新的类来说不是很难，但对已有的类进行改造时，不一定是件容易的事。</li>\n<li>原型模式的另一个缺点是在实现深克隆时需要编写较为复杂的代码。</li>\n</ul>\n</li>\n</ul>\n<h3 id="模式使用-3"><a href="#%E6%A8%A1%E5%BC%8F%E4%BD%BF%E7%94%A8-3" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式使用</h3>\n<ul>\n<li>创建新对象成本较大(CPU，初始化)。</li>\n<li>系统要保存对象的状态，对象状态变化很小。</li>\n<li>当一个类的实例只有几个不同状态组合时，建立相应数目的原型并克隆它们可能比每次用合适的状态手工实例化更为方便。</li>\n</ul>\n<h3 id="模式应用-2"><a href="#%E6%A8%A1%E5%BC%8F%E5%BA%94%E7%94%A8-2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式应用</h3>\n<p>原型模式在很多软件都可以找到它的应用，如果实例化一个类要花大量时间，原型模式是最好的解决方案。很多软件提供的复制、粘贴功能都是原型模式的应用。类型相同，但内存地址不同的对象。</p>',
id:"/home/runner/work/GatsbyBlog/GatsbyBlog/blog/设计模式之创建型模式/index.md absPath of file >>> MarkdownRemark",timeToRead:21,frontmatter:{date:"2018-04-19 00:03:47",path:"/design-pattern-construction/",tags:"面试, 设计模式, 读书笔记",title:"设计模式之创建型模式",draft:null}},{excerpt:"一、可读性的重要性 编程有很大一部分时间是在阅读代码，不仅要阅读自己的代码，而且要阅读别人的代码。因此，可读性良好的代码能够大大提高编程效率。 可读性良好的代码往往会让代码架构更好，因为程序员更愿意去修改这部分代码，而且也更容易修改。 只有在核心领域为了效率才可以放弃可读性，否则可读性是第一位。 二、用名字表达代码含义 一些比较有表达力的单词： 单词 可替代单词 send deliver、dispatch、announce、distribute、route find search、extract…",html:'<h1 id="一、可读性的重要性"><a href="#%E4%B8%80%E3%80%81%E5%8F%AF%E8%AF%BB%E6%80%A7%E7%9A%84%E9%87%8D%E8%A6%81%E6%80%A7" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>一、可读性的重要性</h1>\n<p>编程有很大一部分时间是在阅读代码，不仅要阅读自己的代码，而且要阅读别人的代码。因此，可读性良好的代码能够大大提高编程效率。</p>\n<p>可读性良好的代码往往会让代码架构更好，因为程序员更愿意去修改这部分代码，而且也更容易修改。</p>\n<p>只有在核心领域为了效率才可以放弃可读性，否则可读性是第一位。</p>\n<h1 id="二、用名字表达代码含义"><a href="#%E4%BA%8C%E3%80%81%E7%94%A8%E5%90%8D%E5%AD%97%E8%A1%A8%E8%BE%BE%E4%BB%A3%E7%A0%81%E5%90%AB%E4%B9%89" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>二、用名字表达代码含义</h1>\n<p>一些比较有表达力的单词：</p>\n<table>\n<thead>\n<tr>\n<th>单词</th>\n<th>可替代单词</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>send</td>\n<td>deliver、dispatch、announce、distribute、route</td>\n</tr>\n<tr>\n<td>find</td>\n<td>search、extract、locate、recover</td>\n</tr>\n<tr>\n<td>start</td>\n<td>launch、create、begin、open</td>\n</tr>\n<tr>\n<td>make</td>\n<td>create、set up、build、generate、compose、add、new</td>\n</tr>\n</tbody>\n</table>\n<p>使用 i、j、k 作为循环迭代器的名字过于简单，user<em>i、member</em>i 这种名字会更有表达力。因为循环层次越多，代码越难理解，有表达力的迭代器名字可读性会更高</p>\n<p>为名字添加形容词等信息能让名字更具有表达力，但是名字也会变长。名字长短的准则是：作用域越大，名字越长。因此只有在短作用域才能使用一些简单名字。</p>\n<h1 id="三、名字不能带来歧义"><a href="#%E4%B8%89%E3%80%81%E5%90%8D%E5%AD%97%E4%B8%8D%E8%83%BD%E5%B8%A6%E6%9D%A5%E6%AD%A7%E4%B9%89" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>三、名字不能带来歧义</h1>\n<p>起完名字要思考一下别人会对这个名字有何解读，会不会误解了原本想表达的含义。</p>\n<p>用 min、max 表示数量范围；用 first、last 表示访问空间的包含范围，begin、end 表示访问空间的排除范围，即 end 不包含尾部。</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/05907ab4-42c5-4b5e-9388-6617f6c97bea-8611d2647f8479381ff27c0a99fe0721-a66ac.jpg" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 322px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 91.92546583850931%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAASABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAIDBAX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAH0p1k6GY2sJB//xAAbEAACAwADAAAAAAAAAAAAAAAAAgEDEhETQf/aAAgBAQABBQKbst3iNqGmzXNosuekH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8BH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8BH//EABoQAAEFAQAAAAAAAAAAAAAAAAABECExoSD/2gAIAQEABj8CWNK1oKXn/8QAHBABAQEBAAIDAAAAAAAAAAAAAREAIRBBcZHx/9oACAEBAAE/IYLruNI+mVmTs1UDPg35hknT7wFsL4AHCb//2gAMAwEAAgADAAAAEEDIPP/EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8QH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8QH//EAB4QAQADAAICAwAAAAAAAAAAAAEAESExQRCBUWHR/9oACAEBAAE/EMqacrK+oldOVC2517cDd4fsCrlxKK6h6D2xWqbRQGHMCC0NfFDAfAVP/9k=\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="05907ab4 42c5 4b5e 9388 6617f6c97bea" title="" data-src="/static/05907ab4-42c5-4b5e-9388-6617f6c97bea-8611d2647f8479381ff27c0a99fe0721-a66ac.jpg" data-srcset="/static/05907ab4-42c5-4b5e-9388-6617f6c97bea-8611d2647f8479381ff27c0a99fe0721-c635e.jpg 200w,\n/static/05907ab4-42c5-4b5e-9388-6617f6c97bea-8611d2647f8479381ff27c0a99fe0721-a66ac.jpg 322w" data-sizes="(max-width: 322px) 100vw, 322px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>布尔相关的命名加上 is、can、should、has 等前缀。</p>\n<h1 id="四、良好的代码风格"><a href="#%E5%9B%9B%E3%80%81%E8%89%AF%E5%A5%BD%E7%9A%84%E4%BB%A3%E7%A0%81%E9%A3%8E%E6%A0%BC" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>四、良好的代码风格</h1>\n<p>适当的空行和缩进。</p>\n<p>排列整齐的注释：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="53585552899710984000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`int a = 1;   // 注释\nint b = 11;  // 注释\nint c = 111; // 注释`, `53585552899710984000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="java"\n              >\n                <span class="gatsby-code-button-language">java</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="java"><pre style="counter-reset: linenumber NaN" class="language-java line-numbers"><code class="language-java"><span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>   <span class="token comment">// 注释</span>\n<span class="token keyword">int</span> b <span class="token operator">=</span> <span class="token number">11</span><span class="token punctuation">;</span>  <span class="token comment">// 注释</span>\n<span class="token keyword">int</span> c <span class="token operator">=</span> <span class="token number">111</span><span class="token punctuation">;</span> <span class="token comment">// 注释</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<p>语句顺序不能随意，比如与 html 表单相关联的变量的赋值应该和表单在 html 中的顺序一致；</p>\n<p>把相关的代码按块组织起来放在一起。</p>\n<h1 id="五、编写注释"><a href="#%E4%BA%94%E3%80%81%E7%BC%96%E5%86%99%E6%B3%A8%E9%87%8A" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>五、编写注释</h1>\n<p>阅读代码首先会注意到注释，如果注释没太大作用，那么就会浪费代码阅读的时间。那些能直接看出含义的代码不需要写注释，特别是并不需要为每个方法都加上注释，比如那些简单的 getter 和 setter 方法，为这些方法写注释反而让代码可读性更差。</p>\n<p>不能因为有注释就随便起个名字，而是争取起个好名字而不写注释。</p>\n<p>可以用注释来记录采用当前解决办法的思考过程，从而让读者更容易理解代码。</p>\n<p>注释用来提醒一些特殊情况。</p>\n<p>用 TODO 等做标记：</p>\n<table>\n<thead>\n<tr>\n<th>标记</th>\n<th>用法</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>TODO</td>\n<td>待做</td>\n</tr>\n<tr>\n<td>FIXME</td>\n<td>待修复</td>\n</tr>\n<tr>\n<td>HACH</td>\n<td>粗糙的解决方案</td>\n</tr>\n<tr>\n<td>XXX</td>\n<td>危险！这里有重要的问题</td>\n</tr>\n</tbody>\n</table>\n<h1 id="六、如何编写注释"><a href="#%E5%85%AD%E3%80%81%E5%A6%82%E4%BD%95%E7%BC%96%E5%86%99%E6%B3%A8%E9%87%8A" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>六、如何编写注释</h1>\n<p>尽量简洁明了：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="91373998539205250000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// The first String is student\'s name\n// The Second Integer is student\'s score\nMap<String, Integer> scoreMap = new HashMap<>();`, `91373998539205250000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="java"\n              >\n                <span class="gatsby-code-button-language">java</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="java"><pre style="counter-reset: linenumber NaN" class="language-java line-numbers"><code class="language-java"><span class="token comment">// The first String is student\'s name</span>\n<span class="token comment">// The Second Integer is student\'s score</span>\n<span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">></span></span> scoreMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="47894051289050360000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// Student\' name -> Student\'s score\nMap<String, Integer> scoreMap = new HashMap<>();`, `47894051289050360000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="java"\n              >\n                <span class="gatsby-code-button-language">java</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="java"><pre style="counter-reset: linenumber NaN" class="language-java line-numbers"><code class="language-java"><span class="token comment">// Student\' name -> Student\'s score</span>\n<span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">></span></span> scoreMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>\n<p>添加测试用例来说明：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="74795686368720340000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`//...\n// Example: add(1, 2), return 3\nint add(int x, int y) {\n    return x + y;\n}`, `74795686368720340000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="java"\n              >\n                <span class="gatsby-code-button-language">java</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="java"><pre style="counter-reset: linenumber NaN" class="language-java line-numbers"><code class="language-java"><span class="token comment">//...</span>\n<span class="token comment">// Example: add(1, 2), return 3</span>\n<span class="token keyword">int</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> y<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">return</span> x <span class="token operator">+</span> y<span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>在很复杂的函数调用中对每个参数标上名字：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="3137752359403278300"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`int a = 1;\nint b = 2;\nint num = add(\\* x = *\\ a, \\* y = *\\ b);`, `3137752359403278300`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="java"\n              >\n                <span class="gatsby-code-button-language">java</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="java"><pre style="counter-reset: linenumber NaN" class="language-java line-numbers"><code class="language-java"><span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>\n<span class="token keyword">int</span> b <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>\n<span class="token keyword">int</span> num <span class="token operator">=</span> <span class="token function">add</span><span class="token punctuation">(</span>\\<span class="token operator">*</span> x <span class="token operator">=</span> <span class="token operator">*</span>\\ a<span class="token punctuation">,</span> \\<span class="token operator">*</span> y <span class="token operator">=</span> <span class="token operator">*</span>\\ b<span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<p>使用专业名词来缩短概念上的解释，比如用设计模式名来说明代码。</p>\n<h1 id="七、提高控制流的可读性"><a href="#%E4%B8%83%E3%80%81%E6%8F%90%E9%AB%98%E6%8E%A7%E5%88%B6%E6%B5%81%E7%9A%84%E5%8F%AF%E8%AF%BB%E6%80%A7" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>七、提高控制流的可读性</h1>\n<p>条件表达式中，左侧是变量，右侧是常数。比如下面第一个语句正确：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="24377750663176530000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`if(len < 10)\nif(10 > len)`, `24377750663176530000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="java"\n              >\n                <span class="gatsby-code-button-language">java</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="java"><pre style="counter-reset: linenumber NaN" class="language-java line-numbers"><code class="language-java"><span class="token keyword">if</span><span class="token punctuation">(</span>len <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">)</span>\n<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token number">10</span> <span class="token operator">></span> len<span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>\n<p>if / else 条件语句，逻辑的处理顺序为：① 正逻辑；② 关键逻辑；③ 简单逻辑。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="3704984204996031500"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`if(a == b) {\n    // 正逻辑\n} else{\n    // 反逻辑\n}`, `3704984204996031500`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="java"\n              >\n                <span class="gatsby-code-button-language">java</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="java"><pre style="counter-reset: linenumber NaN" class="language-java line-numbers"><code class="language-java"><span class="token keyword">if</span><span class="token punctuation">(</span>a <span class="token operator">==</span> b<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 正逻辑</span>\n<span class="token punctuation">}</span> <span class="token keyword">else</span><span class="token punctuation">{</span>\n    <span class="token comment">// 反逻辑</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>只有在逻辑简单的情况下使用 ? : 三目运算符来使代码更紧凑，否则应该拆分成 if / else；</p>\n<p>do / while 的条件放在后面，不够简单明了，并且会有一些迷惑的地方，最好使用 while 来代替。</p>\n<p>如果只有一个 goto 目标，那么 goto 尚且还能接受，但是过于复杂的 goto 会让代码可读性特别差，应该避免使用 goto。</p>\n<p>在嵌套的循环中，用一些 return 语句往往能减少嵌套的层数。</p>\n<h1 id="八、拆分长表达式"><a href="#%E5%85%AB%E3%80%81%E6%8B%86%E5%88%86%E9%95%BF%E8%A1%A8%E8%BE%BE%E5%BC%8F" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>八、拆分长表达式</h1>\n<p>长表达式的可读性很差，可以引入一些解释变量从而拆分表达式：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="84969234939861390000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`if line.split(\':\')[0].strip() == &quot;root&quot;:\n    ...`, `84969234939861390000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="python"\n              >\n                <span class="gatsby-code-button-language">python</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="python"><pre style="counter-reset: linenumber NaN" class="language-python line-numbers"><code class="language-python"><span class="token keyword">if</span> line<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">\':\'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">"root"</span><span class="token punctuation">:</span>\n    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="95808567210006970000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`username = line.split(\':\')[0].strip()\nif username == &quot;root&quot;:\n    ...`, `95808567210006970000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="python"\n              >\n                <span class="gatsby-code-button-language">python</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="python"><pre style="counter-reset: linenumber NaN" class="language-python line-numbers"><code class="language-python">username <span class="token operator">=</span> line<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">\':\'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>\n<span class="token keyword">if</span> username <span class="token operator">==</span> <span class="token string">"root"</span><span class="token punctuation">:</span>\n    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<p>使用摩根定理简化一些逻辑表达式：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="78546556175189560000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`if(!a && !b) {\n    ...\n}`, `78546556175189560000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="java"\n              >\n                <span class="gatsby-code-button-language">java</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="java"><pre style="counter-reset: linenumber NaN" class="language-java line-numbers"><code class="language-java"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>a <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>b<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="25707364419040756000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`if(!(a || b)) {\n    ...\n}`, `25707364419040756000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="java"\n              >\n                <span class="gatsby-code-button-language">java</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="java"><pre style="counter-reset: linenumber NaN" class="language-java line-numbers"><code class="language-java"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>a <span class="token operator">||</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<h1 id="九、变量与可读性"><a href="#%E4%B9%9D%E3%80%81%E5%8F%98%E9%87%8F%E4%B8%8E%E5%8F%AF%E8%AF%BB%E6%80%A7" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>九、变量与可读性</h1>\n<p><strong>去除控制流变量</strong> 。在循环中通过使用 break 或者 return 可以减少控制流变量的使用。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="54181419834823720000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`boolean done = false;\nwhile(/* condition */ && !done) {\n    ...\n    if(...) {\n        done = true;\n        continue;\n    }\n}`, `54181419834823720000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="java"\n              >\n                <span class="gatsby-code-button-language">java</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="java"><pre style="counter-reset: linenumber NaN" class="language-java line-numbers"><code class="language-java"><span class="token keyword">boolean</span> done <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>\n<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token comment">/* condition */</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>done<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\n    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        done <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>\n        <span class="token keyword">continue</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="98045685000771130000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`while(/* condition */) {\n    ...\n    if(...) {\n        break;\n    }\n}`, `98045685000771130000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="js"\n              >\n                <span class="gatsby-code-button-language">js</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="js"><pre style="counter-reset: linenumber NaN" class="language-js line-numbers"><code class="language-js"><span class="token keyword">while</span><span class="token punctuation">(</span><span class="token comment">/* condition */</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token operator">...</span>\n    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">break</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><strong>减小变量作用域</strong> 。作用域越小，越容易定位到变量所有使用的地方。</p>\n<p>JavaScript 可以用闭包减小作用域。以下代码中 submit_form 是函数变量，submitted 变量控制函数不会被提交两次。第一个实现中 submitted 是全局变量，第二个实现把 submitted 放到匿名函数中，从而限制了起作用域范围。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="62414035948408640000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`submitted = false;\nvar submit_form = function(form_name) {\n  if (submitted) {\n    return;\n  }\n  submitted = true;\n};`, `62414035948408640000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="js"\n              >\n                <span class="gatsby-code-button-language">js</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="js"><pre style="counter-reset: linenumber NaN" class="language-js line-numbers"><code class="language-js">submitted <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>\n<span class="token keyword">var</span> <span class="token function-variable function">submit_form</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">form_name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">if</span> <span class="token punctuation">(</span>submitted<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">return</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n  submitted <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="62550115988555310000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`var submit_form = (function() {\n  var submitted = false;\n  return function(form_name) {\n    if (submitted) {\n      return;\n    }\n    submitted = true;\n  };\n})(); // () 使得外层匿名函数立即执行`, `62550115988555310000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="js"\n              >\n                <span class="gatsby-code-button-language">js</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="js"><pre style="counter-reset: linenumber NaN" class="language-js line-numbers"><code class="language-js"><span class="token keyword">var</span> submit_form <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">var</span> submitted <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>\n  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">form_name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span>submitted<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">return</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    submitted <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// () 使得外层匿名函数立即执行</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>JavaScript 中没有用 var 声明的变量都是全局变量，而全局变量很容易造成迷惑，因此应当总是用 var 来声明变量。</p>\n<p>变量定义的位置应当离它使用的位置最近。</p>\n<p><strong>实例解析</strong></p>\n<p>在一个网页中有以下文本输入字段：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="96657241135152270000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`<input type=&quot;text&quot; id=&quot;input1&quot; value=&quot;a&quot; />\n<input type=&quot;text&quot; id=&quot;input2&quot; value=&quot;b&quot; />\n<input type=&quot;text&quot; id=&quot;input3&quot; value=&quot;&quot; />\n<input type=&quot;text&quot; id=&quot;input4&quot; value=&quot;d&quot; />`, `96657241135152270000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="html"\n              >\n                <span class="gatsby-code-button-language">html</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="html"><pre style="counter-reset: linenumber NaN" class="language-html line-numbers"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>input1<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>a<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>input2<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>b<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>input3<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>input4<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>d<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>现在要接受一个字符串并把它放到第一个空的 input 字段中，初始实现如下：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="51175689090850505000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`var setFirstEmptyInput = function(new_alue) {\n  var found = false;\n  var i = 1;\n  var elem = document.getElementById(\'input\' + i);\n  while (elem != null) {\n    if (elem.value === \'\') {\n      found = true;\n      break;\n    }\n    i++;\n    elem = document.getElementById(\'input\' + i);\n  }\n  if (found) elem.value = new_value;\n  return elem;\n};`, `51175689090850505000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="js"\n              >\n                <span class="gatsby-code-button-language">js</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="js"><pre style="counter-reset: linenumber NaN" class="language-js line-numbers"><code class="language-js"><span class="token keyword">var</span> <span class="token function-variable function">setFirstEmptyInput</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">new_alue</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">var</span> found <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>\n  <span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>\n  <span class="token keyword">var</span> elem <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">\'input\'</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">while</span> <span class="token punctuation">(</span>elem <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span>elem<span class="token punctuation">.</span>value <span class="token operator">===</span> <span class="token string">\'\'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      found <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>\n      <span class="token keyword">break</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    i<span class="token operator">++</span><span class="token punctuation">;</span>\n    elem <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">\'input\'</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n  <span class="token keyword">if</span> <span class="token punctuation">(</span>found<span class="token punctuation">)</span> elem<span class="token punctuation">.</span>value <span class="token operator">=</span> new_value<span class="token punctuation">;</span>\n  <span class="token keyword">return</span> elem<span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>以上实现有以下问题：</p>\n<ul>\n<li>found 可以去除；</li>\n<li>elem 作用域过大；</li>\n<li>可以用 for 循环代替 while 循环；</li>\n</ul>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="38815333502380840000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`var setFirstEmptyInput = function(new_value) {\n  for (var i = 1; true; i++) {\n    var elem = document.getElementById(\'input\' + i);\n    if (elem === null) {\n      return null;\n    }\n    if (elem.value === \'\') {\n      elem.value = new_value;\n      return elem;\n    }\n  }\n};`, `38815333502380840000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="js"\n              >\n                <span class="gatsby-code-button-language">js</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="js"><pre style="counter-reset: linenumber NaN" class="language-js line-numbers"><code class="language-js"><span class="token keyword">var</span> <span class="token function-variable function">setFirstEmptyInput</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">new_value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token boolean">true</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">var</span> elem <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">\'input\'</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span>elem <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span>elem<span class="token punctuation">.</span>value <span class="token operator">===</span> <span class="token string">\'\'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      elem<span class="token punctuation">.</span>value <span class="token operator">=</span> new_value<span class="token punctuation">;</span>\n      <span class="token keyword">return</span> elem<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h1 id="十、抽取函数"><a href="#%E5%8D%81%E3%80%81%E6%8A%BD%E5%8F%96%E5%87%BD%E6%95%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>十、抽取函数</h1>\n<p>工程学就是把大问题拆分成小问题再把这些问题的解决方案放回一起。</p>\n<p>首先应该明确一个函数的高层次目标，然后对于不是直接为了这个目标工作的代码，抽取出来放到独立的函数中。</p>\n<p>介绍性的代码：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="36727612986759970000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`int findClostElement(int[] arr) {\n    int clostIdx;\n    int clostDist = Interger.MAX_VALUE;\n    for(int i = 0; i < arr.length; i++) {\n        int x = ...;\n        int y = ...;\n        int z = ...;\n        int value = x * y * z;\n        int dist = Math.sqrt(Math.pow(value, 2), Math.pow(arr[i], 2));\n        if(dist < clostDist) {\n            clostIdx = i;\n            clostDist = value;\n        }\n    }\n    return clostIdx;\n}`, `36727612986759970000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="java"\n              >\n                <span class="gatsby-code-button-language">java</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="java"><pre style="counter-reset: linenumber NaN" class="language-java line-numbers"><code class="language-java"><span class="token keyword">int</span> <span class="token function">findClostElement</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arr<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">int</span> clostIdx<span class="token punctuation">;</span>\n    <span class="token keyword">int</span> clostDist <span class="token operator">=</span> <span class="token class-name">Interger</span><span class="token punctuation">.</span>MAX_VALUE<span class="token punctuation">;</span>\n    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">int</span> x <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">;</span>\n        <span class="token keyword">int</span> y <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">;</span>\n        <span class="token keyword">int</span> z <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">;</span>\n        <span class="token keyword">int</span> value <span class="token operator">=</span> x <span class="token operator">*</span> y <span class="token operator">*</span> z<span class="token punctuation">;</span>\n        <span class="token keyword">int</span> dist <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">pow</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">pow</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">if</span><span class="token punctuation">(</span>dist <span class="token operator">&lt;</span> clostDist<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n            clostIdx <span class="token operator">=</span> i<span class="token punctuation">;</span>\n            clostDist <span class="token operator">=</span> value<span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">return</span> clostIdx<span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>以上代码中循环部分主要计算距离，这部分不属于代码高层次目标，高层次目标是寻找最小距离的值，因此可以把这部分代替提取到独立的函数中。这样做也带来一个额外的好处有：可以单独进行测试、可以快速找到程序错误并修改。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="57116635806366990000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`public int findClostElement(int[] arr) {\n    int clostIdx;\n    int clostDist = Interger.MAX_VALUE;\n    for(int i = 0; i < arr.length; i++) {\n        int dist = computDist(arr, i);\n        if(dist < clostDist) {\n            clostIdx = i;\n            clostDist = value;\n        }\n    }\n    return clostIdx;\n}`, `57116635806366990000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="java"\n              >\n                <span class="gatsby-code-button-language">java</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="java"><pre style="counter-reset: linenumber NaN" class="language-java line-numbers"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">findClostElement</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arr<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">int</span> clostIdx<span class="token punctuation">;</span>\n    <span class="token keyword">int</span> clostDist <span class="token operator">=</span> <span class="token class-name">Interger</span><span class="token punctuation">.</span>MAX_VALUE<span class="token punctuation">;</span>\n    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">int</span> dist <span class="token operator">=</span> <span class="token function">computDist</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">if</span><span class="token punctuation">(</span>dist <span class="token operator">&lt;</span> clostDist<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n            clostIdx <span class="token operator">=</span> i<span class="token punctuation">;</span>\n            clostDist <span class="token operator">=</span> value<span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">return</span> clostIdx<span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>并不是函数抽取的越多越好，如果抽取过多，在阅读代码的时候可能需要不断跳来跳去。只有在当前函数不需要去了解某一块代码细节而能够表达其内容时，把这块代码抽取成子函数才是好的。</p>\n<p>函数抽取也用于减小代码的冗余。</p>\n<h1 id="十一、一次只做一件事"><a href="#%E5%8D%81%E4%B8%80%E3%80%81%E4%B8%80%E6%AC%A1%E5%8F%AA%E5%81%9A%E4%B8%80%E4%BB%B6%E4%BA%8B" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>十一、一次只做一件事</h1>\n<p>只做一件事的代码很容易让人知道其要做的事；</p>\n<p>基本流程：列出代码所做的所有任务；把每个任务拆分到不同的函数，或者不同的段落。</p>\n<h1 id="十二、用自然语言表述代码"><a href="#%E5%8D%81%E4%BA%8C%E3%80%81%E7%94%A8%E8%87%AA%E7%84%B6%E8%AF%AD%E8%A8%80%E8%A1%A8%E8%BF%B0%E4%BB%A3%E7%A0%81" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>十二、用自然语言表述代码</h1>\n<p>先用自然语言书写代码逻辑，也就是伪代码，然后再写代码，这样代码逻辑会更清晰。</p>\n<h1 id="十三、减少代码量"><a href="#%E5%8D%81%E4%B8%89%E3%80%81%E5%87%8F%E5%B0%91%E4%BB%A3%E7%A0%81%E9%87%8F" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>十三、减少代码量</h1>\n<p>不要过度设计，编码过程会有很多变化，过度设计的内容到最后往往是无用的。</p>\n<p>多用标准库实现。</p>\n<h1 id="参考资料"><a href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>参考资料</h1>\n<ul>\n<li>Dustin, Boswell, Trevor, 等. 编写可读代码的艺术 [M]. 机械工业出版社, 2012.</li>\n</ul>',
id:"/home/runner/work/GatsbyBlog/GatsbyBlog/blog/代码可读性/index.md absPath of file >>> MarkdownRemark",timeToRead:6,frontmatter:{date:"2018-04-04 13:26:44",path:"/code-readability/",tags:"面试, 编码实践, 代码可读性, 读书笔记",title:"代码可读性",draft:null}},{excerpt:"第一个案例 如果你发现自己需要为程序添加一个特性，而代码结构使你无法很方便地达成目的，那就先重构这个程序。 在重构前，需要先构建好可靠的测试环境，确保安全地重构。 重构需要以微小的步伐修改程序，如果重构过程发生错误，很容易就能发现错误。 案例分析 影片出租店应用程序，需要计算每位顾客的消费金额。 包括三个类：Movie、Rental 和 Customer，Rental 包含租赁的 Movie 以及天数。 最开始的实现是把所有的计费代码都放在 Customer…",html:'<h1 id="第一个案例"><a href="#%E7%AC%AC%E4%B8%80%E4%B8%AA%E6%A1%88%E4%BE%8B" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>第一个案例</h1>\n<p>如果你发现自己需要为程序添加一个特性，而代码结构使你无法很方便地达成目的，那就先重构这个程序。</p>\n<p>在重构前，需要先构建好可靠的测试环境，确保安全地重构。</p>\n<p>重构需要以微小的步伐修改程序，如果重构过程发生错误，很容易就能发现错误。</p>\n<p><strong>案例分析</strong></p>\n<p>影片出租店应用程序，需要计算每位顾客的消费金额。</p>\n<p>包括三个类：Movie、Rental 和 Customer，Rental 包含租赁的 Movie 以及天数。</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/25d6d3d4-4726-47b1-a9cb-3316d1ff5dd5-0320504d5fb9acd75b3120f351d94f3e-c865f.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 719px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 27.677329624478443%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsSAAALEgHS3X78AAAAqElEQVQY06WQuw6EIBBF+f//s7DygQ+UoIiFkRXWE0mIzVY7BZm598wjiO8fIUIInyeu6+KNMSYjldlKIrD3PltiXVelVFmWTdNM07QsC96+71rrtm2LokAEOM/zOA7EYRgQpZTzPAtjTFVVdV1DjOOICgfErKQDkTjntm3r+54SDIChgiXWWjwS1jKe87iNi9wTuLSlm+npuo4R7AcWqPEV+TN+ie/8BvsBWAUx/UmyAAAAAElFTkSuQmCC\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="25d6d3d4 4726 47b1 a9cb 3316d1ff5dd5" title="" data-src="/static/25d6d3d4-4726-47b1-a9cb-3316d1ff5dd5-0320504d5fb9acd75b3120f351d94f3e-c865f.png" data-srcset="/static/25d6d3d4-4726-47b1-a9cb-3316d1ff5dd5-0320504d5fb9acd75b3120f351d94f3e-d82b3.png 200w,\n/static/25d6d3d4-4726-47b1-a9cb-3316d1ff5dd5-0320504d5fb9acd75b3120f351d94f3e-d61d8.png 400w,\n/static/25d6d3d4-4726-47b1-a9cb-3316d1ff5dd5-0320504d5fb9acd75b3120f351d94f3e-c865f.png 719w" data-sizes="(max-width: 719px) 100vw, 719px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>最开始的实现是把所有的计费代码都放在 Customer 类中。</p>\n<p>可以发现，该代码没有使用 Customer 类中的任何信息，更多的是使用 Rental 类的信息，因此第一个可以重构的点就是把具体计费的代码移到 Rental 类中，然后 Customer 类的 getTotalCharge() 方法只需要调用 Rental 类中的计费方法即可。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="11871259993397643000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class Customer...\ndouble getTotalCharge() {\n    while (rentals.hasMoreElements()) {\n    double thisAmount = 0;\n    Rental each = (Rental) rentals.nextElement();\n    switch (each.getMovie().getPriceCode()) {\n        case Movie.REGULAR:\n            thisAmount += 2;\n            if (each.getDaysRented() > 2)\n                thisAmount += (each.getDaysRented() - 2) * 1.5;\n            break;\n        case Movie.NEW_RELEASE:\n            thisAmount += each.getDaysRented() * 3;\n            break;\n        case Movie.CHILDRENS:\n            thisAmount += 1.5;\n            if (each.getDaysRented() > 3)\n                thisAmount += (each.getDaysRented() - 3) * 1.5;\n            break;\n    }\n}`, `11871259993397643000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="java"\n              >\n                <span class="gatsby-code-button-language">java</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="java"><pre style="counter-reset: linenumber NaN" class="language-java line-numbers"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Customer</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\n<span class="token keyword">double</span> <span class="token function">getTotalCharge</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">while</span> <span class="token punctuation">(</span>rentals<span class="token punctuation">.</span><span class="token function">hasMoreElements</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">double</span> thisAmount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>\n    <span class="token class-name">Rental</span> each <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Rental</span><span class="token punctuation">)</span> rentals<span class="token punctuation">.</span><span class="token function">nextElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">switch</span> <span class="token punctuation">(</span>each<span class="token punctuation">.</span><span class="token function">getMovie</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPriceCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">case</span> <span class="token class-name">Movie</span><span class="token punctuation">.</span>REGULAR<span class="token operator">:</span>\n            thisAmount <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>\n            <span class="token keyword">if</span> <span class="token punctuation">(</span>each<span class="token punctuation">.</span><span class="token function">getDaysRented</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">2</span><span class="token punctuation">)</span>\n                thisAmount <span class="token operator">+=</span> <span class="token punctuation">(</span>each<span class="token punctuation">.</span><span class="token function">getDaysRented</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">1.5</span><span class="token punctuation">;</span>\n            <span class="token keyword">break</span><span class="token punctuation">;</span>\n        <span class="token keyword">case</span> <span class="token class-name">Movie</span><span class="token punctuation">.</span>NEW_RELEASE<span class="token operator">:</span>\n            thisAmount <span class="token operator">+=</span> each<span class="token punctuation">.</span><span class="token function">getDaysRented</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">;</span>\n            <span class="token keyword">break</span><span class="token punctuation">;</span>\n        <span class="token keyword">case</span> <span class="token class-name">Movie</span><span class="token punctuation">.</span>CHILDRENS<span class="token operator">:</span>\n            thisAmount <span class="token operator">+=</span> <span class="token number">1.5</span><span class="token punctuation">;</span>\n            <span class="token keyword">if</span> <span class="token punctuation">(</span>each<span class="token punctuation">.</span><span class="token function">getDaysRented</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">3</span><span class="token punctuation">)</span>\n                thisAmount <span class="token operator">+=</span> <span class="token punctuation">(</span>each<span class="token punctuation">.</span><span class="token function">getDaysRented</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">1.5</span><span class="token punctuation">;</span>\n            <span class="token keyword">break</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>使用 switch 的准则是：只能在对象自己的数据上使用，而不能在另一个对象的数据基础上使用。解释如下：switch 使用的数据通常是一组相关的数据，例如上面的代码使用了 Movie 的多种类别数据。当这组类别的数据发生改变时，例如上面的代码中增加 Movie 的类别或者修改一种 Movie 类别的计费方法，就需要修改 switch 代码。如果允许违反了准则，就会有多个地方的 switch 使用了这部分的数据，那么需要打开所有的 switch 代码进行修改。</p>\n<p>以下是继承 Movie 的多态解决方案，这种方案可以解决上述的 switch 问题，因为每种电影类别的计费方式都被放到了对应 Movie 子类中，当变化发生时，只需要去修改对应子类中的代码即可。</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/76b48b4c-8999-4967-893b-832602e73285-6e0444db67f693aaac703a7346d16a18-565e4.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 669px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 40.20926756352765%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsSAAALEgHS3X78AAAA3klEQVQY022Q5w6DMAyE8/7PyBAQRhkizIbdr0lVFYp/RLmzzz5bHHexLMs4jk3TKKWGYQDelokL3vedt23bNE09z4uiqK5rWnxT9r2Kf9lpmuI4dl03yzIaaa3/B5zE67riELdd1/V9P89znueMhQFC2izvafK2bWVZBkHg+z6CpwkmYzsMQ/wDmVYUBVs4jiOl5I/qLWYIrDRBKRtilT96ePRASpMkgYGHgWc1YTcE0wyT2FMm6IILICRnR4ySmqqqMIJTDvGx/TBBwp6HtGVsIyBlZLkfMjrSjhu9AKnsyTzCu4xmAAAAAElFTkSuQmCC\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="76b48b4c 8999 4967 893b 832602e73285" title="" data-src="/static/76b48b4c-8999-4967-893b-832602e73285-6e0444db67f693aaac703a7346d16a18-565e4.png" data-srcset="/static/76b48b4c-8999-4967-893b-832602e73285-6e0444db67f693aaac703a7346d16a18-e3cbb.png 200w,\n/static/76b48b4c-8999-4967-893b-832602e73285-6e0444db67f693aaac703a7346d16a18-b1707.png 400w,\n/static/76b48b4c-8999-4967-893b-832602e73285-6e0444db67f693aaac703a7346d16a18-565e4.png 669w" data-sizes="(max-width: 669px) 100vw, 669px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>但是由于 Movie 可以在其生命周期内修改自己的类别，一个对象却不能在生命周期内修改自己所属的类，因此这种方案不可行。可以使用策略模式来解决这个问题（原书写的是使用状态模式，但是这里应该为策略模式，具体可以参考设计模式内容）。</p>\n<p>下图中，Price 有多种实现，Movie 组合了一个 Price 对象，并且在运行时可以改变组合的 Price 对象，从而使得它的计费方式发生改变。</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/2a842a14-e4ab-4f37-83fa-f82c206fe426-ee862f7de0c96815818d521dee4fe279-c3000.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 775px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 44.516129032258064%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsSAAALEgHS3X78AAAA9ElEQVQoz42RyQ6DMAxE+f8f5EYEiH2nkLC3T3alLoeqI4GC7RnPBO8uOM9z3/fjODjc/4bHA6eqqjAMoygqy3LbtkOwrus0TTfBsiy/yH3fM8qBUWutc66u6yAIfN/P85zudV3fZEpYpZ0kSdM0bdtqRYMMw4CdruvQYodGe5FpQ8uyjHccx0VRMGcF8zwrfxHwyZs6uZ5kTridBXjDKkIQCMwSIqhnaDhihgEWjONI11MNzUOJ/cYYrBIBCbwQmwoE1lA3AooIfZAJzJ2rMGcWosVmVNDCC1ppmlKni1/v/fZIqBGIrT9M4/AJU20z4ATc6APZ2QQ9nuBEhwAAAABJRU5ErkJggg==\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="2a842a14 e4ab 4f37 83fa f82c206fe426" title="" data-src="/static/2a842a14-e4ab-4f37-83fa-f82c206fe426-ee862f7de0c96815818d521dee4fe279-c3000.png" data-srcset="/static/2a842a14-e4ab-4f37-83fa-f82c206fe426-ee862f7de0c96815818d521dee4fe279-84db6.png 200w,\n/static/2a842a14-e4ab-4f37-83fa-f82c206fe426-ee862f7de0c96815818d521dee4fe279-07229.png 400w,\n/static/2a842a14-e4ab-4f37-83fa-f82c206fe426-ee862f7de0c96815818d521dee4fe279-c3000.png 775w" data-sizes="(max-width: 775px) 100vw, 775px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>重构后整体的类图和时序图如下：</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/9d549816-60b7-4899-9877-23b01503ab13-50b1824841a033ecd676b581c34156a1-d67a7.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 718px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 67.54874651810584%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAAsSAAALEgHS3X78AAABX0lEQVQoz33S2W7CUAwE0Pz/5/EAQqwK+76EELaWHmIEqI06DxdfxzMem5scj8fdbrdcLvf7vfj+ga8P3KuQzOfzdrtdr9fnJS6Xy/V6vd1utFar1Ww2m06nm83mfD5XkzudjvN0OinNskz/oijW63W32200Gr4uFgtfK8iHw4Ht0WgUNA5vJQQsLEu4hqM43+TvEoyFNrd5nlMhyipF0oK8RGRIPMnxo1RWkzRNGSakczgaj8fb7TYc6TEcDiUFRnt0RnYxtiyyaqvCHwwGaYl+v6+n6l6vF1dbnEwmTzJtHBK6sccC55FxpYUpQFAZI7DwtG3U6Gzh+EawGGQZTBKumodnc6lBec/8egnh5YXYaPUj4YeG8fipfAmfD64oYR0WTjHhiplmsymwBsOc/gBBNbceTK1Wi0clkxiy1WpFZyf/Uf0LTFFHU2Nt4gcZR0PrzUr8Y5sEmp76xT//A7fQICPaZW4KAAAAAElFTkSuQmCC\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="9d549816 60b7 4899 9877 23b01503ab13" title="" data-src="/static/9d549816-60b7-4899-9877-23b01503ab13-50b1824841a033ecd676b581c34156a1-d67a7.png" data-srcset="/static/9d549816-60b7-4899-9877-23b01503ab13-50b1824841a033ecd676b581c34156a1-8a0cc.png 200w,\n/static/9d549816-60b7-4899-9877-23b01503ab13-50b1824841a033ecd676b581c34156a1-ca50d.png 400w,\n/static/9d549816-60b7-4899-9877-23b01503ab13-50b1824841a033ecd676b581c34156a1-d67a7.png 718w" data-sizes="(max-width: 718px) 100vw, 718px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/2c8a7a87-1bf1-4d66-9ba9-225a1add0a51-b7305eaa662f33cb180e1eb3b6c5d6d0-b5415.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 33.8479809976247%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsSAAALEgHS3X78AAAAsUlEQVQY022Q2w7DIAxD+f8vRQw0bhW0FLqzMFVsmh9onMTGVO377r1/CqhLKbOOMZ7nWWsNIUA55zQIkLTWFC32tNbWWlYZU0BpMqbDHhTBnGJkjOF8i7dto4XFGOMSUPTerwVE+EtVzvkhSCk557BEeRwHsybAi3MV31QxwwmNF5AWC4LhZQS8gg53zNcSnpgf8fxwFRYzOWOCDAGUVWhcwEu/xOsjqfkLa86fX3DTF8qllktK7HibAAAAAElFTkSuQmCC\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="2c8a7a87 1bf1 4d66 9ba9 225a1add0a51" title="" data-src="/static/2c8a7a87-1bf1-4d66-9ba9-225a1add0a51-b7305eaa662f33cb180e1eb3b6c5d6d0-fee1c.png" data-srcset="/static/2c8a7a87-1bf1-4d66-9ba9-225a1add0a51-b7305eaa662f33cb180e1eb3b6c5d6d0-a67b7.png 200w,\n/static/2c8a7a87-1bf1-4d66-9ba9-225a1add0a51-b7305eaa662f33cb180e1eb3b6c5d6d0-0b187.png 400w,\n/static/2c8a7a87-1bf1-4d66-9ba9-225a1add0a51-b7305eaa662f33cb180e1eb3b6c5d6d0-fee1c.png 800w,\n/static/2c8a7a87-1bf1-4d66-9ba9-225a1add0a51-b7305eaa662f33cb180e1eb3b6c5d6d0-b5415.png 842w" data-sizes="(max-width: 800px) 100vw, 800px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<h1 id="重构原则"><a href="#%E9%87%8D%E6%9E%84%E5%8E%9F%E5%88%99" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>重构原则</h1>\n<h2 id="定义"><a href="#%E5%AE%9A%E4%B9%89" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>定义</h2>\n<p>重构是对软件内部结构的一种调整，目的是在不改变软件可观察行为的前提下，提高其可理解性，降低其修改成本。</p>\n<h2 id="为何重构"><a href="#%E4%B8%BA%E4%BD%95%E9%87%8D%E6%9E%84" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>为何重构</h2>\n<ul>\n<li>改进软件设计</li>\n<li>使软件更容易理解</li>\n<li>帮助找到 Bug</li>\n<li>提高编程速度</li>\n</ul>\n<h2 id="三次法则"><a href="#%E4%B8%89%E6%AC%A1%E6%B3%95%E5%88%99" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>三次法则</h2>\n<p>第一次做某件事时只管去做；第二次做类似事情时可以去做；第三次再做类似的事，就应该重构。</p>\n<h2 id="间接层与重构"><a href="#%E9%97%B4%E6%8E%A5%E5%B1%82%E4%B8%8E%E9%87%8D%E6%9E%84" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>间接层与重构</h2>\n<p>计算机科学中的很多问题可以通过增加一个间接层来解决，间接层具有以下价值：</p>\n<ul>\n<li>允许逻辑共享</li>\n<li>分开解释意图和实现</li>\n<li>隔离变化</li>\n<li>封装条件逻辑。</li>\n</ul>\n<p>重构可以理解为在适当的位置插入间接层以及在不需要时移除间接层。</p>\n<h2 id="修改接口"><a href="#%E4%BF%AE%E6%94%B9%E6%8E%A5%E5%8F%A3" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>修改接口</h2>\n<p>如果重构手法改变了已发布的接口，就必须维护新旧两个接口。</p>\n<p>可以保留旧接口，让旧接口去调用新接口，并且使用 Java 提供的 @deprecation 将旧接口标记为弃用。</p>\n<p>可见修改接口特别麻烦，因此除非真有必要，否则不要发布接口，并且不要过早发布接口。</p>\n<h2 id="何时不该重构"><a href="#%E4%BD%95%E6%97%B6%E4%B8%8D%E8%AF%A5%E9%87%8D%E6%9E%84" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>何时不该重构</h2>\n<p>当现有代码过于混乱时，应当重写而不是重构。</p>\n<p>一个折中的办法是，将代码封装成一个个组件，然后对各个组件做重写或者重构的决定。</p>\n<h2 id="重构与设计"><a href="#%E9%87%8D%E6%9E%84%E4%B8%8E%E8%AE%BE%E8%AE%A1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>重构与设计</h2>\n<p>软件开发无法预先设计，因为开发过程有很多变化发生，在最开始不可能都把所有情况考虑进去。</p>\n<p>重构可以简化设计，重构在一个简单的设计上进行修修改改，当变化发生时，以一种灵活的方式去应对变化，进而带来更好的设计。</p>\n<h2 id="重构与性能"><a href="#%E9%87%8D%E6%9E%84%E4%B8%8E%E6%80%A7%E8%83%BD" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>重构与性能</h2>\n<p>为了软代码更容易理解，重构可能会导致性能减低。</p>\n<p>在编写代码时，不用对性能过多关注，只有在最后性能优化阶段再考虑性能问题。</p>\n<p>应当只关注关键代码的性能，因为只有一小部分的代码是关键代码。</p>\n<h1 id="代码的坏味道"><a href="#%E4%BB%A3%E7%A0%81%E7%9A%84%E5%9D%8F%E5%91%B3%E9%81%93" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>代码的坏味道</h1>\n<p>本章主要介绍一些不好的代码，也就是说这些代码应该被重构。</p>\n<p>文中提到的具体重构原则可以先忽略。</p>\n<h2 id="重复代码"><a href="#%E9%87%8D%E5%A4%8D%E4%BB%A3%E7%A0%81" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>重复代码</h2>\n<blockquote>\n<p>Duplicated Code</p>\n</blockquote>\n<p>同一个类的两个函数有相同表达式，则用 Extract Method 提取出重复代码；</p>\n<p>两个互为兄弟的子类含有相同的表达式，先使用 Extract Method，然后把提取出来的函数 Pull Up Method 推入超类。</p>\n<p>如果只是部分相同，用 Extract Method 分离出相似部分和差异部分，然后使用 Form Template Method 这种模板方法设计模式。</p>\n<p>如果两个毫不相关的类出现重复代码，则使用 Extract Class 方法将重复代码提取到一个独立类中。</p>\n<h2 id="过长函数"><a href="#%E8%BF%87%E9%95%BF%E5%87%BD%E6%95%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>过长函数</h2>\n<blockquote>\n<p>Long Method</p>\n</blockquote>\n<p>函数应该尽可能小，因为小函数具有解释能力、共享能力、选择能力。</p>\n<p>分解长函数的原则：当需要用注释来说明一段代码时，就需要把这部分代码写入一个独立的函数中。</p>\n<p>Extract Method 会把很多参数和临时变量都当做参数，可以用 Replace Temp with Query 消除临时变量，Introduce Parameter Object 和 Preserve Whole Object 可以将过长的参数列变得更简洁。</p>\n<p>条件和循环语句往往也需要提取到新的函数中。</p>\n<h2 id="过大的类"><a href="#%E8%BF%87%E5%A4%A7%E7%9A%84%E7%B1%BB" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>过大的类</h2>\n<blockquote>\n<p>Large Class</p>\n</blockquote>\n<p>应该尽可能让一个类只做一件事，而过大的类做了过多事情，需要使用 Extract Class 或 Extract Subclass。</p>\n<p>先确定客户端如何使用该类，然后运用 Extract Interface 为每一种使用方式提取出一个接口。</p>\n<h2 id="过长的参数列表"><a href="#%E8%BF%87%E9%95%BF%E7%9A%84%E5%8F%82%E6%95%B0%E5%88%97%E8%A1%A8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>过长的参数列表</h2>\n<blockquote>\n<p>Long Parameter List</p>\n</blockquote>\n<p>太长的参数列表往往会造成前后不一致，不易使用。</p>\n<p>面向对象程序中，函数所需要的数据通常内在宿主类中找到。</p>\n<h2 id="发散式变化"><a href="#%E5%8F%91%E6%95%A3%E5%BC%8F%E5%8F%98%E5%8C%96" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>发散式变化</h2>\n<blockquote>\n<p>Divergent Change</p>\n</blockquote>\n<p>设计原则：一个类应该只有一个引起改变的原因。也就是说，针对某一外界变化所有相应的修改，都只应该发生在单一类中。</p>\n<p>针对某种原因的变化，使用 Extract Class 将它提炼到一个类中。</p>\n<h2 id="散弹式修改"><a href="#%E6%95%A3%E5%BC%B9%E5%BC%8F%E4%BF%AE%E6%94%B9" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>散弹式修改</h2>\n<blockquote>\n<p>Shotgun Surgery</p>\n</blockquote>\n<p>一个变化引起多个类修改；</p>\n<p>使用 Move Method 和 Move Field 把所有需要修改的代码放到同一个类中。</p>\n<h2 id="依恋情结"><a href="#%E4%BE%9D%E6%81%8B%E6%83%85%E7%BB%93" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>依恋情结</h2>\n<blockquote>\n<p>Feature Envy</p>\n</blockquote>\n<p>一个函数对某个类的兴趣高于对自己所处类的兴趣，通常是过多访问其它类的数据，</p>\n<p>使用 Move Method 将它移到该去的地方，如果对多个类都有 Feature Envy，先用 Extract Method 提取出多个函数。</p>\n<h2 id="数据泥团"><a href="#%E6%95%B0%E6%8D%AE%E6%B3%A5%E5%9B%A2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>数据泥团</h2>\n<blockquote>\n<p>Data Clumps</p>\n</blockquote>\n<p>有些数据经常一起出现，比如两个类具有相同的字段、许多函数有相同的参数，这些绑定在一起出现的数据应该拥有属于它们自己的对象。</p>\n<p>使用 Extract Class 将它们放在一起。</p>\n<h2 id="基本类型偏执"><a href="#%E5%9F%BA%E6%9C%AC%E7%B1%BB%E5%9E%8B%E5%81%8F%E6%89%A7" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>基本类型偏执</h2>\n<blockquote>\n<p>Primitive Obsession</p>\n</blockquote>\n<p>使用类往往比使用基本类型更好，使用 Replace Data Value with Object 将数据值替换为对象。</p>\n<h2 id="switch-惊悚现身"><a href="#switch-%E6%83%8A%E6%82%9A%E7%8E%B0%E8%BA%AB" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>switch 惊悚现身</h2>\n<blockquote>\n<p>Switch Statements</p>\n</blockquote>\n<p>具体参见第一章的案例。</p>\n<h2 id="平行继承体系"><a href="#%E5%B9%B3%E8%A1%8C%E7%BB%A7%E6%89%BF%E4%BD%93%E7%B3%BB" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>平行继承体系</h2>\n<blockquote>\n<p>Parallel Inheritance Hierarchies</p>\n</blockquote>\n<p>每当为某个类增加一个子类，必须也为另一个类相应增加一个子类。</p>\n<p>这种结果会带来一些重复性，消除重复性的一般策略：让一个继承体系的实例引用另一个继承体系的实例。</p>\n<h2 id="冗余类"><a href="#%E5%86%97%E4%BD%99%E7%B1%BB" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>冗余类</h2>\n<blockquote>\n<p>Lazy Class</p>\n</blockquote>\n<p>如果一个类没有做足够多的工作，就应该消失。</p>\n<h2 id="夸夸其谈未来性"><a href="#%E5%A4%B8%E5%A4%B8%E5%85%B6%E8%B0%88%E6%9C%AA%E6%9D%A5%E6%80%A7" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>夸夸其谈未来性</h2>\n<blockquote>\n<p>Speculative Generality</p>\n</blockquote>\n<p>有些内容是用来处理未来可能发生的变化，但是往往会造成系统难以理解和维护，并且预测未来可能发生的改变很可能和最开始的设想相反。因此，如果不是必要，就不要这么做。</p>\n<h2 id="令人迷惑的暂时字段"><a href="#%E4%BB%A4%E4%BA%BA%E8%BF%B7%E6%83%91%E7%9A%84%E6%9A%82%E6%97%B6%E5%AD%97%E6%AE%B5" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>令人迷惑的暂时字段</h2>\n<blockquote>\n<p>Temporary Field</p>\n</blockquote>\n<p>某个字段仅为某种特定情况而设，这样的代码不易理解，因为通常认为对象在所有时候都需要它的所有字段。</p>\n<p>把这种字段和特定情况的处理操作使用 Extract Class 提炼到一个独立类中。</p>\n<h2 id="过度耦合的消息链"><a href="#%E8%BF%87%E5%BA%A6%E8%80%A6%E5%90%88%E7%9A%84%E6%B6%88%E6%81%AF%E9%93%BE" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>过度耦合的消息链</h2>\n<blockquote>\n<p>Message Chains</p>\n</blockquote>\n<p>一个对象请求另一个对象，然后再向后者请求另一个对象，然后…，这就是消息链。采用这种方式，意味着客户代码将与对象间的关系紧密耦合。</p>\n<p>改用函数链，用函数委托另一个对象来处理。</p>\n<h2 id="中间人"><a href="#%E4%B8%AD%E9%97%B4%E4%BA%BA" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>中间人</h2>\n<blockquote>\n<p>Middle Man</p>\n</blockquote>\n<p>中间人负责处理委托给它的操作，如果一个类中有过多的函数都委托给其它类，那就是过度运用委托，应当 Remove Middle Man，直接与负责的对象打交道。</p>\n<h2 id="狎昵关系"><a href="#%E7%8B%8E%E6%98%B5%E5%85%B3%E7%B3%BB" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>狎昵关系</h2>\n<blockquote>\n<p>Inappropriate Intimacy</p>\n</blockquote>\n<p>两个类多于亲密，花费太多时间去探讨彼此的 private 成分。</p>\n<h2 id="异曲同工的类"><a href="#%E5%BC%82%E6%9B%B2%E5%90%8C%E5%B7%A5%E7%9A%84%E7%B1%BB" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>异曲同工的类</h2>\n<blockquote>\n<p>Alernative Classes with Different Interfaces</p>\n</blockquote>\n<p>两个函数做同一件事，却有着不同的签名。</p>\n<p>使用 Rename Method 根据它们的用途重新命名。</p>\n<h2 id="不完美的类库"><a href="#%E4%B8%8D%E5%AE%8C%E7%BE%8E%E7%9A%84%E7%B1%BB%E5%BA%93" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>不完美的类库</h2>\n<blockquote>\n<p>Incomplete Library Class</p>\n</blockquote>\n<p>类库的设计者不可能设计出完美的类库，当我们需要对类库进行一些修改时，可以使用以下两种方法：如果只是修改一两个函数，使用 Introduce Foreign Method；如果要添加一大堆额外行为，使用 Introduce Local Extension。</p>\n<h2 id="幼稚的数据类"><a href="#%E5%B9%BC%E7%A8%9A%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>幼稚的数据类</h2>\n<blockquote>\n<p>Data Class</p>\n</blockquote>\n<p>它只拥有一些数据字段，以及用于访问这些字段的函数，除此之外一无长物。</p>\n<p>找出字段使用的地方，然后把相应的操作移到 Data Class 中。</p>\n<h2 id="被拒绝的馈赠"><a href="#%E8%A2%AB%E6%8B%92%E7%BB%9D%E7%9A%84%E9%A6%88%E8%B5%A0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>被拒绝的馈赠</h2>\n<blockquote>\n<p>Refused Bequest</p>\n</blockquote>\n<p>子类不想继承超类的所有函数和数据。</p>\n<p>为子类新建一个兄弟类，不需要的函数或数据使用 Push Down Method 和 Push Down Field 下推给那个兄弟。</p>\n<h2 id="过多的注释"><a href="#%E8%BF%87%E5%A4%9A%E7%9A%84%E6%B3%A8%E9%87%8A" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>过多的注释</h2>\n<blockquote>\n<p>Comments</p>\n</blockquote>\n<p>使用 Extract Method 提炼出需要注释的部分，然后用函数名来解释函数的行为。</p>\n<h1 id="构筑测试体系"><a href="#%E6%9E%84%E7%AD%91%E6%B5%8B%E8%AF%95%E4%BD%93%E7%B3%BB" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>构筑测试体系</h1>\n<p>Java 可以使用 Junit 进行单元测试。</p>\n<p>测试应该能够完全自动化，并能检查测试的结果。Junit 可以做到。</p>\n<p>小步修改，频繁测试。</p>\n<p>单元测试的对象是类的方法，而功能测是以客户的角度保证软件正常运行。</p>\n<p>应当集中测试可能出错的边界条件。</p>\n<h1 id="重新组织函数"><a href="#%E9%87%8D%E6%96%B0%E7%BB%84%E7%BB%87%E5%87%BD%E6%95%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>重新组织函数</h1>\n<h2 id="提炼函数"><a href="#%E6%8F%90%E7%82%BC%E5%87%BD%E6%95%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>提炼函数</h2>\n<blockquote>\n<p>Extract Method</p>\n</blockquote>\n<p>将这段代码放进一个独立函数中，并让函数名称解释该函数的用途。</p>\n<h2 id="内联函数"><a href="#%E5%86%85%E8%81%94%E5%87%BD%E6%95%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>内联函数</h2>\n<blockquote>\n<p>Inline Method</p>\n</blockquote>\n<p>一个函数的本体与名称同样清楚易懂。</p>\n<p>在函数调用点插入函数本体，然后移除该函数。</p>\n<h2 id="内联临时变量"><a href="#%E5%86%85%E8%81%94%E4%B8%B4%E6%97%B6%E5%8F%98%E9%87%8F" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>内联临时变量</h2>\n<blockquote>\n<p>Inline Temp</p>\n</blockquote>\n<p>一个临时变量，只被简单表达式赋值一次，而它妨碍了其它重构手法。</p>\n<p>将所有对该变量的引用替换为对它赋值的那个表达式自身。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="16693194198794158000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`double basePrice = anOrder.basePrice();\nreturn basePrice > 1000;`, `16693194198794158000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="java"\n              >\n                <span class="gatsby-code-button-language">java</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="java"><pre style="counter-reset: linenumber NaN" class="language-java line-numbers"><code class="language-java"><span class="token keyword">double</span> basePrice <span class="token operator">=</span> anOrder<span class="token punctuation">.</span><span class="token function">basePrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">return</span> basePrice <span class="token operator">></span> <span class="token number">1000</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="32492909938711100000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`return anOrder.basePrice() > 1000;`, `32492909938711100000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="java"\n              >\n                <span class="gatsby-code-button-language">java</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="java"><pre style="counter-reset: linenumber NaN" class="language-java line-numbers"><code class="language-java"><span class="token keyword">return</span> anOrder<span class="token punctuation">.</span><span class="token function">basePrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">1000</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>\n<h2 id="以查询取代临时变量"><a href="#%E4%BB%A5%E6%9F%A5%E8%AF%A2%E5%8F%96%E4%BB%A3%E4%B8%B4%E6%97%B6%E5%8F%98%E9%87%8F" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>以查询取代临时变量</h2>\n<blockquote>\n<p>Replace Temp with Query</p>\n</blockquote>\n<p>以临时变量保存某一表达式的运算结果，将这个表达式提炼到一个独立函数中，将所有对临时变量的引用点替换为对新函数的调用。Replace Temp with Query 往往是 Extract Method 之前必不可少的一个步骤，因为局部变量会使代码难以提炼。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="52219705401179240000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`double basePrice = quantity * itemPrice;\nif(basePrice > 1000)\n    return basePrice * 0.95;\nelse\n    return basePrice * 0.98;`, `52219705401179240000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="java"\n              >\n                <span class="gatsby-code-button-language">java</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="java"><pre style="counter-reset: linenumber NaN" class="language-java line-numbers"><code class="language-java"><span class="token keyword">double</span> basePrice <span class="token operator">=</span> quantity <span class="token operator">*</span> itemPrice<span class="token punctuation">;</span>\n<span class="token keyword">if</span><span class="token punctuation">(</span>basePrice <span class="token operator">></span> <span class="token number">1000</span><span class="token punctuation">)</span>\n    <span class="token keyword">return</span> basePrice <span class="token operator">*</span> <span class="token number">0.95</span><span class="token punctuation">;</span>\n<span class="token keyword">else</span>\n    <span class="token keyword">return</span> basePrice <span class="token operator">*</span> <span class="token number">0.98</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="85196383565961560000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`if(basePrice() > 1000)\n    return basePrice() * 0.95;\nelse\n    return basePrice() * 0.98;\n\n// ...\ndouble basePrice(){\n    return quantity * itemPrice;\n}`, `85196383565961560000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="java"\n              >\n                <span class="gatsby-code-button-language">java</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="java"><pre style="counter-reset: linenumber NaN" class="language-java line-numbers"><code class="language-java"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">basePrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">1000</span><span class="token punctuation">)</span>\n    <span class="token keyword">return</span> <span class="token function">basePrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">0.95</span><span class="token punctuation">;</span>\n<span class="token keyword">else</span>\n    <span class="token keyword">return</span> <span class="token function">basePrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">0.98</span><span class="token punctuation">;</span>\n\n<span class="token comment">// ...</span>\n<span class="token keyword">double</span> <span class="token function">basePrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>\n    <span class="token keyword">return</span> quantity <span class="token operator">*</span> itemPrice<span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="引起解释变量"><a href="#%E5%BC%95%E8%B5%B7%E8%A7%A3%E9%87%8A%E5%8F%98%E9%87%8F" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>引起解释变量</h2>\n<blockquote>\n<p>Introduce Explaining Variable</p>\n</blockquote>\n<p>将复杂表达式（或其中一部分）的结果放进一个临时变量，以此变量名称来解释表达式用途。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="241013181349214460"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`if((platform.toUpperCase().indexOf(&quot;MAC&quot;) > -1) &&\n  (browser.toUpperCase().indexOf(&quot;IE&quot;) > -1) &&\n  wasInitialized() && resize > 0) {\n    // do something\n}`, `241013181349214460`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="java"\n              >\n                <span class="gatsby-code-button-language">java</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="java"><pre style="counter-reset: linenumber NaN" class="language-java line-numbers"><code class="language-java"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>platform<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">"MAC"</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>\n  <span class="token punctuation">(</span>browser<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">"IE"</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>\n  <span class="token function">wasInitialized</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> resize <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// do something</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="28869073648321364000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`final boolean isMacOS = platform.toUpperCase().indexOf(&quot;MAC&quot;) > -1;\nfinal boolean isIEBrower = browser.toUpperCase().indexOf(&quot;IE&quot;) > -1;\nfinal boolean wasResized = resize > 0;\n\nif(isMacOS && isIEBrower && wasInitialized() && wasResized) {\n    // do something\n}`, `28869073648321364000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="java"\n              >\n                <span class="gatsby-code-button-language">java</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="java"><pre style="counter-reset: linenumber NaN" class="language-java line-numbers"><code class="language-java"><span class="token keyword">final</span> <span class="token keyword">boolean</span> isMacOS <span class="token operator">=</span> platform<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">"MAC"</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>\n<span class="token keyword">final</span> <span class="token keyword">boolean</span> isIEBrower <span class="token operator">=</span> browser<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">"IE"</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>\n<span class="token keyword">final</span> <span class="token keyword">boolean</span> wasResized <span class="token operator">=</span> resize <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">;</span>\n\n<span class="token keyword">if</span><span class="token punctuation">(</span>isMacOS <span class="token operator">&amp;&amp;</span> isIEBrower <span class="token operator">&amp;&amp;</span> <span class="token function">wasInitialized</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> wasResized<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// do something</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="分解临时变量"><a href="#%E5%88%86%E8%A7%A3%E4%B8%B4%E6%97%B6%E5%8F%98%E9%87%8F" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>分解临时变量</h2>\n<blockquote>\n<p>Split Temporary Variable</p>\n</blockquote>\n<p>某个临时变量被赋值超过一次，它既不是循环变量，也不是用于收集计算结果。</p>\n<p>针对每次赋值，创造一个独立、对应的临时变量，每个临时变量只承担一个责任。</p>\n<h2 id="移除对参数的赋值"><a href="#%E7%A7%BB%E9%99%A4%E5%AF%B9%E5%8F%82%E6%95%B0%E7%9A%84%E8%B5%8B%E5%80%BC" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>移除对参数的赋值</h2>\n<blockquote>\n<p>Remove Assigments to Parameters</p>\n</blockquote>\n<p>以一个临时变量取代对该参数的赋值。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="98134192223831870000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`int discount (int inputVal, int quentity, int yearToDate){\n    if (inputVal > 50) inputVal -= 2;`, `98134192223831870000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="java"\n              >\n                <span class="gatsby-code-button-language">java</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="java"><pre style="counter-reset: linenumber NaN" class="language-java line-numbers"><code class="language-java"><span class="token keyword">int</span> discount <span class="token punctuation">(</span><span class="token keyword">int</span> inputVal<span class="token punctuation">,</span> <span class="token keyword">int</span> quentity<span class="token punctuation">,</span> <span class="token keyword">int</span> yearToDate<span class="token punctuation">)</span><span class="token punctuation">{</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span>inputVal <span class="token operator">></span> <span class="token number">50</span><span class="token punctuation">)</span> inputVal <span class="token operator">-=</span> <span class="token number">2</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="55364193289392950000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`int discount (int inputVal, int quentity, int yearToDate){\n    int result = inputVal;\n    if (inputVal > 50) result -= 2;`, `55364193289392950000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="java"\n              >\n                <span class="gatsby-code-button-language">java</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="java"><pre style="counter-reset: linenumber NaN" class="language-java line-numbers"><code class="language-java"><span class="token keyword">int</span> discount <span class="token punctuation">(</span><span class="token keyword">int</span> inputVal<span class="token punctuation">,</span> <span class="token keyword">int</span> quentity<span class="token punctuation">,</span> <span class="token keyword">int</span> yearToDate<span class="token punctuation">)</span><span class="token punctuation">{</span>\n    <span class="token keyword">int</span> result <span class="token operator">=</span> inputVal<span class="token punctuation">;</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span>inputVal <span class="token operator">></span> <span class="token number">50</span><span class="token punctuation">)</span> result <span class="token operator">-=</span> <span class="token number">2</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<h2 id="以函数对象取代函数"><a href="#%E4%BB%A5%E5%87%BD%E6%95%B0%E5%AF%B9%E8%B1%A1%E5%8F%96%E4%BB%A3%E5%87%BD%E6%95%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>以函数对象取代函数</h2>\n<blockquote>\n<p>Replace Method with Method Object</p>\n</blockquote>\n<p>当对一个大型函数采用 Extract Method 时，由于包含了局部变量使得很难进行该操作。</p>\n<p>将这个函数放进一个单独对象中，如此一来局部变量就成了对象内的字段。然后可以在同一个对象中将这个大型函数分解为多个小型函数。</p>\n<h2 id="替换算法"><a href="#%E6%9B%BF%E6%8D%A2%E7%AE%97%E6%B3%95" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>替换算法</h2>\n<blockquote>\n<p>Subsititute Algorithn</p>\n</blockquote>\n<h1 id="在对象之间搬移特性"><a href="#%E5%9C%A8%E5%AF%B9%E8%B1%A1%E4%B9%8B%E9%97%B4%E6%90%AC%E7%A7%BB%E7%89%B9%E6%80%A7" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>在对象之间搬移特性</h1>\n<h2 id="搬移函数"><a href="#%E6%90%AC%E7%A7%BB%E5%87%BD%E6%95%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>搬移函数</h2>\n<blockquote>\n<p>Move Method</p>\n</blockquote>\n<p>类中的某个函数与另一个类进行更多交流：调用后者或者被后者调用。</p>\n<p>将这个函数搬移到另一个类中。</p>\n<h2 id="搬移字段"><a href="#%E6%90%AC%E7%A7%BB%E5%AD%97%E6%AE%B5" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>搬移字段</h2>\n<blockquote>\n<p>Move Field</p>\n</blockquote>\n<p>类中的某个字段被另一个类更多地用到，这里的用到是指调用取值设值函数，应当把该字段移到另一个类中。</p>\n<h2 id="提炼类"><a href="#%E6%8F%90%E7%82%BC%E7%B1%BB" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>提炼类</h2>\n<blockquote>\n<p>Extract Class</p>\n</blockquote>\n<p>某个类做了应当由两个类做的事。</p>\n<p>应当建立一个新类，将相关的字段和函数从旧类搬移到新类。</p>\n<h2 id="将类内联化"><a href="#%E5%B0%86%E7%B1%BB%E5%86%85%E8%81%94%E5%8C%96" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>将类内联化</h2>\n<blockquote>\n<p>Inline Class</p>\n</blockquote>\n<p>与 Extract Class 相反。</p>\n<h2 id="隐藏委托关系"><a href="#%E9%9A%90%E8%97%8F%E5%A7%94%E6%89%98%E5%85%B3%E7%B3%BB" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>隐藏委托关系</h2>\n<blockquote>\n<p>Hide Delegate</p>\n</blockquote>\n<p>建立所需的函数，隐藏委托关系。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="29587699919379173000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class Person{\n    Department department;\n\n    public Department getDepartment(){\n        return department;\n    }\n}\n\nclass Department{\n    private Person manager;\n\n    public Person getManager(){\n        return manager;\n    }\n}`, `29587699919379173000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="java"\n              >\n                <span class="gatsby-code-button-language">java</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="java"><pre style="counter-reset: linenumber NaN" class="language-java line-numbers"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Person</span><span class="token punctuation">{</span>\n    <span class="token class-name">Department</span> department<span class="token punctuation">;</span>\n\n    <span class="token keyword">public</span> <span class="token class-name">Department</span> <span class="token function">getDepartment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>\n        <span class="token keyword">return</span> department<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">class</span> <span class="token class-name">Department</span><span class="token punctuation">{</span>\n    <span class="token keyword">private</span> <span class="token class-name">Person</span> manager<span class="token punctuation">;</span>\n\n    <span class="token keyword">public</span> <span class="token class-name">Person</span> <span class="token function">getManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>\n        <span class="token keyword">return</span> manager<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>如果客户希望知道某人的经理是谁，必须获得 Department 对象，这样就对客户揭露了 Department 的工作原理。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="17379767464192608000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`Person manager = john.getDepartment().getManager();`, `17379767464192608000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="java"\n              >\n                <span class="gatsby-code-button-language">java</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="java"><pre style="counter-reset: linenumber NaN" class="language-java line-numbers"><code class="language-java"><span class="token class-name">Person</span> manager <span class="token operator">=</span> john<span class="token punctuation">.</span><span class="token function">getDepartment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>\n<p>通过为 Peron 建立一个函数来隐藏这种委托关系。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="6244552834184014000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`public Person getManager(){\n    return department.getManager();\n}`, `6244552834184014000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="java"\n              >\n                <span class="gatsby-code-button-language">java</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="java"><pre style="counter-reset: linenumber NaN" class="language-java line-numbers"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">Person</span> <span class="token function">getManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>\n    <span class="token keyword">return</span> department<span class="token punctuation">.</span><span class="token function">getManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<h2 id="移除中间人"><a href="#%E7%A7%BB%E9%99%A4%E4%B8%AD%E9%97%B4%E4%BA%BA" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>移除中间人</h2>\n<blockquote>\n<p>Remove Middle Man</p>\n</blockquote>\n<p>与 Hide Delegate 相反，本方法需要移除委托函数，让客户直接调用委托类。</p>\n<p>Hide Delegate 有很大好处，但是它的代价是：每当客户要使用受托类的新特性时，就必须在服务器端添加一个简单的委托函数。随着受委托的特性越来越多，服务器类完全变成了一个“中间人”。</p>\n<h2 id="引入外加函数"><a href="#%E5%BC%95%E5%85%A5%E5%A4%96%E5%8A%A0%E5%87%BD%E6%95%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>引入外加函数</h2>\n<blockquote>\n<p>Introduce Foreign Method</p>\n</blockquote>\n<p>需要为提供服务的类添加一个函数，但是无法修改这个类。</p>\n<p>可以在客户类中建立一个函数，并以第一参数形式传入一个服务类的实例，让客户类组合服务器实例。</p>\n<h2 id="引入本地扩展"><a href="#%E5%BC%95%E5%85%A5%E6%9C%AC%E5%9C%B0%E6%89%A9%E5%B1%95" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>引入本地扩展</h2>\n<blockquote>\n<p>Introduce Local Extension</p>\n</blockquote>\n<p>和 Introduce Foreign Method 目的一样，但是 Introduce Local Extension 通过建立新的类来实现。有两种方式：子类或者包装类，子类就是通过继承实现，包装类就是通过组合实现。</p>\n<h1 id="重新组织数据"><a href="#%E9%87%8D%E6%96%B0%E7%BB%84%E7%BB%87%E6%95%B0%E6%8D%AE" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>重新组织数据</h1>\n<h2 id="自封装字段"><a href="#%E8%87%AA%E5%B0%81%E8%A3%85%E5%AD%97%E6%AE%B5" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>自封装字段</h2>\n<blockquote>\n<p>Self Encapsulate Field</p>\n</blockquote>\n<p>为字段建立取值/设值函数，并用这些函数来访问字段。只有当子类想访问超类的一个字段，又想在子类中将对这个字段访问改为一个计算后的值，才使用这种方式，否则直接访问字段的方式简洁明了。</p>\n<h2 id="以对象取代数据值"><a href="#%E4%BB%A5%E5%AF%B9%E8%B1%A1%E5%8F%96%E4%BB%A3%E6%95%B0%E6%8D%AE%E5%80%BC" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>以对象取代数据值</h2>\n<blockquote>\n<p>Replace Data Value with Object</p>\n</blockquote>\n<p>在开发初期，往往会用简单的数据项表示简单的情况，但是随着开发的进行，一些简单数据项会具有一些特殊行为。比如一开始会把电话号码存成字符串，但是随后发现电话号码需要“格式化”、“抽取区号”之类的特殊行为。</p>\n<h2 id="将值对象改成引用对象"><a href="#%E5%B0%86%E5%80%BC%E5%AF%B9%E8%B1%A1%E6%94%B9%E6%88%90%E5%BC%95%E7%94%A8%E5%AF%B9%E8%B1%A1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>将值对象改成引用对象</h2>\n<blockquote>\n<p>Change Value to Reference</p>\n</blockquote>\n<p>将彼此相等的实例替换为同一个对象。这就要用一个工厂来创建这种唯一对象，工厂类中需要保留一份已经创建对象的列表，当要创建一个对象时，先查找这份列表中是否已经存在该对象，如果存在，则返回列表中的这个对象；否则，新建一个对象，添加到列表中，并返回该对象。</p>\n<h2 id="将引用对象改为值对象"><a href="#%E5%B0%86%E5%BC%95%E7%94%A8%E5%AF%B9%E8%B1%A1%E6%94%B9%E4%B8%BA%E5%80%BC%E5%AF%B9%E8%B1%A1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>将引用对象改为值对象</h2>\n<blockquote>\n<p>Change Reference to value</p>\n</blockquote>\n<p>以 Change Value to Reference 相反。值对象有个非常重要的特性：它是不可变的，不可变表示如果要改变这个对象，必须用一个新的对象来替换旧对象，而不是修改旧对象。</p>\n<p>需要为值对象实现 equals() 和 hashCode() 方法</p>\n<h2 id="以对象取代数组"><a href="#%E4%BB%A5%E5%AF%B9%E8%B1%A1%E5%8F%96%E4%BB%A3%E6%95%B0%E7%BB%84" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>以对象取代数组</h2>\n<blockquote>\n<p>Replace Array with Object</p>\n</blockquote>\n<p>有一个数组，其中的元素各自代表不同的东西。</p>\n<p>以对象替换数组，对于数组中的每个元素，以一个字段来表示，这样方便操作，也更容易理解。</p>\n<h2 id="赋值被监视数据"><a href="#%E8%B5%8B%E5%80%BC%E8%A2%AB%E7%9B%91%E8%A7%86%E6%95%B0%E6%8D%AE" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>赋值被监视数据</h2>\n<blockquote>\n<p>Duplicate Observed Data</p>\n</blockquote>\n<p>一些领域数据置身于 GUI 控件中，而领域函数需要访问这些数据。</p>\n<p>将该数据赋值到一个领域对象中，建立一个 Oberver 模式，用以同步领域对象和 GUI 对象内的重复数据。</p>\n<h2 id="将单向关联改为双向关联"><a href="#%E5%B0%86%E5%8D%95%E5%90%91%E5%85%B3%E8%81%94%E6%94%B9%E4%B8%BA%E5%8F%8C%E5%90%91%E5%85%B3%E8%81%94" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>将单向关联改为双向关联</h2>\n<blockquote>\n<p>Change Unidirectional Association to Bidirectional</p>\n</blockquote>\n<p>当两个类都需要对方的特性时，可以使用双向关联。</p>\n<p>有两个类，分别为订单 Order 和客户 Customer，Order 引用了 Customer，Customer 也需要引用 Order 来查看其所有订单详情。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="8188172400909876000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class Order{\n    private Customer customer;\n    public void setCustomer(Customer customer){\n        if(this.customer != null)\n            this.customer.removeOrder(this);\n        this.customer = customer;\n        this.customer.add(this);\n    }\n}`, `8188172400909876000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="java"\n              >\n                <span class="gatsby-code-button-language">java</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="java"><pre style="counter-reset: linenumber NaN" class="language-java line-numbers"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Order</span><span class="token punctuation">{</span>\n    <span class="token keyword">private</span> <span class="token class-name">Customer</span> customer<span class="token punctuation">;</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setCustomer</span><span class="token punctuation">(</span><span class="token class-name">Customer</span> customer<span class="token punctuation">)</span><span class="token punctuation">{</span>\n        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>customer <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>\n            <span class="token keyword">this</span><span class="token punctuation">.</span>customer<span class="token punctuation">.</span><span class="token function">removeOrder</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>customer <span class="token operator">=</span> customer<span class="token punctuation">;</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>customer<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="92351149127585990000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class Curstomer{\n    private Set<Order> orders = new HashSet<>();\n    public void removeOrder(Order order){\n        orders.remove(order);\n    }\n    public void addOrder(Order order){\n        orders.add(order);\n    }\n}`, `92351149127585990000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="java"\n              >\n                <span class="gatsby-code-button-language">java</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="java"><pre style="counter-reset: linenumber NaN" class="language-java line-numbers"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Curstomer</span><span class="token punctuation">{</span>\n    <span class="token keyword">private</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Order</span><span class="token punctuation">></span></span> orders <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">removeOrder</span><span class="token punctuation">(</span><span class="token class-name">Order</span> order<span class="token punctuation">)</span><span class="token punctuation">{</span>\n        orders<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>order<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addOrder</span><span class="token punctuation">(</span><span class="token class-name">Order</span> order<span class="token punctuation">)</span><span class="token punctuation">{</span>\n        orders<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>order<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>注意到，这里让 Curstomer 类来控制关联关系。有以下原则来决定哪个类来控制关联关系：如果某个对象是组成另一个对象的部件，那么由后者负责控制关联关系；如果是一对多关系，则由单一引用那一方来控制关联关系。</p>\n<h2 id="将双向关联改为单向关联"><a href="#%E5%B0%86%E5%8F%8C%E5%90%91%E5%85%B3%E8%81%94%E6%94%B9%E4%B8%BA%E5%8D%95%E5%90%91%E5%85%B3%E8%81%94" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>将双向关联改为单向关联</h2>\n<blockquote>\n<p>Change Bidirectional Association to Unidirectional</p>\n</blockquote>\n<p>和 Change Unidirectional Association to Bidirectiona 为反操作。</p>\n<p>双向关联维护成本高，并且也不易于理解。大量的双向连接很容易造成“僵尸对象”：某个对象本身已经死亡了，却保留在系统中，因为它的引用还没有全部完全清除。</p>\n<h2 id="以字面常量取代魔法数"><a href="#%E4%BB%A5%E5%AD%97%E9%9D%A2%E5%B8%B8%E9%87%8F%E5%8F%96%E4%BB%A3%E9%AD%94%E6%B3%95%E6%95%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>以字面常量取代魔法数</h2>\n<blockquote>\n<p>Replace Magic Number with Symbolic Constant</p>\n</blockquote>\n<p>创建一个常量，根据其意义为它命名，并将字面常量换位这个常量。</p>\n<h2 id="封装字段"><a href="#%E5%B0%81%E8%A3%85%E5%AD%97%E6%AE%B5" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>封装字段</h2>\n<blockquote>\n<p>Encapsulate Field</p>\n</blockquote>\n<p>public 字段应当改为 private，并提供相应的访问函数。</p>\n<h2 id="封装集合"><a href="#%E5%B0%81%E8%A3%85%E9%9B%86%E5%90%88" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>封装集合</h2>\n<blockquote>\n<p>Encapsulate Collection</p>\n</blockquote>\n<p>函数返回集合的一个只读副本，并在这个类中提供添加/移除集合元素的函数。如果函数返回集合自身，会让用户得以修改集合内容而集合拥有者却一无所知。</p>\n<h2 id="以数据类取代记录"><a href="#%E4%BB%A5%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%8F%96%E4%BB%A3%E8%AE%B0%E5%BD%95" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>以数据类取代记录</h2>\n<blockquote>\n<p>Replace Record with Data Class</p>\n</blockquote>\n<h2 id="以类取代类型码"><a href="#%E4%BB%A5%E7%B1%BB%E5%8F%96%E4%BB%A3%E7%B1%BB%E5%9E%8B%E7%A0%81" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>以类取代类型码</h2>\n<blockquote>\n<p>Replace Type Code with Class</p>\n</blockquote>\n<p>类中有一个数值类型码，但它并不影响类的行为，就用一个新类替换该数值类型码。如果类型码出现在 switch 语句中，需要使用 Replace Conditional with Polymorphism 去掉 switch，首先必须运用 Replace Type Code with Subcalss 或 Replace Type Code with State/Strategy 去掉类型码。</p>\n<h2 id="以子类取代类型码"><a href="#%E4%BB%A5%E5%AD%90%E7%B1%BB%E5%8F%96%E4%BB%A3%E7%B1%BB%E5%9E%8B%E7%A0%81" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>以子类取代类型码</h2>\n<blockquote>\n<p>Replace Type Code with Subcalsses</p>\n</blockquote>\n<p>有一个不可变的类型码，它会影响类的行为，以子类取代这个类型码。</p>\n<h2 id="以-statestrategy-取代类型码"><a href="#%E4%BB%A5-statestrategy-%E5%8F%96%E4%BB%A3%E7%B1%BB%E5%9E%8B%E7%A0%81" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>以 State/Strategy 取代类型码</h2>\n<blockquote>\n<p>Replace Type Code with State/Strategy</p>\n</blockquote>\n<p>有一个可变的类型码，它会影响类的行为，以状态对象取代类型码。</p>\n<p>和 Replace Type Code with Subcalsses 的区别是 Replace Type Code with State/Strategy 的类型码是动态可变的，前者通过继承的方式来实现，后者通过组合的方式来实现。因为类型码可变，如果通过继承的方式，一旦一个对象的类型码改变，那么就要改变用新的对象来取代旧对象，而客户端难以改变新的对象。但是通过组合的方式，改变引用的状态类是很容易的。</p>\n<h2 id="以字段取代子类"><a href="#%E4%BB%A5%E5%AD%97%E6%AE%B5%E5%8F%96%E4%BB%A3%E5%AD%90%E7%B1%BB" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>以字段取代子类</h2>\n<blockquote>\n<p>Replace Subclass with Fields</p>\n</blockquote>\n<p>各个子类的唯一差别只在“返回常量数据”的函数上。</p>\n<h1 id="简化条件表达式"><a href="#%E7%AE%80%E5%8C%96%E6%9D%A1%E4%BB%B6%E8%A1%A8%E8%BE%BE%E5%BC%8F" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>简化条件表达式</h1>\n<h2 id="分解条件表达式"><a href="#%E5%88%86%E8%A7%A3%E6%9D%A1%E4%BB%B6%E8%A1%A8%E8%BE%BE%E5%BC%8F" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>分解条件表达式</h2>\n<blockquote>\n<p>Decompose Conditional</p>\n</blockquote>\n<p>对于一个复杂的条件语句，可以从 if、then、else 三个段落中分别提炼出独立函数。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="38875467148737840000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`if(data.befor(SUMMER_START) || data.after(SUMMER_END))\n    charge = quantity * winterRate + winterServiceCharge;\nelse charge = quantity * summerRate;`, `38875467148737840000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="java"\n              >\n                <span class="gatsby-code-button-language">java</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="java"><pre style="counter-reset: linenumber NaN" class="language-java line-numbers"><code class="language-java"><span class="token keyword">if</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token function">befor</span><span class="token punctuation">(</span>SUMMER_START<span class="token punctuation">)</span> <span class="token operator">||</span> data<span class="token punctuation">.</span><span class="token function">after</span><span class="token punctuation">(</span>SUMMER_END<span class="token punctuation">)</span><span class="token punctuation">)</span>\n    charge <span class="token operator">=</span> quantity <span class="token operator">*</span> winterRate <span class="token operator">+</span> winterServiceCharge<span class="token punctuation">;</span>\n<span class="token keyword">else</span> charge <span class="token operator">=</span> quantity <span class="token operator">*</span> summerRate<span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="36217499195955937000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`if(notSummer(date))\n    charge = winterCharge(quantity);\nelse charge = summerCharge(quantity);`, `36217499195955937000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="java"\n              >\n                <span class="gatsby-code-button-language">java</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="java"><pre style="counter-reset: linenumber NaN" class="language-java line-numbers"><code class="language-java"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">notSummer</span><span class="token punctuation">(</span>date<span class="token punctuation">)</span><span class="token punctuation">)</span>\n    charge <span class="token operator">=</span> <span class="token function">winterCharge</span><span class="token punctuation">(</span>quantity<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">else</span> charge <span class="token operator">=</span> <span class="token function">summerCharge</span><span class="token punctuation">(</span>quantity<span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<h2 id="合并条件表达式"><a href="#%E5%90%88%E5%B9%B6%E6%9D%A1%E4%BB%B6%E8%A1%A8%E8%BE%BE%E5%BC%8F" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>合并条件表达式</h2>\n<blockquote>\n<p>Consolidate Conditional Expression</p>\n</blockquote>\n<p>有一系列条件测试，都得到相同结果。</p>\n<p>将这些测试合并为一个条件表达式，并将这个条件表达式提炼成为一个独立函数。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="99703216249750100000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`double disabilityAmount(){\n    if (seniority < 2) return 0;\n    if (monthsDisabled > 12) return 0;\n    if (isPartTime) return 0;\n    // ...\n}`, `99703216249750100000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="java"\n              >\n                <span class="gatsby-code-button-language">java</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="java"><pre style="counter-reset: linenumber NaN" class="language-java line-numbers"><code class="language-java"><span class="token keyword">double</span> <span class="token function">disabilityAmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span>seniority <span class="token operator">&lt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span>monthsDisabled <span class="token operator">></span> <span class="token number">12</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span>isPartTime<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>\n    <span class="token comment">// ...</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="39964380626189590000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`double disabilityAmount(){\n    if (isNotEligibleForDisability()) return 0;\n    // ...\n}`, `39964380626189590000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="java"\n              >\n                <span class="gatsby-code-button-language">java</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="java"><pre style="counter-reset: linenumber NaN" class="language-java line-numbers"><code class="language-java"><span class="token keyword">double</span> <span class="token function">disabilityAmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isNotEligibleForDisability</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>\n    <span class="token comment">// ...</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="合并重复的条件片段"><a href="#%E5%90%88%E5%B9%B6%E9%87%8D%E5%A4%8D%E7%9A%84%E6%9D%A1%E4%BB%B6%E7%89%87%E6%AE%B5" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>合并重复的条件片段</h2>\n<blockquote>\n<p>Consolidate Duplicate Conditional Fragments</p>\n</blockquote>\n<p>在条件表达式的每个分支上有着相同的一段代码。</p>\n<p>将这段重复代码搬移到条件表达式之外。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="71079152348748580000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`if (isSpecialDeal()){\n    total = price * 0.95;\n    send();\n} else {\n    total = price * 0.98;\n    send();\n}`, `71079152348748580000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="java"\n              >\n                <span class="gatsby-code-button-language">java</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="java"><pre style="counter-reset: linenumber NaN" class="language-java line-numbers"><code class="language-java"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isSpecialDeal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>\n    total <span class="token operator">=</span> price <span class="token operator">*</span> <span class="token number">0.95</span><span class="token punctuation">;</span>\n    <span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n    total <span class="token operator">=</span> price <span class="token operator">*</span> <span class="token number">0.98</span><span class="token punctuation">;</span>\n    <span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="81830877074261440000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`if (isSpecialDeal()) {\n    total = price * 0.95;\n} else {\n    total = price * 0.98;\n}\nsend();`, `81830877074261440000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="java"\n              >\n                <span class="gatsby-code-button-language">java</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="java"><pre style="counter-reset: linenumber NaN" class="language-java line-numbers"><code class="language-java"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isSpecialDeal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    total <span class="token operator">=</span> price <span class="token operator">*</span> <span class="token number">0.95</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n    total <span class="token operator">=</span> price <span class="token operator">*</span> <span class="token number">0.98</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n<span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="移除控制标记"><a href="#%E7%A7%BB%E9%99%A4%E6%8E%A7%E5%88%B6%E6%A0%87%E8%AE%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>移除控制标记</h2>\n<blockquote>\n<p>Remove Control Flag</p>\n</blockquote>\n<p>在一系列布尔表达式中，某个变量带有“控制标记”的作用。</p>\n<p>用 break 语 句或 return 语句来取代控制标记。</p>\n<h2 id="以卫语句取代嵌套条件表达式"><a href="#%E4%BB%A5%E5%8D%AB%E8%AF%AD%E5%8F%A5%E5%8F%96%E4%BB%A3%E5%B5%8C%E5%A5%97%E6%9D%A1%E4%BB%B6%E8%A1%A8%E8%BE%BE%E5%BC%8F" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>以卫语句取代嵌套条件表达式</h2>\n<blockquote>\n<p>Replace Nested Conditional with Guard Clauses</p>\n</blockquote>\n<p>如果某个条件极其罕见，就应该单独检查该条件，并在该条件为真时立刻从函数中返回，这样的单独检查常常被称为“卫语句”（guard clauses）。</p>\n<p>条件表达式通常有两种表现形式。第一种形式是：所有分支都属于正常行为。第二种形式则是：条件表达式提供的答案中只有一种是正常行为，其他都是不常见的情况，可以使用卫语句表现所有特殊情况。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="10408103321949390000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`double getPayAmount() {\n    double result;\n    if (isDead) result = deadAmount();\n    else {\n        if (isSeparated) result = separatedAmount();\n        else {\n            if (isRetired) result = retiredAmount();\n            else result = normalPayAmount();\n        };\n    }\n    return result;\n};`, `10408103321949390000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="java"\n              >\n                <span class="gatsby-code-button-language">java</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="java"><pre style="counter-reset: linenumber NaN" class="language-java line-numbers"><code class="language-java"><span class="token keyword">double</span> <span class="token function">getPayAmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">double</span> result<span class="token punctuation">;</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span>isDead<span class="token punctuation">)</span> result <span class="token operator">=</span> <span class="token function">deadAmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">else</span> <span class="token punctuation">{</span>\n        <span class="token keyword">if</span> <span class="token punctuation">(</span>isSeparated<span class="token punctuation">)</span> result <span class="token operator">=</span> <span class="token function">separatedAmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">else</span> <span class="token punctuation">{</span>\n            <span class="token keyword">if</span> <span class="token punctuation">(</span>isRetired<span class="token punctuation">)</span> result <span class="token operator">=</span> <span class="token function">retiredAmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n            <span class="token keyword">else</span> result <span class="token operator">=</span> <span class="token function">normalPayAmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">return</span> result<span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="49110058912026310000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`double getPayAmount() {\n    if (isDead) return deadAmount();\n    if (isSeparated) return separatedAmount();\n    if (isRetired) return retiredAmount();\n    return normalPayAmount();\n};`, `49110058912026310000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="java"\n              >\n                <span class="gatsby-code-button-language">java</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="java"><pre style="counter-reset: linenumber NaN" class="language-java line-numbers"><code class="language-java"><span class="token keyword">double</span> <span class="token function">getPayAmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span>isDead<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">deadAmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span>isSeparated<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">separatedAmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span>isRetired<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">retiredAmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">return</span> <span class="token function">normalPayAmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="以多态取代条件表达式"><a href="#%E4%BB%A5%E5%A4%9A%E6%80%81%E5%8F%96%E4%BB%A3%E6%9D%A1%E4%BB%B6%E8%A1%A8%E8%BE%BE%E5%BC%8F" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>以多态取代条件表达式</h2>\n<blockquote>\n<p>Replace Conditional with Polymorphism</p>\n</blockquote>\n<p>将这个条件表达式的每个分支放进一个子类内的覆写函数中，然后将原始函数声明为抽象函数。需要先使用 Replace Type Code with Subclass 或 Replace Type Code with State/Strategy 来建立继承结果。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="86015433457714230000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`double getSpeed() {\n    switch (type) {\n        case EUROPEAN:\n            return getBaseSpeed();\n        case AFRICAN:\n            return getBaseSpeed()- getLoadFactor()* numberOfCoconuts;\n        case NORWEGIAN_BLUE:\n            return isNailed ? 0 : getBaseSpeed(voltage);\n    }\n    throw new RuntimeException(&quot;Should be unreachable&quot;);\n}`, `86015433457714230000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="java"\n              >\n                <span class="gatsby-code-button-language">java</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="java"><pre style="counter-reset: linenumber NaN" class="language-java line-numbers"><code class="language-java"><span class="token keyword">double</span> <span class="token function">getSpeed</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">switch</span> <span class="token punctuation">(</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">case</span> EUROPEAN<span class="token operator">:</span>\n            <span class="token keyword">return</span> <span class="token function">getBaseSpeed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">case</span> AFRICAN<span class="token operator">:</span>\n            <span class="token keyword">return</span> <span class="token function">getBaseSpeed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span> <span class="token function">getLoadFactor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span> numberOfCoconuts<span class="token punctuation">;</span>\n        <span class="token keyword">case</span> NORWEGIAN_BLUE<span class="token operator">:</span>\n            <span class="token keyword">return</span> isNailed <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> <span class="token function">getBaseSpeed</span><span class="token punctuation">(</span>voltage<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">"Should be unreachable"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="引入-null-对象"><a href="#%E5%BC%95%E5%85%A5-null-%E5%AF%B9%E8%B1%A1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>引入 Null 对象</h2>\n<blockquote>\n<p>Introduce Null Object</p>\n</blockquote>\n<p>将 null 值替换为 null 对象。这样做的好处在于，不需要询问对象是否为空，直接调用就行。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="16053601964056097000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`if (customer == null) plan = BillingPlan.basic();\nelse plan = customer.getPlan();`, `16053601964056097000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="java"\n              >\n                <span class="gatsby-code-button-language">java</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="java"><pre style="counter-reset: linenumber NaN" class="language-java line-numbers"><code class="language-java"><span class="token keyword">if</span> <span class="token punctuation">(</span>customer <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> plan <span class="token operator">=</span> <span class="token class-name">BillingPlan</span><span class="token punctuation">.</span><span class="token function">basic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">else</span> plan <span class="token operator">=</span> customer<span class="token punctuation">.</span><span class="token function">getPlan</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>\n<h2 id="引入断言"><a href="#%E5%BC%95%E5%85%A5%E6%96%AD%E8%A8%80" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>引入断言</h2>\n<blockquote>\n<p>Introduce Assertion</p>\n</blockquote>\n<p>以断言明确表现某种假设。断言只能用于开发过程中，产品代码中不会有断言。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="4957190389979815000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`double getExpenseLimit() {\n    // should have either expense limit or a primary project\n    return (expenseLimit != NULL_EXPENSE) ? expenseLimit :  primaryProject.getMemberExpenseLimit();\n}`, `4957190389979815000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="java"\n              >\n                <span class="gatsby-code-button-language">java</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="java"><pre style="counter-reset: linenumber NaN" class="language-java line-numbers"><code class="language-java"><span class="token keyword">double</span> <span class="token function">getExpenseLimit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// should have either expense limit or a primary project</span>\n    <span class="token keyword">return</span> <span class="token punctuation">(</span>expenseLimit <span class="token operator">!=</span> NULL_EXPENSE<span class="token punctuation">)</span> <span class="token operator">?</span> expenseLimit <span class="token operator">:</span>  primaryProject<span class="token punctuation">.</span><span class="token function">getMemberExpenseLimit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="84203886788375630000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`double getExpenseLimit() {\n    Assert.isTrue (expenseLimit != NULL_EXPENSE || primaryProject != null);\n    return (expenseLimit != NULL_EXPENSE) ? expenseLimit :  primaryProject.getMemberExpenseLimit();\n}`, `84203886788375630000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="java"\n              >\n                <span class="gatsby-code-button-language">java</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="java"><pre style="counter-reset: linenumber NaN" class="language-java line-numbers"><code class="language-java"><span class="token keyword">double</span> <span class="token function">getExpenseLimit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token class-name">Assert</span><span class="token punctuation">.</span>isTrue <span class="token punctuation">(</span>expenseLimit <span class="token operator">!=</span> NULL_EXPENSE <span class="token operator">||</span> primaryProject <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">return</span> <span class="token punctuation">(</span>expenseLimit <span class="token operator">!=</span> NULL_EXPENSE<span class="token punctuation">)</span> <span class="token operator">?</span> expenseLimit <span class="token operator">:</span>  primaryProject<span class="token punctuation">.</span><span class="token function">getMemberExpenseLimit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>\n<h1 id="简化函数调用"><a href="#%E7%AE%80%E5%8C%96%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>简化函数调用</h1>\n<h2 id="函数改名"><a href="#%E5%87%BD%E6%95%B0%E6%94%B9%E5%90%8D" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>函数改名</h2>\n<blockquote>\n<p>Rename Method</p>\n</blockquote>\n<p>使函数名能解释函数的用途。</p>\n<h2 id="添加参数"><a href="#%E6%B7%BB%E5%8A%A0%E5%8F%82%E6%95%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>添加参数</h2>\n<blockquote>\n<p>Add Parameter</p>\n</blockquote>\n<p>使函数不需要通过调用获得某个信息。</p>\n<h2 id="移除参数"><a href="#%E7%A7%BB%E9%99%A4%E5%8F%82%E6%95%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>移除参数</h2>\n<blockquote>\n<p>Remove Parameter</p>\n</blockquote>\n<p>与 Add Parameter 相反，改用调用的方式来获得某个信息。</p>\n<h2 id="将查询函数和修改函数分离"><a href="#%E5%B0%86%E6%9F%A5%E8%AF%A2%E5%87%BD%E6%95%B0%E5%92%8C%E4%BF%AE%E6%94%B9%E5%87%BD%E6%95%B0%E5%88%86%E7%A6%BB" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>将查询函数和修改函数分离</h2>\n<blockquote>\n<p>Separate Query from Modifier</p>\n</blockquote>\n<p>某个函数即返回对象状态值，又修改对象状态。</p>\n<p>应当建立两个不同的函数，其中一个负责查询，另一个负责修改。任何有返回值的函数，都不应该有看得到的副作用。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="25425368205776368000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`getTotalOutstandingAndSetReadyForSummaries();`, `25425368205776368000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="java"\n              >\n                <span class="gatsby-code-button-language">java</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="java"><pre style="counter-reset: linenumber NaN" class="language-java line-numbers"><code class="language-java"><span class="token function">getTotalOutstandingAndSetReadyForSummaries</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="32341359865415287000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`getTotalOutstanding();\nsetReadyForSummaries();`, `32341359865415287000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="java"\n              >\n                <span class="gatsby-code-button-language">java</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="java"><pre style="counter-reset: linenumber NaN" class="language-java line-numbers"><code class="language-java"><span class="token function">getTotalOutstanding</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token function">setReadyForSummaries</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>\n<h2 id="令函数携带参数"><a href="#%E4%BB%A4%E5%87%BD%E6%95%B0%E6%90%BA%E5%B8%A6%E5%8F%82%E6%95%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>令函数携带参数</h2>\n<blockquote>\n<p>Parameterize Method</p>\n</blockquote>\n<p>若干函数做了类似的工作，但在函数本体中却包含了不同的值。</p>\n<p>建立单一函数，以参数表达那些不同的值。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="70082190783658800000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fivePercentRaise();\ntenPercentRaise();`, `70082190783658800000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="java"\n              >\n                <span class="gatsby-code-button-language">java</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="java"><pre style="counter-reset: linenumber NaN" class="language-java line-numbers"><code class="language-java"><span class="token function">fivePercentRaise</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token function">tenPercentRaise</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="31362689261425115000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`raise(percentage);`, `31362689261425115000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="java"\n              >\n                <span class="gatsby-code-button-language">java</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="java"><pre style="counter-reset: linenumber NaN" class="language-java line-numbers"><code class="language-java"><span class="token function">raise</span><span class="token punctuation">(</span>percentage<span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>\n<h2 id="以明确函数取代参数"><a href="#%E4%BB%A5%E6%98%8E%E7%A1%AE%E5%87%BD%E6%95%B0%E5%8F%96%E4%BB%A3%E5%8F%82%E6%95%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>以明确函数取代参数</h2>\n<blockquote>\n<p>Replace Parameter with Explicit Methods</p>\n</blockquote>\n<p>有一个函数，完全取决于参数值而采取不同行为。</p>\n<p>针对该参数的每一个可能值，建立一个独立函数。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="4537766463181314000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`void setValue(String name, int value){\n    if (name.equals(&quot;height&quot;)){\n        height = value;\n        return;\n    }\n    if (name.equals(&quot;width&quot;)){\n        width = value;\n        return;\n    }\n    Assert.shouldNeverReachHere();\n}`, `4537766463181314000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="java"\n              >\n                <span class="gatsby-code-button-language">java</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="java"><pre style="counter-reset: linenumber NaN" class="language-java line-numbers"><code class="language-java"><span class="token keyword">void</span> <span class="token function">setValue</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token keyword">int</span> value<span class="token punctuation">)</span><span class="token punctuation">{</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span>name<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"height"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>\n        height <span class="token operator">=</span> value<span class="token punctuation">;</span>\n        <span class="token keyword">return</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span>name<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"width"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>\n        width <span class="token operator">=</span> value<span class="token punctuation">;</span>\n        <span class="token keyword">return</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token class-name">Assert</span><span class="token punctuation">.</span><span class="token function">shouldNeverReachHere</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="32294253543764470000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`void setHeight(int arg){\n    height = arg;\n}\nvoid setWidth(int arg){\n    width = arg;\n}`, `32294253543764470000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="java"\n              >\n                <span class="gatsby-code-button-language">java</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="java"><pre style="counter-reset: linenumber NaN" class="language-java line-numbers"><code class="language-java"><span class="token keyword">void</span> <span class="token function">setHeight</span><span class="token punctuation">(</span><span class="token keyword">int</span> arg<span class="token punctuation">)</span><span class="token punctuation">{</span>\n    height <span class="token operator">=</span> arg<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">void</span> <span class="token function">setWidth</span><span class="token punctuation">(</span><span class="token keyword">int</span> arg<span class="token punctuation">)</span><span class="token punctuation">{</span>\n    width <span class="token operator">=</span> arg<span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="保持对象完整"><a href="#%E4%BF%9D%E6%8C%81%E5%AF%B9%E8%B1%A1%E5%AE%8C%E6%95%B4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>保持对象完整</h2>\n<blockquote>\n<p>Preserve Whole Object</p>\n</blockquote>\n<p>从某个对象中取出若干值，将它们作为某一次函数调用时的参数。</p>\n<p>改为传递整个对象。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="40889166407782600000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`int low = daysTempRange().getLow();\nint high = daysTempRange().getHigh();\nwithinPlan = plan.withinRange(low,high);`, `40889166407782600000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="java"\n              >\n                <span class="gatsby-code-button-language">java</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="java"><pre style="counter-reset: linenumber NaN" class="language-java line-numbers"><code class="language-java"><span class="token keyword">int</span> low <span class="token operator">=</span> <span class="token function">daysTempRange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getLow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">int</span> high <span class="token operator">=</span> <span class="token function">daysTempRange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getHigh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nwithinPlan <span class="token operator">=</span> plan<span class="token punctuation">.</span><span class="token function">withinRange</span><span class="token punctuation">(</span>low<span class="token punctuation">,</span>high<span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="58714682156603515000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`withinPlan = plan.withinRange(daysTempRange());`, `58714682156603515000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="java"\n              >\n                <span class="gatsby-code-button-language">java</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="java"><pre style="counter-reset: linenumber NaN" class="language-java line-numbers"><code class="language-java">withinPlan <span class="token operator">=</span> plan<span class="token punctuation">.</span><span class="token function">withinRange</span><span class="token punctuation">(</span><span class="token function">daysTempRange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>\n<h2 id="以函数取代参数"><a href="#%E4%BB%A5%E5%87%BD%E6%95%B0%E5%8F%96%E4%BB%A3%E5%8F%82%E6%95%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>以函数取代参数</h2>\n<blockquote>\n<p>Replace Parameter with Methods</p>\n</blockquote>\n<p>对象调用某个函数，并将所得结果作为参数，传递给另一个函数。而接受该参数的函数本身也能够调用前一个函数。</p>\n<p>让参数接收者去除该项参数，而是直接调用前一个函数。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="302758221566734600"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`int basePrice = _quantity * _itemPrice;\ndiscountLevel = getDiscountLevel();\ndouble finalPrice = discountedPrice (basePrice, discountLevel);`, `302758221566734600`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="java"\n              >\n                <span class="gatsby-code-button-language">java</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="java"><pre style="counter-reset: linenumber NaN" class="language-java line-numbers"><code class="language-java"><span class="token keyword">int</span> basePrice <span class="token operator">=</span> _quantity <span class="token operator">*</span> _itemPrice<span class="token punctuation">;</span>\ndiscountLevel <span class="token operator">=</span> <span class="token function">getDiscountLevel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">double</span> finalPrice <span class="token operator">=</span> discountedPrice <span class="token punctuation">(</span>basePrice<span class="token punctuation">,</span> discountLevel<span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="89013189319007750000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`int basePrice = _quantity * _itemPrice;\ndouble finalPrice = discountedPrice (basePrice);`, `89013189319007750000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="java"\n              >\n                <span class="gatsby-code-button-language">java</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="java"><pre style="counter-reset: linenumber NaN" class="language-java line-numbers"><code class="language-java"><span class="token keyword">int</span> basePrice <span class="token operator">=</span> _quantity <span class="token operator">*</span> _itemPrice<span class="token punctuation">;</span>\n<span class="token keyword">double</span> finalPrice <span class="token operator">=</span> discountedPrice <span class="token punctuation">(</span>basePrice<span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>\n<h2 id="引入参数对象"><a href="#%E5%BC%95%E5%85%A5%E5%8F%82%E6%95%B0%E5%AF%B9%E8%B1%A1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>引入参数对象</h2>\n<blockquote>\n<p>Introduce Parameter Object</p>\n</blockquote>\n<p>某些参数总是很自然地同时出现，这些参数就是 Data Clumps。</p>\n<p>以一个对象取代这些参数。</p>\n<h2 id="移除设值函数"><a href="#%E7%A7%BB%E9%99%A4%E8%AE%BE%E5%80%BC%E5%87%BD%E6%95%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>移除设值函数</h2>\n<blockquote>\n<p>Remove Setting Method</p>\n</blockquote>\n<p>类中的某个字段应该在对象创建时被设值，然后就不再改变。</p>\n<p>去掉该字段的所有设值函数，并将该字段设为 final。</p>\n<h2 id="隐藏函数"><a href="#%E9%9A%90%E8%97%8F%E5%87%BD%E6%95%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>隐藏函数</h2>\n<blockquote>\n<p>Hide Method</p>\n</blockquote>\n<p>有一个函数，从来没有被其他任何类用到。</p>\n<p>将这个函数修改为 private。</p>\n<h2 id="以工厂函数取代构造函数"><a href="#%E4%BB%A5%E5%B7%A5%E5%8E%82%E5%87%BD%E6%95%B0%E5%8F%96%E4%BB%A3%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>以工厂函数取代构造函数</h2>\n<blockquote>\n<p>Replace Constructor with Factory Method</p>\n</blockquote>\n<p>希望在创建对象时不仅仅是做简单的建构动作。</p>\n<p>将构造函数替换为工厂函数。</p>\n<h2 id="封装向下转型"><a href="#%E5%B0%81%E8%A3%85%E5%90%91%E4%B8%8B%E8%BD%AC%E5%9E%8B" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>封装向下转型</h2>\n<blockquote>\n<p>Encapsulate Downcast</p>\n</blockquote>\n<p>某个函数返回的对象，需要由函数调用者执行向下转型（downcast）。</p>\n<p>将向下转型动作移到函数中。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="11559257267062862000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`Object lastReading(){\n    return readings.lastElement();\n}`, `11559257267062862000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="java"\n              >\n                <span class="gatsby-code-button-language">java</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="java"><pre style="counter-reset: linenumber NaN" class="language-java line-numbers"><code class="language-java"><span class="token class-name">Object</span> <span class="token function">lastReading</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>\n    <span class="token keyword">return</span> readings<span class="token punctuation">.</span><span class="token function">lastElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="46641042930075296000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`Reading lastReading(){\n    return (Reading)readings.lastElement();\n}`, `46641042930075296000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="java"\n              >\n                <span class="gatsby-code-button-language">java</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="java"><pre style="counter-reset: linenumber NaN" class="language-java line-numbers"><code class="language-java"><span class="token class-name">Reading</span> <span class="token function">lastReading</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>\n    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">Reading</span><span class="token punctuation">)</span>readings<span class="token punctuation">.</span><span class="token function">lastElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<h2 id="以异常取代错误码"><a href="#%E4%BB%A5%E5%BC%82%E5%B8%B8%E5%8F%96%E4%BB%A3%E9%94%99%E8%AF%AF%E7%A0%81" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>以异常取代错误码</h2>\n<blockquote>\n<p>Replace Error Code with Exception</p>\n</blockquote>\n<p>某个函数返回一个特定的代码，用以表示某种错误情况。</p>\n<p>改用异常，异常将普通程序和错误处理分开，使代码更容易理解。</p>\n<h2 id="以测试取代异常"><a href="#%E4%BB%A5%E6%B5%8B%E8%AF%95%E5%8F%96%E4%BB%A3%E5%BC%82%E5%B8%B8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>以测试取代异常</h2>\n<blockquote>\n<p>Replace Exception with Test</p>\n</blockquote>\n<p>面对一个调用者可以预先检查的条件，你抛出了一个异常。</p>\n<p>修改调用者，使它在调用函数之前先做检查。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="4117111151957209000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`double getValueForPeriod(int periodNumber) {\n    try {\n        return values[periodNumber];\n    } catch (ArrayIndexOutOfBoundsException e) {\n        return 0;\n    }\n}`, `4117111151957209000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="java"\n              >\n                <span class="gatsby-code-button-language">java</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="java"><pre style="counter-reset: linenumber NaN" class="language-java line-numbers"><code class="language-java"><span class="token keyword">double</span> <span class="token function">getValueForPeriod</span><span class="token punctuation">(</span><span class="token keyword">int</span> periodNumber<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">try</span> <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> values<span class="token punctuation">[</span>periodNumber<span class="token punctuation">]</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ArrayIndexOutOfBoundsException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="63045276380350070000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`double getValueForPeriod(int periodNumber) {\n    if (periodNumber >= values.length) return 0;\n    return values[periodNumber];`, `63045276380350070000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="java"\n              >\n                <span class="gatsby-code-button-language">java</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="java"><pre style="counter-reset: linenumber NaN" class="language-java line-numbers"><code class="language-java"><span class="token keyword">double</span> <span class="token function">getValueForPeriod</span><span class="token punctuation">(</span><span class="token keyword">int</span> periodNumber<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span>periodNumber <span class="token operator">>=</span> values<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>\n    <span class="token keyword">return</span> values<span class="token punctuation">[</span>periodNumber<span class="token punctuation">]</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<h1 id="处理概括关系"><a href="#%E5%A4%84%E7%90%86%E6%A6%82%E6%8B%AC%E5%85%B3%E7%B3%BB" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>处理概括关系</h1>\n<h2 id="字段上移"><a href="#%E5%AD%97%E6%AE%B5%E4%B8%8A%E7%A7%BB" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>字段上移</h2>\n<blockquote>\n<p>Pull Up Field</p>\n</blockquote>\n<p>两个子类拥有相同的字段。</p>\n<p>将该字段移至超类。</p>\n<h2 id="函数上移"><a href="#%E5%87%BD%E6%95%B0%E4%B8%8A%E7%A7%BB" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>函数上移</h2>\n<blockquote>\n<p>Pull Up Method</p>\n</blockquote>\n<p>有些函数，在各个子类中产生完全相同的结果。</p>\n<p>将该函数移至超类。</p>\n<h2 id="构造函数本体上移"><a href="#%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E6%9C%AC%E4%BD%93%E4%B8%8A%E7%A7%BB" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>构造函数本体上移</h2>\n<blockquote>\n<p>Pull Up Constructor Body</p>\n</blockquote>\n<p>你在各个子类中拥有一些构造函数，它们的本体几乎完全一致。</p>\n<p>在超类中新建一个构造函数，并在子类构造函数中调用它。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="2806038460375859000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class Manager extends Employee...\n\npublic Manager(String name, String id, int grade) {\n    this.name = name;\n    this.id = id;\n    this.grade = grade;\n}`, `2806038460375859000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="java"\n              >\n                <span class="gatsby-code-button-language">java</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="java"><pre style="counter-reset: linenumber NaN" class="language-java line-numbers"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Manager</span> <span class="token keyword">extends</span> <span class="token class-name">Employee</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\n\n<span class="token keyword">public</span> <span class="token class-name">Manager</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token class-name">String</span> id<span class="token punctuation">,</span> <span class="token keyword">int</span> grade<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>grade <span class="token operator">=</span> grade<span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="43368279519597855000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`public Manager(String name, String id, int grade) {\n    super(name, id);\n    this.grade = grade;\n}`, `43368279519597855000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="java"\n              >\n                <span class="gatsby-code-button-language">java</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="java"><pre style="counter-reset: linenumber NaN" class="language-java line-numbers"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">Manager</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token class-name">String</span> id<span class="token punctuation">,</span> <span class="token keyword">int</span> grade<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>grade <span class="token operator">=</span> grade<span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="函数下移"><a href="#%E5%87%BD%E6%95%B0%E4%B8%8B%E7%A7%BB" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>函数下移</h2>\n<blockquote>\n<p>Push Down Method</p>\n</blockquote>\n<p>超类中的某个函数只与部分子类有关。</p>\n<p>将这个函数移到相关的那些子类去。</p>\n<h2 id="字段下移"><a href="#%E5%AD%97%E6%AE%B5%E4%B8%8B%E7%A7%BB" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>字段下移</h2>\n<blockquote>\n<p>Push Down Field</p>\n</blockquote>\n<p>超类中的某个字段只被部分子类用到。</p>\n<p>将这个字段移到需要它的那些子类去。</p>\n<h2 id="提炼子类"><a href="#%E6%8F%90%E7%82%BC%E5%AD%90%E7%B1%BB" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>提炼子类</h2>\n<blockquote>\n<p>Extract Subclass</p>\n</blockquote>\n<p>类中的某些特性只被某些实例用到。</p>\n<p>新建一个子类，将上面所说的那一部分特性移到子类中。</p>\n<h2 id="提炼超类"><a href="#%E6%8F%90%E7%82%BC%E8%B6%85%E7%B1%BB" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>提炼超类</h2>\n<blockquote>\n<p>Extract Superclass</p>\n</blockquote>\n<p>两个类有相似特性。</p>\n<p>为这两个类建立一个超类，将相同特性移至超类。</p>\n<h2 id="提炼接口"><a href="#%E6%8F%90%E7%82%BC%E6%8E%A5%E5%8F%A3" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>提炼接口</h2>\n<blockquote>\n<p>Extract Interface</p>\n</blockquote>\n<p>若干客户使用类接口中的同一子集，或者两个类的接口有部分相同。</p>\n<p>将相同的子集提炼到一个独立接口中。</p>\n<h2 id="折叠继承体系"><a href="#%E6%8A%98%E5%8F%A0%E7%BB%A7%E6%89%BF%E4%BD%93%E7%B3%BB" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>折叠继承体系</h2>\n<blockquote>\n<p>Collapse Hierarchy</p>\n</blockquote>\n<p>超类和子类之间无太大区别。</p>\n<p>将它们合为一体。</p>\n<h2 id="塑造模板函数"><a href="#%E5%A1%91%E9%80%A0%E6%A8%A1%E6%9D%BF%E5%87%BD%E6%95%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>塑造模板函数</h2>\n<blockquote>\n<p>Form Template Method</p>\n</blockquote>\n<p>你有一些子类，其中相应的某些函数以相同顺序执行类似的操作，但各个操作的细节上有所不同。</p>\n<p>将这些操作分别放进独立函数中，并保持它们都有相同的签名，于是原函数也就变得相同了。然后将原函数上移至超类。(模板方法模式)</p>\n<h2 id="以委托取代继承"><a href="#%E4%BB%A5%E5%A7%94%E6%89%98%E5%8F%96%E4%BB%A3%E7%BB%A7%E6%89%BF" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>以委托取代继承</h2>\n<blockquote>\n<p>Replace Inheritance with Delegation</p>\n</blockquote>\n<p>某个子类只使用超类接口中的一部分，或是根本不需要继承而来的数据。</p>\n<p>在子类中新建一个字段用以保存超类，调整子类函数，令它改而委托超类，然后去掉两者之间的继承关系。</p>\n<h2 id="以继承取代委托"><a href="#%E4%BB%A5%E7%BB%A7%E6%89%BF%E5%8F%96%E4%BB%A3%E5%A7%94%E6%89%98" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>以继承取代委托</h2>\n<blockquote>\n<p>Replace Delegation with Inheritance</p>\n</blockquote>\n<p>你在两个类之间使用委托关系，并经常为整个接口编写许多极简单的委托函数。</p>\n<p>让委托类继承受托类。</p>\n<h1 id="参考资料"><a href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>参考资料</h1>\n<ul>\n<li>MartinFowler, 福勒, 贝克, 等. 重构: 改善既有代码的设计 [M]. 电子工业出版社, 2011.</li>\n</ul>',
id:"/home/runner/work/GatsbyBlog/GatsbyBlog/blog/代码重构/index.md absPath of file >>> MarkdownRemark",timeToRead:26,frontmatter:{date:"2018-04-04 13:11:28",path:"/code-restructure/",tags:"面试, 编码实践, 代码重构, 读书笔记",title:"代码重构",draft:null}},{excerpt:"一、存储引擎 InnoDB InnoDB 是 MySQL 默认的事务型存储引擎，只有在需要 InnoDB 不支持的特性时，才考虑使用其它存储引擎。 采用 MVCC 来支持高并发，并且实现了四个标准的隔离级别，默认级别是可重复读。 表是基于聚簇索引建立的，它对主键的查询性能有很高的提升。 内部做了很多优化，包括从磁盘读取数据时采用的可预测性读、能够自动在内存中创建哈希索引以加速读操作的自适应哈希索引、能够加速插入操作的插入缓冲区等。 通过一些机制和工具支持真正的热备份。 MyISAM MyISAM…",html:'<h1 id="一、存储引擎"><a href="#%E4%B8%80%E3%80%81%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>一、存储引擎</h1>\n<h2 id="innodb"><a href="#innodb" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>InnoDB</h2>\n<p>InnoDB 是 MySQL 默认的事务型存储引擎，只有在需要 InnoDB 不支持的特性时，才考虑使用其它存储引擎。</p>\n<p>采用 MVCC 来支持高并发，并且实现了四个标准的隔离级别，默认级别是可重复读。</p>\n<p>表是基于聚簇索引建立的，它对主键的查询性能有很高的提升。</p>\n<p>内部做了很多优化，包括从磁盘读取数据时采用的可预测性读、能够自动在内存中创建哈希索引以加速读操作的自适应哈希索引、能够加速插入操作的插入缓冲区等。</p>\n<p>通过一些机制和工具支持真正的热备份。</p>\n<h2 id="myisam"><a href="#myisam" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>MyISAM</h2>\n<p>MyISAM 提供了大量的特性，包括全文索引、压缩、空间函数（GIS）等。但 MyISAM 不支持事务和行级锁，而且崩溃后无法安全恢复。</p>\n<p>只能对整张表加锁，而不是针对行。</p>\n<p>可以手工或者自动执行检查和修复操作，但是和事务恢复以及崩溃恢复不同，可能导致一些数据丢失，而且修复操作是非常慢的。</p>\n<p>可以包含动态或者静态的行。</p>\n<p>如果指定了 DELAY<em>KEY</em>WRITE 选项，在每次修改执行完成时，不会立即将修改的索引数据写入磁盘，而是会写到内存中的键缓冲区，只有在清理键缓冲区或者关闭表的时候才会将对应的索引块写入磁盘。这种方式可以极大的提升写入性能，但是在数据库或者主机崩溃时会造成索引损坏，需要执行修复操作。</p>\n<p>如果表在创建并导入数据以后，不会再进行修改操作，那么这样的表适合采用 MyISAM 压缩表。</p>\n<p>对于只读数据，或者表比较小、可以容忍修复操作，则依然可以继续使用 MyISAM。</p>\n<p>MyISAM 设计简单，数据以紧密格式存储，所以在某些场景下性能很好。</p>\n<h2 id="比较"><a href="#%E6%AF%94%E8%BE%83" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>比较</h2>\n<ol>\n<li>事务：InnoDB 是事务型的。</li>\n<li>备份：InnoDB 支持在线热备份。</li>\n<li>崩溃恢复：MyISAM 崩溃后发生损坏的概率比 InnoDB 高很多，而且恢复的速度也更慢。</li>\n<li>并发：MyISAM 只支持表级锁，而 InnoDB 还支持行级锁。</li>\n<li>其它特性：MyISAM 支持全文索引，地理空间索引。</li>\n</ol>\n<h1 id="二、数据类型"><a href="#%E4%BA%8C%E3%80%81%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>二、数据类型</h1>\n<h2 id="整型"><a href="#%E6%95%B4%E5%9E%8B" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>整型</h2>\n<p>TINYINT, SMALLINT, MEDIUMINT, INT, BIGINT 分别使用 8, 16, 24, 32, 64 位存储空间，一般情况下越小的列越好。</p>\n<p>INT(11) 中的数字只是规定了交互工具显示字符的个数，对于存储和计算来说是没有意义的。</p>\n<h2 id="浮点数"><a href="#%E6%B5%AE%E7%82%B9%E6%95%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>浮点数</h2>\n<p>FLOAT 和 DOUBLE 为浮点类型，DECIMAL 为高精度小数类型。CPU 原生支持浮点运算，但是不支持 DECIMAl 类型的计算，因此 DECIMAL 的计算比浮点类型需要更高的代价。</p>\n<p>FLOAT、DOUBLE 和 DECIMAL 都可以指定列宽，例如 DECIMAL(18, 9) 表示总共 18 位，取 9 位存储小数部分，剩下 9 位存储整数部分。</p>\n<h2 id="字符串"><a href="#%E5%AD%97%E7%AC%A6%E4%B8%B2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>字符串</h2>\n<p>主要有 CHAR 和 VARCHAR 两种类型，一种是定长的，一种是变长的。</p>\n<p>VARCHAR 这种变长类型能够节省空间，因为只需要存储必要的内容。但是在执行 UPDATE 时可能会使行变得比原来长，当超出一个页所能容纳的大小时，就要执行额外的操作。MyISAM 会将行拆成不同的片段存储，而 InnoDB 则需要分裂页来使行放进页内。</p>\n<p>VARCHAR 会保留字符串末尾的空格，而 CHAR 会删除。</p>\n<h2 id="时间和日期"><a href="#%E6%97%B6%E9%97%B4%E5%92%8C%E6%97%A5%E6%9C%9F" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>时间和日期</h2>\n<p>MySQL 提供了两种相似的日期时间类型：DATATIME 和 TIMESTAMP。</p>\n<h3 id="1-datatime"><a href="#1-datatime" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. DATATIME</h3>\n<p>能够保存从 1001 年到 9999 年的日期和时间，精度为秒，使用 8 字节的存储空间。</p>\n<p>它与时区无关。</p>\n<p>默认情况下，MySQL 以一种可排序的、无歧义的格式显示 DATATIME 值，例如“2008-01-16 22:37:08”，这是 ANSI 标准定义的日期和时间表示方法。</p>\n<h3 id="2-timestamp"><a href="#2-timestamp" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. TIMESTAMP</h3>\n<p>和 UNIX 时间戳相同，保存从 1970 年 1 月 1 日午夜（格林威治时间）以来的秒数，使用 4 个字节，只能表示从 1970 年 到 2038 年。</p>\n<p>它和时区有关。</p>\n<p>MySQL 提供了 FROM<em>UNIXTIME() 函数把 UNIX 时间戳转换为日期，并提供了 UNIX</em>TIMESTAMP() 函数把日期转换为 UNIX 时间戳。</p>\n<p>默认情况下，如果插入时没有指定 TIMESTAMP 列的值，会将这个值设置为当前时间。</p>\n<p>应该尽量使用 TIMESTAMP，因为它比 DATETIME 空间效率更高。</p>\n<h1 id="三、索引"><a href="#%E4%B8%89%E3%80%81%E7%B4%A2%E5%BC%95" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>三、索引</h1>\n<p>索引是在存储引擎层实现的，而不是在服务器层实现的，所以不同存储引擎具有不同的索引类型和实现。</p>\n<p>索引能够轻易将查询性能提升几个数量级。</p>\n<p>对于非常小的表、大部分情况下简单的全表扫描比建立索引更高效。对于中到大型的表，索引就非常有效。但是对于特大型的表，建立和使用索引的代价将会随之增长。这种情况下，需要用到一种技术可以直接区分出需要查询的一组数据，而不是一条记录一条记录地匹配，例如可以使用分区技术。</p>\n<h2 id="索引分类"><a href="#%E7%B4%A2%E5%BC%95%E5%88%86%E7%B1%BB" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>索引分类</h2>\n<h3 id="1-btree-索引"><a href="#1-btree-%E7%B4%A2%E5%BC%95" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. B+Tree 索引</h3>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/c23957e9-a572-44f8-be15-f306c8b92722-a0b8518d6f1281a7707a9b3040cb37f2-065b3.jpg" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 700px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 65.42857142857143%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAIDAQX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAHtbRRiYf/EABkQAQACAwAAAAAAAAAAAAAAAAEAMRARIf/aAAgBAQABBQLcLw0HP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABcQAAMBAAAAAAAAAAAAAAAAAAAgMUH/2gAIAQEABj8ChU0//8QAHRAAAgIBBQAAAAAAAAAAAAAAAREAIRAxQVFxkf/aAAgBAQABPyEakQHLhg0c5G23Ucz9T//aAAwDAQACAAMAAAAQ88//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAbEAACAwEBAQAAAAAAAAAAAAABEQAhMVEQYf/aAAgBAQABPxA40gtRX2FhCqxWd9CVOm0M7iOPP//Z\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="c23957e9 a572 44f8 be15 f306c8b92722" title="" data-src="/static/c23957e9-a572-44f8-be15-f306c8b92722-a0b8518d6f1281a7707a9b3040cb37f2-065b3.jpg" data-srcset="/static/c23957e9-a572-44f8-be15-f306c8b92722-a0b8518d6f1281a7707a9b3040cb37f2-f88e0.jpg 200w,\n/static/c23957e9-a572-44f8-be15-f306c8b92722-a0b8518d6f1281a7707a9b3040cb37f2-8f330.jpg 400w,\n/static/c23957e9-a572-44f8-be15-f306c8b92722-a0b8518d6f1281a7707a9b3040cb37f2-065b3.jpg 700w" data-sizes="(max-width: 700px) 100vw, 700px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>《高性能 MySQL》一书使用 B-Tree 进行描述，其实从技术上来说这种索引是 B+Tree。</p>\n<p>B+Tree 索引是大多数 MySQL 存储引擎的默认索引类型。</p>\n<p>因为不再需要进行全表扫描，只需要对树进行搜索即可，因此查找速度快很多。</p>\n<p>可以指定多个列作为索引列，多个索引列共同组成键。B+Tree 索引适用于全键值、键值范围和键前缀查找，其中键前缀查找只适用于最左前缀查找。</p>\n<p>除了用于查找，还可以用于排序和分组。</p>\n<p>如果不是按照索引列的顺序进行查找，则无法使用索引。</p>\n<h3 id="2-哈希索引"><a href="#2-%E5%93%88%E5%B8%8C%E7%B4%A2%E5%BC%95" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. 哈希索引</h3>\n<p>基于哈希表实现，优点是查找非常快。</p>\n<p>在 MySQL 中只有 Memory 引擎显式支持哈希索引。</p>\n<p>InnoDB 引擎有一个特殊的功能叫“自适应哈希索引”，当某个索引值被使用的非常频繁时，会在 B+Tree 索引之上再创建一个哈希索引，这样就让 B+Tree 索引具有哈希索引的一些优点，比如快速的哈希查找。</p>\n<p>限制：哈希索引只包含哈希值和行指针，而不存储字段值，所以不能使用索引中的值来避免读取行。不过，访问内存中的行的速度很快，所以大部分情况下这一点对性能影响并不明显；无法用于分组与排序；只支持精确查找，无法用于部分查找和范围查找；如果哈希冲突很多，查找速度会变得很慢。</p>\n<h3 id="3-空间索引（r-tree）"><a href="#3-%E7%A9%BA%E9%97%B4%E7%B4%A2%E5%BC%95%EF%BC%88r-tree%EF%BC%89" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. 空间索引（R-Tree）</h3>\n<p>MyISAM 存储引擎支持空间索引，可以用于地理数据存储。</p>\n<p>空间索引会从所有维度来索引数据，可以有效地使用任意维度来进行组合查询。</p>\n<h3 id="4-全文索引"><a href="#4-%E5%85%A8%E6%96%87%E7%B4%A2%E5%BC%95" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4. 全文索引</h3>\n<p>MyISAM 存储引擎支持全文索引，用于查找文本中的关键词，而不是直接比较索引中的值。</p>\n<p>使用 MATCH AGAINST，而不是普通的 WHERE。</p>\n<h2 id="索引的优点"><a href="#%E7%B4%A2%E5%BC%95%E7%9A%84%E4%BC%98%E7%82%B9" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>索引的优点</h2>\n<ul>\n<li>\n<p>大大减少了服务器需要扫描的数据量；</p>\n</li>\n<li>\n<p>避免服务器进行排序和创建临时表；</p>\n</li>\n<li>\n<p>将随机 I/O 变为顺序 I/O。</p>\n</li>\n</ul>\n<h2 id="索引优化"><a href="#%E7%B4%A2%E5%BC%95%E4%BC%98%E5%8C%96" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>索引优化</h2>\n<h3 id="1-独立的列"><a href="#1-%E7%8B%AC%E7%AB%8B%E7%9A%84%E5%88%97" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. 独立的列</h3>\n<p>在进行查询时，索引列不能是表达式的一部分，也不能是函数的参数，否则无法使用索引。</p>\n<p>例如下面的查询不能使用 actor_id 列的索引：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="80031255930169820000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`SELECT actor_id FROM sakila.actor WHERE actor_id + 1 = 5;`, `80031255930169820000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql"><span class="token keyword">SELECT</span> actor_id <span class="token keyword">FROM</span> sakila<span class="token punctuation">.</span>actor <span class="token keyword">WHERE</span> actor_id <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>\n<h3 id="2-前缀索引"><a href="#2-%E5%89%8D%E7%BC%80%E7%B4%A2%E5%BC%95" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. 前缀索引</h3>\n<p>对于 BLOB、TEXT 和 VARCHAR 类型的列，必须使用前缀索引，只索引开始的部分字符。</p>\n<p>对于前缀长度的选取需要根据 <strong>索引选择性</strong> 来确定：不重复的索引值和记录总数的比值。选择性越高，查询效率也越高。最大值为 1，此时每个记录都有唯一的索引与其对应。</p>\n<h3 id="3-多列索引"><a href="#3-%E5%A4%9A%E5%88%97%E7%B4%A2%E5%BC%95" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. 多列索引</h3>\n<p>在需要使用多个列作为条件进行查询时，使用多列索引比使用多个单列索引性能更好。例如下面的语句中，最好把 actor<em>id 和 film</em>id 设置为多列索引。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="92179482543427800000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`SELECT film_id, actor_id FROM sakila.film_actor\nWhERE actor_id = 1 AND film_id = 1;`, `92179482543427800000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql"><span class="token keyword">SELECT</span> film_id<span class="token punctuation">,</span> actor_id <span class="token keyword">FROM</span> sakila<span class="token punctuation">.</span>film_actor\n<span class="token keyword">WhERE</span> actor_id <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">AND</span> film_id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>\n<h3 id="4-索引列的顺序"><a href="#4-%E7%B4%A2%E5%BC%95%E5%88%97%E7%9A%84%E9%A1%BA%E5%BA%8F" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4. 索引列的顺序</h3>\n<p>让选择性最强的索引列放在前面，例如下面显示的结果中 customer<em>id 的选择性比 staff</em>id 更高，因此最好把 customer_id 列放在多列索引的前面。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="11438751223347853000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`SELECT COUNT(DISTINCT staff_id)/COUNT(*) AS staff_id_selectivity,\nCOUNT(DISTINCT customer_id)/COUNT(*) AS customer_id_selectivity,\nCOUNT(*)\nFROM payment;`, `11438751223347853000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql"><span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token keyword">DISTINCT</span> staff_id<span class="token punctuation">)</span><span class="token operator">/</span><span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> staff_id_selectivity<span class="token punctuation">,</span>\n<span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token keyword">DISTINCT</span> customer_id<span class="token punctuation">)</span><span class="token operator">/</span><span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> customer_id_selectivity<span class="token punctuation">,</span>\n<span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>\n<span class="token keyword">FROM</span> payment<span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="45487382662695030000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`   staff_id_selectivity: 0.0001\ncustomer_id_selectivity: 0.0373\n               COUNT(*): 16049`, `45487382662695030000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql">   staff_id_selectivity: <span class="token number">0.0001</span>\ncustomer_id_selectivity: <span class="token number">0.0373</span>\n               <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>: <span class="token number">16049</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<h3 id="5-聚簇索引"><a href="#5-%E8%81%9A%E7%B0%87%E7%B4%A2%E5%BC%95" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>5. 聚簇索引</h3>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/e800b001-7779-495b-8459-d33a7440d7b8-e962109baf7c02b47eb8dd1d97b4b0ab-065b3.jpg" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 700px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 73.28571428571429%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAIDBAX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAHsu0S5mD//xAAaEAEAAgMBAAAAAAAAAAAAAAABABECAxAS/9oACAEBAAEFAn1KOJcaxXa3/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAGRAAAgMBAAAAAAAAAAAAAAAAAAEgITEy/9oACAEBAAY/AsUFRyf/xAAbEAEBAQACAwAAAAAAAAAAAAABEQAQITGBsf/aAAgBAQABPyFMfpiBQvACOLFqeO8CCve//9oADAMBAAIAAwAAABCjz//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABwQAQACAgMBAAAAAAAAAAAAAAEAESFBEDFh8P/aAAgBAQABPxAr14vBmLV90784RnY+w+WBR0fmMkg3Un//2Q==\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="e800b001 7779 495b 8459 d33a7440d7b8" title="" data-src="/static/e800b001-7779-495b-8459-d33a7440d7b8-e962109baf7c02b47eb8dd1d97b4b0ab-065b3.jpg" data-srcset="/static/e800b001-7779-495b-8459-d33a7440d7b8-e962109baf7c02b47eb8dd1d97b4b0ab-f88e0.jpg 200w,\n/static/e800b001-7779-495b-8459-d33a7440d7b8-e962109baf7c02b47eb8dd1d97b4b0ab-8f330.jpg 400w,\n/static/e800b001-7779-495b-8459-d33a7440d7b8-e962109baf7c02b47eb8dd1d97b4b0ab-065b3.jpg 700w" data-sizes="(max-width: 700px) 100vw, 700px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>聚簇索引并不是一种索引类型，而是一种数据存储方式。</p>\n<p>术语“聚簇”表示数据行和相邻的键值紧密地存储在一起，InnoDB 的聚簇索引的数据行存放在 B+Tree 的叶子页中。</p>\n<p>因为无法把数据行存放在两个不同的地方，所以一个表只能有一个聚簇索引。</p>\n<p><strong>优点</strong></p>\n<ol>\n<li>可以把相关数据保存在一起，减少 I/O 操作；</li>\n<li>因为数据保存在 B+Tree 中，因此数据访问更快。</li>\n</ol>\n<p><strong>缺点</strong></p>\n<ol>\n<li>聚簇索引最大限度提高了 I/O 密集型应用的性能，但是如果数据全部放在内存，就没必要用聚簇索引。</li>\n<li>插入速度严重依赖于插入顺序，按主键的顺序插入是最快的。</li>\n<li>更新操作代价很高，因为每个被更新的行都会移动到新的位置。</li>\n<li>当插入到某个已满的页中，存储引擎会将该页分裂成两个页面来容纳该行，页分裂会导致表占用更多的磁盘空间。</li>\n<li>如果行比较稀疏，或者由于页分裂导致数据存储不连续时，聚簇索引可能导致全表扫描速度变慢。</li>\n</ol>\n<h3 id="6-覆盖索引"><a href="#6-%E8%A6%86%E7%9B%96%E7%B4%A2%E5%BC%95" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>6. 覆盖索引</h3>\n<p>索引包含所有需要查询的字段的值。</p>\n<p><strong>优点</strong></p>\n<ol>\n<li>因为索引条目通常远小于数据行的大小，所以若只读取索引，能大大减少数据访问量。</li>\n<li>一些存储引擎（例如 MyISAM）在内存中只缓存索引，而数据依赖于操作系统来缓存。因此，只访问索引可以不使用系统调用（通常比较费时）。</li>\n<li>对于 InnoDB 引擎，若二级索引能够覆盖查询，则无需访问聚簇索引。</li>\n</ol>\n<h2 id="b-tree-和-btree-原理"><a href="#b-tree-%E5%92%8C-btree-%E5%8E%9F%E7%90%86" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>B-Tree 和 B+Tree 原理</h2>\n<h3 id="1-b-tree"><a href="#1-b-tree" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. B-Tree</h3>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/5ed71283-a070-4b21-85ae-f2cbfd6ba6e1-9d09686de3b660727e20c1bc54d1b1db-2edef.jpg" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 586px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 29.180887372013654%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAGABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAIF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3QUD/8QAFxAAAwEAAAAAAAAAAAAAAAAAAAEQEf/aAAgBAQABBQJmT//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAABD/2gAIAQEABj8Cf//EABcQAQEBAQAAAAAAAAAAAAAAAAEAUbH/2gAIAQEAAT8hCxrsX//aAAwDAQACAAMAAAAQg8//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAYEAEBAQEBAAAAAAAAAAAAAAABESEAUf/aAAgBAQABPxDApF9Scqam7FwQj3//2Q==\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="5ed71283 a070 4b21 85ae f2cbfd6ba6e1" title="" data-src="/static/5ed71283-a070-4b21-85ae-f2cbfd6ba6e1-9d09686de3b660727e20c1bc54d1b1db-2edef.jpg" data-srcset="/static/5ed71283-a070-4b21-85ae-f2cbfd6ba6e1-9d09686de3b660727e20c1bc54d1b1db-759ca.jpg 200w,\n/static/5ed71283-a070-4b21-85ae-f2cbfd6ba6e1-9d09686de3b660727e20c1bc54d1b1db-eb32c.jpg 400w,\n/static/5ed71283-a070-4b21-85ae-f2cbfd6ba6e1-9d09686de3b660727e20c1bc54d1b1db-2edef.jpg 586w" data-sizes="(max-width: 586px) 100vw, 586px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>为了描述 B-Tree，首先定义一条数据记录为一个二元组 [key, data]，key 为记录的键，data 为数据记录除 key 外的数据。</p>\n<p>B-Tree 是满足下列条件的数据结构：</p>\n<ul>\n<li>所有叶节点具有相同的深度，也就是说 B-Tree 是平衡的；</li>\n<li>一个节点中的 key 从左到右非递减排列；</li>\n<li>如果某个指针的左右相邻 key 分别是 key<sub>i</sub> 和 key<sub>i+1</sub>，且不为 null，则该指针指向节点的所有 key 大于 key<sub>i</sub> 且小于 key<sub>i+1</sub>。</li>\n</ul>\n<p>在 B-Tree 中按 key 检索数据的算法非常直观：首先从根节点进行二分查找，如果找到则返回对应节点的 data，否则对相应区间的指针指向的节点递归进行查找，直到找到节点或找到 null 指针，前者查找成功，后者查找失败。</p>\n<p>由于插入删除新的数据记录会破坏 B-Tree 的性质，因此在插入删除时，需要对树进行一个分裂、合并、转移等操作以保持 B-Tree 性质。</p>\n<h3 id="2-btree"><a href="#2-btree" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. B+Tree</h3>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/63cd5b50-d6d8-4df6-8912-ef4a1dd5ba13-7087cfc3a39b1e5ced85f0fe26e7e87a-1c963.jpg" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 747px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 31.325301204819272%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAGABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAIF/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAdwRYr//xAAXEAADAQAAAAAAAAAAAAAAAAAAARAR/9oACAEBAAEFAtFP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAEP/aAAgBAQAGPwJ//8QAGBABAQADAAAAAAAAAAAAAAAAAREAECH/2gAIAQEAAT8he3IWTX//2gAMAwEAAgADAAAAEPvP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAFxABAQEBAAAAAAAAAAAAAAAAAQBBIf/aAAgBAQABPxBgDJIwjhf/2Q==\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="63cd5b50 d6d8 4df6 8912 ef4a1dd5ba13" title="" data-src="/static/63cd5b50-d6d8-4df6-8912-ef4a1dd5ba13-7087cfc3a39b1e5ced85f0fe26e7e87a-1c963.jpg" data-srcset="/static/63cd5b50-d6d8-4df6-8912-ef4a1dd5ba13-7087cfc3a39b1e5ced85f0fe26e7e87a-a4cbe.jpg 200w,\n/static/63cd5b50-d6d8-4df6-8912-ef4a1dd5ba13-7087cfc3a39b1e5ced85f0fe26e7e87a-c8cb9.jpg 400w,\n/static/63cd5b50-d6d8-4df6-8912-ef4a1dd5ba13-7087cfc3a39b1e5ced85f0fe26e7e87a-1c963.jpg 747w" data-sizes="(max-width: 747px) 100vw, 747px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>与 B-Tree 相比，B+Tree 有以下不同点：</p>\n<ul>\n<li>每个节点的指针上限为 2d 而不是 2d+1；</li>\n<li>内节点不存储 data，只存储 key，叶子节点不存储指针。</li>\n</ul>\n<h3 id="3-带有顺序访问指针的-btree"><a href="#3-%E5%B8%A6%E6%9C%89%E9%A1%BA%E5%BA%8F%E8%AE%BF%E9%97%AE%E6%8C%87%E9%92%88%E7%9A%84-btree" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. 带有顺序访问指针的 B+Tree</h3>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/1ee5f0a5-b8df-43b9-95ab-c516c54ec797-95ad6a6463bb18e1f35e0e3a49eb77eb-e8a5e.jpg" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 702px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 36.46723646723647%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAHABQDASIAAhEBAxEB/8QAFwABAAMAAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAdyQsD//xAAXEAADAQAAAAAAAAAAAAAAAAAAARAR/9oACAEBAAEFAtFP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAEP/aAAgBAQAGPwJ//8QAFxAAAwEAAAAAAAAAAAAAAAAAAAEQIf/aAAgBAQABPyFjU//aAAwDAQACAAMAAAAQg8//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAVEQEBAAAAAAAAAAAAAAAAAAAQEf/aAAgBAgEBPxCH/8QAGRABAQEBAQEAAAAAAAAAAAAAAREAIXHR/9oACAEBAAE/EF7Bnh90JIkxw3//2Q==\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="1ee5f0a5 b8df 43b9 95ab c516c54ec797" title="" data-src="/static/1ee5f0a5-b8df-43b9-95ab-c516c54ec797-95ad6a6463bb18e1f35e0e3a49eb77eb-e8a5e.jpg" data-srcset="/static/1ee5f0a5-b8df-43b9-95ab-c516c54ec797-95ad6a6463bb18e1f35e0e3a49eb77eb-20ce8.jpg 200w,\n/static/1ee5f0a5-b8df-43b9-95ab-c516c54ec797-95ad6a6463bb18e1f35e0e3a49eb77eb-a9549.jpg 400w,\n/static/1ee5f0a5-b8df-43b9-95ab-c516c54ec797-95ad6a6463bb18e1f35e0e3a49eb77eb-e8a5e.jpg 702w" data-sizes="(max-width: 702px) 100vw, 702px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>一般在数据库系统或文件系统中使用的 B+Tree 结构都在经典 B+Tree 基础上进行了优化，在叶子节点增加了顺序访问指针，做这个优化的目的是为了提高区间访问的性能。</p>\n<h3 id="4-为什么使用-b-tree-和-btree"><a href="#4-%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BD%BF%E7%94%A8-b-tree-%E5%92%8C-btree" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4. 为什么使用 B-Tree 和 B+Tree</h3>\n<p>红黑树等数据结构也可以用来实现索引，但是文件系统及数据库系统普遍采用 B-/+Tree 作为索引结构。</p>\n<p>页是计算机管理存储器的逻辑块，硬件及操作系统往往将主存和磁盘存储区分割为连续的大小相等的块，每个存储块称为一页（在许多操作系统中，页的大小通常为 4k），主存和磁盘以页为单位交换数据。</p>\n<p>一般来说，索引本身也很大，不可能全部存储在内存中，因此索引往往以索引文件的形式存储的磁盘上。为了减少磁盘 I/O，磁盘往往不是严格按需读取，而是每次都会预读。这样做的理论依据是计算机科学中著名的局部性原理：当一个数据被用到时，其附近的数据也通常会马上被使用。数据库系统的设计者巧妙利用了磁盘预读原理，将一个节点的大小设为等于一个页，这样每个节点只需要一次 I/O 就可以完全载入。B-Tree 中一次检索最多需要 h-1 次 I/O（根节点常驻内存），渐进复杂度为 O(h)=O(log<sub>d</sub>N)。一般实际应用中，出度 d 是非常大的数字，通常超过 100，因此 h 非常小（通常不超过 3）。而红黑树这种结构，h 明显要深的多。并且于逻辑上很近的节点（父子）物理上可能很远，无法利用局部性，效率明显比 B-Tree 差很多。</p>\n<p>B+Tree 更适合外存索引，原因和内节点出度 d 有关。由于 B+Tree 内节点去掉了 data 域，因此可以拥有更大的出度，拥有更好的性能。</p>\n<h1 id="四、查询性能优化"><a href="#%E5%9B%9B%E3%80%81%E6%9F%A5%E8%AF%A2%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>四、查询性能优化</h1>\n<h2 id="explain"><a href="#explain" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Explain</h2>\n<p>用来分析 SQL 语句，分析结果中比较重要的字段有：</p>\n<ul>\n<li>\n<p>select_type : 查询类型，有简单查询、联合查询和子查询</p>\n</li>\n<li>\n<p>key : 使用的索引</p>\n</li>\n<li>\n<p>rows : 扫描的行数</p>\n</li>\n</ul>\n<h2 id="减少返回的列"><a href="#%E5%87%8F%E5%B0%91%E8%BF%94%E5%9B%9E%E7%9A%84%E5%88%97" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>减少返回的列</h2>\n<p>慢查询主要是因为访问了过多数据，除了访问过多行之外，也包括访问过多列。</p>\n<p>最好不要使用 SELECT * 语句，要根据需要选择查询的列。</p>\n<h2 id="减少返回的行"><a href="#%E5%87%8F%E5%B0%91%E8%BF%94%E5%9B%9E%E7%9A%84%E8%A1%8C" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>减少返回的行</h2>\n<p>最好使用 LIMIT 语句来取出想要的那些行。</p>\n<p>还可以建立索引来减少条件语句的全表扫描。例如对于下面的语句，不使用索引的情况下需要进行全表扫描，而使用索引只需要扫描几行记录即可，使用 Explain 语句可以通过观察 rows 字段来看出这种差异。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="91264204732035090000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`SELECT * FROM sakila.film_actor WHERE film_id = 1;`, `91264204732035090000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> sakila<span class="token punctuation">.</span>film_actor <span class="token keyword">WHERE</span> film_id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>\n<h2 id="拆分大的-delete-或-insert-语句"><a href="#%E6%8B%86%E5%88%86%E5%A4%A7%E7%9A%84-delete-%E6%88%96-insert-%E8%AF%AD%E5%8F%A5" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>拆分大的 DELETE 或 INSERT 语句</h2>\n<p>如果一次性执行的话，可能一次锁住很多数据、占满整个事务日志、耗尽系统资源、阻塞很多小的但重要的查询。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="26035643405519114000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`DELEFT FROM messages WHERE create < DATE_SUB(NOW(), INTERVAL 3 MONTH);`, `26035643405519114000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql">DELEFT <span class="token keyword">FROM</span> messages <span class="token keyword">WHERE</span> <span class="token keyword">create</span> <span class="token operator">&lt;</span> DATE_SUB<span class="token punctuation">(</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">INTERVAL</span> <span class="token number">3</span> <span class="token keyword">MONTH</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="51510878411959800000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`rows_affected = 0\ndo {\n    rows_affected = do_query(\n    &quot;DELETE FROM messages WHERE create  < DATE_SUB(NOW(), INTERVAL 3 MONTH) LIMIT 10000&quot;)\n} while rows_affected > 0`, `51510878411959800000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql">rows_affected <span class="token operator">=</span> <span class="token number">0</span>\n<span class="token keyword">do</span> {\n    rows_affected <span class="token operator">=</span> do_query<span class="token punctuation">(</span>\n    <span class="token string">"DELETE FROM messages WHERE create  &lt; DATE_SUB(NOW(), INTERVAL 3 MONTH) LIMIT 10000"</span><span class="token punctuation">)</span>\n} <span class="token keyword">while</span> rows_affected <span class="token operator">></span> <span class="token number">0</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h1 id="五、切分"><a href="#%E4%BA%94%E3%80%81%E5%88%87%E5%88%86" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>五、切分</h1>\n<p>随着时间和业务的发展，数据库中的表会越来越多，并且表中的数据量也会越来越大，那么读写操作的开销也会随着增大。</p>\n<h2 id="垂直切分"><a href="#%E5%9E%82%E7%9B%B4%E5%88%87%E5%88%86" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>垂直切分</h2>\n<p>将表按功能模块、关系密切程度划分出来，部署到不同的库上。例如，我们会建立商品数据库 payDB、用户数据库 userDB 等，分别用来存储项目与商品有关的表和与用户有关的表。</p>\n<h2 id="水平切分"><a href="#%E6%B0%B4%E5%B9%B3%E5%88%87%E5%88%86" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>水平切分</h2>\n<p>把表中的数据按照某种规则存储到多个结构相同的表中，例如按 id 的散列值、性别等进行划分。</p>\n<h2 id="切分的选择"><a href="#%E5%88%87%E5%88%86%E7%9A%84%E9%80%89%E6%8B%A9" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>切分的选择</h2>\n<p>如果数据库中的表太多，并且项目各项业务逻辑清晰，那么垂直切分是首选。</p>\n<p>如果数据库的表不多，但是单表的数据量很大，应该选择水平切分。</p>\n<h2 id="存在的问题"><a href="#%E5%AD%98%E5%9C%A8%E7%9A%84%E9%97%AE%E9%A2%98" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>存在的问题</h2>\n<h3 id="1-事务问题"><a href="#1-%E4%BA%8B%E5%8A%A1%E9%97%AE%E9%A2%98" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. 事务问题</h3>\n<p>在执行分库分表之后，由于数据存储到了不同的库上，数据库事务管理出现了困难。如果依赖数据库本身的分布式事务管理功能去执行事务，将付出高昂的性能代价；如果由应用程序去协助控制，形成程序逻辑上的事务，又会造成编程方面的负担。</p>\n<h3 id="2-跨库跨表连接问题"><a href="#2-%E8%B7%A8%E5%BA%93%E8%B7%A8%E8%A1%A8%E8%BF%9E%E6%8E%A5%E9%97%AE%E9%A2%98" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. 跨库跨表连接问题</h3>\n<p>在执行了分库分表之后，难以避免会将原本逻辑关联性很强的数据划分到不同的表、不同的库上。这时，表的连接操作将受到限制，我们无法连接位于不同分库的表，也无法连接分表粒度不同的表，导致原本只需要一次查询就能够完成的业务需要进行多次才能完成。</p>\n<h3 id="3-额外的数据管理负担和数据运算压力"><a href="#3-%E9%A2%9D%E5%A4%96%E7%9A%84%E6%95%B0%E6%8D%AE%E7%AE%A1%E7%90%86%E8%B4%9F%E6%8B%85%E5%92%8C%E6%95%B0%E6%8D%AE%E8%BF%90%E7%AE%97%E5%8E%8B%E5%8A%9B" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. 额外的数据管理负担和数据运算压力</h3>\n<p>最显而易见的就是数据的定位问题和数据的增删改查的重复执行问题，这些都可以通过应用程序解决，但必然引起额外的逻辑运算。</p>\n<h1 id="六、故障转移和故障恢复"><a href="#%E5%85%AD%E3%80%81%E6%95%85%E9%9A%9C%E8%BD%AC%E7%A7%BB%E5%92%8C%E6%95%85%E9%9A%9C%E6%81%A2%E5%A4%8D" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>六、故障转移和故障恢复</h1>\n<p>故障转移也叫做切换，当主库出现故障时就切换到备库，使备库成为主库。故障恢复顾名思义就是从故障中恢复过来，并且保证数据的正确性。</p>\n<h2 id="提升备库或切换角色"><a href="#%E6%8F%90%E5%8D%87%E5%A4%87%E5%BA%93%E6%88%96%E5%88%87%E6%8D%A2%E8%A7%92%E8%89%B2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>提升备库或切换角色</h2>\n<p>提升一台备库为主库，或者在一个主-主复制结构中调整主动和被动角色。</p>\n<h2 id="虚拟-ip-地址和-ip-托管"><a href="#%E8%99%9A%E6%8B%9F-ip-%E5%9C%B0%E5%9D%80%E5%92%8C-ip-%E6%89%98%E7%AE%A1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>虚拟 IP 地址和 IP 托管</h2>\n<p>为 MySQL 实例指定一个逻辑 IP 地址，当 MySQL 实例失效时，可以将 IP 地址转移到另一台 MySQL 服务器上。</p>\n<h2 id="中间件解决方案"><a href="#%E4%B8%AD%E9%97%B4%E4%BB%B6%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>中间件解决方案</h2>\n<p>通过代理，可以路由流量到可以使用的服务器上。</p>\n<h2 id="在应用中处理故障转移"><a href="#%E5%9C%A8%E5%BA%94%E7%94%A8%E4%B8%AD%E5%A4%84%E7%90%86%E6%95%85%E9%9A%9C%E8%BD%AC%E7%A7%BB" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>在应用中处理故障转移</h2>\n<p>将故障转移整合到应用中可能导致应用变得太过笨拙。</p>\n<h1 id="参考资料"><a href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>参考资料</h1>\n<ul>\n<li>BaronScbwartz, PeterZaitsev, VadimTkacbenko, 等. 高性能 MySQL[M]. 电子工业出版社, 2013.</li>\n<li><a href="https://medium.com/@jeeyoungk/how-sharding-works-b4dec46b3f6" target="_blank" rel="nofollow noreferrer noopener">How Sharding Works</a></li>\n<li><a href="http://blog.codinglabs.org/articles/theory-of-mysql-index.html" target="_blank" rel="nofollow noreferrer noopener">MySQL 索引背后的数据结构及算法原理 </a></li>\n<li><a href="https://www.jfox.info/20-tiao-mysql-xing-nen-you-hua-de-zui-jia-jing-yan.html" target="_blank" rel="nofollow noreferrer noopener">20+ 条 MySQL 性能优化的最佳经验 </a></li>\n<li><a href="https://www.i3geek.com/archives/1108" target="_blank" rel="nofollow noreferrer noopener">数据库为什么分库分表？mysql 的分库分表方案</a></li>\n</ul>',
id:"/home/runner/work/GatsbyBlog/GatsbyBlog/blog/高性能MySQL/index.md absPath of file >>> MarkdownRemark",timeToRead:11,frontmatter:{date:"2018-04-03 15:24:28",path:"/mysql-introduce/",tags:"面试, 数据库, 后端, 读书笔记",title:"高性能MySQL",draft:null}}],length:75,tag:"读书笔记",pagesSum:15,page:12}}}});