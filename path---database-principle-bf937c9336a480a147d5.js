webpackJsonp([0xa2e97e8c80ae],{1228:function(a,n){a.exports={data:{file:{childImageSharp:{sizes:{base64:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAeCAYAAAAsEj5rAAAACXBIWXMAAAsSAAALEgHS3X78AAAHlElEQVRIx12We2xT5xXAbcI2Vmn7o1I1uhVYRxL8tuPn9bXv0+/4/YgdOyYkkATCCEEYsqVNC2wCIYQWShmUBFh4hMAWECot0BUtlI4yAS1oKqJQXimsDBgTU8codnLO7r0uUPpJn87Rp+/8vvOdc75zr8xmZmTieI1NykU5yxOfxDncz3NUjAlyDXMjXGMhys+cG+FzGQ8VU4t7XuV8z8m+GUkrJclSqVReYJ0ZWQ8Tl2AdTPhnq9ns2QKd+crDZiHha8NsYCE21HZiXphpb3sxxTf99Tdsw51ldHqFaLOXXyzvYqOyZ0YPk5soylfouuUbvHOxh56JbiqJfi4/FnE1lxKetrGUZ954nbcdU/752ORpxWVsc6mZjPxctFtApeVtra1lmIPwTxClgeCqvGTsX/WWOEbtyTGWSoGbToOPzUHQ1QghVxOEhRniZ5U8XB4TzvTdgj1ZJdq2OOrkGhVRBnrYFum6TiK0l2fr0emMlVxcBhlnEniqDjlBuqg0CnD0MPWiDrwzhR4u+5B3x3WiLUNHJjxzZYvR8ZKTCP+Xo1JoM/nBYvSB1egHuyUIrCOBPj4LtD0KlD2K4h7SGip62aygxzaK9rHA3Aqt2vw0MRYjnyJtYaQdsXG9hgWFwgmVlXZUKUjUqmm0CgfwhA80Kgr1Wg40Sue4SuFEnZq+YjMbJ0kh0zmfemjQ0j2EJYh2a23RVOODIBvHmCsBUaoWLDoWKIsP50bTApxC5QwH1Ghp0Gk4MBk8aDLQEslooCc88VClsK+zGANI2mqLer0XFuea8PSuN+DM7o3QWyhAR7IBfj+vDbyOICS9aSjkZo8nvSlUKuxXLDUOKdN6LSl/AlRUE+vNAnD50l8XeTIEPiYEzXYG5mlNeGz7BvjPpY/g5snDcHxwE+zs7oCh1zvHCrNm48u/ML8j2muVQblBZ3t6ZY2KXKtQcDiwdk1xx9rV0BlqghEuD4fNUTy1Zwhw7Cbioxu461fdsOgFDa5pbh3zu6NifE9f+XCPlGHS5nuaFI3K8brJ4EUHES4WFiyEP2/dCPc2vYH/3NIHePcywP1LWLp3Ec4tWQa3FvbAu7294yqVA801rju5utYfiQyKDD4DnC8GWEhMafJPtBALxuHjo3+C8bufIn59DfHBFcDiDcQvzyF+/iEsbWuDadNMaDW5H7nY6Iyyh165zfLNtdUqIqLTsEJSQqBVUTD1JQPqdRT8sf9NuH7kMHy0fRg+O3EUzp96H/Zs2SBklxFKxwFmowtdTCIoPQx7oKLzl32PPTRPVSudDwQgCrUGL0+twdzsDjjSdwD2J1fh/q7N0N+1EtykB178qVY4lAahRktWkw95JrG4DAxPvHU3Wwb+rlcsHfK0WNxCoMdUCgdUaxnMBPKw7dVe2LyhDw4MboORA4NQOd2CaiUFaqWjZJGAyQGRUeubP8FqElqZspquEBeUM2zrnEQUa3R8USVcp2qGDZV6ErqXL4PfrlwFhSU9cPL4MejfshOsZq90sCg5KvHZ5MnPfa+cmFrxukRFuRZNcYqIoNngHheeFmiF11ClIDBdPwfqG9qhc1E3rF25GnrX90M204JqBfWItPrP8lTqa7vFpSw3GJ9cZjI4pW5TXaWezpKxh4Q5gEY9LwApVOtZMApxVWhd2DKvC7K5FjTUsFCj45Ah4yXaHuz1MBlgyHCb1HXISIXMTcekOJqN1h/72Mx92h5DwuwHjeChWseBQsNgJJ6H944eB5oNgaLajnaL/07E24wuKr7Cz+XuuenUsMioCxYmyHhnSPLQTYVVYVfjI46Mo80WBLMgLY4E1FhCOENBAsfHQG/0juuNPqGguU8ywXas5XNbg6783wJ8w781GtUPJc+irkap/Ufdje0JXytStnDJbA2D1Z4EKxEHsyUMRmsIdcZaNFpCYBYqwWQLPhD3Btn6t2Pe5uF0cD7Sdr/xmSab8racFaDooOvuk0wDEs40EFQGbVQGbEKXJoTPgZ3JoJGIgULvR6M1jE67rzvpae5ojC7GEJ9rfgILc7lC3NV0T6flTtjoPLK+VuD8rcD65gDtaQInPxOtzoxQRrXgD8/BdW/+YezYByfxvfdHvnxl+ZLKCDfzUMIze60Ey+brJukrqcjA1u3tBw8dfZiZuRQFaNFory/WEPUlE5kFK5WDQKRtbFPfUOnChUvFL27cwKuj/8CBHXv2iQw/k/KGuNwyCYiIkhw+sO/569eu7b1+ffR/H5z4BAcG38X1m/biyjX9ODR8GC9dHsXLV0fx5KlzePDIyFd7ht9ZJZhJrcvLhV/wMuUPljQWtC6Z+FjfuWPHlPMXLq64Onpz3d8/Pf9WX//OW2vWbITBof3n3tqya9fbh/7SvW1gZ9Xj/V1dr8kf614qIZONjBwrezi8Ty54K5d9ZzTmF+xe1LnioaD+4Nvrn4/ermif3yHp8UCDLMCky7Z+n192+/YdST9z5mPZ7t1D8ouXv6gQ4S9WTplks7mut8xZijxbKz2vvi2D39/cPyB/HC5xOm2czPvd35F8rkGCS0+I4WXV1QbJaMq06XqbNXCQJIILpH8hOic3GghZMpl62qG/Nf4PRzaQ862MzO4AAAAASUVORK5CYII=",aspectRatio:.6666666666666666,src:"/static/avatar-dc7bc85837bf005ae32d2a37dfdfa8a2-25c91.png",srcSet:"/static/avatar-dc7bc85837bf005ae32d2a37dfdfa8a2-8a97b.png 200w,\n/static/avatar-dc7bc85837bf005ae32d2a37dfdfa8a2-0fdf3.png 400w,\n/static/avatar-dc7bc85837bf005ae32d2a37dfdfa8a2-25c91.png 600w",srcWebp:"/static/avatar-dc7bc85837bf005ae32d2a37dfdfa8a2-216f6.webp",srcSetWebp:"/static/avatar-dc7bc85837bf005ae32d2a37dfdfa8a2-5d70e.webp 200w,\n/static/avatar-dc7bc85837bf005ae32d2a37dfdfa8a2-d1677.webp 400w,\n/static/avatar-dc7bc85837bf005ae32d2a37dfdfa8a2-216f6.webp 600w",sizes:"(max-width: 600px) 100vw, 600px"}}},site:{siteMetadata:{title:"女王控的博客",description:'前端工程师，黑猫女王控，欢迎勾搭，技术相关<a href="https://github.com/towavephone" target="_blank">@towavephone</a>，QQ闲聊<a href="tencent://AddContact/?fromId=45&fromSubId=1&subcmd=all&uin=634407147&website=www.oicqzone.com">@towave</a>，bili关注<a href="https://space.bilibili.com/11507708#/" target="_blank">@towave</a>',siteUrl:"https://blog.towavephone.com"}},mainPost:{html:'<h1 id="一、事务"><a href="#%E4%B8%80%E3%80%81%E4%BA%8B%E5%8A%A1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>一、事务</h1>\n<h2 id="概念"><a href="#%E6%A6%82%E5%BF%B5" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>概念</h2>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/185b9c49-4c13-4241-a848-fbff85c03a64-2abdfd9841404e5b70fad83a35f55a95-1857e.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 448px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 97.54464285714285%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAAsSAAALEgHS3X78AAACVklEQVQ4y6VTS2/aQBDm/x+bW1VVlXpo00tEIhopVhweAVxFgCmpwCF+YmNjm/WuH7vm2Y5xIEAjFalzWM3M7rfzzbezhd//YYX9YLVaxTFOEkwZYYxQSmiShUlCYGu9tWNwngpD7Pmc9PSt3vjws/elUn3fFD46k5Ln3YVhuDv2d+UsmySR61UT2pi4fLny6b7+GaEs9PwGQgGlLMmMAos3aMPFgJ9OPYxRFAHnCCGf0ohRZlntsc3ZDm+Mbgjx8sOFIw0Wi8VyuVxsDML5fJ7nTfOHpl88K0VFLRIyeQXvZAA+SRKDM5vN0jQFh1Ka3wJ5hFzfdwhBeWZPsM0KNfNboGDeGFyx6xCSy+XqWLCJqTyLVYID23YeHx8HgwFoa5qmKIqqqnqe1+12ZVmO4lhThnKnEvh7tNVfD1LlqyoP250Ox3HNZhMwt7e3tVqt1WrV6/flclkQBFlRylxpWDu3tKdXcBRFZ2fvXNdFCOm6zhjLW5AkKU0zwVRVRwhvRFnHUQxbL7TzJsVu947ngSFIBb3FcWyaluOMMFFIqKhaC5wAywEehuHkjfHUNA1ISi828H00HveHz+f9/rkxKlrjK8O4tKwL23nYFs7B26EDYTHG0435fqCqPV0vKWpJ075b4xvL5kzr2nbErfwbMIz84vANtgMzhy+RphFjYfZJaLYyRg9oW0pfEq5Dkkli27ZhGI7j7FT5x5c0hz1ZuCQB2oyhCe8Emufg9Vt2OCQTtyN2Qee87d2cnVS51+vxPA/vDD5MWLvdBuanguGPQqunNHlkfwAU2GuYkeWO8gAAAABJRU5ErkJggg==\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="185b9c49 4c13 4241 a848 fbff85c03a64" title="" data-src="/static/185b9c49-4c13-4241-a848-fbff85c03a64-2abdfd9841404e5b70fad83a35f55a95-1857e.png" data-srcset="/static/185b9c49-4c13-4241-a848-fbff85c03a64-2abdfd9841404e5b70fad83a35f55a95-15195.png 200w,\n/static/185b9c49-4c13-4241-a848-fbff85c03a64-2abdfd9841404e5b70fad83a35f55a95-82e6d.png 400w,\n/static/185b9c49-4c13-4241-a848-fbff85c03a64-2abdfd9841404e5b70fad83a35f55a95-1857e.png 448w" data-sizes="(max-width: 448px) 100vw, 448px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>事务指的是满足 ACID 特性的一系列操作。在数据库中，可以通过 Commit 提交一个事务，也可以使用 Rollback 进行回滚。</p>\n<h2 id="四大特性"><a href="#%E5%9B%9B%E5%A4%A7%E7%89%B9%E6%80%A7" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>四大特性</h2>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/09e6e8d4-4d83-4949-b908-6d6b4c2fd064-46f9e93837b5a746d8faee2d474de4ad-4b0e9.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 571px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 38.00350262697023%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsSAAALEgHS3X78AAABW0lEQVQY001M2XKCQBD0/38myYvJiyceeJAoqLC7KCgsx3IoCwQQg1lIFZWurqnununplOVPlpdZcc+Lsrg/2Mwatjb/v8rvjEw/G3QuskAA76EVAQu07jsK78Elo3WYw3WP5S5cELhEQt+W5z5aMepbLqFRXSZg9rR5d9OtMG9vuk9nSWE/O40e5ry2mE/Q4Omu7ObAEz8KnYvggF79unwWxzEcBcoogmMwfb0qw1AeRojz9z0wfUmPU4omMeLg7C2UB4E8pIi7CO/RNajL2unoWCZQDjY29zsx9Ilx1k8qciyMgMKktP3yXPuwl9jZEQFsXrSjervd6rLv+y4hgvCJsUUIieMEqaoo7WicUEp1/cxxkyRJ2JkfBKIkyQoIwjCO47psGIZtWRbGpmkihNhkCTO6rmua5jgOxth1XVVV2Qo3YDl7V5fzPE/T9LtBK1r7l7SiRVVVrPwLXGKus8kqE+AAAAAASUVORK5CYII=\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="09e6e8d4 4d83 4949 b908 6d6b4c2fd064" title="" data-src="/static/09e6e8d4-4d83-4949-b908-6d6b4c2fd064-46f9e93837b5a746d8faee2d474de4ad-4b0e9.png" data-srcset="/static/09e6e8d4-4d83-4949-b908-6d6b4c2fd064-46f9e93837b5a746d8faee2d474de4ad-b8aee.png 200w,\n/static/09e6e8d4-4d83-4949-b908-6d6b4c2fd064-46f9e93837b5a746d8faee2d474de4ad-fe23d.png 400w,\n/static/09e6e8d4-4d83-4949-b908-6d6b4c2fd064-46f9e93837b5a746d8faee2d474de4ad-4b0e9.png 571w" data-sizes="(max-width: 571px) 100vw, 571px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<h3 id="1-原子性（atomicity）"><a href="#1-%E5%8E%9F%E5%AD%90%E6%80%A7%EF%BC%88atomicity%EF%BC%89" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. 原子性（Atomicity）</h3>\n<p>事务被视为不可分割的最小单元，要么全部提交成功，要么全部失败回滚。</p>\n<h3 id="2-一致性（consistency）"><a href="#2-%E4%B8%80%E8%87%B4%E6%80%A7%EF%BC%88consistency%EF%BC%89" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. 一致性（Consistency）</h3>\n<p>事务执行前后都保持一致性状态。在一致性状态下，所有事务对一个数据的读取结果都是相同的。</p>\n<h3 id="3-隔离性（isolation）"><a href="#3-%E9%9A%94%E7%A6%BB%E6%80%A7%EF%BC%88isolation%EF%BC%89" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. 隔离性（Isolation）</h3>\n<p>一个事务所做的修改在最终提交以前，对其它事务是不可见的。</p>\n<h3 id="4-持久性（durability）"><a href="#4-%E6%8C%81%E4%B9%85%E6%80%A7%EF%BC%88durability%EF%BC%89" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4. 持久性（Durability）</h3>\n<p>一旦事务提交，则其所做的修改将会永远保存到数据库中。即使系统发生崩溃，事务执行的结果也不能丢失。可以通过数据库备份和恢复来保证持久性。</p>\n<h1 id="二、并发一致性问题"><a href="#%E4%BA%8C%E3%80%81%E5%B9%B6%E5%8F%91%E4%B8%80%E8%87%B4%E6%80%A7%E9%97%AE%E9%A2%98" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>二、并发一致性问题</h1>\n<p>在并发环境下，一个事务如果受到另一个事务的影响，那么事务操作就无法满足一致性条件。</p>\n<h2 id="问题"><a href="#%E9%97%AE%E9%A2%98" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题</h2>\n<h3 id="1-丢失修改"><a href="#1-%E4%B8%A2%E5%A4%B1%E4%BF%AE%E6%94%B9" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. 丢失修改</h3>\n<p>T<sub>1</sub> 和 T<sub>2</sub> 两个事务都对一个数据进行修改，T<sub>1</sub> 先修改，T<sub>2</sub> 随后修改，T<sub>2</sub> 的修改覆盖了 T<sub>1</sub> 的修改。</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/88ff46b3-028a-4dbb-a572-1f062b8b96d3-ab6f899b1f4288d34844487ad110ea74-5751a.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 447px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 126.62192393736018%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAZCAIAAAC+dZmEAAAACXBIWXMAAAsSAAALEgHS3X78AAACg0lEQVQ4y42U+VPaQBTH/f//jF4zztiqtWopjCQCGoRy0waSEHIQcpKb3KGL25EAq+P+9PYln/fd3XecbArL9/0oijavL9u24zh+2Z4Uv5mm6bouMPI8R8KKoqzX65cfdjDQHI1GDMMck9DjOE6/35ckCQGvfb/x8AA+p2mKhHVdx3GcoqhDGG5YdmZb1hvHpmm6GPoE/raQFIaVflVqzfZwygiW5SBDCIJQ3G6V0yR87Ak/iVWJUK/r0gUmTmZL4M+yd8CbPBtNhFqbw4hp4/e8StCipL1XGaw4CvI0HA46kshlSZDn2QGWAVee87wADRgWKqdDUsBb3EWpXalPsKc5v1CRyjzPAfeecpZGtSfm89X4y1X3W3kKDJJeFO8MoiwVTZL129Idw4qLpRZF8e7Yum5K8mo4pmZziRcV1/Mh8788bLPyyH3HFz/uxa8V+qw0UVTjMM+KIkdReFweYbAmurNyY1qpk+A5y7W/5nMu92BQeqA3XimSrWc86ifJUWO8BkMjCoNmb4Y1mdOLe4yg8SaFUJZlOQwRx/Zc+7pKfjjvfjxvn978+XTZU9TVDrZtx3H9R6JFTqiVaQdBsJfkLFsqhrg0egNSkHSQyN1r52n81J9f3tFnt4Ob+xkwmLkMC+Pg3uJxheVZ0hnx1zh1WR6UH9gbnGaFwyKBaeN4Pn9J4HNXbY1gDdrZ57i5Yeiu6xSfdE9ZFBG1DUO0Wi2O497o52q1CsYYYpL4nlev1bqdTpqgJ4mmaRiGkSSJgOMkGZMkuy39DRL2PA8MOVVVEXCiG8nKSiQlVnVIFHkwfYCyZVmgpUEUyBeUNSO2nVBWY8M8hkGqgSYYzODN4PQF6x8i35EQdgqBZgAAAABJRU5ErkJggg==\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="88ff46b3 028a 4dbb a572 1f062b8b96d3" title="" data-src="/static/88ff46b3-028a-4dbb-a572-1f062b8b96d3-ab6f899b1f4288d34844487ad110ea74-5751a.png" data-srcset="/static/88ff46b3-028a-4dbb-a572-1f062b8b96d3-ab6f899b1f4288d34844487ad110ea74-a742c.png 200w,\n/static/88ff46b3-028a-4dbb-a572-1f062b8b96d3-ab6f899b1f4288d34844487ad110ea74-4517e.png 400w,\n/static/88ff46b3-028a-4dbb-a572-1f062b8b96d3-ab6f899b1f4288d34844487ad110ea74-5751a.png 447w" data-sizes="(max-width: 447px) 100vw, 447px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<h3 id="2-读脏数据"><a href="#2-%E8%AF%BB%E8%84%8F%E6%95%B0%E6%8D%AE" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. 读脏数据</h3>\n<p>T<sub>1</sub> 修改一个数据，T<sub>2</sub> 随后读取这个数据。如果 T<sub>1</sub> 撤销了这次修改，那么 T<sub>2</sub> 读取的数据是脏数据。</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/dd782132-d830-4c55-9884-cfac0a541b8e-bb7884b30859577688430c5e90f662ed-9c82e.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 495px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 115.55555555555554%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAXCAIAAACEf/j0AAAACXBIWXMAAAsSAAALEgHS3X78AAACUUlEQVQ4y5VUWXPaQAzm//+NPrQPgQmdEkIZCMdAUgjXGIfDBzY2vk+Ijb3GpgKnYIIzTPdhR1qtpG/1aZXZXy7f97fb7f6L5bqu53knNfPJ7DiOZVkgRFGUPI9VwzDW6/VJzSTNcDDG8X5/4PvoOi1CqNvtEgSRkjkORtMUjmNfwR4MBsvlMsV5u/VYTu4P35qtV5ZT7PXmGrYoivDss7MkSYqiiKIgynq2TP0o4Pkn5r7Gz2nx6HPhLMtyspyZ8LjA9u642JTvYYvXEY1NV5pu3XY+SbvdznUdkiRHoyEICPnXsFOcY4Ok6L/q9EOTzVfm+SpFMdLtzFEUfXBo2rU/1NMLVXshqy80J6j/ATs265rMsYujGt6GDS3luK5lmqKklhqzbLGXK/Z/t+jFMgU2UHNBFXScba81VeF46b6MZ4ujn5VJrjyhmANVRx6imA5QVVVN72244fm+oqirleB5fhAEyZyAzzStTrc3mxGGaQI154KdYm82G9M0T82saZquG7IkTEkxV57nSnihwVQ70Ffq58wQY7Xi58QMokFsCAcvdKFEW4fhlMozUWlPG93F84CzLPuCZ0OV3+p3w/L37uO3WfNOZMl9omJhCDhDUeDfN3a4Q+cvGUu2qROd0qT9MG4VyM6jKrBJ59sFg51l2fF4HHfrNc8YhsHHSh8GsA+Hw3a7fSp1csFhvV6PQ6d3mCjLS55LnQRwgWFZRdPSZ9iBaJZHvBDoxv6yvw6zUVICRfMoBmkf1gvnCMjyUYRQFOyuM4coiILgcOFfOf4C5NYkETLcwbAAAAAASUVORK5CYII=\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="dd782132 d830 4c55 9884 cfac0a541b8e" title="" data-src="/static/dd782132-d830-4c55-9884-cfac0a541b8e-bb7884b30859577688430c5e90f662ed-9c82e.png" data-srcset="/static/dd782132-d830-4c55-9884-cfac0a541b8e-bb7884b30859577688430c5e90f662ed-84a0c.png 200w,\n/static/dd782132-d830-4c55-9884-cfac0a541b8e-bb7884b30859577688430c5e90f662ed-afbfd.png 400w,\n/static/dd782132-d830-4c55-9884-cfac0a541b8e-bb7884b30859577688430c5e90f662ed-9c82e.png 495w" data-sizes="(max-width: 495px) 100vw, 495px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<h3 id="3-不可重复读"><a href="#3-%E4%B8%8D%E5%8F%AF%E9%87%8D%E5%A4%8D%E8%AF%BB" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. 不可重复读</h3>\n<p>T<sub>2</sub> 读取一个数据，T<sub>1</sub> 对该数据做了修改。如果 T<sub>2</sub> 再次读取这个数据，此时读取的结果和和第一次读取的结果不同。</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/c8d18ca9-0b09-441a-9a0c-fb063630d708-43b9484f7524b7047c9ad9546fc9c8f5-a3fce.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 515px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 113.7864077669903%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAXCAIAAACEf/j0AAAACXBIWXMAAAsSAAALEgHS3X78AAACVElEQVQ4y6VUa3OaUBD1//+LTmf6mHRSJ4npjG1qG018RAwENRrlKQKXh8hTQcCuoikC6ZfecUDu7tm75+zuLW3/Y5XyW57nRVFU6L1er8H6L7CiKEEQZDbjOIanZVmqqr5+ZsGmafV6jwzDvHqk8FuKoh9x3PeD4pOjMCSfcEkSM+DkP88xD53WSdpgiKKdTdOXM8m4vcMGY06Q9IR5HIbg4TnucCI2sZfvv7rEUFBUYwcGD0mSEFKWht7rc+/K5Psydladnlf7PjAPo9VsHkpIJJ+/NeefrodXt/z5DTdh0OHkMAz3h8Sqbk5YDSOm5FhgBS2t+WazEeYKxQgEOeJmsmU7Wc6ObZk66rbveHpsGdqBMzyT33br+z5Cck7t/Qc3wmSsLPeu2PsvVOsSXPN1Bo4n4Hi/doIhQaZwdtDmhh2RHgCdDBjCybJcXGdv5ZvO+gEjWF50vHWmzgVgeOm6blqWLM3xAfe5Qn68wL7+eKnUhuk+S7xBf6QoJ2BoOs9beZ5LsdLv9vSmPvh5P2phk3zanusKM6447QNzTXVd59hxcRxG2yiC2KOp1Ow+V2sdcjRX9eVfwdJ9Bq1vOwdwoGi+rAQML0/pSmP24ZK8qLFnVXpMy8UnA9g5grfHQmyCQBBVmhWf+tC6yLKct9LWXNctnOcg8NW0YHmwIAggYX4kYUFQjuPenGdQuF6v8zxfOJI0TTcajYKbJDHbtk0QRDp8esElgeP4a/1L+QsMBIM2yt9EMFiGYYDJNM1iMCCBMNBerVaZpCAuaLlYLBBCyf4fq4glsbXc34sAAAAASUVORK5CYII=\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="c8d18ca9 0b09 441a 9a0c fb063630d708" title="" data-src="/static/c8d18ca9-0b09-441a-9a0c-fb063630d708-43b9484f7524b7047c9ad9546fc9c8f5-a3fce.png" data-srcset="/static/c8d18ca9-0b09-441a-9a0c-fb063630d708-43b9484f7524b7047c9ad9546fc9c8f5-96d1c.png 200w,\n/static/c8d18ca9-0b09-441a-9a0c-fb063630d708-43b9484f7524b7047c9ad9546fc9c8f5-2b9d0.png 400w,\n/static/c8d18ca9-0b09-441a-9a0c-fb063630d708-43b9484f7524b7047c9ad9546fc9c8f5-a3fce.png 515w" data-sizes="(max-width: 515px) 100vw, 515px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<h3 id="4-幻影读"><a href="#4-%E5%B9%BB%E5%BD%B1%E8%AF%BB" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4. 幻影读</h3>\n<p>T<sub>1</sub> 读取某个范围的数据，T<sub>2</sub> 在这个范围内插入新的数据，T<sub>1</sub> 再次读取这个范围的数据，此时读取的结果和和第一次读取的结果不同。</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/688dacfe-1057-412f-b3a1-86abb5b0f914-1981e3684ab12885095511a5bee9220d-6dd13.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 459px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 124.61873638344227%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAZCAIAAAC+dZmEAAAACXBIWXMAAAsSAAALEgHS3X78AAACf0lEQVQ4y6WUWXOiQBCA/f+/JI+72SS1iestGyIgGo21ISJyyI3ciiDDtiEhiG7ysF0wNfT0x1SftawkSZLYtp2dE4QQrK7rBkFQfNYqsK7r+cFZ2H6VKpx/8DyPYZgsy4WmfBpF0XA4pCgqTdNcfwRbloXjuOM4Fbiwmc1mk8mk0NRybS6wXy55hNKypuKzqqrnfQZZrVaf+Oz7PgSlDKO17aq6pZu2ohr1RlvWzMNes2zH+wKO46j98NIgjBah/XqQbzGxMVBapHaHqxg5z7K0DHuedwTvdtvOYHnVXXVo77LFXXX4654IK2juaSlDSRmGJJum+QEnye5+IvSndv9R79NaeyDBio20NqE80AswK8OSrLDcEjb79D1g9nRmPTPrP0zouQzzHPheGPiw7qKowBRxsRj16N4N3b0Rn+4VkXuD97aLgk262R7+LVWjDZk7ZGE+fuleTJsXAnFpjK4E5hGdpgrK6wR+Lcy1KfNzfj57ntKKwDr2+u3m7XYbBP5ms3EcG8P6YRCE8AZBHMfnUmWUo73r4ExvqHXJVYdc/ezNu5QCAWvgEjlmC7siVZqmfcBRtL3rszeY0qLsb032uif8OORJ+N4R8ZFQgatFAiFt4IvW0G7TVpMyGoTWJPQWqd/+VvAh+wWM0lTnRZkT4FElZTyeqJqh6SaUquv5X5Qn2u/jlwXSdGSYWRgqivJ5YxiGcdRV6L2O4iShaRqVpAJDz3Ecd9ySB7NDJQi8UK/X/zUMYIAQgwFMi6NhUJgKgkCR1Hq9PgtD2qevUoVz6zAM4VroG5iEp24DDD7DKcyTKgxnLMsCzDAMVM5ptGAAQfFCRCVJypW17D/kL8BPjg5Da9QCAAAAAElFTkSuQmCC\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="688dacfe 1057 412f b3a1 86abb5b0f914" title="" data-src="/static/688dacfe-1057-412f-b3a1-86abb5b0f914-1981e3684ab12885095511a5bee9220d-6dd13.png" data-srcset="/static/688dacfe-1057-412f-b3a1-86abb5b0f914-1981e3684ab12885095511a5bee9220d-fad05.png 200w,\n/static/688dacfe-1057-412f-b3a1-86abb5b0f914-1981e3684ab12885095511a5bee9220d-a671c.png 400w,\n/static/688dacfe-1057-412f-b3a1-86abb5b0f914-1981e3684ab12885095511a5bee9220d-6dd13.png 459w" data-sizes="(max-width: 459px) 100vw, 459px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<h2 id="解决方法"><a href="#%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>解决方法</h2>\n<p>产生并发不一致性问题主要原因是破坏了事务的隔离性，解决方法是通过并发控制来保证隔离性。</p>\n<p>在没有并发的情况下，事务以串行的方式执行，互不干扰，因此可以保证隔离性。在并发的情况下，如果能通过并发控制，让事务的执行结果和某一个串行执行的结果相同，就认为事务的执行结果满足隔离性要求，也就是说是正确的。把这种事务执行方式称为 <strong>可串行化调度</strong> 。</p>\n<p><strong>并发控制可以通过封锁来实现，但是封锁操作需要用户自己控制，相当复杂。数据库管理系统提供了事务的隔离级别，让用户以一种更轻松的方式处理并发一致性问题。</strong></p>\n<h1 id="三、封锁"><a href="#%E4%B8%89%E3%80%81%E5%B0%81%E9%94%81" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>三、封锁</h1>\n<h2 id="封锁粒度"><a href="#%E5%B0%81%E9%94%81%E7%B2%92%E5%BA%A6" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>封锁粒度</h2>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/1a851e90-0d5c-4d4f-ac54-34c20ecfb903-52bf098a69c66740636507d9638776ca-cba36.jpg" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 432px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 80.0925925925926%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAQABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAIDBf/EABQBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAezU0mgH/8QAGRAAAgMBAAAAAAAAAAAAAAAAAAIBERID/9oACAEBAAEFAujZFuYH0LdH/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAGRAAAgMBAAAAAAAAAAAAAAAAABARITEi/9oACAEBAAY/Askxclr/xAAbEAEAAwADAQAAAAAAAAAAAAABABEhEDFBYf/aAAgBAQABPyFAJo1EFaL5KmXW/ssz3j//2gAMAwEAAgADAAAAEHDP/8QAFhEAAwAAAAAAAAAAAAAAAAAAEBEh/9oACAEDAQE/EKx//8QAFhEAAwAAAAAAAAAAAAAAAAAAEBEh/9oACAECAQE/EIh//8QAHRABAAICAgMAAAAAAAAAAAAAAREhADEQUXGR4f/aAAgBAQABPxCVGodV4xyhBW6wAVPvI5sTsGz5vIdGthpeP//Z\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="1a851e90 0d5c 4d4f ac54 34c20ecfb903" title="" data-src="/static/1a851e90-0d5c-4d4f-ac54-34c20ecfb903-52bf098a69c66740636507d9638776ca-cba36.jpg" data-srcset="/static/1a851e90-0d5c-4d4f-ac54-34c20ecfb903-52bf098a69c66740636507d9638776ca-d4ced.jpg 200w,\n/static/1a851e90-0d5c-4d4f-ac54-34c20ecfb903-52bf098a69c66740636507d9638776ca-88845.jpg 400w,\n/static/1a851e90-0d5c-4d4f-ac54-34c20ecfb903-52bf098a69c66740636507d9638776ca-cba36.jpg 432w" data-sizes="(max-width: 432px) 100vw, 432px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>应该尽量只锁定需要修改的那部分数据，而不是所有的资源。锁定的数据量越少，发生锁争用的可能就越小，系统的并发程度就越高。</p>\n<p>但是加锁需要消耗资源，锁的各种操作，包括获取锁，检查锁是否已经解除、释放锁，都会增加系统开销。因此封锁粒度越小，系统开销就越大。需要在锁开销以及数据安全性之间做一个权衡。</p>\n<p>MySQL 中提供了两种封锁粒度：行级锁以及表级锁。</p>\n<h2 id="封锁类型"><a href="#%E5%B0%81%E9%94%81%E7%B1%BB%E5%9E%8B" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>封锁类型</h2>\n<h3 id="1-排它锁与共享锁"><a href="#1-%E6%8E%92%E5%AE%83%E9%94%81%E4%B8%8E%E5%85%B1%E4%BA%AB%E9%94%81" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. 排它锁与共享锁</h3>\n<ul>\n<li>排它锁（Exclusive），简写为 X 锁，又称写锁。</li>\n<li>共享锁（Shared），简写为 S 锁，又称读锁。</li>\n</ul>\n<p>有以下两个规定：</p>\n<ol>\n<li>一个事务对数据对象 A 加了 X 锁，就可以对 A 进行读取和更新。加锁期间其它事务不能对 A 加任何锁。</li>\n<li>一个事务对数据对象 A 加了 S 锁，可以对 A 进行读取操作，但是不能进行更新操作。加锁期间其它事务能对 A 加 S 锁，但是不能加 X 锁。</li>\n</ol>\n<p>锁的兼容关系如下：</p>\n<table>\n<thead>\n<tr>\n<th align="center">-</th>\n<th align="center">X</th>\n<th align="center">S</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align="center">X</td>\n<td align="center">No</td>\n<td align="center">No</td>\n</tr>\n<tr>\n<td align="center">S</td>\n<td align="center">No</td>\n<td align="center">Yes</td>\n</tr>\n</tbody>\n</table>\n<h3 id="2-意向锁"><a href="#2-%E6%84%8F%E5%90%91%E9%94%81" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. 意向锁</h3>\n<p>意向锁（Intention Locks）可以支持多粒度封锁。它本身是一个表锁，通过在原来的 X/S 锁之上引入了 IX/IS，用来表示一个事务想要在某个数据行上加 X 锁或 S 锁。</p>\n<p>有以下两个规定：</p>\n<ol>\n<li>一个事务在获得某个数据行对象的 S 锁之前，必须先获得 IS 锁或者更强的锁；</li>\n<li>一个事务在获得某个数据行对象的 X 锁之前，必须先获得 IX 锁。</li>\n</ol>\n<p>各种锁的兼容关系如下：</p>\n<table>\n<thead>\n<tr>\n<th align="center">-</th>\n<th align="center">X</th>\n<th align="center">IX</th>\n<th align="center">S</th>\n<th align="center">IS</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align="center">X</td>\n<td align="center">No</td>\n<td align="center">No</td>\n<td align="center">No</td>\n<td align="center">No</td>\n</tr>\n<tr>\n<td align="center">IX</td>\n<td align="center">No</td>\n<td align="center">Yes</td>\n<td align="center">No</td>\n<td align="center">Yes</td>\n</tr>\n<tr>\n<td align="center">S</td>\n<td align="center">No</td>\n<td align="center">No</td>\n<td align="center">Yes</td>\n<td align="center">Yes</td>\n</tr>\n<tr>\n<td align="center">IS</td>\n<td align="center">No</td>\n<td align="center">Yes</td>\n<td align="center">Yes</td>\n<td align="center">Yes</td>\n</tr>\n</tbody>\n</table>\n<h2 id="封锁协议"><a href="#%E5%B0%81%E9%94%81%E5%8D%8F%E8%AE%AE" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>封锁协议</h2>\n<h3 id="1-三级封锁协议"><a href="#1-%E4%B8%89%E7%BA%A7%E5%B0%81%E9%94%81%E5%8D%8F%E8%AE%AE" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. 三级封锁协议</h3>\n<p><strong>一级封锁协议</strong></p>\n<p>事务 T 要修改数据 A 时必须加 X 锁，直到 T 结束才释放锁。</p>\n<p>可以解决丢失修改问题，因为不能同时有两个事务对同一个数据进行修改，那么一个事务的修改就不会被覆盖。</p>\n<table>\n<thead>\n<tr>\n<th align="center">T\n<sub>\n1\n</sub></th>\n<th align="center">T\n<sub>\n1\n</sub></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align="center">lock-x(A)</td>\n<td align="center"></td>\n</tr>\n<tr>\n<td align="center">read A=20</td>\n<td align="center"></td>\n</tr>\n<tr>\n<td align="center"></td>\n<td align="center">lock-x(A)</td>\n</tr>\n<tr>\n<td align="center"></td>\n<td align="center">wait</td>\n</tr>\n<tr>\n<td align="center">write A=19</td>\n<td align="center"></td>\n</tr>\n<tr>\n<td align="center">commit</td>\n<td align="center"></td>\n</tr>\n<tr>\n<td align="center">unlock-x(A)</td>\n<td align="center"></td>\n</tr>\n<tr>\n<td align="center"></td>\n<td align="center">obtain</td>\n</tr>\n<tr>\n<td align="center"></td>\n<td align="center">read A=19</td>\n</tr>\n<tr>\n<td align="center"></td>\n<td align="center">write A=21</td>\n</tr>\n<tr>\n<td align="center"></td>\n<td align="center">commit</td>\n</tr>\n<tr>\n<td align="center"></td>\n<td align="center">unlock-x(A)</td>\n</tr>\n</tbody>\n</table>\n<p><strong>二级封锁协议</strong></p>\n<p>在一级的基础上，要求读取数据 A 时必须加 S 锁，读取完马上释放 S 锁。</p>\n<p>可以解决读脏数据问题，因为如果一个事务在对数据 A 进行修改，根据 1 级封锁协议，会加 X 锁，那么就不能再加 S 锁了，也就是不会读入数据。</p>\n<table>\n<thead>\n<tr>\n<th align="center">T\n<sub>\n1\n</sub></th>\n<th align="center">T\n<sub>\n1\n</sub></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align="center">lock-x(A)</td>\n<td align="center"></td>\n</tr>\n<tr>\n<td align="center">read A=20</td>\n<td align="center"></td>\n</tr>\n<tr>\n<td align="center">write A=19</td>\n<td align="center"></td>\n</tr>\n<tr>\n<td align="center"></td>\n<td align="center">lock-s(A)</td>\n</tr>\n<tr>\n<td align="center"></td>\n<td align="center">wait</td>\n</tr>\n<tr>\n<td align="center">rollback</td>\n<td align="center"></td>\n</tr>\n<tr>\n<td align="center">A=20</td>\n<td align="center"></td>\n</tr>\n<tr>\n<td align="center">unlock-x(A)</td>\n<td align="center"></td>\n</tr>\n<tr>\n<td align="center"></td>\n<td align="center">obtain</td>\n</tr>\n<tr>\n<td align="center"></td>\n<td align="center">read A=20</td>\n</tr>\n<tr>\n<td align="center"></td>\n<td align="center">commit</td>\n</tr>\n<tr>\n<td align="center"></td>\n<td align="center">unlock-s(A)</td>\n</tr>\n</tbody>\n</table>\n<p><strong>三级封锁协议</strong></p>\n<p>在二级的基础上，要求读取数据 A 时必须加 S 锁，直到事务结束了才能释放 S 锁。</p>\n<p>可以解决不可重复读的问题，因为读 A 时，其它事务不能对 A 加 X 锁，从而避免了在读的期间数据发生改变。</p>\n<table>\n<thead>\n<tr>\n<th align="center">T\n<sub>\n1\n</sub></th>\n<th align="center">T\n<sub>\n1\n</sub></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align="center">lock-s(A)</td>\n<td align="center"></td>\n</tr>\n<tr>\n<td align="center">read A=20</td>\n<td align="center"></td>\n</tr>\n<tr>\n<td align="center"></td>\n<td align="center">lock-x(A)</td>\n</tr>\n<tr>\n<td align="center"></td>\n<td align="center">wait</td>\n</tr>\n<tr>\n<td align="center">read A=20</td>\n<td align="center"></td>\n</tr>\n<tr>\n<td align="center">commit</td>\n<td align="center"></td>\n</tr>\n<tr>\n<td align="center">unlock-s(A)</td>\n<td align="center"></td>\n</tr>\n<tr>\n<td align="center"></td>\n<td align="center">obtain</td>\n</tr>\n<tr>\n<td align="center"></td>\n<td align="center">read A=20</td>\n</tr>\n<tr>\n<td align="center"></td>\n<td align="center">write A=19</td>\n</tr>\n<tr>\n<td align="center"></td>\n<td align="center">commit</td>\n</tr>\n<tr>\n<td align="center"></td>\n<td align="center">unlock-X(A)</td>\n</tr>\n</tbody>\n</table>\n<h3 id="2-两段锁协议"><a href="#2-%E4%B8%A4%E6%AE%B5%E9%94%81%E5%8D%8F%E8%AE%AE" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. 两段锁协议</h3>\n<p>加锁和解锁分为两个阶段进行，事务 T 对数据 A 进行读或者写操作之前，必须先获得对 A 的封锁，并且在释放一个封锁之后，T 不能再获得任何的其它锁。</p>\n<p>事务遵循两段锁协议是保证并发操作可串行化调度的充分条件。例如以下操作满足两段锁协议，它是可串行化调度。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="2387723825528765000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`lock-x(A)...lock-s(B)...lock-s(c)...unlock(A)...unlock(C)...unlock(B)`, `2387723825528765000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="html"\n              >\n                <span class="gatsby-code-button-language">html</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="html"><pre style="counter-reset: linenumber NaN" class="language-html line-numbers"><code class="language-html">lock-x(A)...lock-s(B)...lock-s(c)...unlock(A)...unlock(C)...unlock(B)</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>\n<p>但不是必要条件，例如以下操作不满足两段锁协议，但是它还是可串行化调度。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="4466349753190313000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`lock-x(A)...unlock(A)...lock-s(B)...unlock(B)...lock-s(c)...unlock(C)...`, `4466349753190313000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="html"\n              >\n                <span class="gatsby-code-button-language">html</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="html"><pre style="counter-reset: linenumber NaN" class="language-html line-numbers"><code class="language-html">lock-x(A)...unlock(A)...lock-s(B)...unlock(B)...lock-s(c)...unlock(C)...</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>\n<h1 id="四、隔离级别"><a href="#%E5%9B%9B%E3%80%81%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>四、隔离级别</h1>\n<p><font size=4> <strong>1. 未提交读（READ UNCOMMITTED）</strong> </font> </br></p>\n<p>事务中的修改，即使没有提交，对其它事务也是可见的。</p>\n<p><font size=4> <strong>2. 提交读（READ COMMITTED）</strong> </font> </br></p>\n<p>一个事务只能读取已经提交的事务所做的修改。换句话说，一个事务所做的修改在提交之前对其它事务是不可见的。</p>\n<p><font size=4> <strong>3. 可重复读（REPEATABLE READ）</strong> </font> </br></p>\n<p>保证在同一个事务中多次读取同样数据的结果是一样的。</p>\n<p><font size=4> <strong>4. 可串行化（SERIALIXABLE）</strong> </font> </br></p>\n<p>强制事务串行执行。</p>\n<p><font size=4> <strong>四个隔离级别的对比</strong> </font> </br></p>\n<table>\n<thead>\n<tr>\n<th align="center">隔离级别</th>\n<th align="center">脏读</th>\n<th align="center">不可重复读</th>\n<th align="center">幻影读</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align="center">未提交读</td>\n<td align="center">YES</td>\n<td align="center">YES</td>\n<td align="center">YES</td>\n</tr>\n<tr>\n<td align="center">提交读</td>\n<td align="center">NO</td>\n<td align="center">YES</td>\n<td align="center">YES</td>\n</tr>\n<tr>\n<td align="center">可重复读</td>\n<td align="center">NO</td>\n<td align="center">NO</td>\n<td align="center">YES</td>\n</tr>\n<tr>\n<td align="center">可串行化</td>\n<td align="center">NO</td>\n<td align="center">NO</td>\n<td align="center">NO</td>\n</tr>\n</tbody>\n</table>\n<h1 id="五、多版本并发控制"><a href="#%E4%BA%94%E3%80%81%E5%A4%9A%E7%89%88%E6%9C%AC%E5%B9%B6%E5%8F%91%E6%8E%A7%E5%88%B6" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>五、多版本并发控制</h1>\n<p>（Multi-Version Concurrency Control, MVCC）是 MySQL 的 InnoDB 存储引擎实现隔离级别的一种具体方式，用于实现提交读和可重复读这两种隔离级别。而未提交读隔离级别总是读取最新的数据行，无需使用 MVCC；可串行化隔离级别需要对所有读取的行都加锁，单纯使用 MVCC 无法实现。</p>\n<h2 id="版本号"><a href="#%E7%89%88%E6%9C%AC%E5%8F%B7" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>版本号</h2>\n<ul>\n<li>系统版本号：是一个递增的数字，每开始一个新的事务，系统版本号就会自动递增。</li>\n<li>事务版本号：事务开始时的系统版本号。</li>\n</ul>\n<p>InooDB 的 MVCC 在每行记录后面都保存着两个隐藏的列，用来存储两个版本号：</p>\n<ul>\n<li>创建版本号：指示创建一个数据行的快照时的系统版本号；</li>\n<li>删除版本号：如果该快照的删除版本号大于当前事务版本号表示该快照有效，否则表示该快照已经被删除了。</li>\n</ul>\n<h2 id="undo-日志"><a href="#undo-%E6%97%A5%E5%BF%97" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Undo 日志</h2>\n<p>InnoDB 的 MVCC 使用到的快照存储在 Undo 日志中，该日志通过回滚指针把一个数据行（Record）的所有快照连接起来。</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/e41405a8-7c05-4f70-8092-e961e28d3112-e4fb40fe4b5144998bf1b1179d8da315-6ce5d.jpg" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 536px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 36.38059701492538%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAHABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAIF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3QUD/8QAFRABAQAAAAAAAAAAAAAAAAAAEDH/2gAIAQEAAQUCj//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAABD/2gAIAQEABj8Cf//EABkQAAIDAQAAAAAAAAAAAAAAAAABESFRYf/aAAgBAQABPyG+iXgj/9oADAMBAAIAAwAAABDwD//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABoQAQADAAMAAAAAAAAAAAAAAAEAETEhQZH/2gAIAQEAAT8QSxNPc58exKWlT//Z\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="e41405a8 7c05 4f70 8092 e961e28d3112" title="" data-src="/static/e41405a8-7c05-4f70-8092-e961e28d3112-e4fb40fe4b5144998bf1b1179d8da315-6ce5d.jpg" data-srcset="/static/e41405a8-7c05-4f70-8092-e961e28d3112-e4fb40fe4b5144998bf1b1179d8da315-60771.jpg 200w,\n/static/e41405a8-7c05-4f70-8092-e961e28d3112-e4fb40fe4b5144998bf1b1179d8da315-bb403.jpg 400w,\n/static/e41405a8-7c05-4f70-8092-e961e28d3112-e4fb40fe4b5144998bf1b1179d8da315-6ce5d.jpg 536w" data-sizes="(max-width: 536px) 100vw, 536px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<h2 id="实现过程"><a href="#%E5%AE%9E%E7%8E%B0%E8%BF%87%E7%A8%8B" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>实现过程</h2>\n<p>以下过程针对可重复读隔离级别。</p>\n<h3 id="1-select"><a href="#1-select" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. SELECT</h3>\n<p>该操作必须保证多个事务读取到同一个数据行的快照，这个快照是最近的一个有效快照。但是也有例外，如果有一个事务正在修改该数据行，那么它可以读取事务本身所做的修改，而不用和其它事务的读取结果一致。</p>\n<p>当开始新一个事务时，该事务的版本号肯定会大于当前所有数据行快照的创建版本号，理解这一点很关键。</p>\n<p>把没对一个数据行做修改的事务称为 T，T 所要读取的数据行快照的创建版本号必须小于 T 的版本号，因为如果大于或者等于 T 的版本号，那么表示该数据行快照是其它事务的最新修改，因此不能去读取它。</p>\n<p>除了上面的要求，T 所要读取的数据行快照的删除版本号必须大于 T 的版本号，因为如果小于等于 T 的版本号，那么表示该数据行快照是已经被删除的，不应该去读取它。</p>\n<h3 id="2-insert"><a href="#2-insert" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. INSERT</h3>\n<p>将系统版本号作为数据行快照的创建版本号。</p>\n<h3 id="3-delete"><a href="#3-delete" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. DELETE</h3>\n<p>将系统版本号作为数据行快照的删除版本号。</p>\n<h3 id="4-update"><a href="#4-update" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4. UPDATE</h3>\n<p>将系统版本号作为更新后的数据行快照的创建版本号，同时将系统版本号作为作为更新前的数据行快照的删除版本号。可以理解为先执行 DELETE 后执行 INSERT。</p>\n<h2 id="快照读与当前读"><a href="#%E5%BF%AB%E7%85%A7%E8%AF%BB%E4%B8%8E%E5%BD%93%E5%89%8D%E8%AF%BB" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>快照读与当前读</h2>\n<h3 id="1-当前读"><a href="#1-%E5%BD%93%E5%89%8D%E8%AF%BB" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. 当前读</h3>\n<p>读取最新的数据。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="75116035609873380000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`select * from table ....;`, `75116035609873380000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">table</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>\n<h3 id="2-快照读"><a href="#2-%E5%BF%AB%E7%85%A7%E8%AF%BB" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. 快照读</h3>\n<p>读取快照中的数据。</p>\n<p>引入快照读的目的主要是为了免去加锁操作带来的性能开销，但是当前读需要加锁。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="14186114834175357000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`select * from table where ? lock in share mode;\nselect * from table where ? for update;\ninsert;\nupdate ;\ndelete;`, `14186114834175357000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">table</span> <span class="token keyword">where</span> ? <span class="token keyword">lock</span> <span class="token operator">in</span> <span class="token keyword">share</span> <span class="token keyword">mode</span><span class="token punctuation">;</span>\n<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">table</span> <span class="token keyword">where</span> ? <span class="token keyword">for</span> <span class="token keyword">update</span><span class="token punctuation">;</span>\n<span class="token keyword">insert</span><span class="token punctuation">;</span>\n<span class="token keyword">update</span> <span class="token punctuation">;</span>\n<span class="token keyword">delete</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h1 id="六、next-key-locks"><a href="#%E5%85%AD%E3%80%81next-key-locks" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>六、Next-Key Locks</h1>\n<p>Next-Key Locks 也是 MySQL 的 InnoDB 存储引擎的一种锁实现。MVCC 不能解决幻读的问题，Next-Key Locks 就是为了解决这个问题而存在的。在可重复读隔离级别下，MVCC + Next-Key Locks，就可以防止幻读的出现。</p>\n<h2 id="record-locks"><a href="#record-locks" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Record Locks</h2>\n<p>锁定的对象是索引，而不是数据。如果表没有设置索引，InnoDB 会自动在主键上创建隐藏的聚集索引，因此 Record Locks 依然可以使用。</p>\n<h2 id="grap-locks"><a href="#grap-locks" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Grap Locks</h2>\n<p>锁定一个范围内的索引，例如当一个事务执行以下语句，其它事务就不能在 t.c 中插入 15。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="57423398543330480000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`SELECT c FROM t WHERE c BETWEEN 10 and 20 FOR UPDATE;`, `57423398543330480000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql"><span class="token keyword">SELECT</span> c <span class="token keyword">FROM</span> t <span class="token keyword">WHERE</span> c <span class="token operator">BETWEEN</span> <span class="token number">10</span> <span class="token operator">and</span> <span class="token number">20</span> <span class="token keyword">FOR</span> <span class="token keyword">UPDATE</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>\n<h2 id="next-key-locks"><a href="#next-key-locks" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Next-Key Locks</h2>\n<p>它是 Record Locks 和 Gap Locks 的结合。在 user 中有以下记录：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="32102946821855970000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`|   id | last_name   | first_name   |   age |\n|------|-------------|--------------|-------|\n|    4 | stark       | tony         |    21 |\n|    1 | tom         | hiddleston   |    30 |\n|    3 | morgan      | freeman      |    40 |\n|    5 | jeff        | dean         |    50 |\n|    2 | donald      | trump        |    80 |\n+------|-------------|--------------|-------+`, `32102946821855970000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql"><span class="token operator">|</span>   id <span class="token operator">|</span> last_name   <span class="token operator">|</span> first_name   <span class="token operator">|</span>   age <span class="token operator">|</span>\n<span class="token operator">|</span><span class="token comment">------|-------------|--------------|-------|</span>\n<span class="token operator">|</span>    <span class="token number">4</span> <span class="token operator">|</span> stark       <span class="token operator">|</span> tony         <span class="token operator">|</span>    <span class="token number">21</span> <span class="token operator">|</span>\n<span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span> tom         <span class="token operator">|</span> hiddleston   <span class="token operator">|</span>    <span class="token number">30</span> <span class="token operator">|</span>\n<span class="token operator">|</span>    <span class="token number">3</span> <span class="token operator">|</span> morgan      <span class="token operator">|</span> freeman      <span class="token operator">|</span>    <span class="token number">40</span> <span class="token operator">|</span>\n<span class="token operator">|</span>    <span class="token number">5</span> <span class="token operator">|</span> jeff        <span class="token operator">|</span> dean         <span class="token operator">|</span>    <span class="token number">50</span> <span class="token operator">|</span>\n<span class="token operator">|</span>    <span class="token number">2</span> <span class="token operator">|</span> donald      <span class="token operator">|</span> trump        <span class="token operator">|</span>    <span class="token number">80</span> <span class="token operator">|</span>\n<span class="token operator">+</span><span class="token comment">------|-------------|--------------|-------+</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>那么就需要锁定以下范围：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="86617125728195200000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`(-∞, 21]\n(21, 30]\n(30, 40]\n(40, 50]\n(50, 80]\n(80, ∞)`, `86617125728195200000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql"><span class="token punctuation">(</span><span class="token operator">-</span>∞<span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">]</span>\n<span class="token punctuation">(</span><span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">]</span>\n<span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">]</span>\n<span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">]</span>\n<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">]</span>\n<span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">,</span> ∞<span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h1 id="七、关系数据库设计理论"><a href="#%E4%B8%83%E3%80%81%E5%85%B3%E7%B3%BB%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1%E7%90%86%E8%AE%BA" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>七、关系数据库设计理论</h1>\n<h2 id="函数依赖"><a href="#%E5%87%BD%E6%95%B0%E4%BE%9D%E8%B5%96" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>函数依赖</h2>\n<p>记 A->B 表示 A 函数决定 B，也可以说 B 函数依赖于 A。</p>\n<p>如果 {A1，A2，… ，An} 是关系的一个或多个属性的集合，该集合决定了关系的其它所有属性并且是最小的，那么该集合就称为键码。</p>\n<p>对于 W->A，如果能找到 W 的真子集 W’，使得 W’-> A，那么 W->A 就是部分函数依赖，否则就是完全函数依赖；</p>\n<h2 id="异常"><a href="#%E5%BC%82%E5%B8%B8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>异常</h2>\n<p>以下的学生课程关系的函数依赖为 Sno, Cname -> Sname, Sdept, Mname, Grade，键码为 {Sno, Cname}。也就是说，确定学生和课程之后，就能确定其它信息。</p>\n<table>\n<thead>\n<tr>\n<th align="center">Sno</th>\n<th align="center">Sname</th>\n<th align="center">Sdept</th>\n<th align="center">Mname</th>\n<th align="center">Cname</th>\n<th align="center">Grade</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align="center">1</td>\n<td align="center">学生-1</td>\n<td align="center">学院-1</td>\n<td align="center">院长-1</td>\n<td align="center">课程-1</td>\n<td align="center">90</td>\n</tr>\n<tr>\n<td align="center">2</td>\n<td align="center">学生-2</td>\n<td align="center">学院-2</td>\n<td align="center">院长-2</td>\n<td align="center">课程-2</td>\n<td align="center">80</td>\n</tr>\n<tr>\n<td align="center">2</td>\n<td align="center">学生-2</td>\n<td align="center">学院-2</td>\n<td align="center">院长-2</td>\n<td align="center">课程-1</td>\n<td align="center">100</td>\n</tr>\n</tbody>\n</table>\n<p>不符合范式的关系，会产生很多异常，主要有以下四种异常：</p>\n<ol>\n<li>冗余数据，例如学生-2 出现了两次。</li>\n<li>修改异常，修改了一个记录中的信息，但是另一个记录中相同的信息却没有被修改。</li>\n<li>删除异常，删除一个信息，那么也会丢失其它信息。例如如果删除了课程-1，需要删除第二行和第三行，那么学生-1 的信息就会丢失。</li>\n<li>插入异常，例如想要插入一个学生的信息，如果这个学生还没选课，那么就无法插入。</li>\n</ol>\n<h2 id="范式"><a href="#%E8%8C%83%E5%BC%8F" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>范式</h2>\n<p>范式理论是为了解决以上提到四种异常。高级别范式的依赖于低级别的范式。</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/c2d343f7-604c-4856-9a3c-c71d6f67fecc-7ba22bf87301fe8adab3ed66b10413a7-1c0b9.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 472px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 83.68644067796612%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAIAAABSJhvpAAAACXBIWXMAAAsSAAALEgHS3X78AAABwElEQVQ4y22TW6+CQAyE+f9/yQcNvEiIGA2RRKISL1FBRcUbeDnnC2NAifuwdLuddjpsjb/v9Xq92J/PZ57n1+s1SZLL5ZJlGR7dKkDLKC2C9vv94/FI0zQp1ul0AoP/cDhwZFeKL7CSDYfDVqtFxP1+lweD4lmxRGS73WL8qExNkJ7nua4LhePxyPF8PkMEQ57b7QYFctXBu90OL3dBEMRxTC7qizPItFjE0Asxomboo5Siulqtms2m7/vEAVafsOUoOpDHX4FBco3NBXjiTNO0bduyrPl8LvIAMIiElyq9wWDYlVu5iKNIGIboRF6ogVfnURSBh9EbTDMYXEhYjsqFQf3RaKSfL8FxzmYzRKnA3IkMKQjSkYjxeEz/y+Vys9lwxU7l6XRaVSaOA6WAQRiSwJSL42AwaDQa6/UaXmSBCHvVMxj9RvoEBhGByYgHqfj5juMgAfr1+32cX/8ZPnQLALUBYxNBKXSiZrvd7na77L1ej4dQfyRg0FDvpHxJyAspyQ4McKfT+fHChKemnkH5JHkzUEUhKoMnbzkORm0kaVJThaRgJpMJ8jAzaLZYLD7n8Qf4c56hp6kq56w2z/87i8krO/VKyQAAAABJRU5ErkJggg==\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="c2d343f7 604c 4856 9a3c c71d6f67fecc" title="" data-src="/static/c2d343f7-604c-4856-9a3c-c71d6f67fecc-7ba22bf87301fe8adab3ed66b10413a7-1c0b9.png" data-srcset="/static/c2d343f7-604c-4856-9a3c-c71d6f67fecc-7ba22bf87301fe8adab3ed66b10413a7-689e7.png 200w,\n/static/c2d343f7-604c-4856-9a3c-c71d6f67fecc-7ba22bf87301fe8adab3ed66b10413a7-d007c.png 400w,\n/static/c2d343f7-604c-4856-9a3c-c71d6f67fecc-7ba22bf87301fe8adab3ed66b10413a7-1c0b9.png 472w" data-sizes="(max-width: 472px) 100vw, 472px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<h3 id="1-第一范式-1nf"><a href="#1-%E7%AC%AC%E4%B8%80%E8%8C%83%E5%BC%8F-1nf" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. 第一范式 (1NF)</h3>\n<p>属性不可分；</p>\n<h3 id="2-第二范式-2nf"><a href="#2-%E7%AC%AC%E4%BA%8C%E8%8C%83%E5%BC%8F-2nf" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. 第二范式 (2NF)</h3>\n<p>每个非主属性完全函数依赖于键码。</p>\n<p>可以通过分解来满足。</p>\n<p><font size=4> <strong>分解前</strong> </font><br></p>\n<table>\n<thead>\n<tr>\n<th align="center">Sno</th>\n<th align="center">Sname</th>\n<th align="center">Sdept</th>\n<th align="center">Mname</th>\n<th align="center">Cname</th>\n<th align="center">Grade</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align="center">1</td>\n<td align="center">学生-1</td>\n<td align="center">学院-1</td>\n<td align="center">院长-1</td>\n<td align="center">课程-1</td>\n<td align="center">90</td>\n</tr>\n<tr>\n<td align="center">2</td>\n<td align="center">学生-2</td>\n<td align="center">学院-2</td>\n<td align="center">院长-2</td>\n<td align="center">课程-2</td>\n<td align="center">80</td>\n</tr>\n<tr>\n<td align="center">2</td>\n<td align="center">学生-2</td>\n<td align="center">学院-2</td>\n<td align="center">院长-2</td>\n<td align="center">课程-1</td>\n<td align="center">100</td>\n</tr>\n</tbody>\n</table>\n<p>以上学生课程关系中，{Sno, Cname} 为键码，有如下函数依赖：</p>\n<ul>\n<li>Sno, Cname -> Sname, Sdept, Mname</li>\n<li>Sno -> Sname, Sdept</li>\n<li>Sdept -> Mname</li>\n<li>Sno -> Manme</li>\n<li>Sno, Cname-> Grade</li>\n</ul>\n<p>Grade 完全函数依赖于键码，它没有任何冗余数据，每个学生的每门课都有特定的成绩。</p>\n<p>Sname, Sdept 和 Manme 都函数依赖于 Sno，而部分依赖于键码。当一个学生选修了多门课时，这些数据就会出现多次，造成大量冗余数据。</p>\n<p><font size=4> <strong>分解后</strong> </font><br></p>\n<p>关系-1</p>\n<table>\n<thead>\n<tr>\n<th align="center">Sno</th>\n<th align="center">Sname</th>\n<th align="center">Sdept</th>\n<th align="center">Mname</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align="center">1</td>\n<td align="center">学生-1</td>\n<td align="center">学院-1</td>\n<td align="center">院长-1</td>\n</tr>\n<tr>\n<td align="center">2</td>\n<td align="center">学生-2</td>\n<td align="center">学院-2</td>\n<td align="center">院长-2</td>\n</tr>\n</tbody>\n</table>\n<p>有以下函数依赖：</p>\n<ul>\n<li>Sno -> Sname, Sdept, Mname</li>\n<li>Sdept -> Mname</li>\n</ul>\n<p>关系-2</p>\n<table>\n<thead>\n<tr>\n<th align="center">Sno</th>\n<th align="center">Cname</th>\n<th align="center">Grade</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align="center">1</td>\n<td align="center">课程-1</td>\n<td align="center">90</td>\n</tr>\n<tr>\n<td align="center">2</td>\n<td align="center">课程-2</td>\n<td align="center">80</td>\n</tr>\n<tr>\n<td align="center">2</td>\n<td align="center">课程-1</td>\n<td align="center">100</td>\n</tr>\n</tbody>\n</table>\n<p>有以下函数依赖：</p>\n<ul>\n<li>Sno, Cname -> Grade</li>\n</ul>\n<h3 id="3-第三范式-3nf"><a href="#3-%E7%AC%AC%E4%B8%89%E8%8C%83%E5%BC%8F-3nf" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. 第三范式 (3NF)</h3>\n<p>非主属性不传递依赖于键码。</p>\n<p>上面的关系-1 中存在以下传递依赖：Sno -> Sdept -> Mname，可以进行以下分解：</p>\n<p>关系-11</p>\n<table>\n<thead>\n<tr>\n<th align="center">Sno</th>\n<th align="center">Sname</th>\n<th align="center">Sdept</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align="center">1</td>\n<td align="center">学生-1</td>\n<td align="center">学院-1</td>\n</tr>\n<tr>\n<td align="center">2</td>\n<td align="center">学生-2</td>\n<td align="center">学院-2</td>\n</tr>\n</tbody>\n</table>\n<p>关系-12</p>\n<table>\n<thead>\n<tr>\n<th align="center">Sdept</th>\n<th align="center">Mname</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align="center">学院-1</td>\n<td align="center">院长-1</td>\n</tr>\n<tr>\n<td align="center">学院-2</td>\n<td align="center">院长-2</td>\n</tr>\n</tbody>\n</table>\n<h3 id="4-bc-范式（bcnf）"><a href="#4-bc-%E8%8C%83%E5%BC%8F%EF%BC%88bcnf%EF%BC%89" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4. BC 范式（BCNF）</h3>\n<p>所有属性不传递依赖于键码。</p>\n<p>关系 STC(Sname, Tname, Cname, Grade) 的四个属性分别为学生姓名、教师姓名、课程名和成绩，它的键码为 (Sname, Cname, Tname)，有以下函数依赖：</p>\n<ul>\n<li>Sname, Cname -> Tname</li>\n<li>Sname, Cname -> Grade</li>\n<li>Sname, Tname -> Cname</li>\n<li>Sname, Tname -> Grade</li>\n<li>Tname -> Cname</li>\n</ul>\n<p>存在着以下函数传递依赖：</p>\n<ul>\n<li>Sname -> Tname -> Cname</li>\n</ul>\n<p>可以分解成 SC(Sname, Cname, Grade) 和 ST(Sname, Tname)，对于 ST，属性之间是多对多关系，无函数依赖。</p>\n<h1 id="八、数据库系统概述"><a href="#%E5%85%AB%E3%80%81%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E6%A6%82%E8%BF%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>八、数据库系统概述</h1>\n<h2 id="基本术语"><a href="#%E5%9F%BA%E6%9C%AC%E6%9C%AF%E8%AF%AD" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>基本术语</h2>\n<h3 id="1-数据模型"><a href="#1-%E6%95%B0%E6%8D%AE%E6%A8%A1%E5%9E%8B" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. 数据模型</h3>\n<p>由数据结构、数据操作和完整性三个要素组成。</p>\n<h3 id="2-数据库系统"><a href="#2-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. 数据库系统</h3>\n<p>数据库系统包含所有与数据库相关的内容，包括数据库、数据库管理系统、应用程序以及数据库管理员和用户，还包括相关的硬件和软件。</p>\n<h2 id="数据库的三层模式和两层映像"><a href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E4%B8%89%E5%B1%82%E6%A8%A1%E5%BC%8F%E5%92%8C%E4%B8%A4%E5%B1%82%E6%98%A0%E5%83%8F" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>数据库的三层模式和两层映像</h2>\n<ul>\n<li>外模式：局部逻辑结构</li>\n<li>模式：全局逻辑结构</li>\n<li>内模式：物理结构</li>\n</ul>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/20150928140509757-bdd38a18c364cb5893ff4cc2dfb6b58b-b5415.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 95.72446555819477%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAIAAAAf7rriAAAACXBIWXMAAAsSAAALEgHS3X78AAAB0klEQVQ4y4XTyY4iQQwEUP7/17ggAUJi39cCxL7T/SjTRU9pRuMDmMi0I8JOCl9pnM/n1Wp1u92ez+dyuTwej8DdbrderyHX6xV4Op2Arm02G6C8EF/OqtXqfD4/HA6NRqPZbD4ej8FgAIRst1vJcDgE1uv1VqvVbrf3+/27GEOn04mu0+m01+tRoVe3292n0e/34ff7XTKZTFwgpxCyL5fLbDZTrFeWEC/XV814POZCx9FopBcO4LtYFiaZdxY/I1iFuy3RlHKnkJfnuBEzoKdUKjGMIfAwlSQJvFarUb5YLAzIFD7FOumHls84+B30qwlFbpJgip9phx8Jk4aMwTz8JNKQ+SRKDskM/8EcxbrahCFlmnGaOSpgcELexaiYpDYaR7gX+lerZZIs9HXbBRwkxFJfxTZWLBZpC56YvDL7NCGjmkzGx5+Aex7lctnpa1U8cBg7yCaMijwg53CIhwDRi3+f8WzznoMfA2PuUSTZphG9JBpFVX7a2YOjyD6xOTqkAY9/SMaRZw7PVKGtVCqu2lysDc4wjxnHX4p19VogBNtNVEoIBmaaP8Uqf68qHoPB3NLwKow6W0e+OBcaWaE/tpXqkuv7n2IkvHkP8dT+Fd/TSELbkDRP0gAAAABJRU5ErkJggg==\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="20150928140509757" title="" data-src="/static/20150928140509757-bdd38a18c364cb5893ff4cc2dfb6b58b-fee1c.png" data-srcset="/static/20150928140509757-bdd38a18c364cb5893ff4cc2dfb6b58b-a67b7.png 200w,\n/static/20150928140509757-bdd38a18c364cb5893ff4cc2dfb6b58b-0b187.png 400w,\n/static/20150928140509757-bdd38a18c364cb5893ff4cc2dfb6b58b-fee1c.png 800w,\n/static/20150928140509757-bdd38a18c364cb5893ff4cc2dfb6b58b-b5415.png 842w" data-sizes="(max-width: 800px) 100vw, 800px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<h3 id="1-外模式"><a href="#1-%E5%A4%96%E6%A8%A1%E5%BC%8F" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. 外模式</h3>\n<p>又称用户模式，是用户和数据库系统的接口，特定的用户只能访问数据库系统提供给他的外模式中的数据。例如不同的用户创建了不同数据库，那么一个用户只能访问他有权限访问的数据库。</p>\n<p>一个数据库可以有多个外模式，一个用户只能有一个外模式，但是一个外模式可以给多个用户使用。</p>\n<h3 id="2-模式"><a href="#2-%E6%A8%A1%E5%BC%8F" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. 模式</h3>\n<p>可以分为概念模式和逻辑模式，概念模式可以用概念-关系来描述；逻辑模式使用特定的数据模式（比如关系模型）来描述数据的逻辑结构，这种逻辑结构包括数据的组成、数据项的名称、类型、取值范围。不仅如此，逻辑模式还要描述数据之间的关系、数据的完整性与安全性要求。</p>\n<h3 id="3-内模式"><a href="#3-%E5%86%85%E6%A8%A1%E5%BC%8F" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. 内模式</h3>\n<p>又称为存储模式，描述记录的存储方式，例如索引的组织方式、数据是否压缩以及是否加密等等。</p>\n<h3 id="4-外模式模式映像"><a href="#4-%E5%A4%96%E6%A8%A1%E5%BC%8F%E6%A8%A1%E5%BC%8F%E6%98%A0%E5%83%8F" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4. 外模式/模式映像</h3>\n<p>把外模式的局部逻辑结构和模式的全局逻辑结构联系起来。该映像可以保证数据和应用程序的逻辑独立性。</p>\n<h3 id="5-模式内模式映像"><a href="#5-%E6%A8%A1%E5%BC%8F%E5%86%85%E6%A8%A1%E5%BC%8F%E6%98%A0%E5%83%8F" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>5. 模式/内模式映像</h3>\n<p>把模式的全局逻辑结构和内模式的物理结构联系起来，该映像可以保证数据和应用程序的物理独立性。</p>\n<h1 id="九、关系数据库建模"><a href="#%E4%B9%9D%E3%80%81%E5%85%B3%E7%B3%BB%E6%95%B0%E6%8D%AE%E5%BA%93%E5%BB%BA%E6%A8%A1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>九、关系数据库建模</h1>\n<h2 id="er-图"><a href="#er-%E5%9B%BE" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ER 图</h2>\n<p>Entity-Relationship，有三个组成部分：实体、属性、联系。</p>\n<h3 id="1-实体的三种联系"><a href="#1-%E5%AE%9E%E4%BD%93%E7%9A%84%E4%B8%89%E7%A7%8D%E8%81%94%E7%B3%BB" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. 实体的三种联系</h3>\n<p>联系包含一对一，一对多，多对多三种。</p>\n<p>如果 A 到 B 是一对多关系，那么画个带箭头的线段指向 B；如果是一对一，画两个带箭头的线段；如果是多对多，画两个不带箭头的线段。下图的 Course 和 Student 是一对多的关系。</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/292b4a35-4507-4256-84ff-c218f108ee31-bbd0031829e7578e92a5f8222b8fffb1-763cb.jpg" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 413px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 14.285714285714285%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAADABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAIF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3AWD/8QAFhABAQEAAAAAAAAAAAAAAAAAAAFB/9oACAEBAAEFAmR//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAEP/aAAgBAQAGPwJ//8QAGhAAAgIDAAAAAAAAAAAAAAAAAAERMSGR8P/aAAgBAQABPyGMO9kdZQ//2gAMAwEAAgADAAAAEAAP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGhABAAIDAQAAAAAAAAAAAAAAAQAxESFRkf/aAAgBAQABPxADt9IFs31Bgz//2Q==\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="292b4a35 4507 4256 84ff c218f108ee31" title="" data-src="/static/292b4a35-4507-4256-84ff-c218f108ee31-bbd0031829e7578e92a5f8222b8fffb1-763cb.jpg" data-srcset="/static/292b4a35-4507-4256-84ff-c218f108ee31-bbd0031829e7578e92a5f8222b8fffb1-819b6.jpg 200w,\n/static/292b4a35-4507-4256-84ff-c218f108ee31-bbd0031829e7578e92a5f8222b8fffb1-a059c.jpg 400w,\n/static/292b4a35-4507-4256-84ff-c218f108ee31-bbd0031829e7578e92a5f8222b8fffb1-763cb.jpg 413w" data-sizes="(max-width: 413px) 100vw, 413px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<h3 id="2-表示出现多次的关系"><a href="#2-%E8%A1%A8%E7%A4%BA%E5%87%BA%E7%8E%B0%E5%A4%9A%E6%AC%A1%E7%9A%84%E5%85%B3%E7%B3%BB" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. 表示出现多次的关系</h3>\n<p>一个实体在联系出现几次，就要用几条线连接。下图表示一个课程的先修关系，先修关系出现两个 Course 实体，第一个是先修课程，后一个是后修课程，因此需要用两条线来表示这种关系。</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/8b798007-e0fb-420c-b981-ead215692417-7153f449cde16ea60d36fd8e4e2a6192-ce34b.jpg" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 309px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 43.689320388349515%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAJABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAEDBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAdxUmUGH/8QAFxAAAwEAAAAAAAAAAAAAAAAAAQIQMf/aAAgBAQABBQKnEn//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAWEAEBAQAAAAAAAAAAAAAAAAAhACD/2gAIAQEABj8CSM//xAAbEAACAwADAAAAAAAAAAAAAAABEQAhMRBBgf/aAAgBAQABPyFk1RMPf1wNWFNJg8f/2gAMAwEAAgADAAAAEAAP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAHhAAAgEDBQAAAAAAAAAAAAAAAREAECExUWGhscH/2gAIAQEAAT8QeIbGQfY8zfAyZjRucAzq0//Z\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="8b798007 e0fb 420c b981 ead215692417" title="" data-src="/static/8b798007-e0fb-420c-b981-ead215692417-7153f449cde16ea60d36fd8e4e2a6192-ce34b.jpg" data-srcset="/static/8b798007-e0fb-420c-b981-ead215692417-7153f449cde16ea60d36fd8e4e2a6192-767ab.jpg 200w,\n/static/8b798007-e0fb-420c-b981-ead215692417-7153f449cde16ea60d36fd8e4e2a6192-ce34b.jpg 309w" data-sizes="(max-width: 309px) 100vw, 309px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<h3 id="3-联系的多向性"><a href="#3-%E8%81%94%E7%B3%BB%E7%9A%84%E5%A4%9A%E5%90%91%E6%80%A7" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. 联系的多向性</h3>\n<p>虽然老师可以开设多门课，并且可以教授多名学生，但是对于特定的学生和课程，只有一个老师教授，这就构成了一个三元联系。</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/423f2a40-bee1-488e-b460-8e76c48ee560-c954c93da557bf9d4f58096363a31cf2-24d05.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 436px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 25.688073394495415%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAAsSAAALEgHS3X78AAAAq0lEQVQY021P2Q6DIADz/z9No08kYlCieDx4IPEgAaJb55UlW59KaUvxtm1r27bv+67r1nV9/cN+4+SP7jnnwjAMgsD3/TRNx3FEhdZ6WZZhGOZ5ttY+bnsDqU8YTfBN06SUggR3FEXoYoyVZZllGSEE/JwGTimN47iqquvlJEnogbqupZScc7jzPEdYCIEjRGxBb1EUqMMViq4w1rIDTdMYY85fQUfge/Mv3t00GJ+MrziHAAAAAElFTkSuQmCC\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="423f2a40 bee1 488e b460 8e76c48ee560" title="" data-src="/static/423f2a40-bee1-488e-b460-8e76c48ee560-c954c93da557bf9d4f58096363a31cf2-24d05.png" data-srcset="/static/423f2a40-bee1-488e-b460-8e76c48ee560-c954c93da557bf9d4f58096363a31cf2-7ab77.png 200w,\n/static/423f2a40-bee1-488e-b460-8e76c48ee560-c954c93da557bf9d4f58096363a31cf2-a60d7.png 400w,\n/static/423f2a40-bee1-488e-b460-8e76c48ee560-c954c93da557bf9d4f58096363a31cf2-24d05.png 436w" data-sizes="(max-width: 436px) 100vw, 436px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>一般只使用二元联系，可以把多元关系转换为二元关系。</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/de9b9ea0-1327-4865-93e5-6f805c48bc9e-86a090eb324d35c8a77a373a1f062c87-c347e.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 555px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 35.67567567567567%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsSAAALEgHS3X78AAAA20lEQVQY03WQ6WqGMBREff83E/yjIOKKG+6KuOBuevqlSLE0IITJdebMVYQQYRhqmmYYRlEU53kuyzJN03EcPN33fV3X/Tnic+QdkbvCNwxDWZZt2/Z9HwSBZVmO49i2XVWVnBb/HOWvRGzXdeu6ep5nmmYURXEcAyUDiYE0yzIYld9sLxeG6CJZ8jyXIkSqquJIr3cyhZumoQLTdV1Lx33fSUZHBEoW/sGGcBzHeZ4BBhVv3/dd12UFkosQyFHYBe7PIr5/TpJE13XY0jTFldFt26j0gnr2/xT8ApPCjvhSRm4EAAAAAElFTkSuQmCC\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="de9b9ea0 1327 4865 93e5 6f805c48bc9e" title="" data-src="/static/de9b9ea0-1327-4865-93e5-6f805c48bc9e-86a090eb324d35c8a77a373a1f062c87-c347e.png" data-srcset="/static/de9b9ea0-1327-4865-93e5-6f805c48bc9e-86a090eb324d35c8a77a373a1f062c87-58c7f.png 200w,\n/static/de9b9ea0-1327-4865-93e5-6f805c48bc9e-86a090eb324d35c8a77a373a1f062c87-5d49f.png 400w,\n/static/de9b9ea0-1327-4865-93e5-6f805c48bc9e-86a090eb324d35c8a77a373a1f062c87-c347e.png 555w" data-sizes="(max-width: 555px) 100vw, 555px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<h3 id="4-表示子类"><a href="#4-%E8%A1%A8%E7%A4%BA%E5%AD%90%E7%B1%BB" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4. 表示子类</h3>\n<p>用一个三角形和两条线来连接类和子类，与子类有关的属性和联系都连到子类上，而与父类和子类都有关的连到父类上。</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/7ec9d619-fa60-4a2b-95aa-bf1a62aad408-59a43cdcd46a0629465eff0144fbcbb1-1c373.jpg" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 501px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 43.31337325349301%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAJABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAIDBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAd1azGAP/8QAGBAAAwEBAAAAAAAAAAAAAAAAAAExEBH/2gAIAQEAAQUC6MUxT//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEABj8CX//EABsQAAEFAQEAAAAAAAAAAAAAABEAARBBUSEx/9oACAEBAAE/IXA7SDviwh7g/9oADAMBAAIAAwAAABBTz//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABwQAAMAAQUAAAAAAAAAAAAAAAABEUEQMWFxsf/aAAgBAQABPxB8nOhmI2ea2iYpTh3T3No//9k=\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="7ec9d619 fa60 4a2b 95aa bf1a62aad408" title="" data-src="/static/7ec9d619-fa60-4a2b-95aa-bf1a62aad408-59a43cdcd46a0629465eff0144fbcbb1-1c373.jpg" data-srcset="/static/7ec9d619-fa60-4a2b-95aa-bf1a62aad408-59a43cdcd46a0629465eff0144fbcbb1-145e4.jpg 200w,\n/static/7ec9d619-fa60-4a2b-95aa-bf1a62aad408-59a43cdcd46a0629465eff0144fbcbb1-9ffa4.jpg 400w,\n/static/7ec9d619-fa60-4a2b-95aa-bf1a62aad408-59a43cdcd46a0629465eff0144fbcbb1-1c373.jpg 501w" data-sizes="(max-width: 501px) 100vw, 501px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<h1 id="十、约束"><a href="#%E5%8D%81%E3%80%81%E7%BA%A6%E6%9D%9F" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>十、约束</h1>\n<h2 id="1-键码"><a href="#1-%E9%94%AE%E7%A0%81" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. 键码</h2>\n<p>用于唯一表示一个实体。</p>\n<p>键码可以由多个属性构成，每个构成键码的属性称为码。</p>\n<h2 id="2-单值约束"><a href="#2-%E5%8D%95%E5%80%BC%E7%BA%A6%E6%9D%9F" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. 单值约束</h2>\n<p>某个属性的值是唯一的。</p>\n<h2 id="3-引用完整性约束"><a href="#3-%E5%BC%95%E7%94%A8%E5%AE%8C%E6%95%B4%E6%80%A7%E7%BA%A6%E6%9D%9F" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. 引用完整性约束</h2>\n<p>一个实体的属性引用的值在另一个实体的某个属性中存在。</p>\n<h2 id="4-域约束"><a href="#4-%E5%9F%9F%E7%BA%A6%E6%9D%9F" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4. 域约束</h2>\n<p>某个属性的值在特定范围之内。</p>\n<h2 id="5-一般约束"><a href="#5-%E4%B8%80%E8%88%AC%E7%BA%A6%E6%9D%9F" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>5. 一般约束</h2>\n<p>比如大小约束，数量约束。</p>\n<h1 id="参考资料"><a href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>参考资料</h1>\n<ul>\n<li>史嘉权. 数据库系统概论[M]. 清华大学出版社有限公司, 2006.</li>\n<li>施瓦茨. 高性能 MYSQL(第 3 版) [M]. 电子工业出版社, 2013.</li>\n<li><a href="https://dev.mysql.com/doc/refman/5.7/en/innodb-storage-engine.html" target="_blank" rel="nofollow noreferrer noopener">The InnoDB Storage Engine</a></li>\n<li><a href="https://www.slideshare.net/ErnestoHernandezRodriguez/transaction-isolation-levels" target="_blank" rel="nofollow noreferrer noopener">Transaction isolation levels</a></li>\n<li><a href="http://scanftree.com/dbms/2-phase-locking-protocol" target="_blank" rel="nofollow noreferrer noopener">Concurrency Control</a></li>\n<li><a href="https://www.slideshare.net/brshristov/the-nightmare-of-locking-blocking-and-isolation-levels-46391666" target="_blank" rel="nofollow noreferrer noopener">The Nightmare of Locking, Blocking and Isolation Levels!</a></li>\n<li><a href="http://blog.csdn.net/d2457638978/article/details/48783923" target="_blank" rel="nofollow noreferrer noopener">三级模式与两级映像</a></li>\n<li><a href="https://aksakalli.github.io/2012/03/12/database-normalization-and-normal-forms-with-an-example.html" target="_blank" rel="nofollow noreferrer noopener">Database Normalization and Normal Forms with an Example</a></li>\n<li><a href="https://blog.jcole.us/2014/04/16/the-basics-of-the-innodb-undo-logging-and-history-system/" target="_blank" rel="nofollow noreferrer noopener">The basics of the InnoDB undo logging and history system</a></li>\n<li><a href="https://www.brightbox.com/blog/2013/10/31/on-mysql-locks/" target="_blank" rel="nofollow noreferrer noopener">MySQL locking for the busy web developer</a></li>\n<li><a href="https://draveness.me/mysql-innodb" target="_blank" rel="nofollow noreferrer noopener">浅入浅出 MySQL 和 InnoDB</a></li>\n<li><a href="https://tech.meituan.com/innodb-lock.html" target="_blank" rel="nofollow noreferrer noopener">fd945daf-4a6c-4f20-b9c2-5390f5955ce5.jpg</a></li>\n</ul>',
excerpt:"一、事务 概念 事务指的是满足 ACID 特性的一系列操作。在数据库中，可以通过 Commit 提交一个事务，也可以使用 Rollback 进行回滚。 四大特性 1. 原子性（Atomicity） 事务被视为不可分割的最小单元，要么全部提交成功，要么全部失败回滚。…",timeToRead:18,tableOfContents:'<ul>\n<li>\n<p><a href="/database-principle/#%E4%B8%80%E3%80%81%E4%BA%8B%E5%8A%A1">一、事务</a></p>\n<ul>\n<li><a href="/database-principle/#%E6%A6%82%E5%BF%B5">概念</a></li>\n<li>\n<p><a href="/database-principle/#%E5%9B%9B%E5%A4%A7%E7%89%B9%E6%80%A7">四大特性</a></p>\n<ul>\n<li><a href="/database-principle/#1-%E5%8E%9F%E5%AD%90%E6%80%A7%EF%BC%88atomicity%EF%BC%89">1. 原子性（Atomicity）</a></li>\n<li><a href="/database-principle/#2-%E4%B8%80%E8%87%B4%E6%80%A7%EF%BC%88consistency%EF%BC%89">2. 一致性（Consistency）</a></li>\n<li><a href="/database-principle/#3-%E9%9A%94%E7%A6%BB%E6%80%A7%EF%BC%88isolation%EF%BC%89">3. 隔离性（Isolation）</a></li>\n<li><a href="/database-principle/#4-%E6%8C%81%E4%B9%85%E6%80%A7%EF%BC%88durability%EF%BC%89">4. 持久性（Durability）</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href="/database-principle/#%E4%BA%8C%E3%80%81%E5%B9%B6%E5%8F%91%E4%B8%80%E8%87%B4%E6%80%A7%E9%97%AE%E9%A2%98">二、并发一致性问题</a></p>\n<ul>\n<li>\n<p><a href="/database-principle/#%E9%97%AE%E9%A2%98">问题</a></p>\n<ul>\n<li><a href="/database-principle/#1-%E4%B8%A2%E5%A4%B1%E4%BF%AE%E6%94%B9">1. 丢失修改</a></li>\n<li><a href="/database-principle/#2-%E8%AF%BB%E8%84%8F%E6%95%B0%E6%8D%AE">2. 读脏数据</a></li>\n<li><a href="/database-principle/#3-%E4%B8%8D%E5%8F%AF%E9%87%8D%E5%A4%8D%E8%AF%BB">3. 不可重复读</a></li>\n<li><a href="/database-principle/#4-%E5%B9%BB%E5%BD%B1%E8%AF%BB">4. 幻影读</a></li>\n</ul>\n</li>\n<li><a href="/database-principle/#%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95">解决方法</a></li>\n</ul>\n</li>\n<li>\n<p><a href="/database-principle/#%E4%B8%89%E3%80%81%E5%B0%81%E9%94%81">三、封锁</a></p>\n<ul>\n<li><a href="/database-principle/#%E5%B0%81%E9%94%81%E7%B2%92%E5%BA%A6">封锁粒度</a></li>\n<li>\n<p><a href="/database-principle/#%E5%B0%81%E9%94%81%E7%B1%BB%E5%9E%8B">封锁类型</a></p>\n<ul>\n<li><a href="/database-principle/#1-%E6%8E%92%E5%AE%83%E9%94%81%E4%B8%8E%E5%85%B1%E4%BA%AB%E9%94%81">1. 排它锁与共享锁</a></li>\n<li><a href="/database-principle/#2-%E6%84%8F%E5%90%91%E9%94%81">2. 意向锁</a></li>\n</ul>\n</li>\n<li>\n<p><a href="/database-principle/#%E5%B0%81%E9%94%81%E5%8D%8F%E8%AE%AE">封锁协议</a></p>\n<ul>\n<li><a href="/database-principle/#1-%E4%B8%89%E7%BA%A7%E5%B0%81%E9%94%81%E5%8D%8F%E8%AE%AE">1. 三级封锁协议</a></li>\n<li><a href="/database-principle/#2-%E4%B8%A4%E6%AE%B5%E9%94%81%E5%8D%8F%E8%AE%AE">2. 两段锁协议</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href="/database-principle/#%E5%9B%9B%E3%80%81%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB">四、隔离级别</a></li>\n<li>\n<p><a href="/database-principle/#%E4%BA%94%E3%80%81%E5%A4%9A%E7%89%88%E6%9C%AC%E5%B9%B6%E5%8F%91%E6%8E%A7%E5%88%B6">五、多版本并发控制</a></p>\n<ul>\n<li><a href="/database-principle/#%E7%89%88%E6%9C%AC%E5%8F%B7">版本号</a></li>\n<li><a href="/database-principle/#undo-%E6%97%A5%E5%BF%97">Undo 日志</a></li>\n<li>\n<p><a href="/database-principle/#%E5%AE%9E%E7%8E%B0%E8%BF%87%E7%A8%8B">实现过程</a></p>\n<ul>\n<li><a href="/database-principle/#1-select">1. SELECT</a></li>\n<li><a href="/database-principle/#2-insert">2. INSERT</a></li>\n<li><a href="/database-principle/#3-delete">3. DELETE</a></li>\n<li><a href="/database-principle/#4-update">4. UPDATE</a></li>\n</ul>\n</li>\n<li>\n<p><a href="/database-principle/#%E5%BF%AB%E7%85%A7%E8%AF%BB%E4%B8%8E%E5%BD%93%E5%89%8D%E8%AF%BB">快照读与当前读</a></p>\n<ul>\n<li><a href="/database-principle/#1-%E5%BD%93%E5%89%8D%E8%AF%BB">1. 当前读</a></li>\n<li><a href="/database-principle/#2-%E5%BF%AB%E7%85%A7%E8%AF%BB">2. 快照读</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href="/database-principle/#%E5%85%AD%E3%80%81next-key-locks">六、Next-Key Locks</a></p>\n<ul>\n<li><a href="/database-principle/#record-locks">Record Locks</a></li>\n<li><a href="/database-principle/#grap-locks">Grap Locks</a></li>\n<li><a href="/database-principle/#next-key-locks">Next-Key Locks</a></li>\n</ul>\n</li>\n<li>\n<p><a href="/database-principle/#%E4%B8%83%E3%80%81%E5%85%B3%E7%B3%BB%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1%E7%90%86%E8%AE%BA">七、关系数据库设计理论</a></p>\n<ul>\n<li><a href="/database-principle/#%E5%87%BD%E6%95%B0%E4%BE%9D%E8%B5%96">函数依赖</a></li>\n<li><a href="/database-principle/#%E5%BC%82%E5%B8%B8">异常</a></li>\n<li>\n<p><a href="/database-principle/#%E8%8C%83%E5%BC%8F">范式</a></p>\n<ul>\n<li><a href="/database-principle/#1-%E7%AC%AC%E4%B8%80%E8%8C%83%E5%BC%8F-1nf">1. 第一范式 (1NF)</a></li>\n<li><a href="/database-principle/#2-%E7%AC%AC%E4%BA%8C%E8%8C%83%E5%BC%8F-2nf">2. 第二范式 (2NF)</a></li>\n<li><a href="/database-principle/#3-%E7%AC%AC%E4%B8%89%E8%8C%83%E5%BC%8F-3nf">3. 第三范式 (3NF)</a></li>\n<li><a href="/database-principle/#4-bc-%E8%8C%83%E5%BC%8F%EF%BC%88bcnf%EF%BC%89">4. BC 范式（BCNF）</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href="/database-principle/#%E5%85%AB%E3%80%81%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E6%A6%82%E8%BF%B0">八、数据库系统概述</a></p>\n<ul>\n<li>\n<p><a href="/database-principle/#%E5%9F%BA%E6%9C%AC%E6%9C%AF%E8%AF%AD">基本术语</a></p>\n<ul>\n<li><a href="/database-principle/#1-%E6%95%B0%E6%8D%AE%E6%A8%A1%E5%9E%8B">1. 数据模型</a></li>\n<li><a href="/database-principle/#2-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F">2. 数据库系统</a></li>\n</ul>\n</li>\n<li>\n<p><a href="/database-principle/#%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E4%B8%89%E5%B1%82%E6%A8%A1%E5%BC%8F%E5%92%8C%E4%B8%A4%E5%B1%82%E6%98%A0%E5%83%8F">数据库的三层模式和两层映像</a></p>\n<ul>\n<li><a href="/database-principle/#1-%E5%A4%96%E6%A8%A1%E5%BC%8F">1. 外模式</a></li>\n<li><a href="/database-principle/#2-%E6%A8%A1%E5%BC%8F">2. 模式</a></li>\n<li><a href="/database-principle/#3-%E5%86%85%E6%A8%A1%E5%BC%8F">3. 内模式</a></li>\n<li><a href="/database-principle/#4-%E5%A4%96%E6%A8%A1%E5%BC%8F%E6%A8%A1%E5%BC%8F%E6%98%A0%E5%83%8F">4. 外模式/模式映像</a></li>\n<li><a href="/database-principle/#5-%E6%A8%A1%E5%BC%8F%E5%86%85%E6%A8%A1%E5%BC%8F%E6%98%A0%E5%83%8F">5. 模式/内模式映像</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href="/database-principle/#%E4%B9%9D%E3%80%81%E5%85%B3%E7%B3%BB%E6%95%B0%E6%8D%AE%E5%BA%93%E5%BB%BA%E6%A8%A1">九、关系数据库建模</a></p>\n<ul>\n<li>\n<p><a href="/database-principle/#er-%E5%9B%BE">ER 图</a></p>\n<ul>\n<li><a href="/database-principle/#1-%E5%AE%9E%E4%BD%93%E7%9A%84%E4%B8%89%E7%A7%8D%E8%81%94%E7%B3%BB">1. 实体的三种联系</a></li>\n<li><a href="/database-principle/#2-%E8%A1%A8%E7%A4%BA%E5%87%BA%E7%8E%B0%E5%A4%9A%E6%AC%A1%E7%9A%84%E5%85%B3%E7%B3%BB">2. 表示出现多次的关系</a></li>\n<li><a href="/database-principle/#3-%E8%81%94%E7%B3%BB%E7%9A%84%E5%A4%9A%E5%90%91%E6%80%A7">3. 联系的多向性</a></li>\n<li><a href="/database-principle/#4-%E8%A1%A8%E7%A4%BA%E5%AD%90%E7%B1%BB">4. 表示子类</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href="/database-principle/#%E5%8D%81%E3%80%81%E7%BA%A6%E6%9D%9F">十、约束</a></p>\n<ul>\n<li><a href="/database-principle/#1-%E9%94%AE%E7%A0%81">1. 键码</a></li>\n<li><a href="/database-principle/#2-%E5%8D%95%E5%80%BC%E7%BA%A6%E6%9D%9F">2. 单值约束</a></li>\n<li><a href="/database-principle/#3-%E5%BC%95%E7%94%A8%E5%AE%8C%E6%95%B4%E6%80%A7%E7%BA%A6%E6%9D%9F">3. 引用完整性约束</a></li>\n<li><a href="/database-principle/#4-%E5%9F%9F%E7%BA%A6%E6%9D%9F">4. 域约束</a></li>\n<li><a href="/database-principle/#5-%E4%B8%80%E8%88%AC%E7%BA%A6%E6%9D%9F">5. 一般约束</a></li>\n</ul>\n</li>\n<li><a href="/database-principle/#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99">参考资料</a></li>\n</ul>',wordCount:{words:872},frontmatter:{date:"2018-04-03 15:09:47",path:"/database-principle/",tags:"面试, 数据库, 后端, 读书笔记",title:"数据库系统原理",draft:null,catalog_number:null}},nextPost:{html:'<h1 id="一、设计原则"><a href="#%E4%B8%80%E3%80%81%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>一、设计原则</h1>\n<h2 id="solid"><a href="#solid" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>S.O.L.I.D</h2>\n<table>\n<thead>\n<tr>\n<th align="center">简写</th>\n<th align="center">全拼</th>\n<th align="center">中文翻译</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align="center">SRP</td>\n<td align="center">The Single Responsibility Principle</td>\n<td align="center">单一责任原则</td>\n</tr>\n<tr>\n<td align="center">OCP</td>\n<td align="center">The Open Closed Principle</td>\n<td align="center">开放封闭原则</td>\n</tr>\n<tr>\n<td align="center">LSP</td>\n<td align="center">The Liskov Substitution Principle</td>\n<td align="center">里氏替换原则</td>\n</tr>\n<tr>\n<td align="center">ISP</td>\n<td align="center">The Interface Segregation Principle</td>\n<td align="center">接口分离原则</td>\n</tr>\n<tr>\n<td align="center">DIP</td>\n<td align="center">The Dependency Inversion Principle</td>\n<td align="center">依赖倒置原则</td>\n</tr>\n</tbody>\n</table>\n<h3 id="1-单一责任原则"><a href="#1-%E5%8D%95%E4%B8%80%E8%B4%A3%E4%BB%BB%E5%8E%9F%E5%88%99" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. 单一责任原则</h3>\n<blockquote>\n<p>修改一个类的原因应该只有一个。</p>\n</blockquote>\n<p>换句话说就是让一个类只负责一件事，当这个类需要做过多事情的时候，就需要分解这个类。</p>\n<p>如果一个类承担的职责过多，就等于把这些职责耦合在了一起，一个职责的变化可能会削弱这个类完成其它职责的能力。</p>\n<h3 id="2-开放封闭原则"><a href="#2-%E5%BC%80%E6%94%BE%E5%B0%81%E9%97%AD%E5%8E%9F%E5%88%99" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. 开放封闭原则</h3>\n<blockquote>\n<p>类应该对扩展开放，对修改关闭。</p>\n</blockquote>\n<p>扩展就是添加新功能的意思，因此该原则要求在添加新功能时不需要修改代码。</p>\n<p>符合开闭原则最典型的设计模式是装饰者模式，它可以动态地将责任附加到对象上，而不用去修改类的代码。</p>\n<h3 id="3-里氏替换原则"><a href="#3-%E9%87%8C%E6%B0%8F%E6%9B%BF%E6%8D%A2%E5%8E%9F%E5%88%99" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. 里氏替换原则</h3>\n<blockquote>\n<p>子类对象必须能够替换掉所有父类对象。</p>\n</blockquote>\n<p>继承是一种 IS-A 关系，子类需要能够当成父类来使用，并且需要比父类更特殊。</p>\n<p>如果不满足这个原则，那么各个子类的行为上就会有很大差异，增加继承体系的复杂度。</p>\n<h3 id="4-接口分离原则"><a href="#4-%E6%8E%A5%E5%8F%A3%E5%88%86%E7%A6%BB%E5%8E%9F%E5%88%99" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4. 接口分离原则</h3>\n<blockquote>\n<p>不应该强迫客户依赖于它们不用的方法。</p>\n</blockquote>\n<p>因此使用多个专门的接口比使用单一的总接口要好。</p>\n<h3 id="5-依赖倒置原则"><a href="#5-%E4%BE%9D%E8%B5%96%E5%80%92%E7%BD%AE%E5%8E%9F%E5%88%99" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>5. 依赖倒置原则</h3>\n<blockquote>\n<p>高层模块不应该依赖于低层模块，二者都应该依赖于抽象；</br>抽象不应该依赖于细节，细节应该依赖于抽象。</p>\n</blockquote>\n<p>高层模块包含一个应用程序中重要的策略选择和业务模块，如果高层模块依赖于低层模块，那么低层模块的改动就会直接影响到高层模块，从而迫使高层模块也需要改动。</p>\n<p>依赖于抽象意味着：</p>\n<ul>\n<li>任何变量都不应该持有一个指向具体类的指针或者引用；</li>\n<li>任何类都不应该从具体类派生；</li>\n<li>任何方法都不应该覆写它的任何基类中的已经实现的方法。</li>\n</ul>\n<h2 id="其他常见原则"><a href="#%E5%85%B6%E4%BB%96%E5%B8%B8%E8%A7%81%E5%8E%9F%E5%88%99" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>其他常见原则</h2>\n<p>除了上述的经典原则，在实际开发中还有下面这些常见的设计原则。</p>\n<table>\n<thead>\n<tr>\n<th align="center">简写</th>\n<th align="center">全拼</th>\n<th align="center">中文翻译</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align="center">LOD</td>\n<td align="center">The Law of Demeter</td>\n<td align="center">迪米特法则</td>\n</tr>\n<tr>\n<td align="center">CRP</td>\n<td align="center">The Composite Reuse Principle</td>\n<td align="center">合成复用原则</td>\n</tr>\n<tr>\n<td align="center">CCP</td>\n<td align="center">The Common Closure Principle</td>\n<td align="center">共同封闭原则</td>\n</tr>\n<tr>\n<td align="center">SAP</td>\n<td align="center">The Stable Abstractions Principle</td>\n<td align="center">稳定抽象原则</td>\n</tr>\n<tr>\n<td align="center">SDP</td>\n<td align="center">The Stable Dependencies Principle</td>\n<td align="center">稳定依赖原则</td>\n</tr>\n</tbody>\n</table>\n<h3 id="1-迪米特法则"><a href="#1-%E8%BF%AA%E7%B1%B3%E7%89%B9%E6%B3%95%E5%88%99" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. 迪米特法则</h3>\n<p>迪米特法则又叫作最少知识原则（Least Knowledge Principle，简写 LKP），就是说一个对象应当对其他对象有尽可能少的了解，不和陌生人说话。</p>\n<h3 id="2-合成复用原则"><a href="#2-%E5%90%88%E6%88%90%E5%A4%8D%E7%94%A8%E5%8E%9F%E5%88%99" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. 合成复用原则</h3>\n<p>尽量使用对象组合，而不是继承来达到复用的目的。</p>\n<h3 id="3-共同封闭原则"><a href="#3-%E5%85%B1%E5%90%8C%E5%B0%81%E9%97%AD%E5%8E%9F%E5%88%99" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. 共同封闭原则</h3>\n<p>一起修改的类，应该组合在一起（同一个包里）。如果必须修改应用程序里的代码，我们希望所有的修改都发生在一个包里（修改关闭），而不是遍布在很多包里。</p>\n<h3 id="4-稳定抽象原则"><a href="#4-%E7%A8%B3%E5%AE%9A%E6%8A%BD%E8%B1%A1%E5%8E%9F%E5%88%99" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4. 稳定抽象原则</h3>\n<p>最稳定的包应该是最抽象的包，不稳定的包应该是具体的包，即包的抽象程度跟它的稳定性成正比。</p>\n<h3 id="5-稳定依赖原则"><a href="#5-%E7%A8%B3%E5%AE%9A%E4%BE%9D%E8%B5%96%E5%8E%9F%E5%88%99" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>5. 稳定依赖原则</h3>\n<p>包之间的依赖关系都应该是稳定方向依赖的，包要依赖的包要比自己更具有稳定性。</p>\n<h1 id="二、三大特性"><a href="#%E4%BA%8C%E3%80%81%E4%B8%89%E5%A4%A7%E7%89%B9%E6%80%A7" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>二、三大特性</h1>\n<h2 id="封装"><a href="#%E5%B0%81%E8%A3%85" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>封装</h2>\n<p>利用抽象数据类型将数据和基于数据的操作封装在一起，使其构成一个不可分割的独立实体。数据被保护在抽象数据类型的内部，尽可能地隐藏内部的细节，只保留一些对外接口使之与外部发生联系。用户无需知道对象内部的细节，但可以通过对象对外提供的接口来访问该对象。</p>\n<p>封装有三大好处：</p>\n<ol>\n<li>减少耦合</li>\n<li>隐藏内部细节，因此内部结构可以自由修改</li>\n<li>可以对成员进行更精确的控制</li>\n</ol>\n<p>以下 Person 类封装 name、gender、age 等属性，外界只能通过 get() 方法获取一个 Person 对象的 name 属性和 gender 属性，而无法获取 age 属性，但是 age 属性可以供 work() 方法使用。</p>\n<p>注意到 gender 属性使用 int 数据类型进行存储，封装使得用户注意不到这种实现细节。并且在需要修改 gender 属性使用的数据类型时，也可以在不影响客户端代码的情况下进行。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="48398829241619915000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`public class Person {\n    private String name;\n    private int gender;\n    private int age;\n\n    public String getName() {\n        return name;\n    }\n\n    public String getGender() {\n        return gender == 0 ? &quot;man&quot; : &quot;woman&quot;;\n    }\n\n    public void work() {\n        if(18 <= age && age <= 50) {\n            System.out.println(name + &quot; is working very hard!&quot;);\n        } else {\n            System.out.println(name + &quot; can\'t work any more!&quot;);\n        }\n    }\n}`, `48398829241619915000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="java"\n              >\n                <span class="gatsby-code-button-language">java</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="java"><pre style="counter-reset: linenumber NaN" class="language-java line-numbers"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>\n    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>\n    <span class="token keyword">private</span> <span class="token keyword">int</span> gender<span class="token punctuation">;</span>\n    <span class="token keyword">private</span> <span class="token keyword">int</span> age<span class="token punctuation">;</span>\n\n    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> name<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getGender</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> gender <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token string">"man"</span> <span class="token operator">:</span> <span class="token string">"woman"</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">work</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token number">18</span> <span class="token operator">&lt;=</span> age <span class="token operator">&amp;&amp;</span> age <span class="token operator">&lt;=</span> <span class="token number">50</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>name <span class="token operator">+</span> <span class="token string">" is working very hard!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>name <span class="token operator">+</span> <span class="token string">" can\'t work any more!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="继承"><a href="#%E7%BB%A7%E6%89%BF" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>继承</h2>\n<p>继承实现了 <strong>IS-A</strong> 关系，例如 Cat 和 Animal 就是一种 IS-A 关系，因此 Cat 可以继承自 Animal，从而获得 Animal 非 private 的属性和方法。</p>\n<p>Cat 可以当做 Animal 来使用，也就是说可以使用 Animal 引用 Cat 对象。父类引用指向子类对象称为 <strong>向上转型</strong> 。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="61255156907787160000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`Animal animal = new Cat();`, `61255156907787160000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="java"\n              >\n                <span class="gatsby-code-button-language">java</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="java"><pre style="counter-reset: linenumber NaN" class="language-java line-numbers"><code class="language-java"><span class="token class-name">Animal</span> animal <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>\n<p>继承应该遵循里氏替换原则，子类对象必须能够替换掉所有父类对象。</p>\n<h2 id="多态"><a href="#%E5%A4%9A%E6%80%81" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>多态</h2>\n<p>多态分为编译时多态和运行时多态。编译时多态主要指方法的重载，运行时多态指程序中定义的对象引用所指向的具体类型在运行期间才确定。</p>\n<p>运行时多态有三个条件：</p>\n<ol>\n<li>继承</li>\n<li>覆盖</li>\n<li>向上转型</li>\n</ol>\n<p>下面的代码中，乐器类（Instrument）有两个子类：Wind 和 Percussion，它们都覆盖了父类的 play() 方法，并且在 main() 方法中使用父类 Instrument 来引用 Wind 和 Percussion 对象。在 Instrument 引用调用 play() 方法时，会执行实际引用对象所在类的 play() 方法，而不是 Instrument 类的方法。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="2888260444728252400"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`public class Instrument {\n    public void play() {\n        System.out.println(&quot;Instument is playing...&quot;);\n    }\n}\n\npublic class Wind extends Instrument {\n    public void play() {\n        System.out.println(&quot;Wind is playing...&quot;);\n    }\n}\n\npublic class Percussion extends Instrument {\n    public void play() {\n        System.out.println(&quot;Percussion is playing...&quot;);\n    }\n}\n\npublic class Music {\n    public static void main(String[] args) {\n        List<Instrument> instruments = new ArrayList<>();\n        instruments.add(new Wind());\n        instruments.add(new Percussion());\n        for(Instrument instrument : instruments) {\n            instrument.play();\n        }\n    }\n}`, `2888260444728252400`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="java"\n              >\n                <span class="gatsby-code-button-language">java</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="java"><pre style="counter-reset: linenumber NaN" class="language-java line-numbers"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Instrument</span> <span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Instument is playing..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Wind</span> <span class="token keyword">extends</span> <span class="token class-name">Instrument</span> <span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Wind is playing..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Percussion</span> <span class="token keyword">extends</span> <span class="token class-name">Instrument</span> <span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Percussion is playing..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Music</span> <span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Instrument</span><span class="token punctuation">></span></span> instruments <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        instruments<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Wind</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        instruments<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Percussion</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">Instrument</span> instrument <span class="token operator">:</span> instruments<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n            instrument<span class="token punctuation">.</span><span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h1 id="三、类图"><a href="#%E4%B8%89%E3%80%81%E7%B1%BB%E5%9B%BE" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>三、类图</h1>\n<h2 id="泛化关系-generalization"><a href="#%E6%B3%9B%E5%8C%96%E5%85%B3%E7%B3%BB-generalization" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>泛化关系 (Generalization)</h2>\n<p>用来描述继承关系，在 Java 中使用 extends 关键字。</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/b418ca51-f005-4510-b7ad-f092eb6aeb24-3a0d067fd86b964e00dca50789c6de5d-49b3a.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 326px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 73.00613496932516%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAAsSAAALEgHS3X78AAABuklEQVQoz6WSDW+bMBCG8/9/y1Rpm6ZF25q2ozRZkyaEQDAfxmBswHwkWUggWQLMsKza0qqdNOssne+9Rye/dqf+j9V5Wkri0Cd2zLwkIqHvRiHmx0Uac6mqqpfgw7FKA22Xjo1pd9K/WNCBo10uiBj5oNVfhMuyJkgKkSAN3o5uLxxwBaQu1i8dS/oHuKoNtU/NHnPEAAnUuuaJo30CyuB1mF+KYmDNhdnDZ8cYQE1skz40Z6/DfOVFMZsp2CM8X2cbVZ1TGpRleeZWA7elU1RVyUur1UoHYLvdthaUGLsI2b/HPsazbh+OQcDOhkRRUhTFM++8XMSMgDgwGAVJaLqWRJDMr81ncvl4LJmPfFfhbieBGfJOXw8J5PUGph6sczVjD2PxjTJ8Z8of6x2g8C5vR+X5PqIybzDlrqf31NH7w1pmeLxebxqYeDDF/dS796EQIjGwxe/B0JCv8ryBi90PbI2W9BuFtyfVH0LtLts0jnRcW/f0L6H9lSGBR5vcTO8/PMKGIjD7upUaNUI380kvy1p4uUwca+pY8p9haJP9ft+6XfkE/t0wtU3ll9o5vUB1Hmc/54na7J+m7ElRemYDLgAAAABJRU5ErkJggg==\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="b418ca51 f005 4510 b7ad f092eb6aeb24" title="" data-src="/static/b418ca51-f005-4510-b7ad-f092eb6aeb24-3a0d067fd86b964e00dca50789c6de5d-49b3a.png" data-srcset="/static/b418ca51-f005-4510-b7ad-f092eb6aeb24-3a0d067fd86b964e00dca50789c6de5d-6cc38.png 200w,\n/static/b418ca51-f005-4510-b7ad-f092eb6aeb24-3a0d067fd86b964e00dca50789c6de5d-49b3a.png 326w" data-sizes="(max-width: 326px) 100vw, 326px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<h2 id="实现关系-realization"><a href="#%E5%AE%9E%E7%8E%B0%E5%85%B3%E7%B3%BB-realization" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>实现关系 (Realization)</h2>\n<p>用来实现一个接口，在 Java 中使用 implement 关键字。</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/27cd6f0c-f581-45da-b8c9-fed026830560-b162c13e09eb94ad45c69282df5488e8-3091a.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 361px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 78.67036011080333%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAIAAACZeshMAAAACXBIWXMAAAsSAAALEgHS3X78AAABp0lEQVQoz6VTbWvbMBD2//8n24eNbAwKLVmyktfajZyqgdaO7cRvSezJlmRLdiJ7U6s2lG6QQMVxCN090nPPnbQ/H1jav0ficCgLXHHKOa15wUvCWXEa3Lat9AVF5vjrfPLNGH4B4w686TzAgQqfBlcMrx+65rgz6X+24eXC+O47RtOe9zIrMhSOdqtBYPXyaJqsrkPvtmnOpY1jz4g9HcV3W3/m26O1Mz/98hG/3SYQLoqC5TmZzQBC2VlqKzBCKI4juRdCxHFMKT23VRJTVfztCSvL5n9Fa28BjJX7fU0IzjIkN4qF9ISQNE2bRtR1pXKO4GeRCrpZ6WRnRs7YtwY0MWV7GK9kCGdp6IzwFpjTH+FylEX62jHVpZpqPaX4d6ALDHfe0H/stfTeX04JeRqsHCW71VAQOOl9Cu3rGgHPunnWvtUUN4JzG14FVjewfkoLre4CXFH6BE6TjZyT0O5tnF/Rsu8uLu5BX9X6UjPnLHDnoQsCdxY4IPKAawHGuSLlPeqRZ/rLW5ng24Zrw/dqC9Hu983RhGiUHHId3oVeJ0b7yJf8C36lklnp7JRfAAAAAElFTkSuQmCC\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="27cd6f0c f581 45da b8c9 fed026830560" title="" data-src="/static/27cd6f0c-f581-45da-b8c9-fed026830560-b162c13e09eb94ad45c69282df5488e8-3091a.png" data-srcset="/static/27cd6f0c-f581-45da-b8c9-fed026830560-b162c13e09eb94ad45c69282df5488e8-07e05.png 200w,\n/static/27cd6f0c-f581-45da-b8c9-fed026830560-b162c13e09eb94ad45c69282df5488e8-3091a.png 361w" data-sizes="(max-width: 361px) 100vw, 361px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<h2 id="聚合关系-aggregation"><a href="#%E8%81%9A%E5%90%88%E5%85%B3%E7%B3%BB-aggregation" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>聚合关系 (Aggregation)</h2>\n<p>表示整体由部分组成，但是整体和部分不是强依赖的，整体不存在了部分还是会存在。</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/aa42f9c6-ad7a-48f4-8e8b-f3b6de3feaec-6d168bd76e799a4d94ec32d4b73a5053-a64ad.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 450px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 51.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsSAAALEgHS3X78AAABZElEQVQoz41QaU+DQBTk//8Lf4PG1GCqtfayV6zQlnLIsVALy7WwXAvUhRrTmBp9HzY782Ze3hvmeKkSjFxbh7bmu1ZZlsdfivlJ1DV9Qs8Eu+5j58qUR3GMW7r+23wSAV2QuY7C321eWc/3/2U+KYIwlMStuJ6aGr9aDiVJzvP8op85sd+NKIogdCIUWdZHWVYGsIoihxDGcXTm/foxNI+SkLquiqII2qIsxnEQ+O0sFIZhs04QeJ6XZRmV1VVFCtKYMYIS31uMbk1lnqQZjqAmDFbTDrQ4qgzcvcg9yOuesp1gnNp71dZn/II9GG90ChO6pr5hheUNEPtlVQeuYezuheX1QR1HcerZmr5ltQ0rcd0kzZEHHPWJZmkq4zRNGegAIA1cMBf5PiEVtIGpDCGYqbsxTjLXAZYysvWpJr1Qs+sYQHqGxuxdmDRmQojf3OPTkGlsDfR9CttTzyE663oINfATKlQyd6eo0bsAAAAASUVORK5CYII=\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="aa42f9c6 ad7a 48f4 8e8b f3b6de3feaec" title="" data-src="/static/aa42f9c6-ad7a-48f4-8e8b-f3b6de3feaec-6d168bd76e799a4d94ec32d4b73a5053-a64ad.png" data-srcset="/static/aa42f9c6-ad7a-48f4-8e8b-f3b6de3feaec-6d168bd76e799a4d94ec32d4b73a5053-a484f.png 200w,\n/static/aa42f9c6-ad7a-48f4-8e8b-f3b6de3feaec-6d168bd76e799a4d94ec32d4b73a5053-d7c5d.png 400w,\n/static/aa42f9c6-ad7a-48f4-8e8b-f3b6de3feaec-6d168bd76e799a4d94ec32d4b73a5053-a64ad.png 450w" data-sizes="(max-width: 450px) 100vw, 450px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="34972631107255837000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`public class Computer\n    private KeyBoard keyboard;\n    private Mouse mouse;\n\n    public void Running()\n    {\n        keyboard.running();\n        mouse.running();\n    }\n}`, `34972631107255837000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="cpp"\n              >\n                <span class="gatsby-code-button-language">cpp</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Computer</span>\n    <span class="token keyword">private</span> KeyBoard keyboard<span class="token punctuation">;</span>\n    <span class="token keyword">private</span> Mouse mouse<span class="token punctuation">;</span>\n\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Running</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        keyboard<span class="token punctuation">.</span><span class="token function">running</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        mouse<span class="token punctuation">.</span><span class="token function">running</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="组合关系-composition"><a href="#%E7%BB%84%E5%90%88%E5%85%B3%E7%B3%BB-composition" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>组合关系 (Composition)</h2>\n<p>和聚合不同，组合中整体和部分是强依赖的，整体不存在了部分也不存在了。比如公司和部门，公司没了部门就不存在了。但是公司和员工就属于聚合关系了，因为公司没了员工还在。</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/0e34263d-7287-4ffe-a716-37c53d1a2526-5fa8144e842b175365fa63bac252162d-6db8f.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 383px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 63.44647519582245%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsSAAALEgHS3X78AAABiElEQVQoz5WRa2+CMBSG/f8f92nLkmX/YMmi7oO3oVEznSIqDuWmgEihKlQuVRFXvC+biXtz0rR9+7TnnCa2PxWGIbTAFAJ7DkmYQPc8d+dE219KnGZRFNvuwkEm41q0yOZ0qbyct01d2Ns3wYZctZSKxGbVAQWVijrs3Qo79kxk89aoMuJyE6mk8QWhT5/cq/Dp9ka98vhwt8KoRGWen+5x4P1JHuDoKNItsvyM1YizcJxkKr1eh5dnrr4c1+wubNuOT282ZFytVhDC7RUldoC7QIvA9xFCsix73iHPfS6apgEAcIB933ccFO4SOcB4uYTjrqXUOSYnspSpfIBxj7B7fgYNx2D4TmFAop2fjWmyc+pfIgiwqTYnItWpvXKtNyAXVbERbg7dg0Cz9RpHp3uNZKv6ApWqoQ/PMMb4q5XV+QLhSahcpksXotiOa56M5UErZUhFXXy3RmWumdQU8QyTqtRRXxYYmWeGQlvi6aHERcd/Q2geW0KbjMQV+s0pNM/w9p+6/K1vfHvemPrMHBIAAAAASUVORK5CYII=\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="0e34263d 7287 4ffe a716 37c53d1a2526" title="" data-src="/static/0e34263d-7287-4ffe-a716-37c53d1a2526-5fa8144e842b175365fa63bac252162d-6db8f.png" data-srcset="/static/0e34263d-7287-4ffe-a716-37c53d1a2526-5fa8144e842b175365fa63bac252162d-89fca.png 200w,\n/static/0e34263d-7287-4ffe-a716-37c53d1a2526-5fa8144e842b175365fa63bac252162d-6db8f.png 383w" data-sizes="(max-width: 383px) 100vw, 383px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="99347133124708240000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`public class Company\n{\n    private DepartmentA departmentA;\n    private DepartmentB departmentB;\n    public Company()\n    {\n        departmentA = new DepartmentA();\n        departmentB = new DepartmentB();\n    }\n}  `, `99347133124708240000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="cpp"\n              >\n                <span class="gatsby-code-button-language">cpp</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Company</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">private</span> DepartmentA departmentA<span class="token punctuation">;</span>\n    <span class="token keyword">private</span> DepartmentB departmentB<span class="token punctuation">;</span>\n    <span class="token keyword">public</span> <span class="token function">Company</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        departmentA <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">DepartmentA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        departmentB <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">DepartmentB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>  </code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="关联关系-association"><a href="#%E5%85%B3%E8%81%94%E5%85%B3%E7%B3%BB-association" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>关联关系 (Association)</h2>\n<p>表示不同类对象之间有关联，这是一种静态关系，与运行过程的状态无关，在最开始就可以确定。因此也可以用 1 对 1、多对 1、多对多这种关联关系来表示。比如学生和学校就是一种关联关系，一个学校可以有很多学生，但是一个学生只属于一个学校，因此这是一种多对一的关系，在运行开始之前就可以确定。</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/2017511e-22f0-4d74-873d-1261b71cf5a4-a24c985a40285b86b67f5ba681a08d0d-960c5.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 229px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 138.42794759825327%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAcCAIAAADuuAg3AAAACXBIWXMAAAsSAAALEgHS3X78AAACDUlEQVQ4y82U227aQBCGef+nqHoVqb2I0lZVq8YBbMAcY4MBY2zvrs9AnAC2OdSnLN6UKhRDkvaio5E1Gs2/4x3P50L6F1b4l+IoTsLol4fxzzAmMc6fEW+3WzDmTcAbgNdUzkK9idk3II8DUajO5/e4JkmSP8RZarn0HK2ZhlK6EiX+a4v5UPr2fuXeponqgLJpwBxxukt5vm/DVhoMo+XQARWh+eXH53dzu5VuZUsp65q6b/NMTM7z/UDkqSlkLIW2VWaKanc6a6v0TKt1G5cQyMc7k5TnB1Lv5t6oTVF1pu18AitTVHmwGoP2p1wxee0gWPW5GySV1GERiEVlQOljBkllbUy3q7izkid+ssViYVmWaZq2bbMsy/O8IPQcx8EZz/NetCTkeFUFWAbh4ZBzxUlmcRzjWJZlEpDkS9eTlCqKQsSv2+29OIqit4vf3hnfGSFkGMbRC5+dtuq6Lv5mef0PxXGcZFTuqiXpado4E59Fcr3eSIO6oTZ1pQlGtVGvBCVWkxsW7Aida/duehJJz3cQZkhK16N+66pbv6wXL5JgkIayA2hDByeRJOKVmPjiDLEYKVOmtw9Cuhljts4jOeSoCWDMDEmMNHZTLmM2+ToGY3wSSc8fdanfSGZPgmS/fZUr3g+Ma1FC53uv/cwH3DVDfYTwHJJhFPlB4B+zzWZzsC2F/+an/yp7BPokR4FFOnw4AAAAAElFTkSuQmCC\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="2017511e 22f0 4d74 873d 1261b71cf5a4" title="" data-src="/static/2017511e-22f0-4d74-873d-1261b71cf5a4-a24c985a40285b86b67f5ba681a08d0d-960c5.png" data-srcset="/static/2017511e-22f0-4d74-873d-1261b71cf5a4-a24c985a40285b86b67f5ba681a08d0d-6f066.png 200w,\n/static/2017511e-22f0-4d74-873d-1261b71cf5a4-a24c985a40285b86b67f5ba681a08d0d-960c5.png 229w" data-sizes="(max-width: 229px) 100vw, 229px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="32275692272509903000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`public class School\n{\n    private Student[] students;\n\n    public void GoToSchool()\n    {\n        students.study();\n    }\n}`, `32275692272509903000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="cpp"\n              >\n                <span class="gatsby-code-button-language">cpp</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">School</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">private</span> Student<span class="token punctuation">[</span><span class="token punctuation">]</span> students<span class="token punctuation">;</span>\n\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">GoToSchool</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        students<span class="token punctuation">.</span><span class="token function">study</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="依赖关系-dependency"><a href="#%E4%BE%9D%E8%B5%96%E5%85%B3%E7%B3%BB-dependency" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>依赖关系 (Dependency)</h2>\n<p>和关联关系不同的是，依赖关系是在运行过程中起作用的。A 类和 B 类是依赖关系主要有三种形式：</p>\n<ol>\n<li>A 类是 B 类中的（某中方法的）局部变量；</li>\n<li>A 类是 B 类方法当中的一个参数；</li>\n<li>A 类向 B 类发送消息，从而影响 B 类发生变化；</li>\n</ol>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/c7d4956c-9988-4a10-a704-28fdae7f3d28-1eecc91b83b4c8ce1090cd155d61ed31-95c58.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 477px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 49.05660377358491%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsSAAALEgHS3X78AAABO0lEQVQoz4VRa2+CMBTl//+bZZn7hMuMYTA34xsHKAgVsSBCaeXRVlezBTFz20l7k97b09t7jnS6gWMjNrJn8MY6Sc1aUZZlVTHOKaVVRcVRJE+/Q6qb5DmJg2kIBrNB2zVV33nbB5MMxV/vipihPQycCHrhdhXvfMaYVNcIQZGnRa6i9x+A+RzY3Z2nbgOP8yNjNMuIqb9ao9ZQuzOGLWB1McYX8oEge9Z2P2RgPq3m8mbZMYaP240ryGKGvCh9b25N5Hfl3hjL9odCCLmQi6IAzsjSVcforawesPsL/SXd7+oLVVXhDB0OoiXCOOOcS2KH4RJCI45tGC7Wa933l+ys5VmJfwQTukahFkcdlKo405JEAUAW8/9063iNbzKEY4SmSTJJknGaTqNokOf4ptU3rKKU0Wv8/dsan6ZeOiAZvgj9AAAAAElFTkSuQmCC\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="c7d4956c 9988 4a10 a704 28fdae7f3d28" title="" data-src="/static/c7d4956c-9988-4a10-a704-28fdae7f3d28-1eecc91b83b4c8ce1090cd155d61ed31-95c58.png" data-srcset="/static/c7d4956c-9988-4a10-a704-28fdae7f3d28-1eecc91b83b4c8ce1090cd155d61ed31-9ffd2.png 200w,\n/static/c7d4956c-9988-4a10-a704-28fdae7f3d28-1eecc91b83b4c8ce1090cd155d61ed31-bef37.png 400w,\n/static/c7d4956c-9988-4a10-a704-28fdae7f3d28-1eecc91b83b4c8ce1090cd155d61ed31-95c58.png 477w" data-sizes="(max-width: 477px) 100vw, 477px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="43574998678771550000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`public class Transport\n{\n    public void Run\n    {\n    }\n    // way 代表行驶方式\n    public void Fly(Way way)\n    {\n        way.fly();\n    }\n}`, `43574998678771550000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="cpp"\n              >\n                <span class="gatsby-code-button-language">cpp</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Transport</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> Run\n    <span class="token punctuation">{</span>\n    <span class="token punctuation">}</span>\n    <span class="token comment">// way 代表行驶方式</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Fly</span><span class="token punctuation">(</span>Way way<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        way<span class="token punctuation">.</span><span class="token function">fly</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h1 id="参考资料"><a href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>参考资料</h1>\n<ul>\n<li>Java 编程思想</li>\n<li>敏捷软件开发：原则、模式与实践</li>\n<li><a href="http://www.cnblogs.com/shanyou/archive/2009/09/21/1570716.html" target="_blank" rel="nofollow noreferrer noopener">面向对象设计的 SOLID 原则</a></li>\n<li><a href="http://design-patterns.readthedocs.io/zh_CN/latest/read_uml.html#generalization" target="_blank" rel="nofollow noreferrer noopener">看懂 UML 类图和时序图</a></li>\n<li><a href="http://www.cnblogs.com/wolf-sun/p/UML-Sequence-diagram.html" target="_blank" rel="nofollow noreferrer noopener">UML 系列——时序图（顺序图）sequence diagram</a></li>\n<li><a href="http://blog.csdn.net/jianyuerensheng/article/details/51602015" target="_blank" rel="nofollow noreferrer noopener">面向对象编程三大特性 ------ 封装、继承、多态</a></li>\n</ul>',
excerpt:"一、设计原则 S.O.L.I.D 简写 全拼 中文翻译 SRP The Single Responsibility Principle 单一责任原则 OCP The Open Closed Principle 开放封闭原则 LSP The Liskov Substitution…",frontmatter:{date:"2018-04-02 17:54:51",path:"/object-oriented-thinking/",tags:"面试, 面向对象, 读书笔记",title:"面向对象思想",draft:null}},prePost:{html:'<h1 id="一、基础"><a href="#%E4%B8%80%E3%80%81%E5%9F%BA%E7%A1%80" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>一、基础</h1>\n<p>模式定义了数据如何存储、存储什么样的数据以及数据如何分解等信息，数据库和表都有模式。</p>\n<p>主键的值不允许修改，也不允许复用（不能使用已经删除的主键值赋给新数据行的主键）。</p>\n<p>SQL（Structured Query Language），标准 SQL 由 ANSI 标准委员会管理，从而称为 ANSI SQL。各个 DBMS 都有自己的实现，如 PL/SQL、Transact-SQL 等。</p>\n<p>SQL 语句不区分大小写，但是数据库表名、列名和值是否区分依赖于具体的 DBMS 以及配置。</p>\n<p>SQL 支持以下三种注释：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="16105593406653028000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`# 注释\nSELECT *\nFROM mytable; -- 注释\n/* 注释1\n   注释2 */`, `16105593406653028000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql"><span class="token comment"># 注释</span>\n<span class="token keyword">SELECT</span> <span class="token operator">*</span>\n<span class="token keyword">FROM</span> mytable<span class="token punctuation">;</span> <span class="token comment">-- 注释</span>\n<span class="token comment">/* 注释1\n   注释2 */</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h1 id="二、创建表"><a href="#%E4%BA%8C%E3%80%81%E5%88%9B%E5%BB%BA%E8%A1%A8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>二、创建表</h1>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="47424175670009586000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`CREATE TABLE mytable (\n  id INT NOT NULL AUTO_INCREMENT,\n  col1 INT NOT NULL DEFAULT 1,\n  col2 VARCHAR(45) NULL,\n  col3 DATE NULL,\n  PRIMARY KEY (\\`id\\`));`, `47424175670009586000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> mytable <span class="token punctuation">(</span>\n  id <span class="token keyword">INT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>\n  col1 <span class="token keyword">INT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token number">1</span><span class="token punctuation">,</span>\n  col2 <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">45</span><span class="token punctuation">)</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>\n  col3 <span class="token keyword">DATE</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>\n  <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token punctuation">`</span>id<span class="token punctuation">`</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h1 id="三、修改表"><a href="#%E4%B8%89%E3%80%81%E4%BF%AE%E6%94%B9%E8%A1%A8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>三、修改表</h1>\n<p>添加列</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="82860439628257570000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`ALTER TABLE mytable\nADD col CHAR(20);`, `82860439628257570000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql"><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> mytable\n<span class="token keyword">ADD</span> col <span class="token keyword">CHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>\n<p>删除列</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="82286806371382260000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`ALTER TABLE mytable\nDROP COLUMN col;`, `82286806371382260000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql"><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> mytable\n<span class="token keyword">DROP</span> <span class="token keyword">COLUMN</span> col<span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>\n<p>删除表</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="26358912630723408000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`DROP TABLE mytable;`, `26358912630723408000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql"><span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> mytable<span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>\n<h1 id="四、插入"><a href="#%E5%9B%9B%E3%80%81%E6%8F%92%E5%85%A5" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>四、插入</h1>\n<p>普通插入</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="50928049393148410000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`INSERT INTO mytable(col1, col2)\nVALUES(val1, val2);`, `50928049393148410000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql"><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> mytable<span class="token punctuation">(</span>col1<span class="token punctuation">,</span> col2<span class="token punctuation">)</span>\n<span class="token keyword">VALUES</span><span class="token punctuation">(</span>val1<span class="token punctuation">,</span> val2<span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>\n<p>插入检索出来的数据</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="78943389218252160000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`INSERT INTO mytable1(col1, col2)\nSELECT col1, col2\nFROM mytable2;`, `78943389218252160000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql"><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> mytable1<span class="token punctuation">(</span>col1<span class="token punctuation">,</span> col2<span class="token punctuation">)</span>\n<span class="token keyword">SELECT</span> col1<span class="token punctuation">,</span> col2\n<span class="token keyword">FROM</span> mytable2<span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<p>将一个表的内容插入到一个新表</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="39797173434083200000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`CREATE TABLE newtable AS\nSELECT * FROM mytable;`, `39797173434083200000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> newtable <span class="token keyword">AS</span>\n<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> mytable<span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>\n<h1 id="五、更新"><a href="#%E4%BA%94%E3%80%81%E6%9B%B4%E6%96%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>五、更新</h1>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="94369988861572960000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`UPDATE mytable\nSET col = val\nWHERE id = 1;`, `94369988861572960000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql"><span class="token keyword">UPDATE</span> mytable\n<span class="token keyword">SET</span> col <span class="token operator">=</span> val\n<span class="token keyword">WHERE</span> id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<h1 id="六、删除"><a href="#%E5%85%AD%E3%80%81%E5%88%A0%E9%99%A4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>六、删除</h1>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="1012965049377689900"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`DELETE FROM mytable\nWHERE id = 1;`, `1012965049377689900`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql"><span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> mytable\n<span class="token keyword">WHERE</span> id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>\n<p><strong>TRUNCATE TABLE</strong> 可以清空表，也就是删除所有行。</p>\n<p>使用更新和删除操作时一定要用 WHERE 子句，不然会把整张表的数据都破坏。可以先用 SELECT 语句进行测试，防止错误删除。</p>\n<h1 id="七、查询"><a href="#%E4%B8%83%E3%80%81%E6%9F%A5%E8%AF%A2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>七、查询</h1>\n<h2 id="distinct"><a href="#distinct" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>DISTINCT</h2>\n<p>相同值只会出现一次。它作用于所有列，也就是说所有列的值都相同才算相同。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="6617015376919611"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`SELECT DISTINCT col1, col2\nFROM mytable;`, `6617015376919611`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql"><span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> col1<span class="token punctuation">,</span> col2\n<span class="token keyword">FROM</span> mytable<span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>\n<h2 id="limit"><a href="#limit" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>LIMIT</h2>\n<p>限制返回的行数。可以有两个参数，第一个参数为起始行，从 0 开始；第二个参数为返回的总行数。</p>\n<p>返回前 5 行：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="5552970772316668000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`SELECT *\nFROM mytable\nLIMIT 5;`, `5552970772316668000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span>\n<span class="token keyword">FROM</span> mytable\n<span class="token keyword">LIMIT</span> <span class="token number">5</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="45770697009846860000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`SELECT *\nFROM mytable\nLIMIT 0, 5;`, `45770697009846860000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span>\n<span class="token keyword">FROM</span> mytable\n<span class="token keyword">LIMIT</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<p>返回第 3 ~ 5 行：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="24205339903403410000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`SELECT *\nFROM mytable\nLIMIT 2, 3;`, `24205339903403410000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span>\n<span class="token keyword">FROM</span> mytable\n<span class="token keyword">LIMIT</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<h1 id="八、排序"><a href="#%E5%85%AB%E3%80%81%E6%8E%92%E5%BA%8F" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>八、排序</h1>\n<ul>\n<li><strong>ASC</strong> ：升序（默认）</li>\n<li><strong>DESC</strong> ：降序</li>\n</ul>\n<p>可以按多个列进行排序，并且为每个列指定不同的排序方式：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="31672936087820337000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`SELECT *\nFROM mytable\nORDER BY col1 DESC, col2 ASC;`, `31672936087820337000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span>\n<span class="token keyword">FROM</span> mytable\n<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> col1 <span class="token keyword">DESC</span><span class="token punctuation">,</span> col2 <span class="token keyword">ASC</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<h1 id="九、过滤"><a href="#%E4%B9%9D%E3%80%81%E8%BF%87%E6%BB%A4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>九、过滤</h1>\n<p>不进行过滤的数据非常大，导致通过网络传输了多余的数据，从而浪费了网络带宽。因此尽量使用 SQL 语句来过滤不必要的数据，而不是传输所有的数据到客户端中然后由客户端进行过滤。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="9954797727774235000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`SELECT *\nFROM mytable\nWHERE col IS NULL;`, `9954797727774235000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span>\n<span class="token keyword">FROM</span> mytable\n<span class="token keyword">WHERE</span> col <span class="token operator">IS</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<p>下表显示了 WHERE 子句可用的操作符</p>\n<table>\n<thead>\n<tr>\n<th>操作符</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>= &#x3C; ></td>\n<td>等于 小于 大于</td>\n</tr>\n<tr>\n<td>&#x3C;> !=</td>\n<td>不等于</td>\n</tr>\n<tr>\n<td>&#x3C;= !></td>\n<td>小于等于</td>\n</tr>\n<tr>\n<td>>\n= !&#x3C;</td>\n<td>大于等于</td>\n</tr>\n<tr>\n<td>BETWEEN</td>\n<td>在两个值之间</td>\n</tr>\n<tr>\n<td>IS NULL</td>\n<td>为 NULL 值</td>\n</tr>\n</tbody>\n</table>\n<p>应该注意到，NULL 与 0 、空字符串都不同。</p>\n<p><strong>AND OR</strong> 用于连接多个过滤条件。优先处理 AND，因此当一个过滤表达式涉及到多个 AND 和 OR 时，应当使用 () 来决定优先级。</p>\n<p><strong>IN</strong> 操作符用于匹配一组值，其后也可以接一个 SELECT 子句，从而匹配子查询得到的一组值。</p>\n<p><strong>NOT</strong> 操作符用于否定一个条件。</p>\n<h1 id="十、通配符"><a href="#%E5%8D%81%E3%80%81%E9%80%9A%E9%85%8D%E7%AC%A6" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>十、通配符</h1>\n<p>通配符也是用在过滤语句中，但它只能用于文本字段。</p>\n<ul>\n<li>\n<p><strong>%</strong> 匹配 >=0 个任意字符；</p>\n</li>\n<li>\n<p><strong>_</strong> 匹配 ==1 个任意字符；</p>\n</li>\n<li>\n<p><strong>[ ]</strong> 可以匹配集合内的字符，例如 [ab] 将匹配字符 a 或者 b。用脱字符 ^ 可以对其进行否定，也就是不匹配集合内的字符。</p>\n</li>\n</ul>\n<p>使用 Like 来进行通配符匹配。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="73032128446745846000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`SELECT *\nFROM mytable\nWHERE col LIKE \'[^AB]%\' -- 不以 A 和 B 开头的任意文本`, `73032128446745846000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span>\n<span class="token keyword">FROM</span> mytable\n<span class="token keyword">WHERE</span> col <span class="token operator">LIKE</span> <span class="token string">\'[^AB]%\'</span> <span class="token comment">-- 不以 A 和 B 开头的任意文本</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<p>不要滥用通配符，通配符位于开头处匹配会非常慢。</p>\n<h1 id="十一、计算字段"><a href="#%E5%8D%81%E4%B8%80%E3%80%81%E8%AE%A1%E7%AE%97%E5%AD%97%E6%AE%B5" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>十一、计算字段</h1>\n<p>在数据库服务器上完成数据的转换和格式化的工作往往比客户端上快得多，并且转换和格式化后的数据量更少的话可以减少网络通信量。</p>\n<p>计算字段通常需要使用 <strong>AS</strong> 来取别名，否则输出的时候字段名为计算表达式。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="17925625553241975000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`SELECT col1*col2 AS alias\nFROM mytable`, `17925625553241975000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql"><span class="token keyword">SELECT</span> col1<span class="token operator">*</span>col2 <span class="token keyword">AS</span> alias\n<span class="token keyword">FROM</span> mytable</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>\n<p><strong>CONCAT()</strong> 用于连接两个字段。许多数据库会使用空格把一个值填充为列宽，因此连接的结果会出现一些不必要的空格，使用 <strong>TRIM()</strong> 可以去除首尾空格。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="75338486592898320000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`SELECT CONCAT(TRIM(col1), \' (\', TRIM(col2), \')\')\nFROM mytable`, `75338486592898320000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql"><span class="token keyword">SELECT</span> CONCAT<span class="token punctuation">(</span>TRIM<span class="token punctuation">(</span>col1<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">\' (\'</span><span class="token punctuation">,</span> TRIM<span class="token punctuation">(</span>col2<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">\')\'</span><span class="token punctuation">)</span>\n<span class="token keyword">FROM</span> mytable</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>\n<h1 id="十二、函数"><a href="#%E5%8D%81%E4%BA%8C%E3%80%81%E5%87%BD%E6%95%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>十二、函数</h1>\n<p>各个 DBMS 的函数都是不相同的，因此不可移植。</p>\n<h2 id="文本处理"><a href="#%E6%96%87%E6%9C%AC%E5%A4%84%E7%90%86" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>文本处理</h2>\n<table>\n<thead>\n<tr>\n<th>函数</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>LEFT() RIGHT()</td>\n<td>左边或者右边的字符</td>\n</tr>\n<tr>\n<td>LOWER() UPPER()</td>\n<td>转换为小写或者大写</td>\n</tr>\n<tr>\n<td>LTRIM() RTIM()</td>\n<td>去除左边或者右边的空格</td>\n</tr>\n<tr>\n<td>LENGTH()</td>\n<td>长度</td>\n</tr>\n<tr>\n<td>SUNDEX()</td>\n<td>转换为语音值</td>\n</tr>\n</tbody>\n</table>\n<p>其中， <strong>SOUNDEX()</strong> 是将一个字符串转换为描述其语音表示的字母数字模式的算法，它是根据发音而不是字母比较。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="15791876421045404000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`SELECT *\nFROM mytable\nWHERE SOUNDEX(col1) = SOUNDEX(\'apple\')`, `15791876421045404000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span>\n<span class="token keyword">FROM</span> mytable\n<span class="token keyword">WHERE</span> SOUNDEX<span class="token punctuation">(</span>col1<span class="token punctuation">)</span> <span class="token operator">=</span> SOUNDEX<span class="token punctuation">(</span><span class="token string">\'apple\'</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<h2 id="日期和时间处理"><a href="#%E6%97%A5%E6%9C%9F%E5%92%8C%E6%97%B6%E9%97%B4%E5%A4%84%E7%90%86" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>日期和时间处理</h2>\n<ul>\n<li>日期格式：YYYY-MM-DD</li>\n<li>时间格式：HH:MM:SS</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>函 数</th>\n<th>说 明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>AddDate()</td>\n<td>增加一个日期（天、周等）</td>\n</tr>\n<tr>\n<td>AddTime()</td>\n<td>增加一个时间（时、分等）</td>\n</tr>\n<tr>\n<td>CurDate()</td>\n<td>返回当前日期</td>\n</tr>\n<tr>\n<td>CurTime()</td>\n<td>返回当前时间</td>\n</tr>\n<tr>\n<td>Date()</td>\n<td>返回日期时间的日期部分</td>\n</tr>\n<tr>\n<td>DateDiff()</td>\n<td>计算两个日期之差</td>\n</tr>\n<tr>\n<td>Date_Add()</td>\n<td>高度灵活的日期运算函数</td>\n</tr>\n<tr>\n<td>Date_Format()</td>\n<td>返回一个格式化的日期或时间串</td>\n</tr>\n<tr>\n<td>Day()</td>\n<td>返回一个日期的天数部分</td>\n</tr>\n<tr>\n<td>DayOfWeek()</td>\n<td>对于一个日期，返回对应的星期几</td>\n</tr>\n<tr>\n<td>Hour()</td>\n<td>返回一个时间的小时部分</td>\n</tr>\n<tr>\n<td>Minute()</td>\n<td>返回一个时间的分钟部分</td>\n</tr>\n<tr>\n<td>Month()</td>\n<td>返回一个日期的月份部分</td>\n</tr>\n<tr>\n<td>Now()</td>\n<td>返回当前日期和时间</td>\n</tr>\n<tr>\n<td>Second()</td>\n<td>返回一个时间的秒部分</td>\n</tr>\n<tr>\n<td>Time()</td>\n<td>返回一个日期时间的时间部分</td>\n</tr>\n<tr>\n<td>Year()</td>\n<td>返回一个日期的年份部分</td>\n</tr>\n</tbody>\n</table>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="89091892910957230000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`mysql> SELECT NOW();\n        -> \'2017-06-28 14:01:52\'`, `89091892910957230000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql">mysql<span class="token operator">></span> <span class="token keyword">SELECT</span> <span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token operator">-</span><span class="token operator">></span> <span class="token string">\'2017-06-28 14:01:52\'</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>\n<h2 id="数值处理"><a href="#%E6%95%B0%E5%80%BC%E5%A4%84%E7%90%86" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>数值处理</h2>\n<table>\n<thead>\n<tr>\n<th>函数</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>SIN()</td>\n<td>正弦</td>\n</tr>\n<tr>\n<td>COS()</td>\n<td>余弦</td>\n</tr>\n<tr>\n<td>TAN()</td>\n<td>正切</td>\n</tr>\n<tr>\n<td>ABS()</td>\n<td>绝对值</td>\n</tr>\n<tr>\n<td>SQRT()</td>\n<td>平方根</td>\n</tr>\n<tr>\n<td>MOD()</td>\n<td>余数</td>\n</tr>\n<tr>\n<td>EXP()</td>\n<td>指数</td>\n</tr>\n<tr>\n<td>PI()</td>\n<td>圆周率</td>\n</tr>\n<tr>\n<td>RAND()</td>\n<td>随机数</td>\n</tr>\n</tbody>\n</table>\n<h2 id="汇总"><a href="#%E6%B1%87%E6%80%BB" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>汇总</h2>\n<table>\n<thead>\n<tr>\n<th>函 数</th>\n<th>说 明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>AVG()</td>\n<td>返回某列的平均值</td>\n</tr>\n<tr>\n<td>COUNT()</td>\n<td>返回某列的行数</td>\n</tr>\n<tr>\n<td>MAX()</td>\n<td>返回某列的最大值</td>\n</tr>\n<tr>\n<td>MIN()</td>\n<td>返回某列的最小值</td>\n</tr>\n<tr>\n<td>SUM()</td>\n<td>返回某列值之和</td>\n</tr>\n</tbody>\n</table>\n<p>AVG() 会忽略 NULL 行。</p>\n<p>使用 DISTINCT 可以让汇总函数值汇总不同的值。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="58000729820407410000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`SELECT AVG(DISTINCT col1) AS avg_col\nFROM mytable`, `58000729820407410000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql"><span class="token keyword">SELECT</span> <span class="token function">AVG</span><span class="token punctuation">(</span><span class="token keyword">DISTINCT</span> col1<span class="token punctuation">)</span> <span class="token keyword">AS</span> avg_col\n<span class="token keyword">FROM</span> mytable</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>\n<h1 id="十三、分组"><a href="#%E5%8D%81%E4%B8%89%E3%80%81%E5%88%86%E7%BB%84" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>十三、分组</h1>\n<p>分组就是把具有相同的数据值的行放在同一组中。</p>\n<p>可以对同一分组数据使用汇总函数进行处理，例如求分组数据的平均值等。</p>\n<p>指定的分组字段除了能让数组按该字段进行分组，也可以按该字段进行排序，例如按 col 字段排序并分组数据：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="75346624276912640000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`SELECT col, COUNT(*) AS num\nFROM mytable\nGROUP BY col;`, `75346624276912640000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql"><span class="token keyword">SELECT</span> col<span class="token punctuation">,</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> num\n<span class="token keyword">FROM</span> mytable\n<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> col<span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<p>WHERE 过滤行，HAVING 过滤分组。行过滤应当先与分组过滤；</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="12658798971273378000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`SELECT col, COUNT(*) AS num\nFROM mytable\nWHERE col > 2\nGROUP BY col\nHAVING COUNT(*) >= 2;`, `12658798971273378000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql"><span class="token keyword">SELECT</span> col<span class="token punctuation">,</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> num\n<span class="token keyword">FROM</span> mytable\n<span class="token keyword">WHERE</span> col <span class="token operator">></span> <span class="token number">2</span>\n<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> col\n<span class="token keyword">HAVING</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">2</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>GROUP BY 的排序结果为分组字段，而 ORDER BY 也可以以聚集字段来进行排序。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="48115445691865650000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`SELECT col, COUNT(*) AS num\nFROM mytable\nGROUP BY col\nORDER BY num;`, `48115445691865650000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql"><span class="token keyword">SELECT</span> col<span class="token punctuation">,</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> num\n<span class="token keyword">FROM</span> mytable\n<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> col\n<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> num<span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>分组规定：</p>\n<ol>\n<li>GROUP BY 子句出现在 WHERE 子句之后，ORDER BY 子句之前；</li>\n<li>除了汇总计算语句的字段外，SELECT 语句中的每一字段都必须在 GROUP BY 子句中给出；</li>\n<li>NULL 的行会单独分为一组；</li>\n<li>大多数 SQL 实现不支持 GROUP BY 列具有可变长度的数据类型。</li>\n</ol>\n<h1 id="十四、子查询"><a href="#%E5%8D%81%E5%9B%9B%E3%80%81%E5%AD%90%E6%9F%A5%E8%AF%A2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>十四、子查询</h1>\n<p>子查询中只能返回一个字段的数据。</p>\n<p>可以将子查询的结果作为 WHRER 语句的过滤条件：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="95625000086449670000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`SELECT *\nFROM mytable1\nWHERE col1 IN (SELECT col2\n                 FROM mytable2);`, `95625000086449670000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span>\n<span class="token keyword">FROM</span> mytable1\n<span class="token keyword">WHERE</span> col1 <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> col2\n                 <span class="token keyword">FROM</span> mytable2<span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>下面的语句可以检索出客户的订单数量，子查询语句会对第一个查询检索出的每个客户执行一次：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="62508787474605440000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`SELECT cust_name, (SELECT COUNT(*)\n                   FROM Orders\n                   WHERE Orders.cust_id = Customers.cust_id)\n                   AS orders_num\nFROM Customers\nORDER BY cust_name;`, `62508787474605440000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql"><span class="token keyword">SELECT</span> cust_name<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>\n                   <span class="token keyword">FROM</span> Orders\n                   <span class="token keyword">WHERE</span> Orders<span class="token punctuation">.</span>cust_id <span class="token operator">=</span> Customers<span class="token punctuation">.</span>cust_id<span class="token punctuation">)</span>\n                   <span class="token keyword">AS</span> orders_num\n<span class="token keyword">FROM</span> Customers\n<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> cust_name<span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h1 id="十五、连接"><a href="#%E5%8D%81%E4%BA%94%E3%80%81%E8%BF%9E%E6%8E%A5" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>十五、连接</h1>\n<p>连接用于连接多个表，使用 JOIN 关键字，并且条件语句使用 ON 而不是 Where。</p>\n<p>连接可以替换子查询，并且比子查询的效率一般会更快。</p>\n<p>可以用 AS 给列名、计算字段和表名取别名，给表名取别名是为了简化 SQL 语句以及连接相同表。</p>\n<h2 id="内连接"><a href="#%E5%86%85%E8%BF%9E%E6%8E%A5" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>内连接</h2>\n<p>内连接又称等值连接，使用 INNER JOIN 关键字。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="30522401390890975000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`select a, b, c\nfrom A inner join B\non A.key = B.key`, `30522401390890975000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql"><span class="token keyword">select</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c\n<span class="token keyword">from</span> A <span class="token keyword">inner</span> <span class="token keyword">join</span> B\n<span class="token keyword">on</span> A<span class="token punctuation">.</span><span class="token keyword">key</span> <span class="token operator">=</span> B<span class="token punctuation">.</span><span class="token keyword">key</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<p>可以不明确使用 INNER JOIN，而使用普通查询并在 WHERE 中将两个表中要连接的列用等值方法连接起来。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="19933634623735940000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`select a, b, c\nfrom A, B\nwhere A.key = B.key`, `19933634623735940000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql"><span class="token keyword">select</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c\n<span class="token keyword">from</span> A<span class="token punctuation">,</span> B\n<span class="token keyword">where</span> A<span class="token punctuation">.</span><span class="token keyword">key</span> <span class="token operator">=</span> B<span class="token punctuation">.</span><span class="token keyword">key</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<p>在没有条件语句的情况下返回笛卡尔积。</p>\n<h2 id="自连接"><a href="#%E8%87%AA%E8%BF%9E%E6%8E%A5" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>自连接</h2>\n<p>自连接可以看成内连接的一种，只是连接的表是自身而已。</p>\n<p>一张员工表，包含员工姓名和员工所属部门，要找出与 Jim 处在同一部门的所有员工姓名。</p>\n<p>子查询版本</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="85620820045825280000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`select name\nfrom employee\nwhere department = (\n      select department\n      from employee\n      where name = &quot;Jim&quot;);`, `85620820045825280000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql"><span class="token keyword">select</span> name\n<span class="token keyword">from</span> employee\n<span class="token keyword">where</span> department <span class="token operator">=</span> <span class="token punctuation">(</span>\n      <span class="token keyword">select</span> department\n      <span class="token keyword">from</span> employee\n      <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">"Jim"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>自连接版本</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="4395793070671572000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`select e2.name\nfrom employee as e1, employee as e2\nwhere e1.department = e2.department\n      and e1.name = &quot;Jim&quot;;`, `4395793070671572000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql"><span class="token keyword">select</span> e2<span class="token punctuation">.</span>name\n<span class="token keyword">from</span> employee <span class="token keyword">as</span> e1<span class="token punctuation">,</span> employee <span class="token keyword">as</span> e2\n<span class="token keyword">where</span> e1<span class="token punctuation">.</span>department <span class="token operator">=</span> e2<span class="token punctuation">.</span>department\n      <span class="token operator">and</span> e1<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"Jim"</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>连接一般比子查询的效率高。</p>\n<h2 id="自然连接"><a href="#%E8%87%AA%E7%84%B6%E8%BF%9E%E6%8E%A5" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>自然连接</h2>\n<p>自然连接是把同名列通过等值测试连接起来的，同名列可以有多个。</p>\n<p>内连接和自然连接的区别：内连接提供连接的列，而自然连接自动连接所有同名列。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="56234176395070070000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`select *\nfrom employee natural join department;`, `56234176395070070000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql"><span class="token keyword">select</span> <span class="token operator">*</span>\n<span class="token keyword">from</span> employee <span class="token keyword">natural</span> <span class="token keyword">join</span> department<span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>\n<h2 id="外连接"><a href="#%E5%A4%96%E8%BF%9E%E6%8E%A5" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>外连接</h2>\n<p>外连接保留了没有关联的那些行。分为左外连接，右外连接以及全外连接，左外连接就是保留左表没有关联的行。</p>\n<p>检索所有顾客的订单信息，包括还没有订单信息的顾客。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="52915429813109440000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`select Customers.cust_id, Orders.order_num\n   from Customers left outer join Orders\n   on Customers.cust_id = Orders.curt_id;`, `52915429813109440000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql"><span class="token keyword">select</span> Customers<span class="token punctuation">.</span>cust_id<span class="token punctuation">,</span> Orders<span class="token punctuation">.</span>order_num\n   <span class="token keyword">from</span> Customers <span class="token keyword">left</span> <span class="token keyword">outer</span> <span class="token keyword">join</span> Orders\n   <span class="token keyword">on</span> Customers<span class="token punctuation">.</span>cust_id <span class="token operator">=</span> Orders<span class="token punctuation">.</span>curt_id<span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<p>如果需要统计顾客的订单数，使用聚集函数。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="5280219133136765000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`select Customers.cust_id,\n       COUNT(Orders.order_num) as num_ord\nfrom Customers left outer join Orders\non Customers.cust_id = Orders.curt_id\ngroup by Customers.cust_id;`, `5280219133136765000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql"><span class="token keyword">select</span> Customers<span class="token punctuation">.</span>cust_id<span class="token punctuation">,</span>\n       <span class="token function">COUNT</span><span class="token punctuation">(</span>Orders<span class="token punctuation">.</span>order_num<span class="token punctuation">)</span> <span class="token keyword">as</span> num_ord\n<span class="token keyword">from</span> Customers <span class="token keyword">left</span> <span class="token keyword">outer</span> <span class="token keyword">join</span> Orders\n<span class="token keyword">on</span> Customers<span class="token punctuation">.</span>cust_id <span class="token operator">=</span> Orders<span class="token punctuation">.</span>curt_id\n<span class="token keyword">group</span> <span class="token keyword">by</span> Customers<span class="token punctuation">.</span>cust_id<span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h1 id="十六、组合查询"><a href="#%E5%8D%81%E5%85%AD%E3%80%81%E7%BB%84%E5%90%88%E6%9F%A5%E8%AF%A2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>十六、组合查询</h1>\n<p>使用 <strong>UNION</strong> 来组合两个查询，如果第一个查询返回 M 行，第二个查询返回 N 行，那么组合查询的结果为 M+N 行。</p>\n<p>每个查询必须包含相同的列、表达式或者聚集函数。</p>\n<p>默认会去除相同行，如果需要保留相同行，使用 UNION ALL。</p>\n<p>只能包含一个 ORDER BY 子句，并且必须位于语句的最后。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="93335312721288680000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`SELECT col\nFROM mytable\nWHERE col = 1\nUNION\nSELECT col\nFROM mytable\nWHERE col =2;`, `93335312721288680000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql"><span class="token keyword">SELECT</span> col\n<span class="token keyword">FROM</span> mytable\n<span class="token keyword">WHERE</span> col <span class="token operator">=</span> <span class="token number">1</span>\n<span class="token keyword">UNION</span>\n<span class="token keyword">SELECT</span> col\n<span class="token keyword">FROM</span> mytable\n<span class="token keyword">WHERE</span> col <span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h1 id="十七、视图"><a href="#%E5%8D%81%E4%B8%83%E3%80%81%E8%A7%86%E5%9B%BE" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>十七、视图</h1>\n<p>视图是虚拟的表，本身不包含数据，也就不能对其进行索引操作。对视图的操作和对普通表的操作一样。</p>\n<p>视图具有如下好处：</p>\n<ol>\n<li>简化复杂的 SQL 操作，比如复杂的联结；</li>\n<li>只使用实际表的一部分数据；</li>\n<li>通过只给用户访问视图的权限，保证数据的安全性；</li>\n<li>更改数据格式和表示。</li>\n</ol>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="12132270934971068000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`CREATE VIEW myview AS\nSELECT Concat(col1, col2) AS concat_col, col3*col4 AS count_col\nFROM mytable\nWHERE col5 = val;`, `12132270934971068000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">VIEW</span> myview <span class="token keyword">AS</span>\n<span class="token keyword">SELECT</span> Concat<span class="token punctuation">(</span>col1<span class="token punctuation">,</span> col2<span class="token punctuation">)</span> <span class="token keyword">AS</span> concat_col<span class="token punctuation">,</span> col3<span class="token operator">*</span>col4 <span class="token keyword">AS</span> count_col\n<span class="token keyword">FROM</span> mytable\n<span class="token keyword">WHERE</span> col5 <span class="token operator">=</span> val<span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>\n<h1 id="十八、存储过程"><a href="#%E5%8D%81%E5%85%AB%E3%80%81%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>十八、存储过程</h1>\n<p>存储过程可以看成是对一系列 SQL 操作的批处理；</p>\n<h2 id="使用存储过程的好处"><a href="#%E4%BD%BF%E7%94%A8%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E7%9A%84%E5%A5%BD%E5%A4%84" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>使用存储过程的好处</h2>\n<ol>\n<li>\n<p>代码封装，保证了一定的安全性；</p>\n</li>\n<li>\n<p>代码复用；</p>\n</li>\n<li>\n<p>由于是预先编译，因此具有很高的性能。</p>\n</li>\n</ol>\n<h2 id="创建存储过程"><a href="#%E5%88%9B%E5%BB%BA%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>创建存储过程</h2>\n<p>命令行中创建存储过程需要自定义分隔符，因为命令行是以 ; 为结束符，而存储过程中也包含了分号，因此会错误把这部分分号当成是结束符，造成语法错误。</p>\n<p>包含 in、out 和 inout 三种参数。</p>\n<p>给变量赋值都需要用 select into 语句。</p>\n<p>每次只能给一个变量赋值，不支持集合的操作。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="14883825623492841000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`delimiter //\n\ncreate procedure myprocedure( out ret int )\n    begin\n        declare y int;\n        select sum(col1)\n        from mytable\n        into y;\n        select y*y into ret;\n    end //\ndelimiter ;`, `14883825623492841000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql"><span class="token keyword">delimiter</span> <span class="token comment">//</span>\n\n<span class="token keyword">create</span> <span class="token keyword">procedure</span> myprocedure<span class="token punctuation">(</span> <span class="token keyword">out</span> ret <span class="token keyword">int</span> <span class="token punctuation">)</span>\n    <span class="token keyword">begin</span>\n        <span class="token keyword">declare</span> y <span class="token keyword">int</span><span class="token punctuation">;</span>\n        <span class="token keyword">select</span> <span class="token function">sum</span><span class="token punctuation">(</span>col1<span class="token punctuation">)</span>\n        <span class="token keyword">from</span> mytable\n        <span class="token keyword">into</span> y<span class="token punctuation">;</span>\n        <span class="token keyword">select</span> y<span class="token operator">*</span>y <span class="token keyword">into</span> ret<span class="token punctuation">;</span>\n    <span class="token keyword">end</span> <span class="token comment">//</span>\n<span class="token keyword">delimiter</span> <span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="16172528562232125000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`call myprocedure(@ret);\nselect @ret;`, `16172528562232125000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql"><span class="token keyword">call</span> myprocedure<span class="token punctuation">(</span><span class="token variable">@ret</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">select</span> <span class="token variable">@ret</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>\n<h1 id="十九、游标"><a href="#%E5%8D%81%E4%B9%9D%E3%80%81%E6%B8%B8%E6%A0%87" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>十九、游标</h1>\n<p>在存储过程中使用游标可以对一个结果集进行移动遍历。</p>\n<p>游标主要用于交互式应用，其中用户需要对数据集中的任意行进行浏览和修改。</p>\n<p>使用游标的四个步骤：</p>\n<ol>\n<li>声明游标，这个过程没有实际检索出数据；</li>\n<li>打开游标；</li>\n<li>取出数据；</li>\n<li>关闭游标；</li>\n</ol>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="31635465934162600000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`delimiter //\ncreate procedure myprocedure(out ret int)\n    begin\n        declare done boolean default 0;\n\n        declare mycursor cursor for\n        select col1 from mytable;\n        # 定义了一个continue handler，当 sqlstate \'02000\' 这个条件出现时，会执行 set done = 1\n        declare continue handler for sqlstate \'02000\' set done = 1;\n\n        open mycursor;\n\n        repeat\n            fetch mycursor into ret;\n            select ret;\n        until done end repeat;\n\n        close mycursor;\n    end //\n delimiter ;`, `31635465934162600000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql"><span class="token keyword">delimiter</span> <span class="token comment">//</span>\n<span class="token keyword">create</span> <span class="token keyword">procedure</span> myprocedure<span class="token punctuation">(</span><span class="token keyword">out</span> ret <span class="token keyword">int</span><span class="token punctuation">)</span>\n    <span class="token keyword">begin</span>\n        <span class="token keyword">declare</span> done <span class="token keyword">boolean</span> <span class="token keyword">default</span> <span class="token number">0</span><span class="token punctuation">;</span>\n\n        <span class="token keyword">declare</span> mycursor <span class="token keyword">cursor</span> <span class="token keyword">for</span>\n        <span class="token keyword">select</span> col1 <span class="token keyword">from</span> mytable<span class="token punctuation">;</span>\n        <span class="token comment"># 定义了一个continue handler，当 sqlstate \'02000\' 这个条件出现时，会执行 set done = 1</span>\n        <span class="token keyword">declare</span> <span class="token keyword">continue</span> <span class="token keyword">handler</span> <span class="token keyword">for</span> sqlstate <span class="token string">\'02000\'</span> <span class="token keyword">set</span> done <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>\n\n        <span class="token keyword">open</span> mycursor<span class="token punctuation">;</span>\n\n        <span class="token keyword">repeat</span>\n            <span class="token keyword">fetch</span> mycursor <span class="token keyword">into</span> ret<span class="token punctuation">;</span>\n            <span class="token keyword">select</span> ret<span class="token punctuation">;</span>\n        until done <span class="token keyword">end</span> <span class="token keyword">repeat</span><span class="token punctuation">;</span>\n\n        <span class="token keyword">close</span> mycursor<span class="token punctuation">;</span>\n    <span class="token keyword">end</span> <span class="token comment">//</span>\n <span class="token keyword">delimiter</span> <span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h1 id="二十、触发器"><a href="#%E4%BA%8C%E5%8D%81%E3%80%81%E8%A7%A6%E5%8F%91%E5%99%A8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>二十、触发器</h1>\n<p>触发器会在某个表执行以下语句时而自动执行：DELETE、INSERT、UPDATE</p>\n<p>触发器必须指定在语句执行之前还是之后自动执行，之前执行使用 BEFORE 关键字，之后执行使用 AFTER 关键字。BEFORE 用于数据验证和净化。</p>\n<p>INSERT 触发器包含一个名为 NEW 的虚拟表。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="56196817190777405000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`CREATE TRIGGER mytrigger AFTER INSERT ON mytable\nFOR EACH ROW SELECT NEW.col;`, `56196817190777405000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TRIGGER</span> mytrigger <span class="token keyword">AFTER</span> <span class="token keyword">INSERT</span> <span class="token keyword">ON</span> mytable\n<span class="token keyword">FOR EACH ROW</span> <span class="token keyword">SELECT</span> NEW<span class="token punctuation">.</span>col<span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>\n<p>DELETE 触发器包含一个名为 OLD 的虚拟表，并且是只读的。</p>\n<p>UPDATE 触发器包含一个名为 NEW 和一个名为 OLD 的虚拟表，其中 NEW 是可以被修改地，而 OLD 是只读的。</p>\n<p>可以使用触发器来进行审计跟踪，把修改记录到另外一张表中。</p>\n<p>MySQL 不允许在触发器中使用 CALL 语句 ，也就是不能调用存储过程。</p>\n<h1 id="二十一、事务处理"><a href="#%E4%BA%8C%E5%8D%81%E4%B8%80%E3%80%81%E4%BA%8B%E5%8A%A1%E5%A4%84%E7%90%86" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>二十一、事务处理</h1>\n<p>基本术语：</p>\n<ol>\n<li>事务（transaction）指一组 SQL 语句；</li>\n<li>回退（rollback）指撤销指定 SQL 语句的过程；</li>\n<li>提交（commit）指将未存储的 SQL 语句结果写入数据库表；</li>\n<li>保留点（savepoint）指事务处理中设置的临时占位符（placeholder），你可以对它发布回退（与回退整个事务处理不同）。</li>\n</ol>\n<p>不能回退 SELECT 语句，回退 SELECT 语句也没意义；也不能回退 CREATE 和 DROP 语句。</p>\n<p>MySQL 的事务提交默认是隐式提交，也就是每执行一条语句就把这条语句当成一个事务然后进行提交。当出现 START TRANSACTION 语句时，会关闭隐式提交；当 COMMIT 或 ROLLBACK 语句执行后，事务会自动关闭，重新恢复隐式提交。</p>\n<p>通过设置 autocommit 为 0 可以取消自动提交，直到 autocommit 被设置为 1 才会提交；autocommit 标记是针对每个连接而不是针对服务器的。</p>\n<p>如果没有设置保留点，ROLLBACK 会回退到 START TRANSACTION 语句处；如果设置了保留点，并且在 ROLLBACK 中指定该保留点，则会回退到该保留点。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="12343241418093220000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`START TRANSACTION\n// ...\nSAVEPOINT delete1\n// ...\nROLLBACK TO delete1\n// ...\nCOMMIT`, `12343241418093220000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql"><span class="token keyword">START</span> <span class="token keyword">TRANSACTION</span>\n<span class="token comment">// ...</span>\n<span class="token keyword">SAVEPOINT</span> delete1\n<span class="token comment">// ...</span>\n<span class="token keyword">ROLLBACK</span> <span class="token keyword">TO</span> delete1\n<span class="token comment">// ...</span>\n<span class="token keyword">COMMIT</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h1 id="二十二、字符集"><a href="#%E4%BA%8C%E5%8D%81%E4%BA%8C%E3%80%81%E5%AD%97%E7%AC%A6%E9%9B%86" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>二十二、字符集</h1>\n<p>基本术语：</p>\n<ol>\n<li>字符集为字母和符号的集合；</li>\n<li>编码为某个字符集成员的内部表示；</li>\n<li>校对字符指定如何比较，主要用于排序和分组。</li>\n</ol>\n<p>除了给表指定字符集和校对外，也可以给列指定：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="91501619398283790000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`CREATE TABLE mytable\n(col VARCHAR(10) CHARACTER SET latin COLLATE latin1_general_ci )\nDEFAULT CHARACTER SET hebrew COLLATE hebrew_general_ci;`, `91501619398283790000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> mytable\n<span class="token punctuation">(</span>col <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> latin <span class="token keyword">COLLATE</span> latin1_general_ci <span class="token punctuation">)</span>\n<span class="token keyword">DEFAULT</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> hebrew <span class="token keyword">COLLATE</span> hebrew_general_ci<span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<p>可以在排序、分组时指定校对：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="62029777001283580000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`SELECT *\nFROM mytable\nORDER BY col COLLATE latin1_general_ci;`, `62029777001283580000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span>\n<span class="token keyword">FROM</span> mytable\n<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> col <span class="token keyword">COLLATE</span> latin1_general_ci<span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<h1 id="二十三、权限管理"><a href="#%E4%BA%8C%E5%8D%81%E4%B8%89%E3%80%81%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>二十三、权限管理</h1>\n<p>MySQL 的账户信息保存在 mysql 这个数据库中。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="38195247579049930000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`USE mysql;\nSELECT user FROM user;`, `38195247579049930000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql"><span class="token keyword">USE</span> mysql<span class="token punctuation">;</span>\n<span class="token keyword">SELECT</span> <span class="token keyword">user</span> <span class="token keyword">FROM</span> <span class="token keyword">user</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>\n<h2 id="创建账户"><a href="#%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>创建账户</h2>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="13889865689928760000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`CREATE USER myuser IDENTIFIED BY \'mypassword\';`, `13889865689928760000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">USER</span> myuser IDENTIFIED <span class="token keyword">BY</span> <span class="token string">\'mypassword\'</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>\n<p>新创建的账户没有任何权限。</p>\n<h2 id="修改账户名"><a href="#%E4%BF%AE%E6%94%B9%E8%B4%A6%E6%88%B7%E5%90%8D" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>修改账户名</h2>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="21321708465001697000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`RENAME myuser TO newuser;`, `21321708465001697000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql"><span class="token keyword">RENAME</span> myuser <span class="token keyword">TO</span> newuser<span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>\n<h2 id="删除账户"><a href="#%E5%88%A0%E9%99%A4%E8%B4%A6%E6%88%B7" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>删除账户</h2>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="98965384623855830000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`DROP USER myuser;`, `98965384623855830000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql"><span class="token keyword">DROP</span> <span class="token keyword">USER</span> myuser<span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>\n<h2 id="查看权限"><a href="#%E6%9F%A5%E7%9C%8B%E6%9D%83%E9%99%90" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>查看权限</h2>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="76266754016596460000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`SHOW GRANTS FOR myuser;`, `76266754016596460000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql"><span class="token keyword">SHOW</span> GRANTS <span class="token keyword">FOR</span> myuser<span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>\n<h2 id="授予权限"><a href="#%E6%8E%88%E4%BA%88%E6%9D%83%E9%99%90" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>授予权限</h2>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="21712368975276040000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`GRANT SELECT, INSERT ON mydatabase.* TO myuser;`, `21712368975276040000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql"><span class="token keyword">GRANT</span> <span class="token keyword">SELECT</span><span class="token punctuation">,</span> <span class="token keyword">INSERT</span> <span class="token keyword">ON</span> mydatabase<span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">TO</span> myuser<span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>\n<p>账户用 username@host 的形式定义，username@% 使用的是默认主机名。</p>\n<h2 id="删除权限"><a href="#%E5%88%A0%E9%99%A4%E6%9D%83%E9%99%90" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>删除权限</h2>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="82361562398825510000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`REVOKE SELECT, INSERT ON mydatabase.* FROM myuser;`, `82361562398825510000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql"><span class="token keyword">REVOKE</span> <span class="token keyword">SELECT</span><span class="token punctuation">,</span> <span class="token keyword">INSERT</span> <span class="token keyword">ON</span> mydatabase<span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">FROM</span> myuser<span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>\n<p>GRANT 和 REVOKE 可在几个层次上控制访问权限：</p>\n<ul>\n<li>整个服务器，使用 GRANT ALL 和 REVOKE ALL；</li>\n<li>整个数据库，使用 ON database.*；</li>\n<li>特定的表，使用 ON database.table；</li>\n<li>特定的列；</li>\n<li>特定的存储过程。</li>\n</ul>\n<h2 id="更改密码"><a href="#%E6%9B%B4%E6%94%B9%E5%AF%86%E7%A0%81" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>更改密码</h2>\n<p>必须使用 Password() 函数</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="20272321428717400000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`SET PASSWROD FOR myuser = Password(\'newpassword\');`, `20272321428717400000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="sql"\n              >\n                <span class="gatsby-code-button-language">sql</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="sql"><pre style="counter-reset: linenumber NaN" class="language-sql line-numbers"><code class="language-sql"><span class="token keyword">SET</span> PASSWROD <span class="token keyword">FOR</span> myuser <span class="token operator">=</span> Password<span class="token punctuation">(</span><span class="token string">\'newpassword\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>\n<h1 id="参考资料"><a href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>参考资料</h1>\n<ul>\n<li>BenForta. SQL 必知必会 [M]. 人民邮电出版社, 2013.</li>\n</ul>',
excerpt:"一、基础 模式定义了数据如何存储、存储什么样的数据以及数据如何分解等信息，数据库和表都有模式。 主键的值不允许修改，也不允许复用（不能使用已经删除的主键值赋给新数据行的主键）。 SQL（Structured Query Language），标准 SQL 由 ANSI…",frontmatter:{date:"2018-04-03 15:23:56",path:"/sql-must-know/",tags:"后端, 面试, 数据库, SQL, 读书笔记",title:"SQL语句必知必会",draft:null}}},pathContext:{mainPostPath:"/database-principle/",nextPostPath:"/object-oriented-thinking/",prePostPath:"/sql-must-know/"}}}});