webpackJsonp([9469948045756],{1335:function(n,a){n.exports={data:{site:{siteMetadata:{description:'前端工程师，黑猫女王控，欢迎勾搭，技术相关<a href="https://github.com/towavephone" target="_blank">@towavephone</a>，QQ闲聊<a href="tencent://AddContact/?fromId=45&fromSubId=1&subcmd=all&uin=634407147&website=www.oicqzone.com">@towave</a>，bili关注<a href="https://space.bilibili.com/11507708#/" target="_blank">@towave</a>',siteUrl:"https://blog.towavephone.com"}}},pathContext:{posts:[{excerpt:"图片合成最常见的需求有验证码图片，亦或者图片加水印等，这种实现一般都是后端实现的。 随着 HTML5 发展和现代浏览器的占比越来越高，我们其实也可以在前端直接进行图片的合成。优点在于，响应更快，体验更好；如果是和文字进行合成，我们可以利用客户端字体，视觉展现效果更丰富；同时展示和合成全部都是前端完成，因此更利于维护。 这里通过举个例子，演示如何在前端实现多个图片合成的效果，主要是借助 HTML5 canvas 相关技术。 使用 canvas…",html:'<p>图片合成最常见的需求有验证码图片，亦或者图片加水印等，这种实现一般都是后端实现的。</p>\n<p>随着 HTML5 发展和现代浏览器的占比越来越高，我们其实也可以在前端直接进行图片的合成。优点在于，响应更快，体验更好；如果是和文字进行合成，我们可以利用客户端字体，视觉展现效果更丰富；同时展示和合成全部都是前端完成，因此更利于维护。</p>\n<p>这里通过举个例子，演示如何在前端实现多个图片合成的效果，主要是借助 HTML5 canvas 相关技术。</p>\n<h1 id="使用-canvas-在前端实现图片水印合成"><a href="#%E4%BD%BF%E7%94%A8-canvas-%E5%9C%A8%E5%89%8D%E7%AB%AF%E5%AE%9E%E7%8E%B0%E5%9B%BE%E7%89%87%E6%B0%B4%E5%8D%B0%E5%90%88%E6%88%90" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>使用 canvas 在前端实现图片水印合成</h1>\n<p>如果仅仅是普通的合成，例如一个底图和一个 PNG 水印图片合成，直接使用 canvas 的 drawImage()方法即可，语法如下：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="62733337441363935000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`context.drawImage(img, x, y);\ncontext.drawImage(img, x, y, width, height);\ncontext.drawImage(img, sx, sy, swidth, sheight, x, y, width, height);`, `62733337441363935000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="js"\n              >\n                <span class="gatsby-code-button-language">js</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="js"><pre style="counter-reset: linenumber NaN" class="language-js line-numbers"><code class="language-js">context<span class="token punctuation">.</span><span class="token function">drawImage</span><span class="token punctuation">(</span>img<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>\ncontext<span class="token punctuation">.</span><span class="token function">drawImage</span><span class="token punctuation">(</span>img<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> width<span class="token punctuation">,</span> height<span class="token punctuation">)</span><span class="token punctuation">;</span>\ncontext<span class="token punctuation">.</span><span class="token function">drawImage</span><span class="token punctuation">(</span>img<span class="token punctuation">,</span> sx<span class="token punctuation">,</span> sy<span class="token punctuation">,</span> swidth<span class="token punctuation">,</span> sheight<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> width<span class="token punctuation">,</span> height<span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<p>各个参数示意为：</p>\n<table>\n<thead>\n<tr>\n<th align="left">参数</th>\n<th align="left">描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align="left">img</td>\n<td align="left">用来被绘制的图像、画布或视频。</td>\n</tr>\n<tr>\n<td align="left">sx</td>\n<td align="left">可选。img 被绘制区域的起始左上 x 坐标。</td>\n</tr>\n<tr>\n<td align="left">sy</td>\n<td align="left">可选。img 被绘制区域的起始左上 y 坐标。</td>\n</tr>\n<tr>\n<td align="left">swidth</td>\n<td align="left">可选。img 被绘制区域的宽度（如果没有后面的 width 或 height 参数，则可以伸展或缩小图像）。</td>\n</tr>\n<tr>\n<td align="left">sheight</td>\n<td align="left">可选。img 被绘制区域的高度（如果没有后面的 width 或 height 参数，则可以伸展或缩小图像）。</td>\n</tr>\n<tr>\n<td align="left">x</td>\n<td align="left">画布上放置 img 的起始 x 坐标。</td>\n</tr>\n<tr>\n<td align="left">y</td>\n<td align="left">画布上放置 img 的起始 y 坐标。</td>\n</tr>\n<tr>\n<td align="left">width</td>\n<td align="left">可选。画布上放置 img 提供的宽度（可能会有图片剪裁效果）。</td>\n</tr>\n<tr>\n<td align="left">height</td>\n<td align="left">可选。画布上放置 img 提供的高度（可能会有图片剪裁效果）。</td>\n</tr>\n</tbody>\n</table>\n<p>而 PNG 水印图片的合成，直接连续在使用 drawImage()把对应的图片绘制到 canvas 画布上就可以，原理就是这么简单。</p>\n<div>\n          <div\n            class="gatsby-resp-iframe-wrapper"\n            style="padding-bottom: 50%; position: relative; height: 0; overflow: hidden;margin-bottom: 2em"\n          >\n            <iframe src="/examples/canvas-picture-watermark-synthesis/js-canvas-image-watermark-synthesis.html" style="\n            position: absolute;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n          "></iframe>\n          </div>\n          </div>\n<p><div class="gatsby-highlight">\n        <pre class="language-html"><code><span class="token doctype">&lt;!DOCTYPE html></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1.0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>X-UA-Compatible<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ie=edge<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Document<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>https://qidian.gtimg.com/lulu/theme/modern/css/common/ui/Button.css<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css">\n    <span class="token selector">html,\n    body</span> <span class="token punctuation">{</span>\n      <span class="token property">background-color</span><span class="token punctuation">:</span> white<span class="token punctuation">;</span>\n      <span class="token property">margin</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token selector">.clip</span> <span class="token punctuation">{</span>\n      <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>\n      <span class="token property">clip</span><span class="token punctuation">:</span> <span class="token function">rect</span><span class="token punctuation">(</span>0 0 0 0<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>demo<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>uploadFile<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>clip<span class="token punctuation">"</span></span> <span class="token attr-name">accept</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>image/png, image/jpeg, image/gif, image/jpg<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ui-button ui-button-primary<span class="token punctuation">"</span></span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>uploadFile<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>选择图片<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>imgCover<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>./watermark.png<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>180<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>180<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>clip<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>imgUploadX<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">\n    <span class="token keyword">var</span> eleUploadFile <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">\'uploadFile\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">var</span> eleImgCover <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">\'imgCover\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">var</span> eleImgUploadX <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">\'imgUploadX\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">if</span> <span class="token punctuation">(</span>history<span class="token punctuation">.</span>pushState<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      eleUploadFile<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">\'change\'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">var</span> reader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">var</span> file <span class="token operator">=</span> event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">||</span> event<span class="token punctuation">.</span>dataTransfer<span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n        reader<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n          <span class="token keyword">var</span> base64 <span class="token operator">=</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>result<span class="token punctuation">;</span>\n          <span class="token keyword">if</span> <span class="token punctuation">(</span>base64<span class="token punctuation">.</span>length <span class="token operator">></span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">50</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n            <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">\'图片尺寸请小于50K\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n            <span class="token keyword">return</span><span class="token punctuation">;</span>\n          <span class="token punctuation">}</span>\n          <span class="token comment">// 使用canvas合成图片，并base64化</span>\n          <span class="token function">imgTogether</span><span class="token punctuation">(</span>base64<span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">url</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n            <span class="token comment">// 尺寸</span>\n            <span class="token keyword">var</span> size <span class="token operator">=</span> <span class="token number">180</span> <span class="token operator">/</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>devicePixelRatio <span class="token operator">||</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n            <span class="token comment">// 预览和变化</span>\n            eleImgUploadX<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">\'&lt;img src="\'</span><span class="token operator">+</span> url <span class="token operator">+</span><span class="token string">\'" width="\'</span><span class="token operator">+</span> size <span class="token operator">+</span><span class="token string">\'" height="\'</span><span class="token operator">+</span> size <span class="token operator">+</span><span class="token string">\'">\'</span><span class="token punctuation">;</span>\n          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span><span class="token punctuation">;</span>\n        reader<span class="token punctuation">.</span><span class="token function">readAsDataURL</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>\n      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n      <span class="token comment">// canvas图片合成</span>\n      <span class="token keyword">var</span> <span class="token function-variable function">imgTogether</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">url<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">\'canvas\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">var</span> size <span class="token operator">=</span> <span class="token number">180</span><span class="token punctuation">;</span>\n        canvas<span class="token punctuation">.</span>width <span class="token operator">=</span> size<span class="token punctuation">;</span>\n        canvas<span class="token punctuation">.</span>height <span class="token operator">=</span> size<span class="token punctuation">;</span>\n        <span class="token keyword">var</span> context <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">\'2d\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token comment">// 这是上传图像</span>\n        <span class="token keyword">var</span> imgUpload <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        imgUpload<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n          <span class="token comment">// 绘制</span>\n          context<span class="token punctuation">.</span><span class="token function">drawImage</span><span class="token punctuation">(</span>imgUpload<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> size<span class="token punctuation">,</span> size<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span> size<span class="token punctuation">,</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span>\n          <span class="token comment">// 再次绘制</span>\n          context<span class="token punctuation">.</span><span class="token function">drawImage</span><span class="token punctuation">(</span>eleImgCover<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> size<span class="token punctuation">,</span> size<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span> size<span class="token punctuation">,</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span>\n          <span class="token comment">// 回调</span>\n          <span class="token function">callback</span><span class="token punctuation">(</span>canvas<span class="token punctuation">.</span><span class="token function">toDataURL</span><span class="token punctuation">(</span><span class="token string">\'image/png\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span><span class="token punctuation">;</span>\n        imgUpload<span class="token punctuation">.</span>src <span class="token operator">=</span> url<span class="token punctuation">;</span>\n      <span class="token punctuation">}</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>eleImgUploadX<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      eleImgUploadX<span class="token punctuation">.</span>className <span class="token operator">=</span> <span class="token string">\'remind\'</span><span class="token punctuation">;</span>\n      eleImgUploadX<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">\'本演示IE10+下才有效果\'</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre>\n        </div></p>\n<h1 id="使用-canvas-实现更为复杂的图片合成"><a href="#%E4%BD%BF%E7%94%A8-canvas-%E5%AE%9E%E7%8E%B0%E6%9B%B4%E4%B8%BA%E5%A4%8D%E6%9D%82%E7%9A%84%E5%9B%BE%E7%89%87%E5%90%88%E6%88%90" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>使用 canvas 实现更为复杂的图片合成</h1>\n<p>具有透明背景的水印图片合成是 canvas 图片合成中最基本最简单的，如果遇到更为复杂的合成，例如各取 50%透明度进行合成，或者经典的 mix-blend-mode 混合模式的，此时可能就需要借助算法来实现了。</p>\n<p>原理为，使用 HTML5 canvas getImageData()方法获取图片完整的像素点信息，通过混合算法，对多个图片的像素信息进行合成，合并，重计算，最后把新的图片像素信息通过 putImageData()方法重新绘制到画布上，从而实现更为复杂的图片合成效果。</p>\n<p>其中，getImageData()方法返回 ImageData 对象，该对象拷贝了画布指定矩形的像素数据。</p>\n<p>ImageData 中有个 data 属性，这个属性是个巨大的数组，而这个数组每四个值为一组，分别对应图片中的每个像素的 RGBA 值，值范围如下：</p>\n<p>R – 红色 (0-255) G – 绿色 (0-255) B – 蓝色 (0-255) A – alpha 通道 (0-255; 0 是透明的，255 是完全可见的)</p>\n<p>只要对这些数字进行重新处理，再 putImageData()重新放到画布上，图像的效果就会发生变化。</p>',id:"/home/runner/work/GatsbyBlog/GatsbyBlog/blog/使用canvas在前端实现图片水印合成/index.md absPath of file >>> MarkdownRemark",timeToRead:3,frontmatter:{date:"2020-01-16 11:11:39",path:"/canvas-picture-watermark-synthesis/",tags:"前端, JS, JS知识点",title:"使用canvas在前端实现图片水印合成",draft:null}},{excerpt:"了解 CSS :focus-within 伪类 CSS :focus-within 伪类选择器和 IE8 就开始支持的:focus 可以说是近亲，区别在于:focus 表示当前元素处于 focus 状态时候干嘛干嘛，而:focus-within 表示当前元素或者当前元素的子元素处于 focus 状态时候干嘛干嘛。 举个例子： 表示仅仅当 处于 focus 状态时候， 元素 outline 出现。换句话说，子元素 focus…",html:'<h1 id="了解-css-focus-within-伪类"><a href="#%E4%BA%86%E8%A7%A3-css-focus-within-%E4%BC%AA%E7%B1%BB" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>了解 CSS :focus-within 伪类</h1>\n<p>CSS :focus-within 伪类选择器和 IE8 就开始支持的:focus 可以说是近亲，区别在于:focus 表示当前元素处于 focus 状态时候干嘛干嘛，而:focus-within 表示当前元素或者当前元素的子元素处于 focus 状态时候干嘛干嘛。</p>\n<p>举个例子：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="53459238580372720000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`form:focus {\n  outline: solid;\n}`, `53459238580372720000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="css"\n              >\n                <span class="gatsby-code-button-language">css</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="css"><pre style="counter-reset: linenumber NaN" class="language-css line-numbers"><code class="language-css"><span class="token selector">form:focus</span> <span class="token punctuation">{</span>\n  <span class="token property">outline</span><span class="token punctuation">:</span> solid<span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<p>表示仅仅当<code class="language-text">&lt;form&gt;</code>处于 focus 状态时候，<code class="language-text">&lt;form&gt;</code>元素 outline 出现。换句话说，子元素 focus，可以让任意父级元素样式发生变化。</p>\n<p>这个新特性的支持，未来势必会带来更加丰富的交互形式，以及特定场景简化我们实现。</p>\n<h1 id="css-focus-within-伪类实际应用举例"><a href="#css-focus-within-%E4%BC%AA%E7%B1%BB%E5%AE%9E%E9%99%85%E5%BA%94%E7%94%A8%E4%B8%BE%E4%BE%8B" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>CSS :focus-within 伪类实际应用举例</h1>\n<h2 id="表单输入勿扰模式"><a href="#%E8%A1%A8%E5%8D%95%E8%BE%93%E5%85%A5%E5%8B%BF%E6%89%B0%E6%A8%A1%E5%BC%8F" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>表单输入勿扰模式</h2>\n<p>当我们表单输入，选择或者进行交互时候，页面上表单以为其他内容全部都不可见。</p>\n<div>\n          <div\n            class="gatsby-resp-iframe-wrapper"\n            style="padding-bottom: 25%; position: relative; height: 0; overflow: hidden;margin-bottom: 2em"\n          >\n            <iframe src="/examples/css-focus-within-pseudo-class-selector/focus-within-form-dnd-mode.html" style="\n            position: absolute;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n          "></iframe>\n          </div>\n          </div>\n<p><div class="gatsby-highlight">\n        <pre class="language-html"><code><span class="token doctype">&lt;!DOCTYPE html></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1.0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>X-UA-Compatible<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ie=edge<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Document<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css">\n    <span class="token selector">html,\n    body</span> <span class="token punctuation">{</span>\n      <span class="token property">background-color</span><span class="token punctuation">:</span> white<span class="token punctuation">;</span>\n      <span class="token property">margin</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token selector">form</span> <span class="token punctuation">{</span>\n      <span class="token property">transition</span><span class="token punctuation">:</span> outline .2s<span class="token punctuation">;</span>\n      <span class="token property">outline</span><span class="token punctuation">:</span> 2000px solid <span class="token function">hsla</span><span class="token punctuation">(</span>0<span class="token punctuation">,</span>0%<span class="token punctuation">,</span>100%<span class="token punctuation">,</span>0<span class="token punctuation">)</span><span class="token punctuation">;</span>\n      <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>\n      <span class="token property">z-index</span><span class="token punctuation">:</span> 1<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token selector">form:focus-within</span> <span class="token punctuation">{</span>\n      <span class="token property">outline</span><span class="token punctuation">:</span> 2000px solid <span class="token function">hsla</span><span class="token punctuation">(</span>0<span class="token punctuation">,</span>0%<span class="token punctuation">,</span>100%<span class="token punctuation">,</span>1<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>\n  购物订单详情\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>p20 bgwh<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h6</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>f14 b<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>完成您的购物订单 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>icon icon_title_inf vn ui-tips<span class="token punctuation">"</span></span> <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>星号为必填<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h6</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>clearfix mt15<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>left<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>邮箱<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>red abs<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>*<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>cell<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>email<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ui-input<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>email<span class="token punctuation">"</span></span> <span class="token attr-name">required</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>clearfix mt15<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>left<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>手机号<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>red abs<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>*<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>cell<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>tel<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ui-input<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>tel<span class="token punctuation">"</span></span> <span class="token attr-name">required</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>clearfix mt15<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>left<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>您的款式<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>red abs<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>*<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>cell<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>radio<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>radioMale<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>type<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>488<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ui-radio<span class="token punctuation">"</span></span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>radioMale<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>mr20 ml5<span class="token punctuation">"</span></span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>radioMale<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>男款<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>radio<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>radioFemale<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>type<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>388<span class="token punctuation">"</span></span> <span class="token attr-name">required</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ui-radio<span class="token punctuation">"</span></span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>radioFemale<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>radioFemale<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ml5<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>女款<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>radioMaleP<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>dn mt10<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>男款每件488元<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>radioFemaleP<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>dn mt10<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>女款每件388元<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>clearfix mt15<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>left<span class="token punctuation">"</span></span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>number<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>购买数量<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>red abs<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>*<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>cell<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>number<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>number<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ui-input<span class="token punctuation">"</span></span> <span class="token attr-name">min</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">max</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>5<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">required</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>直接输入数值<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>clearfix mt15<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>left<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>所在城市<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>red abs<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>*<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>cell<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>citySelect<span class="token punctuation">"</span></span> <span class="token attr-name">required</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>请选择<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>深圳<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>5<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>上海<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>7<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>北京<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>成都<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span>\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>6<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>武汉<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>mt10 dn<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>运费： <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>strong</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>transPrice<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>red<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>strong</span><span class="token punctuation">></span></span> 元<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>clearfix mt15<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>left<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>给商家留言<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>cell<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ui-textarea<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>textarea</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>message<span class="token punctuation">"</span></span> <span class="token attr-name">rows</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>4<span class="token punctuation">"</span></span> <span class="token attr-name">maxlength</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>200<span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>少于200字符<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>textarea</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>clearfix mt15<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>left<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token entity" title="&nbsp;">&amp;nbsp;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>cell<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>checkbox<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>checkInsur<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>insurance<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0.4<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ui-checkbox<span class="token punctuation">"</span></span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>checkInsur<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ml5<span class="token punctuation">"</span></span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>checkInsur<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>使用运费险0.4元<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>pay<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>您总共需要支付 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>strong</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>total<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>red<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>strong</span><span class="token punctuation">></span></span> 元<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>clearfix mt15<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>left<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>是否货到付款<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>cell<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>checkbox<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>switch<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>pay<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ui-switch<span class="token punctuation">"</span></span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>switch<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>clearfix mt15<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>left<span class="token punctuation">"</span></span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>achieveDate<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>希望到货日期<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>cell<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ui-input ui-date-input<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>date<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>achieveDate<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>achieve<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2015-12-27<span class="token punctuation">"</span></span> <span class="token attr-name">min</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2015-12-27<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>gray ml20<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>默认尽快发货<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>clearfix mt20<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>left<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token entity" title="&nbsp;">&amp;nbsp;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>cell<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>validateSubmit<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ui-button ui-button-primary<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>提交<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre>\n        </div></p>\n<p>本案例是真实的勿扰模式效果可以放心大胆在实际项目中使用，因为这是一个体验增强的交互，就算浏览器不支持，对原本功能也不会有任何影响。</p>\n<h2 id="带计数文本域的-focus-高亮"><a href="#%E5%B8%A6%E8%AE%A1%E6%95%B0%E6%96%87%E6%9C%AC%E5%9F%9F%E7%9A%84-focus-%E9%AB%98%E4%BA%AE" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>带计数文本域的 focus 高亮</h2>\n<p>对于带计数的组件化的多行文本域，计数的数值通常是设计在文本域的右下角，这样能够适应各种复杂的场景。如下截图：</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/2020-01-14-17-56-25-1c3f3a477e726fad44623346a0a19cb0-8d9bd.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 308px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 38.31168831168831%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAWUlEQVQY053Ruw3AIAwEUPbfhwXYg4IiqYJSGvyNkbKAfbr26WS5cDaIVCwbogRWPQ1jEQP4fRi76d3GcJfCntas1oMRwzeTynPd75zoy8wSqg/C3mttf9UHBZvaM7Hr3loAAAAASUVORK5CYII=\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="2020 01 14 17 56 25" title="" data-src="/static/2020-01-14-17-56-25-1c3f3a477e726fad44623346a0a19cb0-8d9bd.png" data-srcset="/static/2020-01-14-17-56-25-1c3f3a477e726fad44623346a0a19cb0-b87a4.png 200w,\n/static/2020-01-14-17-56-25-1c3f3a477e726fad44623346a0a19cb0-8d9bd.png 308w" data-sizes="(max-width: 308px) 100vw, 308px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>然而这种设计对我们的布局实现带来的挑战。</p>\n<p>我们通常想到的方法是，计数元素浮在下面的 textarea 元素上。然而这种实现存在有致命的不足，那就是输入框的内容有可能和我们的计数重叠，以及出现的滚动条和技术文本重叠，如下截图所示：</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/2020-01-14-17-57-04-4b28019909c21908c59f29c2f172d815-35f12.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 311px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 38.90675241157556%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAwUlEQVQY05VRyw6CQAzc//8ZvahfoAka1AO+g+GR6LILgspjF7pdeXhGbObQTJvOtCVhATyTsVT/QcD9lROeVzJPUQ+MbyOisq82YZnknGFLD0ITGgCW5poE7+JyOirs1e6qlGrf73KlwNxsyS1JV4ZRM4gDvAeBPp+14ygpGmWWip1l0Zqt57UDftnWOBrDfu9x3uxsLOaz6SSJH61B/HkwARAy6no+YXl58O6GdbJp9CiRF1UooA/1a1PBstKNnh+MN86Q8oHDwwAAAABJRU5ErkJggg==\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="2020 01 14 17 57 04" title="" data-src="/static/2020-01-14-17-57-04-4b28019909c21908c59f29c2f172d815-35f12.png" data-srcset="/static/2020-01-14-17-57-04-4b28019909c21908c59f29c2f172d815-5e330.png 200w,\n/static/2020-01-14-17-57-04-4b28019909c21908c59f29c2f172d815-35f12.png 311w" data-sizes="(max-width: 311px) 100vw, 311px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>因此，我们通常做法就是：边框使用父级<code class="language-text">&lt;div&gt;</code>元素模拟，文本域元素和技术元素上下依次排列（非重叠），文本域原本的边框去除。</p>\n<p>假设 HTML 如下：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="74196165934295580000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`<div class=&quot;textarea-x&quot;>\n  <textarea></textarea>\n  <label class=&quot;textarea-count&quot;>0/250</label>\n</div>`, `74196165934295580000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="html"\n              >\n                <span class="gatsby-code-button-language">html</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="html"><pre style="counter-reset: linenumber NaN" class="language-html line-numbers"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>textarea-x<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>textarea</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>textarea</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>textarea-count<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>0/250<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>则核心 CSS 这样：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="19070744197106970000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`/* 父级div元素模拟边框 */\n.textarea-x {\n  border: 1px solid #d0d0d5;\n  border-radius: 4px;\n  background-color: #fff;\n}\n\n/* 文本域原本的边框去除 */\n.textarea-x > textarea {\n  border: 0;\n  background: none;\n}`, `19070744197106970000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="css"\n              >\n                <span class="gatsby-code-button-language">css</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="css"><pre style="counter-reset: linenumber NaN" class="language-css line-numbers"><code class="language-css"><span class="token comment">/* 父级div元素模拟边框 */</span>\n<span class="token selector">.textarea-x</span> <span class="token punctuation">{</span>\n  <span class="token property">border</span><span class="token punctuation">:</span> 1px solid #d0d0d5<span class="token punctuation">;</span>\n  <span class="token property">border-radius</span><span class="token punctuation">:</span> 4px<span class="token punctuation">;</span>\n  <span class="token property">background-color</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">/* 文本域原本的边框去除 */</span>\n<span class="token selector">.textarea-x > textarea</span> <span class="token punctuation">{</span>\n  <span class="token property">border</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n  <span class="token property">background</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>然而上面的实现有个非常严重的不足，那就是<code class="language-text">&lt;textarea&gt;</code>元素 :focus 时候，边框无法高亮，因为 CSS 中没有父选择器！</p>\n<p>因此，实际开发的时候，我们会使用相邻兄弟选择器，以及新建一个兄弟元素来模拟边框。</p>\n<p>HTML 结构如下：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="79478997217138540000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`<div class=&quot;textarea-x&quot;>\n  <textarea></textarea>\n  <div class=&quot;textarea&quot;></div>\n  <label class=&quot;textarea-count&quot;>0/250</label>\n</div>`, `79478997217138540000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="html"\n              >\n                <span class="gatsby-code-button-language">html</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="html"><pre style="counter-reset: linenumber NaN" class="language-html line-numbers"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>textarea-x<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>textarea</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>textarea</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>textarea<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>textarea-count<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>0/250<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>原理如下图示意：</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/2020-01-14-18-00-12-671927e81f8b47a8aaf176a238ad68e5-dab2c.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 397px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 44.58438287153652%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABfElEQVQoz3WRb2+bMBDG8/2/Sd9EqtRNVaImI1WjNoBGUjXbmn8ERAOkYBtjOxjsm900bzb1bD0+2f49utP1lFLdV9G2nRA2aZpOyo4xq+dLzqWUPfME/4fWVqsKPA+urmA0gpsbWK/h9hb6fXAceHtjlH7C58//whjDYmEB34fpFLZbGI+tV1FAmnIDy0Yec32SgElb8Y4pVpwQbjDVNS8ztdnoNNOTe3BdC+92sFrB4QBhyDm3MKW6Kk6bF7Zf8yQm0T7ZhyjakWhr3FsQFAIfCNG2IA0XZYz1WnMSVPYHybfn49CNrmfHu2kyHMWD8e77oJxM0fWPfLBoH5+gLG0vShn8AisNJ0G95eswyv3w3f+zf/h1fAniwInm98n8MXteRN4MBUEexYcsxUjEoWkZaF2bspssl2kBstNnz+5D1WW3WgklzcRqVhNCKK2rSnDRIox7QghUIlxighFBiGBcYfypCJl5/F4uJ47ju65vwjPLpLNg/nO1ev0LPRfyyEwe0H0AAAAASUVORK5CYII=\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="2020 01 14 18 00 12" title="" data-src="/static/2020-01-14-18-00-12-671927e81f8b47a8aaf176a238ad68e5-dab2c.png" data-srcset="/static/2020-01-14-18-00-12-671927e81f8b47a8aaf176a238ad68e5-06022.png 200w,\n/static/2020-01-14-18-00-12-671927e81f8b47a8aaf176a238ad68e5-dab2c.png 397w" data-sizes="(max-width: 397px) 100vw, 397px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="84863801786656230000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`.textarea-x {\n  position: relative;\n  z-index: 0;\n}\n\n.textarea-x > textarea {\n  border: 0;\n  background: none;\n  outline: 0;\n  resize: none;\n  position: relative;\n}\n\n.textarea-x > .textarea {\n  position: absolute;\n  border: 1px solid #d0d0d5;\n  border-radius: 4px;\n  background-color: #fff;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  z-index: -1;\n}\n\n.textarea-x > :focus + .textarea {\n  border-color: #00a5e0;\n}`, `84863801786656230000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="css"\n              >\n                <span class="gatsby-code-button-language">css</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="css"><pre style="counter-reset: linenumber NaN" class="language-css line-numbers"><code class="language-css"><span class="token selector">.textarea-x</span> <span class="token punctuation">{</span>\n  <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>\n  <span class="token property">z-index</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token selector">.textarea-x > textarea</span> <span class="token punctuation">{</span>\n  <span class="token property">border</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n  <span class="token property">background</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>\n  <span class="token property">outline</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n  <span class="token property">resize</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>\n  <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token selector">.textarea-x > .textarea</span> <span class="token punctuation">{</span>\n  <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>\n  <span class="token property">border</span><span class="token punctuation">:</span> 1px solid #d0d0d5<span class="token punctuation">;</span>\n  <span class="token property">border-radius</span><span class="token punctuation">:</span> 4px<span class="token punctuation">;</span>\n  <span class="token property">background-color</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>\n  <span class="token property">top</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n  <span class="token property">bottom</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n  <span class="token property">left</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n  <span class="token property">right</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n  <span class="token property">z-index</span><span class="token punctuation">:</span> -1<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token selector">.textarea-x > :focus + .textarea</span> <span class="token punctuation">{</span>\n  <span class="token property">border-color</span><span class="token punctuation">:</span> #00a5e0<span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>由于.textarea 元素和原生的<code class="language-text">&lt;textarea&gt;</code>元素是相邻兄弟关系，因此我们可以借助相邻兄弟选择器，让<code class="language-text">&lt;textarea&gt;</code>元素 focus 时候后面用来模拟边框的 .textarea 元素高亮。也就是这么一段 CSS 代码：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="26598295305294540000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`.textarea-x > :focus + .textarea {\n  border-color: #00a5e0;\n}`, `26598295305294540000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="css"\n              >\n                <span class="gatsby-code-button-language">css</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="css"><pre style="counter-reset: linenumber NaN" class="language-css line-numbers"><code class="language-css"><span class="token selector">.textarea-x > :focus + .textarea</span> <span class="token punctuation">{</span>\n  <span class="token property">border-color</span><span class="token punctuation">:</span> #00a5e0<span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<p>这种实现兼容 IE7+ 浏览器。</p>\n<div>\n          <div\n            class="gatsby-resp-iframe-wrapper"\n            style="padding-bottom: 25%; position: relative; height: 0; overflow: hidden;margin-bottom: 2em"\n          >\n            <iframe src="/examples/css-focus-within-pseudo-class-selector/focus-textarea-border-highlight-compatible.html" style="\n            position: absolute;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n          "></iframe>\n          </div>\n          </div>\n<p><div class="gatsby-highlight">\n        <pre class="language-html"><code><span class="token doctype">&lt;!DOCTYPE html></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1.0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>X-UA-Compatible<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ie=edge<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Document<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css">\n    <span class="token selector">html,\n    body</span> <span class="token punctuation">{</span>\n      <span class="token property">background-color</span><span class="token punctuation">:</span> white<span class="token punctuation">;</span>\n      <span class="token property">margin</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token selector">.textarea-x</span> <span class="token punctuation">{</span>\n      <span class="token property">max-width</span><span class="token punctuation">:</span> 300px<span class="token punctuation">;</span>\n      <span class="token property">padding</span><span class="token punctuation">:</span> 1px 1px 24px 0<span class="token punctuation">;</span>\n      <span class="token property">border-radius</span><span class="token punctuation">:</span> 4px<span class="token punctuation">;</span>\n      <span class="token property">-ms-box-sizing</span><span class="token punctuation">:</span> border-box<span class="token punctuation">;</span>\n      <span class="token property">box-sizing</span><span class="token punctuation">:</span> border-box<span class="token punctuation">;</span>\n      <span class="token property">overflow</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span>\n      <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>\n      <span class="token property">z-index</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token selector">.textarea-count</span> <span class="token punctuation">{</span>\n      <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>\n      <span class="token property">font-size</span><span class="token punctuation">:</span> 12px<span class="token punctuation">;</span>\n      <span class="token property">line-height</span><span class="token punctuation">:</span> 16px<span class="token punctuation">;</span>\n      <span class="token property">bottom</span><span class="token punctuation">:</span> 5px<span class="token punctuation">;</span> <span class="token property">right</span><span class="token punctuation">:</span> 10px<span class="token punctuation">;</span>\n      <span class="token property">color</span><span class="token punctuation">:</span> #999<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token selector">.textarea-x > textarea</span> <span class="token punctuation">{</span>\n      <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span>\n      <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>\n      <span class="token property">padding</span><span class="token punctuation">:</span> 7px 9px<span class="token punctuation">;</span>\n      <span class="token property">border</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n      <span class="token property">background</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>\n      <span class="token property">-ms-box-sizing</span><span class="token punctuation">:</span> border-box<span class="token punctuation">;</span>\n      <span class="token property">box-sizing</span><span class="token punctuation">:</span> border-box<span class="token punctuation">;</span>\n      <span class="token property">outline</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n      <span class="token property">resize</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>\n      <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token selector">.textarea-x > .textarea</span> <span class="token punctuation">{</span>\n      <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>\n      <span class="token property">border</span><span class="token punctuation">:</span> 1px solid #d0d0d5<span class="token punctuation">;</span>\n      <span class="token property">border-radius</span><span class="token punctuation">:</span> 4px<span class="token punctuation">;</span>\n      <span class="token property">background-color</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>\n      <span class="token property">top</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n      <span class="token property">bottom</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n      <span class="token property">left</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n      <span class="token property">right</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n      <span class="token property">transition</span><span class="token punctuation">:</span> border-color .2s<span class="token punctuation">;</span>\n      <span class="token property">z-index</span><span class="token punctuation">:</span> -1<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token selector">.textarea-x > :focus + .textarea</span> <span class="token punctuation">{</span>\n      <span class="token property">border-color</span><span class="token punctuation">:</span> #00a5e0<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>textarea-x<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>textarea</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>forFocus<span class="token punctuation">"</span></span> <span class="token attr-name">maxlength</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>250<span class="token punctuation">"</span></span> <span class="token attr-name">rows</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>5<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>textarea</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>textarea<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>forFocus<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>textarea-count<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>0/250<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre>\n        </div></p>\n<p>但是，现在有了 CSS :focus-within 伪类选择器，我们的事情就简单多了。</p>\n<div>\n          <div\n            class="gatsby-resp-iframe-wrapper"\n            style="padding-bottom: 25%; position: relative; height: 0; overflow: hidden;margin-bottom: 2em"\n          >\n            <iframe src="/examples/css-focus-within-pseudo-class-selector/focus-within-textarea-highlight.html" style="\n            position: absolute;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n          "></iframe>\n          </div>\n          </div>\n<p><div class="gatsby-highlight">\n        <pre class="language-html"><code><span class="token doctype">&lt;!DOCTYPE html></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1.0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>X-UA-Compatible<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ie=edge<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Document<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css">\n    <span class="token selector">html,\n    body</span> <span class="token punctuation">{</span>\n      <span class="token property">background-color</span><span class="token punctuation">:</span> white<span class="token punctuation">;</span>\n      <span class="token property">margin</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token selector">.textarea-x</span> <span class="token punctuation">{</span>\n      <span class="token property">max-width</span><span class="token punctuation">:</span> 298px<span class="token punctuation">;</span>\n      <span class="token property">border</span><span class="token punctuation">:</span> 1px solid #d0d0d5<span class="token punctuation">;</span>\n      <span class="token property">border-radius</span><span class="token punctuation">:</span> 4px<span class="token punctuation">;</span>\n      <span class="token property">background-color</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>\n      <span class="token property">padding-bottom</span><span class="token punctuation">:</span> 24px<span class="token punctuation">;</span>\n      <span class="token property">transition</span><span class="token punctuation">:</span> border-color .2s<span class="token punctuation">;</span>\n      <span class="token property">overflow</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span>\n      <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token selector">.textarea-count</span> <span class="token punctuation">{</span>\n      <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>\n      <span class="token property">font-size</span><span class="token punctuation">:</span> 12px<span class="token punctuation">;</span>\n      <span class="token property">line-height</span><span class="token punctuation">:</span> 16px<span class="token punctuation">;</span>\n      <span class="token property">bottom</span><span class="token punctuation">:</span> 5px<span class="token punctuation">;</span> <span class="token property">right</span><span class="token punctuation">:</span> 10px<span class="token punctuation">;</span>\n      <span class="token property">color</span><span class="token punctuation">:</span> #999<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token selector">.textarea-x > textarea</span> <span class="token punctuation">{</span>\n      <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span>\n      <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>\n      <span class="token property">padding</span><span class="token punctuation">:</span> 7px 9px<span class="token punctuation">;</span>\n      <span class="token property">border</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n      <span class="token property">background</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>\n      <span class="token property">-ms-box-sizing</span><span class="token punctuation">:</span> border-box<span class="token punctuation">;</span>\n      <span class="token property">box-sizing</span><span class="token punctuation">:</span> border-box<span class="token punctuation">;</span>\n      <span class="token property">outline</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n      <span class="token property">resize</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token selector">.textarea-x:focus-within</span> <span class="token punctuation">{</span>\n      <span class="token property">border-color</span><span class="token punctuation">:</span> #00a5e0<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>textarea-x<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>textarea</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>forFocus<span class="token punctuation">"</span></span> <span class="token attr-name">maxlength</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>250<span class="token punctuation">"</span></span> <span class="token attr-name">rows</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>5<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>textarea</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>forFocus<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>textarea-count<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>0/250<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre>\n        </div></p>\n<h1 id="更多场景"><a href="#%E6%9B%B4%E5%A4%9A%E5%9C%BA%E6%99%AF" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>更多场景</h1>\n<p>:focus-within 伪类原本设计的作用是原生表单元素 focus 时候，祖先<code class="language-text">&lt;form&gt;</code>元素可以也有状态变化。</p>\n<p>但是在我看来，:focus-within 功能之强悍，远远不是仅仅和祖先<code class="language-text">&lt;form&gt;</code>元素玩过家家这么简单。</p>\n<p>理论上，只要页面上任意一个元素 focus，通过:focus-within 就能对页面上任意的元素进行样式控制。</p>\n<p>例如：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="39956653139003200000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`html:focus-within xxx {\n}`, `39956653139003200000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="css"\n              >\n                <span class="gatsby-code-button-language">css</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="css"><pre style="counter-reset: linenumber NaN" class="language-css line-numbers"><code class="language-css"><span class="token selector">html:focus-within xxx</span> <span class="token punctuation">{</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>\n<ol>\n<li>\n<p>相邻选择器，加号，或者弯弯都只能选择后面的元素，但是有了:focus-within，我们就可以对前面元素进行控制，虽然只能在:focus 行为场景下。例如请重复输入密码时候，让上面的输入密码框也高亮。</p>\n</li>\n<li>\n<p>基于纯 CSS 和 focus 行为实现下拉列表的交互成为了可能。只要把按钮和下拉元素放在一个容器中，就可以了。</p>\n<div>\n          <div\n            class="gatsby-resp-iframe-wrapper"\n            style="padding-bottom: 25%; position: relative; height: 0; overflow: hidden;margin-bottom: 2em"\n          >\n            <iframe src="/examples/css-focus-within-pseudo-class-selector/focus-within-pure-css-droplist.html" style="\n            position: absolute;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n          "></iframe>\n          </div>\n          </div>\n<p><div class="gatsby-highlight">\n        <pre class="language-html"><code><span class="token doctype">&lt;!DOCTYPE html></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1.0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>X-UA-Compatible<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ie=edge<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Document<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css">\n    <span class="token selector">html,\n    body</span> <span class="token punctuation">{</span>\n      <span class="token property">background-color</span><span class="token punctuation">:</span> white<span class="token punctuation">;</span>\n      <span class="token property">margin</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token selector">.bar</span> <span class="token punctuation">{</span>\n      <span class="token property">background-color</span><span class="token punctuation">:</span> #e3e4e5<span class="token punctuation">;</span>\n      <span class="token property">color</span><span class="token punctuation">:</span> #888<span class="token punctuation">;</span>\n      <span class="token property">padding-left</span><span class="token punctuation">:</span> 40px<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token selector">.summary</span> <span class="token punctuation">{</span>\n      <span class="token property">display</span><span class="token punctuation">:</span> inline-block<span class="token punctuation">;</span>\n      <span class="token property">padding</span><span class="token punctuation">:</span> 5px 28px<span class="token punctuation">;</span>\n      <span class="token property">text-indent</span><span class="token punctuation">:</span> -15px<span class="token punctuation">;</span>\n      <span class="token property">-webkit-user-select</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>\n      <span class="token property">-moz-user-select</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>\n      <span class="token property">-ms-user-select</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>\n      <span class="token property">user-select</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>\n      <span class="token property">outline</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n      <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>\n      <span class="token property">z-index</span><span class="token punctuation">:</span> 1<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token selector">.summary::after</span> <span class="token punctuation">{</span>\n      <span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">\'\'</span><span class="token punctuation">;</span>\n      <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>\n      <span class="token property">width</span><span class="token punctuation">:</span> 12px<span class="token punctuation">;</span> <span class="token property">height</span><span class="token punctuation">:</span> 12px<span class="token punctuation">;</span>\n      <span class="token property">margin</span><span class="token punctuation">:</span> 4px 0 0 .5ch<span class="token punctuation">;</span>\n      <span class="token property">background</span><span class="token punctuation">:</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span>./arrow-on.svg<span class="token punctuation">)</span></span> no-repeat<span class="token punctuation">;</span>\n      <span class="token property">background-size</span><span class="token punctuation">:</span> 100% 100%<span class="token punctuation">;</span>\n      <span class="token property">transition</span><span class="token punctuation">:</span> transform .2s<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token selector">.details:focus-within .summary,\n    .summary:hover</span> <span class="token punctuation">{</span>\n      <span class="token property">background-color</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>\n      <span class="token property">box-shadow</span><span class="token punctuation">:</span> inset 1px 0 #ddd<span class="token punctuation">,</span> inset -1px 0 #ddd<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token selector">.details:focus-within .summary::after</span> <span class="token punctuation">{</span>\n      <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">rotate</span><span class="token punctuation">(</span>180deg<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token selector">.box</span> <span class="token punctuation">{</span>\n      <span class="token property">display</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>\n      <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>\n      <span class="token property">border</span><span class="token punctuation">:</span> 1px solid #ddd<span class="token punctuation">;</span>\n      <span class="token property">background-color</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>\n      <span class="token property">min-width</span><span class="token punctuation">:</span> 100px<span class="token punctuation">;</span>\n      <span class="token property">padding</span><span class="token punctuation">:</span> 5px 0<span class="token punctuation">;</span>\n      <span class="token property">margin-top</span><span class="token punctuation">:</span> -1px<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token selector">.details:focus-within .box</span> <span class="token punctuation">{</span>\n      <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token selector">.box a</span> <span class="token punctuation">{</span>\n      <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span>\n      <span class="token property">padding</span><span class="token punctuation">:</span> 5px 10px<span class="token punctuation">;</span>\n      <span class="token property">transition</span><span class="token punctuation">:</span> background-color .2s<span class="token punctuation">,</span> color .2s<span class="token punctuation">;</span>\n      <span class="token property">color</span><span class="token punctuation">:</span> inherit<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token selector">.box a:hover</span> <span class="token punctuation">{</span>\n      <span class="token property">background-color</span><span class="token punctuation">:</span> #f5f5f5<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token selector">.box a:active</span> <span class="token punctuation">{</span>\n      <span class="token property">background-color</span><span class="token punctuation">:</span> #f0f0f0<span class="token punctuation">;</span>\n      <span class="token property">color</span><span class="token punctuation">:</span> #555<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token selector">.box sup</span> <span class="token punctuation">{</span>\n      <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>\n      <span class="token property">color</span><span class="token punctuation">:</span> #cd0000<span class="token punctuation">;</span>\n      <span class="token property">font-size</span><span class="token punctuation">:</span> 12px<span class="token punctuation">;</span>\n      <span class="token property">margin-top</span><span class="token punctuation">:</span> -.25em<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token selector">a</span> <span class="token punctuation">{</span>\n      <span class="token property">color</span><span class="token punctuation">:</span> inherit<span class="token punctuation">;</span>\n      <span class="token property">text-decoration</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>bar<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>details<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>javascript:<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>summary<span class="token punctuation">"</span></span> <span class="token attr-name">tabindex</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>我的消息<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>box<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>javascript:<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>我的回答<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>sup</span><span class="token punctuation">></span></span>12<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>sup</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>javascript:<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>我的私信<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>javascript:<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>未评价订单<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>sup</span><span class="token punctuation">></span></span>2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>sup</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>javascript:<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>我的关注<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>这里放一段文字表明上面的是悬浮效果。<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre>\n        </div></p>\n</li>\n</ol>',
id:"/home/runner/work/GatsbyBlog/GatsbyBlog/blog/focus-within伪类及其交互应用/index.md absPath of file >>> MarkdownRemark",timeToRead:10,frontmatter:{date:"2020-01-14 17:34:53",path:"/css-focus-within-pseudo-class-selector/",tags:"前端, CSS, CSS知识点",title:"focus-within伪类及其交互应用",draft:null}},{excerpt:"填充的两种规则 只要是路径填充，都有两种规则 nonzero 和 evenodd，无论是 SVG 中的路径填充，还是 Canvas 中的路径填充，如果还有其他和路径相关的技术（甚至设计软件），也离不开这两种填充规则。 如果我们用 3 个点，连成一个三角形，则这两种填充规则没什么区别，如下对比 如果是两个三角形，并且发生重叠，差异就出现了，如下： 交叉点 填充规则的关键，就是确定复杂路径构成的图形，哪些是内部，哪些是外部。内部则填充，外部则透明。 “nonzero…",html:'<h1 id="填充的两种规则"><a href="#%E5%A1%AB%E5%85%85%E7%9A%84%E4%B8%A4%E7%A7%8D%E8%A7%84%E5%88%99" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>填充的两种规则</h1>\n<p>只要是路径填充，都有两种规则 nonzero 和 evenodd，无论是 SVG 中的路径填充，还是 Canvas 中的路径填充，如果还有其他和路径相关的技术（甚至设计软件），也离不开这两种填充规则。</p>\n<p>如果我们用 3 个点，连成一个三角形，则这两种填充规则没什么区别，如下对比</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/2020-01-14-16-50-54-35859b174e37486b6182a84d7b47d68c-83562.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 315px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 60%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAB6klEQVQoz11Sz2sTQRQeUHtRpIhgxVvvnvxDip70kgjVmhK9iBehZ68iggqivYgK4sWLVLS2TZNNsNaWhDbtpho0RRvjdt3N7s7PXb+ZKbE6PIb33ve+mfe+GUK5SpiKEt6PGfYwop4f9mOOZGwsYbZARLFGUaMhqphQ5FfAvN+0vv7FqS1/XG2uNtzXb2ZXGq2ez7pesuMlPZ/C6mut6lK9Ul1x2z92Q4H8bshJRKUQCka5wPFohIuU6R0XyhioVDA4ERWUSeRhKIiZJKjOsozLNNu3bCBVKlQKH3v270KMOwimQvDM6Y7dbtyZ6bxf938GPDXFQqbgK5VOPNqcnHaflHca3/oRk0BhDOTEkLc9drxQIefnjlwqnyxWc/eblmbRuzMdcvbd0MXSsSuV0eu1504XSUC6bdNaNvWifTC/MHLVIRfmbzzdQobp8TQUJPL0zaWjl8vDE5XD44uf2qEmc0O2A218j08UHWAjRedzN7FC2M7h33r19UBu4VC+lHvQtHLotq1gtqIw7ZJzs4XHm/DRjhZM2vGzjkdPXauCPLfm/09Whuy0gqF8yXGD/eTB0eMPN85MLVup9wSzZHs+xrj3dttm9p7KkK0ota3g5YeeDf+qDVUGBmDg2587CKWZn/HU/CKN/gEUGX+aTEBDDAAAAABJRU5ErkJggg==\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="2020 01 14 16 50 54" title="" data-src="/static/2020-01-14-16-50-54-35859b174e37486b6182a84d7b47d68c-83562.png" data-srcset="/static/2020-01-14-16-50-54-35859b174e37486b6182a84d7b47d68c-738c0.png 200w,\n/static/2020-01-14-16-50-54-35859b174e37486b6182a84d7b47d68c-83562.png 315w" data-sizes="(max-width: 315px) 100vw, 315px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>如果是两个三角形，并且发生重叠，差异就出现了，如下：</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/2020-01-14-16-51-17-9efb57f0c5d5c20e0d6945d1dbeba3e5-83562.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 315px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 57.77777777777777%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACM0lEQVQoz01RS2sTURQeVyqiVRQX3bpQ8B+4cSt0J6KiCEVtfaAbkerWhRt1IfWxETSCUIqbUroQgxrzbkzENI8xbSaTpIYmM8kkmUzmfe/43ZlSCndx5nuc850z3GBkN1typbpZEf7VN6VMrlBeb0i9MfDuwOyrFgpZ0fiN5nqtBUpWdCDK0NIMlxtqTrW+lS9VG/Vmpy3l8nyJr3W6GhSSwsx91ZZ6o5ogimJjjRflPjOzpmOHs11KKPU8b7Wmh4tDFA71HEIth45NwljQ1EsJ4x+8Cta0ie1QCMBy+M43RhfnSxMzidOPsqruML9LoUAw1HXZmFuo7Z2OnXyYUXWGuC6FYNscrwz2TceO301NzCYfL4r5pqZojkvoyJemNtT3kbbQMd5931rKdn8JKloQ4jEzJkBx9S2//3p88n76wI340dvJjMASwowWGHLlzd9woQ/kW7F/7E6y0NQYi4NZvjlcUA7NJCbvpQ/PJi69KnvUs/2dsSHYxbR88GYiUh6g/hTv6BYhwc6OvwBOcu5ZAU7Mn3pRhCg4WMDinXny58it5MrvXii2y4xgQfuFlLTnWvTs0/z5l+XlXC+IDVvAhqId7nJk6nnxwnz5y5oSsJzrHxadDJucmsu+/trCzA8/2wB1fzIK5Brq7okHmVC0rZnux2gbCJuMv4jhtsvaL+W6omSg0EyCXoZFQAU3A/h5VW50TRSq4VoOQXgOip2HFJa9fSfTIgi2QyHFLpbtAuQ/XmxzBsERsl0AAAAASUVORK5CYII=\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="2020 01 14 16 51 17" title="" data-src="/static/2020-01-14-16-51-17-9efb57f0c5d5c20e0d6945d1dbeba3e5-83562.png" data-srcset="/static/2020-01-14-16-51-17-9efb57f0c5d5c20e0d6945d1dbeba3e5-738c0.png 200w,\n/static/2020-01-14-16-51-17-9efb57f0c5d5c20e0d6945d1dbeba3e5-83562.png 315w" data-sizes="(max-width: 315px) 100vw, 315px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<h1 id="交叉点"><a href="#%E4%BA%A4%E5%8F%89%E7%82%B9" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>交叉点</h1>\n<p>填充规则的关键，就是确定复杂路径构成的图形，哪些是内部，哪些是外部。内部则填充，外部则透明。</p>\n<p>“nonzero 规则”顾名思意就是“非零规则”，用通俗的话讲，就算计算某些东西是不是 0，如果不是 0 则内部，填充；如果是 0 则外部，不填充。</p>\n<p>“evenodd 规则”顾名思意就是“奇偶规则”，用通俗的话讲，就算计算某些东西是不是奇数，如果是是奇数则内部，填充；如果是偶数则外部，不填充。</p>\n<p>nonzero 规则和 evenodd 规则计算的东西还不一样，nonzero 是计算顺时针逆时针数量，evenodd 是交叉路径数量。</p>\n<h2 id="nonzero-规则"><a href="#nonzero-%E8%A7%84%E5%88%99" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>nonzero 规则</h2>\n<p>起始值为 0，射线会和路径相交，如果路径方向和射线方向形成的是顺时针方向则+1，如果是逆时针方向则-1，最后如果数值为 0，则是路径的外部；如果不是 0，则是路径的内部，因此被称为“非 0 规则”。</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/2020-01-14-16-52-41-afec2753728bcf73debade1bc38f65e6-ba5d6.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 254px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 107.08661417322833%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAIAAADJt1n/AAAACXBIWXMAAA7DAAAOwwHHb6hkAAADrUlEQVQ4y21Ta0wTWRQeE2PCoq6VipaXGP8YMaa+wyo+osZsfCBYBLUVKXRKaUClrtFUo0bdCroRBF8IKioSiTxLsaFU6LRUwMeKQFWyWaRURYrYDlPp4MzcnemAYaEnk3tv7jnf/c453xkIAEASJD5M/KBPL1+TqLNfean18EU3QYBRoygKeDMIkCQgGR/VY/tni1iRUsSPe8zffu+N1khf9litDofD5XK53W5vYABcfQOa+6YoeVWgSOsrRrgp5imJz06fKHXZbXn5BTU1NR0dHVardWIKEMgtuPjbodDYinlCDU9q4MEGP5k5SKzfEZ3fpjdbOju/2vtpQ1GUBbPGniGQmXNmYeLihOql+8rXxBRFxDwIE1VFRt44EH4mQ6UGOEqNMo4r3AMGIEtVw992Nxhu8Etu5EkaFoiq+XvLwncVCbdlP80r7X3XAxzfwKCTGhpyDg6+tVgQBLHb7TabjQH3NFsWxT7eICgMFev8JKaZR1umZbZx0pp4clPEalVYTPF2RX3JVmX3qWyUGDYixsrKyq6urvb2dogRZPj7EaXmV1HdFsGdufG1nJMvuX+99rvcOv1C27LD6tkHqyalGqf8nl9w/hbuHED77JjLRZIkhmEQvdHwDu1z/71P6Mw3Rd8OEddxJSb/JIQrNQWmIpFxecLdlzYdfZT9rj2dJOs+99L9x3Hc022KYtAuNCW9YjLcHCypp/HBifoAuIGuYqqsRbD1ambIHt0tPR31gSAdADDMnhGC2AmjV6S0KSyyaIFYG5SoD48tvsyHkzaqfNJehcRr5YIc7GMf02F6nMY0HfopvduB3dmsiF93fmrqi8Ck+kMRJ9bvuseRt/ySYPwTvglwjADj5YLYja28JbdsflTJ7BTzLKlpDmxYLyj0lxqjdt44tiLd0tzpCfMGHiG39a5NqpoONwbABhofKq5dFVusWPlH1LoM5dlaAHBi4myzRnhevXtF5yvUByQbeRLDDKl5aUJ1HpzLETcs2q8eaH0/UvZEMHv7zfLvElEFJ9kcJDX4JCBShRoMoYU5ukk71NeydHQUQXljZsgZB5lxTuMjqg+UN3LjnjSVP2Mcw0M3s+qWRz/EPnwaS/4/MOVpW3ezZaFQ7Stp3C0rB1/7KaZWWqEf11XVJRfKmOcpb8wMObPgx09qoH2I9r5hpBcU89Gubtkp8LDME0d4AbOa/a1vlS05Qrx5+zOdET2cKPj0BYwKPh7M3hLoIJamBJ97wdjBoMb/0v8B6h7Hd9RZc8YAAAAASUVORK5CYII=\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="2020 01 14 16 52 41" title="" data-src="/static/2020-01-14-16-52-41-afec2753728bcf73debade1bc38f65e6-ba5d6.png" data-srcset="/static/2020-01-14-16-52-41-afec2753728bcf73debade1bc38f65e6-e9711.png 200w,\n/static/2020-01-14-16-52-41-afec2753728bcf73debade1bc38f65e6-ba5d6.png 254w" data-sizes="(max-width: 254px) 100vw, 254px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>例如上图点 A，我们随便发出一条射线，结果经过了路径 5 和路径 2，我们顺着路径前进方向和射线前进方向，可以看到，合并后的运动方向都是逆时针，逆时针方向-1，因此，最后计算值是-2，不是 0，因此，是内部，fill 时候可以被填充。</p>\n<p>再看外部的例子：</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/2020-01-14-16-53-41-4f04a6e37e9d514add8c3a332a05db7a-092d7.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 211px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 129.38388625592415%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAaCAIAAAA44esqAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAEtElEQVQ4y3VUa0xTZxg+yy5xonJHIEZki7qBiNkcExwbCAJDJncsLaUdll6oLG5LNoewS5YFA0jEH4BcCnKRIdIC5VZKobSlpUOiGWPA0KRMYeMiYEFaey7fvp4KlmR8OT05X8953ud9n/f5XgRsLAIA3PicUAzhcHO1+K/jscujD8z/4zjYZiEAw1ETZsLIL7p69UdDC/MkcTE3DodVlV1pBwDDCLA92PJu+cl46+B3vNqPoyp2pvbvydC+eWHkFO1XdHyKJP//AAg+O9cr6E1Jb3SidL7C1tpkjrhxFG7p8n1cxet0ubCoE36EbQcmoigltiE+SU0ByY0fUO8cTu1wYStcOEr7jKHE04U0igB7NANLIjBsQxvCKu3Ckvz3eQdTxJ7Mbr9zjScT68NiKoLjq31oLVeP870jb0qqZBZyCMLMWAJsSIjA3438zoCwYl9GG6zTha2El2dajy9NFJRYGxgtyEkoWOgdMuoeAdRgJkZRK2YAno6M+VBFIbGC96h37Hka1/QBZ44KPthzNQ4ZmrfpHdHB+f7pHfyLzbWFHc8iqLhUYYbiOGKOQxgLsoWvMZVnYsuPUYV2PI0bWw5DuKUPwLsDTxOSULOP0fMqS2PD6A/yy50sbzFjMRyxtGGm7+4hisiOrw2PKfOlCc387IG9bAW8O3IHj6S0hsZXH+DKoZaxGW1gcZEgi4d9Jsw6Gtayvmx8I03lylWFx5RDvB2ZP0TCEM5sZWBCbY03Ld7/56YKOdiwDkImb1YPmmQ/RWzP1zpxVOHRZUdpIjve0DupHe6sfgeu2psuvubNvBT646pudtM2iKV1OGmyNO5tz2TxAZbMkTMYEic4HVvZ7vGpH+W2PU/tzlWGhhTV5wrJtlmpvUkua1DlHqR/HlFgwx+G+ITIoop3qdA2MPM9mcMfRgnWuvvNXBi+BWzxDT63UBOU+VF0lSNvEEoFCU/FVcL8bXlDnixZsv9PrXnNJBOxFbxhYHFx90663P2Cdi9b6cxWOPB/izxbeojZFZxU37w/Moxaj+qmt9Zs4Sb3pindJ/Glu2hC1/Q+V67aid7mwlEFxJTRT1y+fDILHh5JWc8mE2LtdZSsnM/4GvFiOp297njulsNn1x3PS90T6oScgiMsCcLS0tIawPw8QaIQ2GQTAM8tspFHR1pz663AbDtaswuj3TmpekeyMIFaDnvxR4vSiyKySe65Wyd74bB/jMbc4WHeykqkyQTPrg7HaxpqUxkFu6hi91SJ63n57jO10uJOS2oTwgGPRFFaZjN4ugR5EMP6urS9fXx6unNp6d7i4uDjma7lJyLlsMe3UtvvB3Z8IznBaliY0q0AsIqaCx1tVR+LqLwn1r4UzGQyzTx8OHb/vmFtbWJsbHVqPOuSaPcXWge+8kqVXAdAHQHgQLuJE/AgqZsGSxJ/AWN/IgSpll6vF1RV1dXVzczOSmV9euOaurLFKaXXi9mlH/rdYqN5ACSQn9RlLScPu5jzAry+vq5QKEZHRw0Gw+TE5LoJXXow8RW1tCLmBzgD0E0XbQxpwoSCf+et+gwdDr1DLridMz6bzs5DabyXY916EVtNYh3FrAKGLTz+G6Cm7cc2+A/dCmuvl3FC8AAAAABJRU5ErkJggg==\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="2020 01 14 16 53 41" title="" data-src="/static/2020-01-14-16-53-41-4f04a6e37e9d514add8c3a332a05db7a-092d7.png" data-srcset="/static/2020-01-14-16-53-41-4f04a6e37e9d514add8c3a332a05db7a-6cb69.png 200w,\n/static/2020-01-14-16-53-41-4f04a6e37e9d514add8c3a332a05db7a-092d7.png 211w" data-sizes="(max-width: 211px) 100vw, 211px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>点 B 再发出一条射线，经过两条路径片段，为路径 2 和路径 3，我们顺着路径前进方向和射线前进方向，可以看到，合并后的运动方向一个是逆时针，-1，一个是顺时针，+1，因此，最后的计算值是 0，是外部，因此，不被填充。</p>\n<h2 id="evenodd-规则"><a href="#evenodd-%E8%A7%84%E5%88%99" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>evenodd 规则</h2>\n<p>起始值为 0，射线会和路径相交，每交叉一条路径，我们计数就+1，最后看我们的总计算数值，如果是奇数，则认为是路径内部，如果是偶数，则认为是路径外部。</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/2020-01-14-16-55-04-31a8c5bc7aee2e39d0a539b12109fa68-4fbd0.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 255px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 106.27450980392157%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAIAAADJt1n/AAAACXBIWXMAAA7DAAAOwwHHb6hkAAADV0lEQVQ4y31TWUwTURQtcfkBxCUxkoAfEPzxw/ijJAYDqNEYoxARKHu6UBCMbGoMCRpEFgXFEII2kJgQRJGtFCmtoNKZUpC2YAphKZSl1VLZIXRKO2+esxRZ9WUymbnvnXfuvedcFty0CBzYcMKOWYkpI1xeXErN/q3oo+KAgLst1jqOgDigHvJTLO2/kZz6SOZ79vnD9FoI1gCE/wMT9NWLU2ZRpYItqPUOa3Dhoa4pvZ5REr1y4F/kLBJHhe326cyiu+wy96C6vdHfnDnIQR5yNEl5nC0uzhZBCHCccDAQO8GY5adv8EhpjXlyRlqF5uW2hqW1nORIIs49uXSxZOrHOHkEAIAzORLERtoMfFY/LeBVGvsnHZHFhXmdUf+p621hC/qqbnlwDK4sU7w4vr1mulMwr0B2OuT9TO8QU+QMhBOA2ljRDAaHv7t2R1KYJRoPSVkb0gP6wHrD6ENz/TqvyGY/bpNJPUj+qm14ux1vBnAEX0x6muGUrnRKVt0MfWYb1sHNYIqc7ltBTotTHHqFWz+tovhtNrsNwBVoaUerbsVXBCZV3xOmiewLZRDOw01gQIuhV2hPRIn3JfYExNWbVRQ/vrLKdAgJz3zsw5nQjRkgRAFh2DAJg6e4sZT7Td7sJjeu/DyvySxVwKx82y8zudMnVZc+qKJY1o2xFUzHe1o1JV6hZ6Lr999W+YdUTmcVQ6uF3FjTG0wfJEyDCFrvLWDyPgq9vJAb8fJIbLtHgtw5vjMwvtmkpuofzX6dwxNCYCd2ZaY1o6KtNd1uEbJjiaiHoMOFiwRwGua6+zuCMk5drhhBKbcCWtvtYId7TKar/AYXvsI9vsNT0LGH35UcXZ4WI2RFIjlZYlIEfMtU7SCvFX5xjvzsnoC4J6IH2DJxVadNP3WB10i6fVY9tF3nDW4abNFN+HFEhwWKQwKFP7fRMk5KAxe0Ov+Yj/n5MsYXLGLrYvBMT94UtbrGfnWLbhe+kFKGsVN1mgbGk6LKzX263dP+S77UO+QTJ/Hht81rHX4k6D6Zvg+YrvMhhrGMRqNSqZTL5QiCaDQaDMOYqaLdCnLTq4vYhY7BofNyiDw8ClcxlsFgIDEqlYp8a7Vaq9XqGEnaMKvitrXMPNpAxCZBHOX9AU/eF1S6WEEoAAAAAElFTkSuQmCC\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="2020 01 14 16 55 04" title="" data-src="/static/2020-01-14-16-55-04-31a8c5bc7aee2e39d0a539b12109fa68-4fbd0.png" data-srcset="/static/2020-01-14-16-55-04-31a8c5bc7aee2e39d0a539b12109fa68-9c75c.png 200w,\n/static/2020-01-14-16-55-04-31a8c5bc7aee2e39d0a539b12109fa68-4fbd0.png 255w" data-sizes="(max-width: 255px) 100vw, 255px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>例如上图点 A，我们随便发出一条射线，结果经过了路径 5 和路径 2，交叉的路径个数为 2，是偶数，因此，属于路径外，不填充。</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/2020-01-14-16-55-22-209b228786f0d772423a644322908fce-f4849.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 249px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 106.82730923694778%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAIAAADJt1n/AAAACXBIWXMAAA7DAAAOwwHHb6hkAAADgklEQVQ4y21Ta0yTVxj+fixmMXgBIwPm5hISjdEEQ7LEP8v8g5eYJYtyMXKxKBaKUeuGYxnIBi5M1IyEyVIIpog3RAu19iYi5Su0COJUlm4WVyVIhtwaW0tv33fOu3PO1zConB/n+3Le877v8zzvczhYvLCIEPk8HQafJ3Be5ZCVBUMiC2B4b3H//woiZoloaurV7sNlcvXnBzQb9lwZNj+mhyy0dDJmhb0Ts+ZrtlylLvmgKa7AGn+0f1mB/WSpDoJztDteKhmLNCTWq5t2fb8p5+6KvXc/yOOXy/iYgr5EOf/l182v7Q56ISxEwOOFnQWBbL5vKh9nlqCZGYfVcVttLa8wpB3v3LmvOWvzKWXFPUBB0kHEWECEHJaqRGAzQuh0afuVxh5SGWFWf2Z68smLQY3telXb6w7Lu/EpmPMS9hAOL+Is6eHk//xkzw1NwwPAQghH4Ilsbz3bkZLRJqvovqmomz5eiRepjTHl7fcqvtMvzzQbm7pIloBIEVEI03Tf3y+3yvRc8R+r9up+P9lMomjhqBDDOtRuj8vtTMi5Z2y8T84ETAOsufjbGV3azvrUrFvOh88lsAvmjDGF7p7NKdYsUwyuzTbfUZF8OglM24B34Fnt+sxf5SpAYRxtEgqFHpparInpdz4ttsZmGPStD6G1TVC10GwhcLG4sVfTT9uycouSJav4Jt3VO8oVX/y48thQ/CGLNr0c9EaBXXijuR96/s+8W7ko00iyD1Rf3rajgTgsUdH3UX63Vs3TaXreXs0806uxzwsUnSyN+K1rPCXfsLrQliTn1xTZYvfptFftYLGc/izvyCkDhHzofc6RB8LUqKsxfpjbnVTUmyDnYwtt6/M7L+3/ZUO27uNso6vnSbTa7wBeAvwFMMuaTz91puaZ4o7Ykwp64gr7Uw4aph85LtZ1cxmdlT8ZJLdy8z73AhBnHiM9Acg7eAG4pLY0XqlLUA6tkJlqfm6jtANztdXGdV/d/PfZSAQ2YotKzTQkJUMI+QH6edXGb2/HVL3aUn6uo6/WBsAjNCn4a8o6qn5oX5qz9OioJIHACaWWy7GXlN0C/5txAAPCA7S8aD5RF7yg4oLBoNPpHB0dHRkZcblcHo8nYnXG/JFpKDlNPWwYlIyBmRdIXTwxgVq1nNvt1uv1PM93dXWZzeaxsbGIWxiFsM8/vD0XLL2SB6Lw/QfIhA0OheS4/AAAAABJRU5ErkJggg==\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="2020 01 14 16 55 22" title="" data-src="/static/2020-01-14-16-55-22-209b228786f0d772423a644322908fce-f4849.png" data-srcset="/static/2020-01-14-16-55-22-209b228786f0d772423a644322908fce-4cd05.png 200w,\n/static/2020-01-14-16-55-22-209b228786f0d772423a644322908fce-f4849.png 249w" data-sizes="(max-width: 249px) 100vw, 249px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>点 B 再发出一条射线，经过路径片段路径 2 和路径 3，交叉的路径个数为 2，是偶数，因此，也属于路径外，不填充。</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/2020-01-14-16-56-50-1bb14bd6deae22341e19c72364302b67-21b91.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 252px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 107.53968253968253%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAWCAIAAABPIytRAAAACXBIWXMAAA7DAAAOwwHHb6hkAAADgklEQVQ4y3VTa0iTURj+iC6kUZBhS/JHfyoIgpDoR2FQqYlhGIW5oDlR1nRpEUWlUWZk94tZrVqleQEvbc6pa8tM52ZbNdNmLS8tt+m6ecnWlu07l873fTat9MB3OB/ved7nfZ/zPhT+Z0EEyf7xM3Muq/gmLcJTL8p/QghBiJjT8CDakVR5VZ0cdT42/NxHay8T5UJTgslH+z61dublKKO2yubxNYHp5ulJhpvnH5EIgFMwE06ye7W6S2LZkpgSKuHpDPGLBaktoWl6XmpL5O4Kr83BkjPs8C8wQhz4+7qtHYKjpleuO5e1afur1qbU8HapV8QWx6zMkt5oIhd+AQQIHEIMwL/MPzs/HE8t7Oc6pEeB3WE1WLUFT6X77h3e84C2vGPExJgoSfuZyT/JM8rqcSu/YXVcyeCrLn9GogRT59DX8qzCjEPVFyvMJrkaF5TAiYJxYo5+sK8SKsITFU7Ts594pM8HeyB6DyDp+G5DftCJa1S+PZT/8Pa2bDzqJXhqGONWjK9gVIaxA4xkysQzz5jDMjMVpvvdGL8BtBWC9wh7Pd0HsgqX76rl7azT1rxm9AeQqmGQ+CDGMoSdGPe0NqxOUsyXNG3ZUzFo7uSKgpAps636uTQkNoMv9Q0McX1RE9+NFZHOza4NEDYHiEwbBJWfOmy4zeIzvGDQI0MnY3Iq82o52nHBaHYHLMNbvTVx7Ym4uNvTRM+jU2sHJMdwSTn3OO9KtQOWbr9GfzGPSUz7arYfid50NVhiDBS1RMQXD+hbOVWNZ0sdze3cwPwHJk/JpmyvfhbMrwsWGxaLmmaLjBtJ/Z0O3PYye6kw97SGpAcITwIm5EzO4SGBRB6QrA8R6Qh+llC3WVLXnHF5c0ReWKLK0zFWOfX/uAOW/ElR49wEDU+sX5jSxBMbFgm09efKI9M1VHxD2XUNZ5VJwNysI9fn6GT5nBS28qRm0V459nkH27vWJyrWCJXY6Zys7Ank5TfrA/mPQyQtQQlqfZmeC33r6AnfUVwq000J5l6CODFcIJ+RYtyWXIm/fGX8yPrJYbHl8q/QZgvFKgxZXyIAwJgf/rhfekFNxTdWFer85SAW71bV/5JkUn19fXK5XKlUqlQqjUbjcrnG2mavOt/YTy0TuhuNLAyOi0I43D8ot9tts9l6e3vtdjvZPR7PuB/ZYQA5F7CznwNNVJW49TcC1kIou75IdwAAAABJRU5ErkJggg==\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="2020 01 14 16 56 50" title="" data-src="/static/2020-01-14-16-56-50-1bb14bd6deae22341e19c72364302b67-21b91.png" data-srcset="/static/2020-01-14-16-56-50-1bb14bd6deae22341e19c72364302b67-0777d.png 200w,\n/static/2020-01-14-16-56-50-1bb14bd6deae22341e19c72364302b67-21b91.png 252w" data-sizes="(max-width: 252px) 100vw, 252px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>最后这个点 C，发出的射线总共和 3 个路径交叉，是奇数。因此，属于路径内，填充。</p>',id:"/home/runner/work/GatsbyBlog/GatsbyBlog/blog/SVG、Canvas中nonzero和evenodd填充规则/index.md absPath of file >>> MarkdownRemark",timeToRead:2,frontmatter:{date:"2020-01-14 16:48:52",path:"/svg-canvas-nonzero-evenodd/",tags:"前端, CSS, CSS知识点",title:"SVG/Canvas中nonzero和evenodd填充规则",draft:null}},{excerpt:"假设页面中有下面这一段 HTML： 点击“返回顶部”这个文字链接的时候，页面就会“唰”地瞬间定位到浏览器顶部。 浏览器已经开始支持原生平滑滚动定位，CSS scroll-behavior 属性和 JS scrollIntoView()方法都可以。 CSS scroll-behavior 与平滑滚动 scroll-behavior:smooth 写在滚动容器元素上，可以让容器（非鼠标手势触发）的滚动变得平滑。 语法 初始值是’auto’。 凡是需要滚动的地方都加一句 scroll-behavior…",html:'<p>假设页面中有下面这一段 HTML：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="34701378227871580000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`<a href=&quot;#&quot; rel=&quot;internal&quot;>返回顶部</a>`, `34701378227871580000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="html"\n              >\n                <span class="gatsby-code-button-language">html</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="html"><pre style="counter-reset: linenumber NaN" class="language-html line-numbers"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#<span class="token punctuation">"</span></span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>internal<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>返回顶部<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>\n<p>点击“返回顶部”这个文字链接的时候，页面就会“唰”地瞬间定位到浏览器顶部。</p>\n<p>浏览器已经开始支持原生平滑滚动定位，CSS scroll-behavior 属性和 JS scrollIntoView()方法都可以。</p>\n<h1 id="css-scroll-behavior-与平滑滚动"><a href="#css-scroll-behavior-%E4%B8%8E%E5%B9%B3%E6%BB%91%E6%BB%9A%E5%8A%A8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>CSS scroll-behavior 与平滑滚动</h1>\n<p>scroll-behavior:smooth 写在滚动容器元素上，可以让容器（非鼠标手势触发）的滚动变得平滑。</p>\n<p>语法</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="18126149261106074000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`scroll-behavior: auto;\nscroll-behavior: smooth;`, `18126149261106074000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="css"\n              >\n                <span class="gatsby-code-button-language">css</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="css"><pre style="counter-reset: linenumber NaN" class="language-css line-numbers"><code class="language-css"><span class="token property">scroll-behavior</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span>\n<span class="token property">scroll-behavior</span><span class="token punctuation">:</span> smooth<span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>\n<p>初始值是’auto’。</p>\n<p>凡是需要滚动的地方都加一句 scroll-behavior:smooth 就好了！</p>\n<p>举个例子，在 PC 浏览器中，网页默认滚动是在<code class="language-text">&lt;html&gt;</code>标签上的，移动端大多数在<code class="language-text">&lt;body&gt;</code>标签上，于是，我加上这么一句：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="91427303115402230000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`html,\nbody {\n  scroll-behavior: smooth;\n}`, `91427303115402230000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="css"\n              >\n                <span class="gatsby-code-button-language">css</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="css"><pre style="counter-reset: linenumber NaN" class="language-css line-numbers"><code class="language-css"><span class="token selector">html,\nbody</span> <span class="token punctuation">{</span>\n  <span class="token property">scroll-behavior</span><span class="token punctuation">:</span> smooth<span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>\n<h1 id="js-scrollintoview-与平滑滚动"><a href="#js-scrollintoview-%E4%B8%8E%E5%B9%B3%E6%BB%91%E6%BB%9A%E5%8A%A8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>JS scrollIntoView 与平滑滚动</h1>\n<p>DOM 元素的 scrollIntoView()方法是一个 IE6 浏览器也支持的原生 JS API，可以让元素进入视区，通过触发滚动容器的定位实现。</p>\n<p>随着 Chrome 和 Firefox 浏览器开始支持 CSS scroll-behavior 属性，顺便对 scrollIntoView()方法进行了升级，使支持更多参数，其中一个参数就是可以使滚动平滑。</p>\n<p>语法如下：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="43284759497698660000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`target.scrollIntoView({\n  behavior: \'smooth\'\n});`, `43284759497698660000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="js"\n              >\n                <span class="gatsby-code-button-language">js</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="js"><pre style="counter-reset: linenumber NaN" class="language-js line-numbers"><code class="language-js">target<span class="token punctuation">.</span><span class="token function">scrollIntoView</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  behavior<span class="token punctuation">:</span> <span class="token string">\'smooth\'</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<p>我们随便打开一个有链接的页面，把首个链接滚动到屏幕外，然后控制台输入类似下面代码，我们就可以看到页面平滑滚动定位了：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="58261116046187954000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`document.links[0].scrollIntoView({\n  behavior: \'smooth\'\n});`, `58261116046187954000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="js"\n              >\n                <span class="gatsby-code-button-language">js</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="js"><pre style="counter-reset: linenumber NaN" class="language-js line-numbers"><code class="language-js">document<span class="token punctuation">.</span>links<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">scrollIntoView</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  behavior<span class="token punctuation">:</span> <span class="token string">\'smooth\'</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<h2 id="其他"><a href="#%E5%85%B6%E4%BB%96" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>其他</h2>\n<ul>\n<li>\n<p>scrollIntoView()升级后的方法，除了支持’behavior’，还有’block’和’inline’等参数，有兴趣可以参阅 MDN 相关文档。</p>\n</li>\n<li>\n<p>如果我们的网页已经通过 CSS 设置了 scroll-behavior:smooth 声明，则我们直接执行 target.scrollIntoView()方法就会有平滑滚动，无需再额外设置 behavior 参数。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="34691406072293708000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`document.forms[0].scrollIntoView();`, `34691406072293708000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="js"\n              >\n                <span class="gatsby-code-button-language">js</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="js"><pre style="counter-reset: linenumber NaN" class="language-js line-numbers"><code class="language-js">document<span class="token punctuation">.</span>forms<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">scrollIntoView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>\n</li>\n</ul>\n<h1 id="js-平滑滚动向下兼容处理"><a href="#js-%E5%B9%B3%E6%BB%91%E6%BB%9A%E5%8A%A8%E5%90%91%E4%B8%8B%E5%85%BC%E5%AE%B9%E5%A4%84%E7%90%86" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>JS 平滑滚动向下兼容处理</h1>\n<p>JS 实现平滑滚动并不难，jQuery 中 animate()方法：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="3177007039385415700"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`scrollContainer.animate({\n  scrollTop: 0\n});`, `3177007039385415700`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="js"\n              >\n                <span class="gatsby-code-button-language">js</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="js"><pre style="counter-reset: linenumber NaN" class="language-js line-numbers"><code class="language-js">scrollContainer<span class="token punctuation">.</span><span class="token function">animate</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  scrollTop<span class="token punctuation">:</span> <span class="token number">0</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<p>或者使用 requestAnimationFrame API 这类原生 JS 也能实现。例如下面这个我速写的个方法：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="52922536245048566000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`/**\n @description 页面垂直平滑滚动到指定滚动高度\n @author zhangxinxu(.com)\n*/\nvar scrollSmoothTo = function(position) {\n  if (!window.requestAnimationFrame) {\n    window.requestAnimationFrame = function(callback, element) {\n      return setTimeout(callback, 17);\n    };\n  }\n  // 当前滚动高度\n  var scrollTop = document.documentElement.scrollTop || document.body.scrollTop;\n  // 滚动step方法\n  var step = function() {\n    // 距离目标滚动距离\n    var distance = position - scrollTop;\n    // 目标滚动位置\n    scrollTop = scrollTop + distance / 5;\n    if (Math.abs(distance) < 1) {\n      window.scrollTo(0, position);\n    } else {\n      window.scrollTo(0, scrollTop);\n      requestAnimationFrame(step);\n    }\n  };\n  step();\n};`, `52922536245048566000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="js"\n              >\n                <span class="gatsby-code-button-language">js</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="js"><pre style="counter-reset: linenumber NaN" class="language-js line-numbers"><code class="language-js"><span class="token comment">/**\n @description 页面垂直平滑滚动到指定滚动高度\n @author zhangxinxu(.com)\n*/</span>\n<span class="token keyword">var</span> <span class="token function-variable function">scrollSmoothTo</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">position</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>window<span class="token punctuation">.</span>requestAnimationFrame<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    window<span class="token punctuation">.</span><span class="token function-variable function">requestAnimationFrame</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">callback<span class="token punctuation">,</span> element</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">return</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>callback<span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n  <span class="token comment">// 当前滚动高度</span>\n  <span class="token keyword">var</span> scrollTop <span class="token operator">=</span> document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>scrollTop <span class="token operator">||</span> document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>scrollTop<span class="token punctuation">;</span>\n  <span class="token comment">// 滚动step方法</span>\n  <span class="token keyword">var</span> <span class="token function-variable function">step</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 距离目标滚动距离</span>\n    <span class="token keyword">var</span> distance <span class="token operator">=</span> position <span class="token operator">-</span> scrollTop<span class="token punctuation">;</span>\n    <span class="token comment">// 目标滚动位置</span>\n    scrollTop <span class="token operator">=</span> scrollTop <span class="token operator">+</span> distance <span class="token operator">/</span> <span class="token number">5</span><span class="token punctuation">;</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>distance<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      window<span class="token punctuation">.</span><span class="token function">scrollTo</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> position<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n      window<span class="token punctuation">.</span><span class="token function">scrollTo</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> scrollTop<span class="token punctuation">)</span><span class="token punctuation">;</span>\n      <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span>step<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span><span class="token punctuation">;</span>\n  <span class="token function">step</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>使用的是缓动动画 JS 小算法，滚动先快后慢。</p>\n<p>使用如下，例如我们希望网页平滑滚动到顶部，直接：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="13846795598748418000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`scrollSmoothTo(0);`, `13846795598748418000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="js"\n              >\n                <span class="gatsby-code-button-language">js</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="js"><pre style="counter-reset: linenumber NaN" class="language-js line-numbers"><code class="language-js"><span class="token function">scrollSmoothTo</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>\n<p>难的是如何支持平滑滚动的浏览器原生处理，不支持的浏览器还是使用老的 JS 方法处理。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="91936566875380190000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`if (typeof window.getComputedStyle(document.body).scrollBehavior == \'undefined\') {\n  // 传统的JS平滑滚动处理代码...\n}`, `91936566875380190000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="js"\n              >\n                <span class="gatsby-code-button-language">js</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="js"><pre style="counter-reset: linenumber NaN" class="language-js line-numbers"><code class="language-js"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> window<span class="token punctuation">.</span><span class="token function">getComputedStyle</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">.</span>scrollBehavior <span class="token operator">==</span> <span class="token string">\'undefined\'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token comment">// 传统的JS平滑滚动处理代码...</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>',
id:"/home/runner/work/GatsbyBlog/GatsbyBlog/blog/CSS scroll-behavior和JS scrollIntoView让页面滚动平滑/index.md absPath of file >>> MarkdownRemark",timeToRead:2,frontmatter:{date:"2020-01-14 10:55:12",path:"/css-js-scroll-smooth/",tags:"前端, CSS, CSS知识点",title:"CSS scroll-behavior和JS scrollIntoView让页面滚动平滑",draft:null}},{excerpt:"所谓“层叠规则”，指的是当网页中的元素发生层叠时的表现规则。 默认情况下，网页内容是没有偏移角的垂直视觉呈现，当内容发生层叠的时候，一定会有一个前后的层叠顺序产生，有点儿类似于真实世界中“论资排辈”的感觉。 z-index 只是 CSS 层叠规则中的一部分 在 CSS 世界中，z-index 属性只有和定位元素（position 不为 static 的元素）在一起的时候才有作用，可以是正数也可以是负数。理论上说，数值越大层级越高，但实际上其规则要复杂很多。 但随着 CSS3 新世界的到来，z…",html:'<p>所谓“层叠规则”，指的是当网页中的元素发生层叠时的表现规则。</p>\n<p>默认情况下，网页内容是没有偏移角的垂直视觉呈现，当内容发生层叠的时候，一定会有一个前后的层叠顺序产生，有点儿类似于真实世界中“论资排辈”的感觉。</p>\n<h1 id="z-index-只是-css-层叠规则中的一部分"><a href="#z-index-%E5%8F%AA%E6%98%AF-css-%E5%B1%82%E5%8F%A0%E8%A7%84%E5%88%99%E4%B8%AD%E7%9A%84%E4%B8%80%E9%83%A8%E5%88%86" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>z-index 只是 CSS 层叠规则中的一部分</h1>\n<p>在 CSS 世界中，z-index 属性只有和定位元素（position 不为 static 的元素）在一起的时候才有作用，可以是正数也可以是负数。理论上说，数值越大层级越高，但实际上其规则要复杂很多。</p>\n<p>但随着 CSS3 新世界的到来，z-index 已经并非只对定位元素有效，flex 盒子的子元素也可以设置 z-index 属性。</p>\n<p>要知道，网页中绝大部分元素是非定位元素，并且影响层叠顺序的属性远不止 z-index 一个，因此大家千万不要以为 z-index 属性就可以代表 CSS 世界的层叠规则，实际上 z-index 只是 CSS 层叠规则中的一叶小舟，CSS 层叠规则的体量要比大家想象的要大得多。</p>\n<h1 id="理解-css-世界的层叠上下文和层叠水平"><a href="#%E7%90%86%E8%A7%A3-css-%E4%B8%96%E7%95%8C%E7%9A%84%E5%B1%82%E5%8F%A0%E4%B8%8A%E4%B8%8B%E6%96%87%E5%92%8C%E5%B1%82%E5%8F%A0%E6%B0%B4%E5%B9%B3" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>理解 CSS 世界的层叠上下文和层叠水平</h1>\n<h2 id="什么是层叠上下文"><a href="#%E4%BB%80%E4%B9%88%E6%98%AF%E5%B1%82%E5%8F%A0%E4%B8%8A%E4%B8%8B%E6%96%87" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>什么是层叠上下文</h2>\n<p>层叠上下文，英文称作 stacking context，是 HTML 中的一个三维的概念。如果一个元素含有层叠上下文，我们可以理解为这个元素在 z 轴上就“高人一等”。</p>\n<p>这里出现了一个名词 — z 轴，它指的是什么呢？其表示的是用户与显示器之间这条看不见的垂直线，即图 7-1 中的这条水平线。</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/2020-01-10-10-26-48-60916aa9129fcfef8a9801f4cdb819f8-27d67.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 281px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 73.66548042704626%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABGElEQVQoz5WTyW6FMAxF+f+vQwKJFayYBWEuM68HLPFoSWnrBUqcHN8bJxivx1jXtaqqbdu0q8avcJZlZVmemWVZpml6w9sRWli2dl3Xti3TeZ4tyzJN86/KkEEQFEUxDAOZpmlOIwbFOJVSioFWue/7MAz55nkue5IkAdlh/DBJ05SSmF8vwRTPCFIiiiIG8DDjOMZxvMN1XZNirVAKvr0EhlFgFYwl13X5IvNxBBt2WByK8t05hsUtOxmz7X1VeEABe1LlzpOhQ5yCsVj4cs8UxgNVtbCYQkAPPwflaFh1xGnwO/zTO5E8yphvjviH8rUEJH1+grkb3tN5SKYAZO7WNLDnebxH/gc6zNuybdv3fcdxpOHX+AQF9m7wmH5TqAAAAABJRU5ErkJggg==\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="2020 01 10 10 26 48" title="" data-src="/static/2020-01-10-10-26-48-60916aa9129fcfef8a9801f4cdb819f8-27d67.png" data-srcset="/static/2020-01-10-10-26-48-60916aa9129fcfef8a9801f4cdb819f8-3c38b.png 200w,\n/static/2020-01-10-10-26-48-60916aa9129fcfef8a9801f4cdb819f8-27d67.png 281w" data-sizes="(max-width: 281px) 100vw, 281px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>层叠上下文是一个概念，跟“块状格式化上下文”（BFC）类似。我们可以把层叠上下文理解为一种“层叠结界”，自成一个小世界。这个小世界中可能有其他的“层叠结界”，而自身也可能处于其他“层叠结界”中。</p>\n<h2 id="什么是层叠水平"><a href="#%E4%BB%80%E4%B9%88%E6%98%AF%E5%B1%82%E5%8F%A0%E6%B0%B4%E5%B9%B3" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>什么是层叠水平</h2>\n<p>stacking level，决定了同一个层叠上下文中元素在 z 轴上的显示顺序。</p>\n<p>所有的元素都有层叠水平，包括层叠上下文元素，也包括普通元素。然而，对普通元素的层叠水平探讨只局限在当前层叠上下文元素中。为什么呢？因为不如此就没有意义。层叠上下文本身就是一个强力的“层叠结界”，而普通元素的层叠水平是无法突破这个结界和结界外的元素去较量层叠水平的。</p>\n<p>需要注意的是，诸位千万不要把层叠水平和 CSS 的 z-index 属性混为一谈。尽管某些情况下 z-index 确实可以影响层叠水平，但是只限于定位元素以及 flex 盒子的孩子元素；而层叠水平所有的元素都存在。</p>\n<h1 id="理解元素的层叠顺序"><a href="#%E7%90%86%E8%A7%A3%E5%85%83%E7%B4%A0%E7%9A%84%E5%B1%82%E5%8F%A0%E9%A1%BA%E5%BA%8F" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>理解元素的层叠顺序</h1>\n<p>再来说说层叠顺序。层叠顺序，英文称作 stacking order，表示元素发生层叠时有着特定的垂直显示顺序。注意，这里跟上面两个不一样，上面的“层叠上下文”和“层叠水平”是概念，而这里的“层叠顺序”是规则。</p>\n<p>在 CSS 2.1 的年代，在 CSS3 新世界还没有到来的时候（注意这里的前提），层叠顺序规则如图 7-2 所示。</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/2020-01-10-10-34-34-44d7195b285f5d49267088c47065a390-32723.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 355px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 80.56338028169014%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAIAAACZeshMAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACoElEQVQoz31Ta0/TYBTuv/EXeIlfMF6IHwgGAYdMxQ8GQRRQlKHDCCrKNjCYmHiPCHI1AxJJiGQToczdNze6tWXQbWxs3UZZcbeyrZ29hMVN8cnb9+3bPOc8J885BZJkKuiMBKCw3xbymXGfFfcag7GtBJPLMTS7FYDZg3AFAivhhX6Dulc337X8tROckywqr6o2rXjuX8FFAPyW0NQ19bQUHJPrJhX6kcfa91JwdghSfVnze6KCWp6dSCSi0ShJkul0mgve9u1ASnRhGJJJlwe6tLK7mp52sKdtSVqvMmt8LIPm9YUUHo/HYrE4HI54PM4FC7VhKNF5Rd0tAW8/1XbIDHee6CW9hnaFueGR8ZsumE9RXLaQkiSSdl1gdm69om2pSgLWdi+Iu7/X3FeXtsyNqBAql4ynUwzDZqALDBMOmr8j3mhFMyiWzTfDH67bPzZBQ6KfLyutL04b+8cDepaQZegC5b0ecE+SSuM4pfV6Sg291SZ5h00hsfXdsw+0WHrGsNEN0rSV5FxgcoXK+TayeyC13QQNP3S+VjpvfoZbJ+Fbn6D6t7ZLfaYyQ3CGLzPLqTFMUTBXf4bOsu/+X8hzq2jQXPdjsUmzdEMPtuq1klVTX8g2GMMtPJsG/vZQqGqHCmsCE+bVN9hUFTYtWleK3DMXXFPnHGOnQiujnH42A+w3PQzvTYpYgyZKnIPlcGMjXN+AiuuQypq1i41YbXPo3fj+wbyJGWonFjISpnn0uBg5UokcPoscPAMfKocOlPgePAP+P718hhzlx1fLLqPHqtGT55ETNWhpLXy0YlP+qthtmkfeeTrLIpPdpSg8kgqGKW5FdvHIbjCcIWPAn01iJ9br9RIEwf4Abrd7gwf7BUZgF4Z5/D7E5YonEnn+bxPqMTLth1doAAAAAElFTkSuQmCC\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="2020 01 10 10 34 34" title="" data-src="/static/2020-01-10-10-34-34-44d7195b285f5d49267088c47065a390-32723.png" data-srcset="/static/2020-01-10-10-34-34-44d7195b285f5d49267088c47065a390-d1052.png 200w,\n/static/2020-01-10-10-34-34-44d7195b285f5d49267088c47065a390-32723.png 355w" data-sizes="(max-width: 355px) 100vw, 355px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>关于图 7-2 这里有一些补充说明。</p>\n<ol>\n<li>位于最下面的 background/border 特指层叠上下文元素的边框和背景色。每一个层叠顺序规则仅适用于当前层叠上下文元素的小世界。</li>\n<li>inline 水平盒子指的是包括 inline/inline-block/inline-table 元素的“层叠顺序”，它们都是同等级别的。</li>\n<li>单纯从层叠水平上看，实际上 z-index: 0 和 z-index: auto 是可以看成是一样的。注意这里的措辞 — “单纯从层叠水平上看”，实际上，两者在层叠上下文领域有着根本性的差异。</li>\n</ol>\n<p>为什么内联元素的层叠顺序要比浮动元素和块状元素都高？</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/2020-01-10-10-37-34-c09dfd24b622ed6015653dc11ebe06d5-8e7aa.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 362px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 77.34806629834253%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACiElEQVQoz32S3U9SYRzH/VdaW7ddtGpr2VqbF62rvHAtp2wMmrlWuZxcYAxsvsRmsXRGS4YshK0LB2iK2HzjRcwpcIjD4U1EDqB4jrwcDxwO5xw6cAp8W9892/PseX6ffX+/5/drgl2HkGUXNEe8hiAwE3Tp/bu2eIUVzVA4TpMkeYIXkWOGpisX1LQ15Z0Xry9IrQtvrXNi6/fnSzalmw0sE6UCnCAyWQJB8WSSpqhLYOckYOhZ0Q5vqOSbqhHneL9dObD5eXBr2RRmnxnmXyB7qq86nE3kj0Kodsw18Nr6XuoYktqHpXapaE096Qaj6H4qT7MZM5fkXIW5bVYHKiSO3qENvswh6HcKxE6eyNnCX5V/8VfLJ0jiMF3KY0UELaTTDZipiSxRVLnc93H7doelU/lDqDd16eafamZ6zLP6gw37gY/JYXSZKmVzRRQ978zJsBIb1YA9O9qOoEIITbSDH1o98nsO2UjYWK260qi25ngW5iQC9fcdsnFAqvFJNP53X0Gxytc7Db7ZOVqsYGQBTpK5LBaPnyTgMzD3l0Buf+XIqwP7VJ52g/ul0fViZqd7eov/K6wuofFiJkWTZYYk2eZddGa4ATGGhzWeLsj8LDLHC1t40dXuyLIAMrcicVPNhj5fMyeaYSiaIhmySGQCxjbft2ZIzvPLOiBJOyh6vK8YRKYMmMt3Odzwp0oHgAq2jYaevAo8EAabOwM326BbrcCVO6lP6jMw17P6oaraPFMFAnrE815r/n29hV2+Gw+Bq3dTY+r/OJ/KgaJx+3Z+cQ37acOW1rOLa8cmSyEQ+QtzhgiCwDCM4ziGYXt7e8lkMhaLsTfBUAjOoCkciyLpNIETp0b1DwOa/ZGQzfZkAAAAAElFTkSuQmCC\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="2020 01 10 10 37 34" title="" data-src="/static/2020-01-10-10-37-34-c09dfd24b622ed6015653dc11ebe06d5-8e7aa.png" data-srcset="/static/2020-01-10-10-37-34-c09dfd24b622ed6015653dc11ebe06d5-acee0.png 200w,\n/static/2020-01-10-10-37-34-c09dfd24b622ed6015653dc11ebe06d5-8e7aa.png 362w" data-sizes="(max-width: 362px) 100vw, 362px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>background/border 为装饰属性，浮动和块状元素一般用作布局，而内联元素都是内容。网页中最重要的是什么？当然是内容了！尤其是 CSS 世界是为更好的图文展示而设计的，因此，一定要让内容的层叠顺序相当高，这样当发生层叠时，重要的文字、图片内容才可以优先显示在屏幕上。例如，文字和浮动图片重叠的时候，如图 7-4 所示。</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/2020-01-10-10-38-33-422f4920ab4b9277b59bd3209ffb2edb-5ae8a.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 214px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 50.46728971962617%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAByklEQVQoz2VRy27TQBTNpyAW/AMVKrtUqEIqRWxggUTVJRIbEEJCsOm2lZoFEh/AJ5QVYkEJjkziV1pn6owTO7ZjR7GjOE5sjxub0zjQShxpZu69c859zFSKotB08uHw1VHt4OTryecvx3Xu1PcDckFIRxVFwfNGqqpSqp+127KiSLLsB4Hv+xBWsJptrvr8Tu319sHbnQd7m/XGz8V80TeMgWlcaCSKZl2qq2pHFASN0g4h2eVyOp2uxb+lH/d2br3b26h93H30YkuUBJ3S87NzlXQ81+W4+q861xJFrsGlKQM/z/NrcaP17f7u7ePDp/z3T2/ev7RsC0GWpnESs4wlMZCwLEuSOM+LEmEYrsV863T74caTx9Xq1t39/Weu66DCfDGHaAGU+9UZz1eIomg8Hq/FjDHHtt2hbZqG49hZhjIZW+FyBbgp8v11S1yJ0QClFFmnYQgGeLZtj0Yj5MZglmWZpum6Lmh4YRi4RWQwGIBQQYjn+clkgv8IgmA2mxFCdF3XNK3f70uSpCgKXLCRqNvtyrLcbDYFQUCWSvEflsul53mO4/R6PRgY0jAMVCvf+SbzWvzvArOBChn24XCI1tAFyt7klMYfakgL3mr8YxQAAAAASUVORK5CYII=\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="2020 01 10 10 38 33" title="" data-src="/static/2020-01-10-10-38-33-422f4920ab4b9277b59bd3209ffb2edb-5ae8a.png" data-srcset="/static/2020-01-10-10-38-33-422f4920ab4b9277b59bd3209ffb2edb-40813.png 200w,\n/static/2020-01-10-10-38-33-422f4920ab4b9277b59bd3209ffb2edb-5ae8a.png 214w" data-sizes="(max-width: 214px) 100vw, 214px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<h1 id="务必牢记的层叠准则"><a href="#%E5%8A%A1%E5%BF%85%E7%89%A2%E8%AE%B0%E7%9A%84%E5%B1%82%E5%8F%A0%E5%87%86%E5%88%99" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>务必牢记的层叠准则</h1>\n<p>下面这两条是层叠领域的黄金准则。当元素发生层叠的时候，其覆盖关系遵循下面两条准则：</p>\n<ol>\n<li>谁大谁上：当具有明显的层叠水平标识的时候，如生效的 z-index 属性值，在同一个层叠上下文领域，层叠水平值大的那一个覆盖小的那一个。</li>\n<li>后来居上：当元素的层叠水平一致、层叠顺序相同的时候，在 DOM 流中处于后面的元素会覆盖前面的元素。</li>\n</ol>\n<p>在 CSS 和 HTML 领域，只要元素发生了重叠，都离不开上面这两条黄金准则。因为后面会有多个实例说明，这里就到此为止。</p>\n<h1 id="深入了解层叠上下文"><a href="#%E6%B7%B1%E5%85%A5%E4%BA%86%E8%A7%A3%E5%B1%82%E5%8F%A0%E4%B8%8A%E4%B8%8B%E6%96%87" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>深入了解层叠上下文</h1>\n<h2 id="层叠上下文的特性"><a href="#%E5%B1%82%E5%8F%A0%E4%B8%8A%E4%B8%8B%E6%96%87%E7%9A%84%E7%89%B9%E6%80%A7" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>层叠上下文的特性</h2>\n<p>层叠上下文元素有如下特性：</p>\n<ul>\n<li>层叠上下文的层叠水平要比普通元素高（原因后面会说明）。</li>\n<li>层叠上下文可以阻断元素的混合模式。（isolation: isolate 创建一个新的层叠上下文(stacking context)。）</li>\n<li>层叠上下文可以嵌套，内部层叠上下文及其所有子元素均受制于外部的“层叠上下文”。</li>\n<li>每个层叠上下文和兄弟元素独立，也就是说，当进行层叠变化或渲染的时候，只需要考虑后代元素。</li>\n<li>每个层叠上下文是自成体系的，当元素发生层叠的时候，整个元素被认为是在父层叠上下文的层叠顺序中。</li>\n</ul>\n<h2 id="层叠上下文的创建"><a href="#%E5%B1%82%E5%8F%A0%E4%B8%8A%E4%B8%8B%E6%96%87%E7%9A%84%E5%88%9B%E5%BB%BA" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>层叠上下文的创建</h2>\n<p>和块状格式化上下文一样，层叠上下文也基本上是由一些特定的 CSS 属性创建的。我将其总结为 3 个流派。</p>\n<ol>\n<li>天生派：页面根元素天生具有层叠上下文，称为根层叠上下文。</li>\n<li>正统派：z-index 值为数值的定位元素的传统“层叠上下文”。</li>\n<li>扩招派：其他 CSS3 属性。</li>\n</ol>\n<h3 id="根层叠上下文"><a href="#%E6%A0%B9%E5%B1%82%E5%8F%A0%E4%B8%8A%E4%B8%8B%E6%96%87" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>根层叠上下文</h3>\n<p>根层叠上下文指的是页面根元素，可以看成是<code class="language-text">&lt;html&gt;</code>元素。因此，页面中所有的元素一定处于至少一个“层叠结界”中。</p>\n<h3 id="定位元素与传统层叠上下文"><a href="#%E5%AE%9A%E4%BD%8D%E5%85%83%E7%B4%A0%E4%B8%8E%E4%BC%A0%E7%BB%9F%E5%B1%82%E5%8F%A0%E4%B8%8A%E4%B8%8B%E6%96%87" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>定位元素与传统层叠上下文</h3>\n<p>对于 position 值为 relative/absolute 以及 Firefox/IE 浏览器（不包括 Chrome 浏览器）下含有 position:fixed 声明的定位元素，当其 z-index 值不是 auto 的时候，会创建层叠上下文。</p>\n<html><head></head><body><div class="gatsby-code-button-container" data-toaster-id="64116865332604630000" data-toaster-class="gatsby-code-button-toaster" data-toaster-text-class="gatsby-code-button-toaster-text" data-toaster-text="复制成功" data-toaster-duration="3500" onclick="copyToClipboard(`<div style=&quot;position:relative; z-index:auto;&quot;>\n  <!-- 美女 -->\n  <img data-src=&quot;1.jpg&quot; style=&quot;position:absolute; z-index:2;&quot; />\n</div>\n<div style=&quot;position:relative; z-index:auto;&quot;>\n  <!-- 美景 -->\n  <img src=&quot;2.jpg&quot; style=&quot;position:relative; z-index:1;&quot; />\n</div>`, `64116865332604630000`)">\n              <div class="gatsby-code-button" title="html">\n                <span class="gatsby-code-button-language">html</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div></body></html>\n<div class="gatsby-highlight" data-language="html"><pre style="counter-reset: linenumber NaN" class="language-html line-numbers"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">position</span><span class="token punctuation">:</span>relative<span class="token punctuation">;</span> <span class="token property">z-index</span><span class="token punctuation">:</span>auto<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token comment">&lt;!-- 美女 --></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1.jpg<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">position</span><span class="token punctuation">:</span>absolute<span class="token punctuation">;</span> <span class="token property">z-index</span><span class="token punctuation">:</span>2<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">position</span><span class="token punctuation">:</span>relative<span class="token punctuation">;</span> <span class="token property">z-index</span><span class="token punctuation">:</span>auto<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token comment">&lt;!-- 美景 --></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2.jpg<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">position</span><span class="token punctuation">:</span>relative<span class="token punctuation">;</span> <span class="token property">z-index</span><span class="token punctuation">:</span>1<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>结果如图 7-5 所示。效果符合预期，毕竟“美女”图片的 z-index 值是 2，而“美景”图片的 z-index 是 1。</p>\n<p>下面我们对父级简单调整一下，把 z-index:auto 改成层叠水平一样高的 z-index:0，代码如下：</p>\n<html><head></head><body><div class="gatsby-code-button-container" data-toaster-id="60917340229038560000" data-toaster-class="gatsby-code-button-toaster" data-toaster-text-class="gatsby-code-button-toaster-text" data-toaster-text="复制成功" data-toaster-duration="3500" onclick="copyToClipboard(`<div style=&quot;position:relative; z-index:0;&quot;>\n  <!-- 美女 -->\n  <img data-src=&quot;1.jpg&quot; style=&quot;position:absolute; z-index:2;&quot; />\n</div>\n<div style=&quot;position:relative; z-index:0;&quot;>\n  <!-- 美景 -->\n  <img src=&quot;2.jpg&quot; style=&quot;position:relative; z-index:1;&quot; />\n</div>`, `60917340229038560000`)">\n              <div class="gatsby-code-button" title="html">\n                <span class="gatsby-code-button-language">html</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div></body></html>\n<div class="gatsby-highlight" data-language="html"><pre style="counter-reset: linenumber NaN" class="language-html line-numbers"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">position</span><span class="token punctuation">:</span>relative<span class="token punctuation">;</span> <span class="token property">z-index</span><span class="token punctuation">:</span>0<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token comment">&lt;!-- 美女 --></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1.jpg<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">position</span><span class="token punctuation">:</span>absolute<span class="token punctuation">;</span> <span class="token property">z-index</span><span class="token punctuation">:</span>2<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">position</span><span class="token punctuation">:</span>relative<span class="token punctuation">;</span> <span class="token property">z-index</span><span class="token punctuation">:</span>0<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token comment">&lt;!-- 美景 --></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2.jpg<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">position</span><span class="token punctuation">:</span>relative<span class="token punctuation">;</span> <span class="token property">z-index</span><span class="token punctuation">:</span>1<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>结果会发现覆盖关系居然反过来了，此时“美景”图片覆盖在了“美女”图片之上，如图 7-6 所示。</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/2020-01-10-10-55-50-fe4e3e20b3123bba55cdc38c2e0b9b3b-81a6c.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 600px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 38.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAB4ElEQVQY02PY2uNzfpHf03WBF2b6rWvzbY+137xl9X8g+PsXSPwD4p8f9u5dMe3K/7lXfiy88WvF3T9bn/w7+vbflz//GXbXiR5rFb8zVXJPkXiSoZAIC0N7fy9I758/QL0gzT/e7NveNfX69zk3Pi64+3nt028H3v24/OPn93//GM5PULg4XfH+VOUrNYqHw5ViVHl6+tqAWv78+Qux+P+Pd1f3t5x5fOvys+u3X9988enO558Pfv1++O/fd4YjU+SuJMkv15YtNZGsNpNxUeXu6SgDaf77D6L574+P59cXXzu97cGFTW+vb/l6Z+v3B7u+P97798c7hvNFsqcNFLYVKC0Jk+8KUqj1FOtPd/3x9RPIw/9A3v7/7+ue6eGLKiKXVwdsqXFdW2K3pMhuaoblw+tnGHb15VXZsU2ME2qLFK4PFKr25q2L1Xr/9jVE8z9wsF07sCTTmKPWlTXDiSvGij3WlifSkunS6X0Md09vbUxwboh3yI52So5yLk3ymNGQ/vULxOZ/EMu/PLs6tTS8Kd6+OsUtI8a5Ms2nPdv3wc1LDL9+fP3w4d3LV6+ePXny+cP7Tx/efv388cePH/9h4NOnT58/f/z44e2Tp88eP3z08f27jx/eAXV9//YNADpXTyrfjFNrAAAAAElFTkSuQmCC\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="2020 01 10 10 55 50" title="" data-src="/static/2020-01-10-10-55-50-fe4e3e20b3123bba55cdc38c2e0b9b3b-81a6c.png" data-srcset="/static/2020-01-10-10-55-50-fe4e3e20b3123bba55cdc38c2e0b9b3b-468c3.png 200w,\n/static/2020-01-10-10-55-50-fe4e3e20b3123bba55cdc38c2e0b9b3b-3ff2b.png 400w,\n/static/2020-01-10-10-55-50-fe4e3e20b3123bba55cdc38c2e0b9b3b-81a6c.png 600w" data-sizes="(max-width: 600px) 100vw, 600px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>z-index: auto 所在的<code class="language-text">&lt;div&gt;</code>元素是一个普通定位元素，于是，里面的两个<code class="language-text">&lt;img&gt;</code>元素的层叠比较就不受父级的影响，两者直接套用“层叠黄金准则”。这里，两个<code class="language-text">&lt;img&gt;</code>元素有着明显不一的 z-index 值，因此遵循“谁大谁上”的准则，于是，z-index 为 2 的那个“美女”就显示在 z-index 为 1 的“美景”上面了。</p>\n<p>而 z-index 一旦变成数值，哪怕是 0，就会创建一个层叠上下文。此时，层叠规则就发生了变化。层叠上下文的特性里面最后一条是自成体系。两个<code class="language-text">&lt;img&gt;</code>元素的层叠顺序比较变成了优先比较其父级层叠上下文元素的层叠顺序。这里，由于外面的两个<code class="language-text">&lt;div&gt;</code>元素都是 z-index:0，两者层叠顺序一样大，此时遵循“层叠黄金准则”的另外一个准则“后来居上”，根据在 DOM 文档流中的位置决定谁在上面，于是，位于后面的“美景”就自然而然显示在“美女”上面了。对，没错，<code class="language-text">&lt;img&gt;</code>元素上的 z-index 没起作用！</p>\n<p>有时候，我们在网页重构的时候会发现 z-index 嵌套错乱，这时要看看是不是受父级的层叠上下文元素干扰了，可能就豁然开朗了。但我还是提一下，IE6 和 IE7 浏览器有个 bug，就是 z-index:auto 的定位元素也会创建层叠上下文。这就是过去 IE6 和 IE7 的 z-index 会折腾死人的原因。</p>\n<p>我再提一下 position:fixed。在过去，position:fixed 和 relative/ absolute 在层叠上下文这一块是一样的，都是需要 z-index 为数值才行。但是，不知道什么时候起，Chrome 等 WebKit 内核浏览器下 position:fixed 元素天然层叠上下文元素，无须 z-index 为数值。根据我的测试，目前 IE 和 Firefox 仍是老套路。</p>\n<h3 id="css3-与新时代的层叠上下文"><a href="#css3-%E4%B8%8E%E6%96%B0%E6%97%B6%E4%BB%A3%E7%9A%84%E5%B1%82%E5%8F%A0%E4%B8%8A%E4%B8%8B%E6%96%87" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>CSS3 与新时代的层叠上下文</h3>\n<p>CSS3 新世界的出现除了带来了新属性，还对过去的很多规则发出了挑战，其中对层叠上下文规则的影响显得特别突出。</p>\n<ol>\n<li>元素为 flex 布局元素（父元素 display:flex|inline-flex），同时 z-index 值不是 auto。</li>\n<li>元素的 opacity 值不是 1。</li>\n<li>元素的 transform 值不是 none。</li>\n<li>元素 mix-blend-mode 值不是 normal。</li>\n<li>元素的 filter 值不是 none。</li>\n<li>元素的 isolation 值是 isolate。</li>\n<li>元素的 will-change 属性值为上面 2 ～ 6 的任意一个（如 will-change:opacity、will-chang:transform 等）。</li>\n<li>元素的 -webkit-overflow-scrolling 设为 touch。</li>\n</ol>\n<h2 id="层叠上下文与层叠顺序"><a href="#%E5%B1%82%E5%8F%A0%E4%B8%8A%E4%B8%8B%E6%96%87%E4%B8%8E%E5%B1%82%E5%8F%A0%E9%A1%BA%E5%BA%8F" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>层叠上下文与层叠顺序</h2>\n<p>一旦普通元素具有了层叠上下文，其层叠顺序就会变高。那它的层叠顺序究竟在哪个位置、哪个级别呢？</p>\n<p>这里需要分两种情况讨论：</p>\n<ol>\n<li>如果层叠上下文元素不依赖 z-index 数值，则其层叠顺序是 z-index:auto，可看成 z:index:0 级别；</li>\n<li>如果层叠上下文元素依赖 z-index 数值，则其层叠顺序由 z-index 值决定。</li>\n</ol>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/2020-01-10-11-06-57-a557185fd95865232fa9dc2cdef58867-1fbcb.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 398px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 78.643216080402%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAIAAACZeshMAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACkElEQVQoz4VT/U8SYRy/P6lfK+uHXtZay4YvU6tZzkoBdc6yGTZKEYx8mXP9UIvMsjJbkqtMRVMURC4FgvDeODqOk461A1SIY3HHdQfL6TrXd8+ePc+ez8vz/ex5AHr9p8+MfpvAXKPQl+f+1RH/isnLfE8IgpDjc8I/lftb4hpA54hPmqVZvWNKa5u+Y/t4a/Gtco5y0eIZz/E7ONkC/JP4WM3MG619yAiO9ICPO1YeaBxDPa4nvW7YE93xL0jE43EcxzEMYxhGIici27QnujCOdrXYjO3Lhna7XmM3aGza5vnPFjyWYjeTmbwCL6JjsZjIDAQCiYTUF8DnhV2OiE5t7Wi3q7odjV0rjTqwoROsve0sVttevidFACfXPyDdJydsb2Xi0aRlKXyyfqGkzXpxwFI9MFs7OKvo/tA/7UTZMJGM8jmO47N7AitoFPy9WKzqhkP5cL4efqSCTHXQ0zLv4Fl3/1HnPSM+JcH2hgfs3nA8L/DCeoI6BhpKV7t1Pr3OZ7i/3nfX12lCBjy0GY878+FxMmSpAUHYSDMaZNwID7+Dml5DDWNw8wv/NZOvunftzGSwL+/PFfIH5J6BFCzzixz0VAyvVa8tKN1W9dfFRu9yG+LQRpx9DDrKsmmapmXJkn8yEwNpszv4jJxpCluaQlNqauYmaWnFJi5s2FrZdCrHyTnvaIhTZmsDNhdDr06jKhVyqQ45X4Oeq8TKrwTLVeHrXcD+XLEz7ndmO/kD3MSsmOIqcrgMOVKOHFQghxTQgVN4hXJ/513+XCodqFTDRaXI8UppnKiCi0qCl1v+Ry48bi7Lhqg0TrB4iMVJaQSIDBmRIVMUJX6AVCpFEEQoFCr8BCpKB8NklsvuRv4B5bgrkz/SXtQAAAAASUVORK5CYII=\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="2020 01 10 11 06 57" title="" data-src="/static/2020-01-10-11-06-57-a557185fd95865232fa9dc2cdef58867-1fbcb.png" data-srcset="/static/2020-01-10-11-06-57-a557185fd95865232fa9dc2cdef58867-4ab03.png 200w,\n/static/2020-01-10-11-06-57-a557185fd95865232fa9dc2cdef58867-1fbcb.png 398w" data-sizes="(max-width: 398px) 100vw, 398px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>这下大家应该知道为什么定位元素会层叠在普通元素的上面了吧？其根本原因就是：元素一旦成为定位元素，其 z-index 就会自动生效，此时其 z-index 就是默认的 auto，也就是 0 级别，根据上面的层叠顺序表，就会覆盖 inline 或 block 或 float 元素。而不支持 z-index 的层叠上下文元素天然是 z-index:auto 级别，也就意味着，层叠上下文元素和定位元素是一个层叠顺序的，于是当它们发生层叠的时候，遵循的是“后来居上”准则。</p>\n<html><head></head><body><div class="gatsby-code-button-container" data-toaster-id="72309306458594255000" data-toaster-class="gatsby-code-button-toaster" data-toaster-text-class="gatsby-code-button-toaster-text" data-toaster-text="复制成功" data-toaster-duration="3500" onclick="copyToClipboard(`<img data-src=&quot;1.jpg&quot; style=&quot;position:relative&quot; /> <img src=&quot;2.jpg&quot; style=&quot;transform:scale(1);&quot; />`, `72309306458594255000`)">\n              <div class="gatsby-code-button" title="html">\n                <span class="gatsby-code-button-language">html</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div></body></html>\n<div class="gatsby-highlight" data-language="html"><pre style="counter-reset: linenumber NaN" class="language-html line-numbers"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1.jpg<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">position</span><span class="token punctuation">:</span>relative</span><span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2.jpg<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">transform</span><span class="token punctuation">:</span><span class="token function">scale</span><span class="token punctuation">(</span>1<span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>\n<p>这符合“后来居上”准则，“美景”覆盖在“美女”之上，如图 7-8 所示。</p>\n<html><head></head><body><div class="gatsby-code-button-container" data-toaster-id="89393625000625470000" data-toaster-class="gatsby-code-button-toaster" data-toaster-text-class="gatsby-code-button-toaster-text" data-toaster-text="复制成功" data-toaster-duration="3500" onclick="copyToClipboard(`<img data-src=&quot;2.jpg&quot; style=&quot;transform:scale(1);&quot; /> <img src=&quot;1.jpg&quot; style=&quot;position:relative&quot; />`, `89393625000625470000`)">\n              <div class="gatsby-code-button" title="html">\n                <span class="gatsby-code-button-language">html</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div></body></html>\n<div class="gatsby-highlight" data-language="html"><pre style="counter-reset: linenumber NaN" class="language-html line-numbers"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2.jpg<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">transform</span><span class="token punctuation">:</span><span class="token function">scale</span><span class="token punctuation">(</span>1<span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1.jpg<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">position</span><span class="token punctuation">:</span>relative</span><span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>\n<p>这同样符合“后来居上”准则，“美女”覆盖在“美景”之上，如图 7-9 所示。</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/2020-01-10-11-11-53-11f48727d02154ce721c5f1538a1ab3b-68fa4.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 641px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 36.973478939157566%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABjElEQVQY02O4d2nnwvMvl93+t+r2r40P/ux5+e/q53///sMAmPn765sDsxOurop5ujH+7Ly4+bVhU+uyXn//xXDnxMwZp2/Muf194d2PG59+OfL+272fv/4jNP8Faf78+ECT1PFW4bvTxNckirhKs2mrKb359o3hydlZF2/svfP69pN31z99u/v378P//58DNSHb/PPjk/PT1S9PVrjeqHwkS2mlm5S7mebnb+8Ybh3oO7yq88KuBff3TXt8YOqD/dMenVr17+8fmF6QzV8/PDrZo3DRVW62kWyuvmSaiZiHqdzLB1cYHp5d3BtjMDlee0qCcleYbJ2/WGea1c+fP8A6/0Fs/vPv7YlK27W2Ytuq5JcmysyIk2vx4j26dTHD3x8f2uNtci3ZklxEA2yFw22EyuPMEZr///8LdsWJTbMzbXjKvcRiXETiXaXi7fj3b1nE8O3Lx8fXT+zbsmYvEG1ff3Lfltvnj/75/fs/UqB9//Hz04t7J/du2rN51e4t6w7t3nLu0I53L54AAL6sK+iccUPyAAAAAElFTkSuQmCC\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="2020 01 10 11 11 53" title="" data-src="/static/2020-01-10-11-11-53-11f48727d02154ce721c5f1538a1ab3b-68fa4.png" data-srcset="/static/2020-01-10-11-11-53-11f48727d02154ce721c5f1538a1ab3b-ea38f.png 200w,\n/static/2020-01-10-11-11-53-11f48727d02154ce721c5f1538a1ab3b-bb505.png 400w,\n/static/2020-01-10-11-11-53-11f48727d02154ce721c5f1538a1ab3b-68fa4.png 641w" data-sizes="(max-width: 641px) 100vw, 641px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>你会发现，两者样式一模一样，只是在 DOM 流中的位置不一样，这导致它们的层叠表现不一样，后面的图片在前面的图片的上面显示。这就说明层叠上下文元素的层叠顺序就是 z-index:auto 级别。</p>\n<p>最后分享一个与层叠上下文相关的有趣现象。</p>\n<p>在实际项目中，我们可能会渐进使用 CSS3 的 fadeIn 淡入 animation 效果增强体验，于是我们可能就会遇到类似下面的现象，有一个绝对定位的黑色半透明层覆盖在图片上，默认显示如图 7-10 所示。但是，一旦图片开始走 fadeIn 淡出的 CSS3 动画，文字就跑到图片后面去了，因为文字一直是 100%透明的纯白色，文字变淡是因为跑到图片后面，而图片半透明，文字穿透显示而已，如图 7-11 所示。</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/2020-01-10-11-13-55-f903d00225e6ac763225c48b30ee5051-50e58.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 593px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 31.1973018549747%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABZElEQVQY02N4/+D4li736yv8H64IPDPNf2GVd3uS+7NHd/7////v318gAjLe3Dl0Zl3dqxOdzw+039jWtn1Ow9Z5vT9/fGf4cHvbrir+M52StydLrk4W9VXlE+dlv3ThAlDP379QzW+vbzi3KPTR5uQnmxJ398SVJ4TmZ6V9/fqF4cPdnWcmSF+erfJgkvLZQqVdgQpOiiKnzl2EaP4P1vzh5uY7m+Ke7Mp6tTn9zsz0Iw1JdYU5n758ZXh9c/vpXvEr/vLzDGSKjSXKTCWs1AXPnUex+dWNzXfWxt2py9xSkjqvOHVWcUJted6nT18Ybl7eNj1CbZqNUWuEVq6jZqKHfpid+q2rF5E1P7y64lSB94HCsF1dwcvLgudVBMyvS/wOdPbLF0/v3Lhy6+7V61fO3Lt1/uGtizcunvr6+RM4wP4Bya9fv3149/zFncuP7l589+zG+6fXnt44/fzu5Q/v3wMAGAz6LJyS9aoAAAAASUVORK5CYII=\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="2020 01 10 11 13 55" title="" data-src="/static/2020-01-10-11-13-55-f903d00225e6ac763225c48b30ee5051-50e58.png" data-srcset="/static/2020-01-10-11-13-55-f903d00225e6ac763225c48b30ee5051-d1b16.png 200w,\n/static/2020-01-10-11-13-55-f903d00225e6ac763225c48b30ee5051-aef18.png 400w,\n/static/2020-01-10-11-13-55-f903d00225e6ac763225c48b30ee5051-50e58.png 593w" data-sizes="(max-width: 593px) 100vw, 593px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>为什么会这样？实际上，学了本节的内容后就很容易理解了。fadeIn 动画本质是 opacity 透明度的变化：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="19459366183722594000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`@keyframes fadeIn {\n  0% {\n    opacity: 0;\n  }\n  100% {\n    opacity: 1;\n  }\n}`, `19459366183722594000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="css"\n              >\n                <span class="gatsby-code-button-language">css</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="css"><pre style="counter-reset: linenumber NaN" class="language-css line-numbers"><code class="language-css"><span class="token atrule"><span class="token rule">@keyframes</span> fadeIn</span> <span class="token punctuation">{</span>\n  <span class="token selector">0%</span> <span class="token punctuation">{</span>\n    <span class="token property">opacity</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n  <span class="token selector">100%</span> <span class="token punctuation">{</span>\n    <span class="token property">opacity</span><span class="token punctuation">:</span> 1<span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>要知道，opacity 的值不是 1 的时候，是具有层叠上下文的，层叠顺序是 z-index:auto 级别，跟没有 z-index 值的 absolute 绝对定位元素是平起平坐的。而本实例中的文字元素在图片元素的前面，于是，只要 CSS3 动画不是最终一瞬间的 opacity:1，位于 DOM 流后面的图片就会遵循“后来居上”准则而覆盖文字。</p>\n<p>知道原因，想要解决这个问题就很简单了：</p>\n<ol>\n<li>调整 DOM 流的先后顺序；</li>\n<li>提高文字的层叠顺序，例如，设置 z-index:1。</li>\n</ol>\n<h1 id="z-index-负值深入理解"><a href="#z-index-%E8%B4%9F%E5%80%BC%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>z-index 负值深入理解</h1>\n<p>z-index 是支持负值的，例如 z-index:-1 或者 z-index:-99999 都是可以的。</p>\n<p>那 z-index 具体的表现规则又是怎样的呢？</p>\n<p>很多人（包括我）一开始的时候，以为一个定位元素设置 z-index 负值，就会跑到页面的背后，隐藏掉，看不到了。结果实际上是有时候确实隐藏了，但有时候又隐藏不掉。为什么会这样？</p>\n<p>因为 z-index 负值的最终表现并不是单一的，而是与“层叠上下文”和“层叠顺序”密切相关。前面展示的层叠顺序规则 7 阶图，其中最下面的 2 阶是理解 z-index 负值表现的关键，如图 7-12 所示。</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/2020-01-10-11-22-00-6f3361285f041e0a0b7683bd159d9b26-9a824.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 235px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 69.7872340425532%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACuUlEQVQoz22R2U8aURSH+QubprZ97UtfrC3qsLkWQRg2UUptWqtJlzSNVm0ctY1UhWGYDUStoAgoIFJZZpRloDADgr0jTRpNT76Hk3vz/U7OvZJmo8nlyqVchctWOKZSuoZjb1NiyjWudnWzJIVUyTVG+94FsRd+xyjhtm2tj5JLkHNZiSIKFFGiK33u1QHsa/fm7nwICK1m65+cTxWdRhq373hs/g09vWmkNmDvut7r0FA/dPSamkJknhUlvtjl9M8eAOGy0Ww2W83rCEn+V2lNi2+aaHR8y2XxOmHCZaAwC+0ykS4L6dSTq3L0ez+29HQjsHh4e3IhXULkKAJhiMy90o8uwuS8jpjTer5oiTYLMLVgoEDjeB8I7mT3vOld+iy6z1zLZyVEhi7LMQRyf1MTLzX0zIR/yuqdHvd9erMzCVOwgjCoRGA5PirFdD3Y8050xuIT5WKWW9PgDg3pUBPrZnpyhDSrPNZBfKwftw6AHjfKCRGFiFlFWvpIfS/+0b4tymAHoSYIVb7B1yvF369hH7gzKUUB+BNDhG1YZHyQAP3EkHhiUWGfX/lFub16qyU+g1CrvzVuAQ3E2wbJEQPRpXFLtSIKIw4ZsF49rjITEOxRmMjTTPmGzNfqdjWp7nRrnmEmCJOqicc6qttCd+oplc0PWb1PDF6pie6zbz8aJkKxkqRt/p0sNFZnD2anfs5N7yEfAkNj9J1u90OF577c0wFhHTKRexD2QO6524NFTzjJ1f+q/ZVVvsUUGky+nj3n2WL9vHjJFhq5vABgi416oyVhWTYUChUKhXQ6nc/nBaF+cpKMxxLB4P5+MBCPHzO5bKVSjkbDR9FwKpVkmdzFxXk8diTwvARoiUSiWq1mMhkQBAaCiDiQjo8jkUg8nuC4Ms8LocPwYTgSi8XT6Uw2xySTpzzP/wHkE4tYzIFZUQAAAABJRU5ErkJggg==\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="2020 01 10 11 22 00" title="" data-src="/static/2020-01-10-11-22-00-6f3361285f041e0a0b7683bd159d9b26-9a824.png" data-srcset="/static/2020-01-10-11-22-00-6f3361285f041e0a0b7683bd159d9b26-012e0.png 200w,\n/static/2020-01-10-11-22-00-6f3361285f041e0a0b7683bd159d9b26-9a824.png 235w" data-sizes="(max-width: 235px) 100vw, 235px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>图 7-12 中已经很明显地标明了，z-index 负值元素的层级是在层叠上下文元素上面、block 元素的下面，也就是 z-index 虽然名为负数层级，但依然无法突破当前层叠上下文所包裹的小世界。</p>\n<html><head></head><body><div class="gatsby-code-button-container" data-toaster-id="91532617921385640000" data-toaster-class="gatsby-code-button-toaster" data-toaster-text-class="gatsby-code-button-toaster-text" data-toaster-text="复制成功" data-toaster-duration="3500" onclick="copyToClipboard(`<div class=&quot;box&quot;>\n  <img data-src=&quot;1.jpg&quot; />\n</div>`, `91532617921385640000`)">\n              <div class="gatsby-code-button" title="html">\n                <span class="gatsby-code-button-language">html</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div></body></html>\n<div class="gatsby-highlight" data-language="html"><pre style="counter-reset: linenumber NaN" class="language-html line-numbers"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>box<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1.jpg<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<p>先看下面的 CSS 代码：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="10852496303808690000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`.box {\n  background-color: blue;\n}\n\n.box > img {\n  position: relative;\n  z-index: -1;\n  right: -50px;\n}`, `10852496303808690000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="css"\n              >\n                <span class="gatsby-code-button-language">css</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="css"><pre style="counter-reset: linenumber NaN" class="language-css line-numbers"><code class="language-css"><span class="token selector">.box</span> <span class="token punctuation">{</span>\n  <span class="token property">background-color</span><span class="token punctuation">:</span> blue<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token selector">.box > img</span> <span class="token punctuation">{</span>\n  <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>\n  <span class="token property">z-index</span><span class="token punctuation">:</span> -1<span class="token punctuation">;</span>\n  <span class="token property">right</span><span class="token punctuation">:</span> -50px<span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>此时.box 是一个普普通通的元素，图片元素所在的层叠上下文元素一定是 .box 的某个祖先元素。好了，知道这么多足够了，现在再回顾一下刚刚出现的图 7-13 所示的这张图。</p>\n<p>图 7-13 中非常明显地标明了 z-index 负值在 block 元素的下面。本例中，图片是 z-index 负值元素，.box 是 block 元素，也就是图片应该在 .box 元素的后面显示，因此，图片会被 .box 元素的蓝色背景覆盖。最后的结果确实如此，如图 7-14 所示。</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/2020-01-10-11-26-27-bf8242fa2e65336e5dd32faa2b20abf2-5e116.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 591px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 31.810490693739425%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABXElEQVQY0y3PsUsCURzA8XenU6Ag4h/QkoWgDUKD20FbS9DSP9BQi9RQg4kWiEM2FI6C0BKEZCo3OEl5F1pw0ZWQFFJcWtKhpud56nuv97TH4zv8eB/eewBjjCAiC042whhCNB4jOqfBzSb2+ZDLhTwe5HajRc/I6cLrXCKxvwr0ti6nq9J55S4plxKPYlxSa62JRBBSrCjYakUAIIaZFAwBwDPmA25pFnQa3cxO4Spwk46IqZBw5i+Imbfaa2s8gtOb63Vss1HGstSbWIq9jugatwC0li5fvKTjD7Fg8fRQPAqI0d3iSfi23zMw/sd2OwQAms3QZCI1CJ5zRFaWnYD8kJwoXyuxPWE7JGwEha2wsBkS683+FJNnWyyYAIahZdkRKTd/nPR7Qa/bGxpGp619vqtSpVGUlPLTd0n++lE7g4FOsGHgfF7jeZ3n+9lsN5f7TV1qz/cfSK3+AbId9t36rQpsAAAAAElFTkSuQmCC\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="2020 01 10 11 26 27" title="" data-src="/static/2020-01-10-11-26-27-bf8242fa2e65336e5dd32faa2b20abf2-5e116.png" data-srcset="/static/2020-01-10-11-26-27-bf8242fa2e65336e5dd32faa2b20abf2-dd2a5.png 200w,\n/static/2020-01-10-11-26-27-bf8242fa2e65336e5dd32faa2b20abf2-20405.png 400w,\n/static/2020-01-10-11-26-27-bf8242fa2e65336e5dd32faa2b20abf2-5e116.png 591w" data-sizes="(max-width: 591px) 100vw, 591px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>现在，我们给.box 元素加个样式，使其具有层叠上下文。很多 CSS 属性都可以，我们这里就使用不影响视觉表现的 transform 属性示意如下：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="59620659608602165000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`.box {\n  background-color: blue;\n  transform: scale(1);\n}\n\n.box > img {\n  position: relative;\n  z-index: -1;\n  right: -50px;\n}`, `59620659608602165000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="css"\n              >\n                <span class="gatsby-code-button-language">css</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="css"><pre style="counter-reset: linenumber NaN" class="language-css line-numbers"><code class="language-css"><span class="token selector">.box</span> <span class="token punctuation">{</span>\n  <span class="token property">background-color</span><span class="token punctuation">:</span> blue<span class="token punctuation">;</span>\n  <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">scale</span><span class="token punctuation">(</span>1<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token selector">.box > img</span> <span class="token punctuation">{</span>\n  <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>\n  <span class="token property">z-index</span><span class="token punctuation">:</span> -1<span class="token punctuation">;</span>\n  <span class="token property">right</span><span class="token punctuation">:</span> -50px<span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>CSS3 transform 可以让元素具有新的层叠上下文，于是，对照图 7-15，非常明显地标明了 z-index 负值在层叠上下文元素的背景色之上，也就是说，这里 z-index 是负值的图片元素应该在.box 元素的上面。最后的结果确实如此，如图 7-16 所示。</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/2020-01-10-11-26-47-762d82898305a2462bd9d4faf5b8e39a-ad33d.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 652px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 29.601226993865033%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABVUlEQVQY02P4DwT/kMD/f3///fv7999/MPj7FyR99tx/H4/3OydFXVkR+nhd+KlZ4dOL/WbWpDEAJZ9denl64eUz8y+fnHXxUM+pJ2dfgHSA9f/5A2Lu2vNfkPvFrlrZkx0i96ZJrk8Sc5NiM9ZUB2m+tvXu6uxda9qPrW47Pr/wwOZZly6cfPb75x+45r37/gvzvDg+UfPqVKWrdSqHM5RXuUn5WhmDNL9//On6vgd9tceaKg431x+tLT3UVHnow4fvYM1A+//t3vOfl/P5oRaZS87Cs/SEs7QF47Q4vG00GCB++/Xr77ZlN6fNvFQ15VzdtAsNMy8+efkVrvn48f8mZu/3VSXtiona1R2zuTx2VUXYwal5DO/evfv27dvXr98+ff748tXrN28/Pn3+6s3bD58/f/nx4wcs2P69fv3x1ZvPz968f/rszbNnr9+8evvr53cA/PIN8nnJG/8AAAAASUVORK5CYII=\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="2020 01 10 11 26 47" title="" data-src="/static/2020-01-10-11-26-47-762d82898305a2462bd9d4faf5b8e39a-ad33d.png" data-srcset="/static/2020-01-10-11-26-47-762d82898305a2462bd9d4faf5b8e39a-6a23f.png 200w,\n/static/2020-01-10-11-26-47-762d82898305a2462bd9d4faf5b8e39a-cad54.png 400w,\n/static/2020-01-10-11-26-47-762d82898305a2462bd9d4faf5b8e39a-ad33d.png 652w" data-sizes="(max-width: 652px) 100vw, 652px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>可以这么说，z-index 负值渲染的过程就是一个寻找第一个层叠上下文元素的过程，然后层叠顺序止步于这个层叠上下文元素。</p>\n<p>那 z-index 负值在实际项目中有什么用呢？具体作用如下。</p>\n<ol>\n<li>\n<p><strong>可访问性隐藏。</strong>z-index 负值可以隐藏元素，只需要层叠上下文内的某一个父元素加个背景色就可以。它与 clip 隐藏相比的一个优势是，元素无须绝对定位，设置 position:relative 也可以隐藏，另一个优势是它对原来的布局以及元素的行为没有任何影响，而 clip 隐藏会导致控件 focus 的焦点发生细微的变化，在特定条件下是有体验问题的。它的不足之处就是不具有普遍适用性，需要其他元素配合进行隐藏。</p>\n</li>\n<li>\n<p><strong>IE8 下的多背景模拟。</strong>CSS3 中有一个多背景特性，就是一个 background 可以写多个背景图。虽然 IE8 浏览器不支持多背景特性，但是 IE8 浏览器支持伪元素，于是，IE8 理论上也能实现多背景，这个背景最多 3 个，好在绝大多数场景 3 个背景图足矣。最麻烦的其实是这个伪元素生成的背景一定是使用 absolute 绝对定位，以免影响内容的布局。于是问题来了，绝对定位会覆盖常规的元素，此时则必须借助 z-index 负值，核心 CSS 代码如下：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="60253561773349860000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`.box {\n background-image: (1png);\n position: relative;\n z-index: 0; /* 创建层叠上下文 */\n}\n\n.box:before,\n.box:after {\n content: \'\';\n position: absolute;\n z-index: -1;\n}\n\n.box:before {\n background-image: (2png);\n}\n\n.box:after {\n background-image: (3png);\n}`, `60253561773349860000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="css"\n              >\n                <span class="gatsby-code-button-language">css</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="css"><pre style="counter-reset: linenumber NaN" class="language-css line-numbers"><code class="language-css"><span class="token selector">.box</span> <span class="token punctuation">{</span>\n <span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token punctuation">(</span>1png<span class="token punctuation">)</span><span class="token punctuation">;</span>\n <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>\n <span class="token property">z-index</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span> <span class="token comment">/* 创建层叠上下文 */</span>\n<span class="token punctuation">}</span>\n\n<span class="token selector">.box:before,\n.box:after</span> <span class="token punctuation">{</span>\n <span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">\'\'</span><span class="token punctuation">;</span>\n <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>\n <span class="token property">z-index</span><span class="token punctuation">:</span> -1<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token selector">.box:before</span> <span class="token punctuation">{</span>\n <span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token punctuation">(</span>2png<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token selector">.box:after</span> <span class="token punctuation">{</span>\n <span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token punctuation">(</span>3png<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>此时，就算.box 元素里面是纯文字，伪元素图片照样在文字下面，如此广泛的适用场景使上面的处理几乎可以作为通用的多背景模拟实现准则来实现了：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="39404802141552796000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`<div class=&quot;box&quot;>我是一段纯文字...</div>`, `39404802141552796000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="html"\n              >\n                <span class="gatsby-code-button-language">html</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="html"><pre style="counter-reset: linenumber NaN" class="language-html line-numbers"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>box<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>我是一段纯文字...<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>\n</li>\n<li>\n<p><strong>定位在元素的后面。</strong>我们直接看一个模拟纸张效果的例子，该效果的亮点是纸张的边角有卷起来的效果，因为底边的阴影看起来更有角度，如图 7-17 所示。 <html><head></head><body><a class="gatsby-resp-image-link" href="/static/2020-01-10-11-32-52-fbbea1c663adfb56fab6befa70acade5-63b89.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 221px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 72.39819004524887%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAB90lEQVQoz3WS2W7aQBSGecE2TdvIYLyMPeMlNBI3FKqWNOpd1WdokquWF0GiEstFYyAXICTUOoDNHhbjGaYn0EqJTH99OvI59ucZWxPjfLvdtLbBz23gHIStHR46Pbfu1Ju3uzSbzVarRSmN8W1IB2/D38ehGw9dIUrwS+Aj4fvXRDyhmyYxDEPTtEwms1wud7L/jt6d0J5Ee8koGzfJJ8nCpSQmiW2blmVhjLPZ7D95+J72BNpXaF+OsrmT+VQuXMkHZcpGH1g/zgYqGyhRwp7CZ0rh+r/yORuIzNOYh6KEfcTnqHClHJI55ZML7st8SPgQPzB6AvMxX+DCtZIQ8Wl0ZTq6oAOZeoR6OMqmj/k9+XZ5SKY0/PI5m7KO02fCWerkjf06Zb9KWS9t44VFjkz8nOjPTs0jAycwMUzzqRyGNJ//lBBVFRmKQiRZf0DSxSQSRRRPKEJcFgRZVXVrF9u2CSG5XG4vhx/P85IkYqzpOgI0TQV0DQGa9rdFSN0HISRJUjqdXiwW8MN4p9NxHKfRaNTr9Zubm/0BhMCk+SiPWziejLHYZDLxfX+9XgdBsFqt4F3T6XQ2m8GuYHK/C0xgHbiYz+dwazwegwJtrNvtVqtV13Xb7bbnefAVtVqtXC5Dhe1UKhWoP3aBx6CFWiqVisUiKH8Ac4RDYuLD5LkAAAAASUVORK5CYII=\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="2020 01 10 11 32 52" title="" data-src="/static/2020-01-10-11-32-52-fbbea1c663adfb56fab6befa70acade5-63b89.png" data-srcset="/static/2020-01-10-11-32-52-fbbea1c663adfb56fab6befa70acade5-89cc8.png 200w,\n/static/2020-01-10-11-32-52-fbbea1c663adfb56fab6befa70acade5-63b89.png 221w" data-sizes="(max-width: 221px) 100vw, 221px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n<p>HTML 结构大致如下：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="27961701325210587000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`<div class=&quot;container&quot;>\n <div class=&quot;page&quot;>标题和内容</div>\n</div>`, `27961701325210587000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="html"\n              >\n                <span class="gatsby-code-button-language">html</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="html"><pre style="counter-reset: linenumber NaN" class="language-html line-numbers"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>\n <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>page<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>标题和内容<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<p>其中，.container 是灰色背景元素，.page 是黄色背景的纸张元素，关键 CSS 如下：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="75805224357515330000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`.container {\n background-color: #666;\n /* 创建层叠上下文 */\n position: relative;\n z-index: 0;\n}\n\n.page {\n background-color: #f4f39e;\n position: relative;\n}\n\n/* 边角卷边阴影 */\n.page:before,\n.page:after {\n content: \'\';\n width: 90%;\n height: 20%;\n box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);\n position: absolute;\n /* 层叠上下文（灰色背景）之上，定位元素（黄色纸张）之下 */\n z-index: -1;\n}\n\n/* 边角卷边阴影定位和角度控制 */\n.page:before {\n transform: skew(-15deg) rotate(-5deg);\n transform-origin: left bottom;\n left: 0;\n bottom: 0;\n}\n\n.page:after {\n transform: skew(15deg) rotate(5deg);\n transform-origin: right bottom;\n right: 0;\n bottom: 0;\n}`, `75805224357515330000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="css"\n              >\n                <span class="gatsby-code-button-language">css</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="css"><pre style="counter-reset: linenumber NaN" class="language-css line-numbers"><code class="language-css"><span class="token selector">.container</span> <span class="token punctuation">{</span>\n <span class="token property">background-color</span><span class="token punctuation">:</span> #666<span class="token punctuation">;</span>\n <span class="token comment">/* 创建层叠上下文 */</span>\n <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>\n <span class="token property">z-index</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token selector">.page</span> <span class="token punctuation">{</span>\n <span class="token property">background-color</span><span class="token punctuation">:</span> #f4f39e<span class="token punctuation">;</span>\n <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">/* 边角卷边阴影 */</span>\n<span class="token selector">.page:before,\n.page:after</span> <span class="token punctuation">{</span>\n <span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">\'\'</span><span class="token punctuation">;</span>\n <span class="token property">width</span><span class="token punctuation">:</span> 90%<span class="token punctuation">;</span>\n <span class="token property">height</span><span class="token punctuation">:</span> 20%<span class="token punctuation">;</span>\n <span class="token property">box-shadow</span><span class="token punctuation">:</span> 0 8px 16px <span class="token function">rgba</span><span class="token punctuation">(</span>0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0.3<span class="token punctuation">)</span><span class="token punctuation">;</span>\n <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>\n <span class="token comment">/* 层叠上下文（灰色背景）之上，定位元素（黄色纸张）之下 */</span>\n <span class="token property">z-index</span><span class="token punctuation">:</span> -1<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">/* 边角卷边阴影定位和角度控制 */</span>\n<span class="token selector">.page:before</span> <span class="token punctuation">{</span>\n <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">skew</span><span class="token punctuation">(</span>-15deg<span class="token punctuation">)</span> <span class="token function">rotate</span><span class="token punctuation">(</span>-5deg<span class="token punctuation">)</span><span class="token punctuation">;</span>\n <span class="token property">transform-origin</span><span class="token punctuation">:</span> left bottom<span class="token punctuation">;</span>\n <span class="token property">left</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n <span class="token property">bottom</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token selector">.page:after</span> <span class="token punctuation">{</span>\n <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">skew</span><span class="token punctuation">(</span>15deg<span class="token punctuation">)</span> <span class="token function">rotate</span><span class="token punctuation">(</span>5deg<span class="token punctuation">)</span><span class="token punctuation">;</span>\n <span class="token property">transform-origin</span><span class="token punctuation">:</span> right bottom<span class="token punctuation">;</span>\n <span class="token property">right</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n <span class="token property">bottom</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>.container 灰色背景通过 position:relative;z-index:0 创建了层叠上下文，.page 仅有 position:relative 而没有设置 z-index 值，因此只能算 z-index:auto 程度的定位元素，于是，z-index:-1 两个边角阴影就完美地藏在了层叠上下文（灰色背景）之上、普通定位元素（黄色纸张）之下（如图 7-18 所示标注），隐藏了丑陋的细节，展示了完美的边角阴影，实现了最终细腻的样式效果。</p>\n<p><html><head></head><body><a class="gatsby-resp-image-link" href="/static/2020-01-10-11-38-57-4518b246b1a2b17fb8ccf2c4dde89c9d-24d05.png" style="display: block" target="_blank" rel="noopener">\n  \n  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 436px; margin-left: auto; margin-right: auto;">\n    <span class="gatsby-resp-image-background-image" style="padding-bottom: 75.45871559633028%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACW0lEQVQoz32Ty27TQBSG81i8BA/QBWxZsGJFJRABgYQKi8KqFaqQShFUoIJoChWqgIakoUnpJW2Sxonj1Lfx2I7v4/HYsRMml9K0XH6Nztia+c75xz6TgkznaLVRyTQP3tT3Xtd2lqrllUbcjZMkpiKEhGHoui596Pf7vVP1h0oxG+3Mzc3P97c+pnOf0rn3N76s3y1YhmuaNsWgqtq2rWma7/sjuD+hVG2dW7m2sfygsPC4tPDwx+x0bnY6/zS9/Wqu7DpOQLBlWYqiCIIgyzIAoNVq0TiGfTPwgLe+fHzn+ub8zM6L+cPFufLCk/23i1UATccLcIDtoTzPo/4dx0EIjeFeMnBS/MbP3trKfj3hdcyKbkvymqJbaTpM202Sc1bP2R4cP+lFYRyRSATebs2o8UYd6gzs1FWd0TUlsHTiXPhUY3jyxUZEgj5n61UsMb5cR1IVCWWnXffEOIl6SUzrRIHZJW4c+t3QPQeP0sqBseOc8IiHflsJREhkjcgGAU5k0FVscajTQAbradXUnyfB3dCMsI4F4DOgUwRKFsAcUAuq/hObbIj0OEJJF1+0PenAJhDik1bhXvPDVGN1il27wq5dPX53mf9+OyTGaFvqrygdSa9LI91aeXlJ3pzRCksw/1zNPjN3M5FiRB3rX5XP6ncaq3LxEarukSMpOGyTfS7Ya+Ltg6DW6v0XHmUYpAjYtpcv+cX9wSgd+MUy/g1f+HsTpQc9QOfYQ9RnZFin0YxsdwxDSPtfxUPRTqadSO8QvQzcUHSJFwVeEhVVlRTAcpwMoSCJtEl/AbmkNMetDThWAAAAAElFTkSuQmCC\'); background-size: cover; display: block;">\n      <img class="gatsby-resp-image-image lazy" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;" alt="2020 01 10 11 38 57" title="" data-src="/static/2020-01-10-11-38-57-4518b246b1a2b17fb8ccf2c4dde89c9d-24d05.png" data-srcset="/static/2020-01-10-11-38-57-4518b246b1a2b17fb8ccf2c4dde89c9d-7ab77.png 200w,\n/static/2020-01-10-11-38-57-4518b246b1a2b17fb8ccf2c4dde89c9d-a60d7.png 400w,\n/static/2020-01-10-11-38-57-4518b246b1a2b17fb8ccf2c4dde89c9d-24d05.png 436w" data-sizes="(max-width: 436px) 100vw, 436px">\n    </span>\n  </span>\n  \n  </a>\n    </body></html></p>\n</li>\n</ol>\n<h1 id="z-index不犯二准则"><a href="#z-index%E4%B8%8D%E7%8A%AF%E4%BA%8C%E5%87%86%E5%88%99" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>z-index“不犯二”准则</h1>\n<p>此准则内容如下：对于非浮层元素，避免设置 z-index 值，z-index 值没有任何道理需要超过 2。</p>\n<ol>\n<li>定位元素一旦设置了 z-index 值，就从普通定位元素变成了层叠上下文元素，相互间的层叠顺序就发生了根本的变化，很容易出现设置了巨大的 z-index 值也无法覆盖其他元素的问题。</li>\n<li>避免 z-index “一山比一山高”的样式混乱问题。此问题多发生在多人协作以及后期维护的时候。例如，A 小图标定位，习惯性写了个 z-index:9；B 一看，自己原来的实现被覆盖了，立马写了个 z-index:99；结果比弹框组件层级还高，那还得了，立马弹框组件来一个 z-index:999999；谁知后来，弹框中又要有出错提示效果……显然，最后项目的 z-index 层级管理就是一团糟。</li>\n</ol>\n<p>如果真的了解了本章的内容，你就会发现，原来自己的代码中很大一部分 z-index 设置都是多余的，不仅浪费代码，还埋下样式问题风险，尤其那种使用 absolute 绝对定位必使用 z-index 的做法是最愚蠢的。</p>\n<p>如果 DOM 顺序确实无法调整，不得不使用 z-index 值，请记住，z-index 不要超过 2，不是不能，而是没有必要。我从业这么多年，遇到很多很复杂的与定位相关的交互场景，但 z-index 最多止步于 2。如果你的定位发现必须 z-index:3 或者以上才能满足效果，建议你检查自己的代码，试试应用“relative 的最小化原则”来实现，试试利用元素原生的层叠顺序进行层级控制，等等。</p>\n<p>很重要的一点，我这里的“不犯二”准则，并不包括那些在页面上飘来飘去的元素定位，弹框、出错提示、一些下拉效果等都不受这一准则限制。</p>\n<p>对于这类 JavaScript 驱动的浮层组件，我会借助“层级计数器”来管理，原因如下：</p>\n<ol>\n<li>总会遇到意想不到的高层级元素；</li>\n<li>组件的覆盖规则具有动态性。</li>\n</ol>\n<p>所谓“层级计数器”，实际上就是一段 JavaScript 脚本，会遍历所有<code class="language-text">&lt;body&gt;</code>处于显示状态的子元素，并得到最大 z-index 值，和默认的 z-index 做比较。如果超出，则显示的组件的 z-index 自动加 1，这样就不会出现有组件被其他组件覆盖的问题；如果不超出，就使用默认的 z-index 值，我习惯设成 9，因为遵循“不犯二”准则的情况下，9 已经是个足够安全的值了，浮层组件根本无须担心会被页面上某个元素层级覆盖。</p>\n<p>此刻大家不妨想想自己的项目，如果所有的浮层相关的组件容器的 z-index 默认值是 9，会不会出现样式问题。如果觉得层级太低不敢想象，则说明你的项目层级这块还有较大改进的空间。页面上主体元素遵循 z-index“不犯二”准则，浮层元素使用 z-index“层级计数器”，双管齐下，从此和 z-index 问题说拜拜！</p>',
id:"/home/runner/work/GatsbyBlog/GatsbyBlog/blog/CSS世界的层叠规则/index.md absPath of file >>> MarkdownRemark",timeToRead:11,frontmatter:{date:"2020-01-10 10:19:55",path:"/css-world-stacking-rule/",tags:"前端, CSS, CSS世界, 读书笔记",title:"CSS世界的层叠规则",draft:null}}],page:21,pagesSum:47,length:231,prevPath:"/page/20",nextPath:"/page/22"}}}});